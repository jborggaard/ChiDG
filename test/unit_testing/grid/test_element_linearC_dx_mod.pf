module test_element_linearC_dx_mod
    use pfunit_mod
    use mod_kinds,                  only: rk,ik
    use mod_constants,              only: ZERO, ONE, TWO, THREE, FIVE, SIX, EIGHT, NINE, TEN, &
                                          XI_MIN, XI_MAX, ETA_MIN, ETA_MAX, ZETA_MIN, ZETA_MAX
    use mod_chidg_mpi,              only: IRANK
    use type_chidg,                 only: chidg_t
    use type_element,               only: element_t
    use type_face,                  only: face_t
    use type_element_connectivity,  only: element_connectivity_t
    use mod_io,                     only: gq_rule
    use type_point,                 only: point_t


    use mod_inv,                    only: inv
    implicit none

    public  :: test_element_linearC_dx


    !>
    !!
    !!  @author Matteo Ugolotti
    !!  @date   10/4/2018
    !!
    !!  This test is build based on test_element_linearC test case.
    !!  The standard initialization is not tested here but the dx initialization 
    !!  is verified.
    !!
    !!  Symbolic pyhton solution is used to check ChiDG matrices.
    !!  The python script is available at the end of this module.
    !!  The input matrices used in the test herein are given by the
    !!  python script
    !!
    !!
    !--------------------------------------------------------------------------
    @TestCase
    type, extends(TestCase) ::  test_element_linearC_dx

        type(chidg_t)               :: chidg
        type(element_t)             :: elem
        type(face_t),   allocatable :: faces(:)
        real(rk),       allocatable :: nodes(:,:)

    contains

        procedure   ::  setUp
        procedure   ::  tearDown

    end type test_element_linearC_dx
    !***************************************************************************


contains

    !> NOTE: make sure to use 'this' instead of 'self' since these are over-writting a 
    !! derived type procedure. The argument names have to match
    !!
    !!  @author Matteo Ugolotti
    !!
    !!
    !-----------------------------------------------------------------------------------------
    subroutine setUp(this)
        class(test_element_linearC_dx),    intent(inout)   :: this
        
        integer(ik), parameter          :: npt = 8
        real(rk)                        :: nodes(npt,3)
        real(rk)                        :: sqrt_two, inv_sqrt_two
        integer(ik)                     :: ftype, ielem, idomain,                           &
                                           nfields, nterms_s, ntime,                        &
                                           dof_start, dof_local_start,                      &
                                           xdof_start, xdof_local_start,                    &
                                           ineighbor_domain_g,  ineighbor_domain_l,         &
                                           ineighbor_element_g, ineighbor_element_l,        &
                                           ineighbor_face, ineighbor_proc,                  &
                                           ineighbor_nfields, ineighbor_nterms_s,           &
                                           ineighbor_nterms_c, ineighbor_nnodes_r,          &
                                           ineighbor_ntime,                                 &
                                           ineighbor_dof_start, ineighbor_dof_local_start,  &
                                           ineighbor_xdof_start, ineighbor_xdof_local_start
        
        
        call this%chidg%start_up('core')
        allocate(this%faces(6))
        
        
        ! Cube element rotated at 45-degrees along the 0,0,0 y-axis
        !
        !              *  (sqrt(2), 0, 0)
        !            /   \ 
        !          /       \
        !        /           \
        !       *             *  (1/sqrt(2), 0, 1/sqrt(2))
        !        \           /
        !          \       /
        !            \   /
        !              *
        !          (0,0,0)
        !
        sqrt_two        = sqrt(2._rk)
        inv_sqrt_two    = 1._rk/sqrt_two
        nodes(1,:) = [0._rk,         0._rk,  0._rk       ]
        nodes(2,:) = [inv_sqrt_two,  0._rk,  inv_sqrt_two]
        nodes(3,:) = [sqrt_two,      0._rk,  0._rk       ]
        nodes(4,:) = [inv_sqrt_two,  0._rk, -inv_sqrt_two]
        nodes(5,:) = [0._rk,         1._rk,  0._rk       ]
        nodes(6,:) = [inv_sqrt_two,  1._rk,  inv_sqrt_two]
        nodes(7,:) = [sqrt_two,      1._rk,  0._rk       ]
        nodes(8,:) = [inv_sqrt_two,  1._rk, -inv_sqrt_two]

        
        
        ! Initialize Element geometry and Numerics
        idomain         = 1
        ielem           = 1
        nfields         = 2
        nterms_s        = 8
        ntime           = 1
        dof_start       = 1
        dof_local_start = 1
        xdof_start       = 1
        xdof_local_start = 1
        call this%elem%init_geom(nodes        = nodes,                              &
                                 connectivity = [1, 2, 3, 4, 5, 6, 7, 8],           &
                                 etype        = 1,                                  &
                                 location     = [idomain,idomain,ielem,ielem,IRANK],&
                                 coord_system = 'Cartesian')
        call this%elem%init_sol('Quadrature',1,nterms_s,nfields,ntime,dof_start,dof_local_start,xdof_start,xdof_local_start)
        call this%elem%update_interpolations_dx()



        ! Initialize face geometries
        call this%faces(XI_MIN)%init_geom(XI_MIN,this%elem)
        call this%faces(XI_MAX)%init_geom(XI_MAX,this%elem)
        call this%faces(ETA_MIN)%init_geom(ETA_MIN,this%elem)
        call this%faces(ETA_MAX)%init_geom(ETA_MAX,this%elem)
        call this%faces(ZETA_MIN)%init_geom(ZETA_MIN,this%elem)
        call this%faces(ZETA_MAX)%init_geom(ZETA_MAX,this%elem)

        ! Initialize face neighbors
        ftype = 0
        ineighbor_domain_g        = 0
        ineighbor_domain_l        = 0
        ineighbor_element_g       = 0
        ineighbor_element_l       = 0
        ineighbor_proc            = 0
        ineighbor_nfields         = 2
        ineighbor_nterms_s        = 8
        ineighbor_nterms_c        = 8
        ineighbor_dof_start       = 1
        ineighbor_dof_local_start = 1
        ineighbor_xdof_start       = 1
        ineighbor_xdof_local_start = 1
        call this%faces(XI_MIN)%set_neighbor(  ftype,ineighbor_domain_g,ineighbor_domain_l,ineighbor_element_g,             &
                                                     ineighbor_element_l,ineighbor_face,ineighbor_nfields,ineighbor_ntime,  &
                                                     ineighbor_nterms_s,ineighbor_nterms_c,ineighbor_proc,                  &
                                                     ineighbor_dof_start,ineighbor_dof_local_start,                         &
                                                     ineighbor_xdof_start,ineighbor_xdof_local_start)
        call this%faces(XI_MAX)%set_neighbor(  ftype,ineighbor_domain_g,ineighbor_domain_l,ineighbor_element_g,             &
                                                     ineighbor_element_l,ineighbor_face,ineighbor_nfields,ineighbor_ntime,  &
                                                     ineighbor_nterms_s,ineighbor_nterms_c,ineighbor_proc,                  &
                                                     ineighbor_dof_start,ineighbor_dof_local_start,                         &
                                                     ineighbor_xdof_start,ineighbor_xdof_local_start)
        call this%faces(ETA_MIN)%set_neighbor( ftype,ineighbor_domain_g,ineighbor_domain_l,ineighbor_element_g,             &
                                                     ineighbor_element_l,ineighbor_face,ineighbor_nfields,ineighbor_ntime,  &
                                                     ineighbor_nterms_s,ineighbor_nterms_c,ineighbor_proc,                  &
                                                     ineighbor_dof_start,ineighbor_dof_local_start,                         &
                                                     ineighbor_xdof_start,ineighbor_xdof_local_start)
        call this%faces(ETA_MAX)%set_neighbor( ftype,ineighbor_domain_g,ineighbor_domain_l,ineighbor_element_g,             &
                                                     ineighbor_element_l,ineighbor_face,ineighbor_nfields,ineighbor_ntime,  &
                                                     ineighbor_nterms_s,ineighbor_nterms_c,ineighbor_proc,                  &
                                                     ineighbor_dof_start,ineighbor_dof_local_start,                         &
                                                     ineighbor_xdof_start,ineighbor_xdof_local_start)
        call this%faces(ZETA_MIN)%set_neighbor(ftype,ineighbor_domain_g,ineighbor_domain_l,ineighbor_element_g,             &
                                                     ineighbor_element_l,ineighbor_face,ineighbor_nfields,ineighbor_ntime,  &
                                                     ineighbor_nterms_s,ineighbor_nterms_c,ineighbor_proc,                  &
                                                     ineighbor_dof_start,ineighbor_dof_local_start,                         &
                                                     ineighbor_xdof_start,ineighbor_xdof_local_start)
        call this%faces(ZETA_MAX)%set_neighbor(ftype,ineighbor_domain_g,ineighbor_domain_l,ineighbor_element_g,             &
                                                     ineighbor_element_l,ineighbor_face,ineighbor_nfields,ineighbor_ntime,  &
                                                     ineighbor_nterms_s,ineighbor_nterms_c,ineighbor_proc,                  &
                                                     ineighbor_dof_start,ineighbor_dof_local_start,                         &
                                                     ineighbor_xdof_start,ineighbor_xdof_local_start)


        call this%faces(XI_MIN)%init_sol(this%elem)
        call this%faces(XI_MAX)%init_sol(this%elem)
        call this%faces(ETA_MIN)%init_sol(this%elem)
        call this%faces(ETA_MAX)%init_sol(this%elem)
        call this%faces(ZETA_MIN)%init_sol(this%elem)
        call this%faces(ZETA_MAX)%init_sol(this%elem)

        !
        ! Update dx interpolators
        !
        call this%faces(XI_MIN)%update_interpolations_dx(this%elem)
        call this%faces(XI_MAX)%update_interpolations_dx(this%elem)
        call this%faces(ETA_MIN)%update_interpolations_dx(this%elem)
        call this%faces(ETA_MAX)%update_interpolations_dx(this%elem)
        call this%faces(ZETA_MIN)%update_interpolations_dx(this%elem)
        call this%faces(ZETA_MAX)%update_interpolations_dx(this%elem)


    end subroutine setUp
    !************************************************************************************
    

    !>
    !!
    !!
    !-------------------------------------------------------------------------------------
    subroutine tearDown(this)
        class(test_element_linearC_dx),    intent(inout)   :: this


        !
        ! Close ChiDG interface
        !
        call this%chidg%shut_down('core')

    end subroutine tearDown
    !**************************************************************************************



    
    
    !> Test element djinv_dx entries at quadrature points
    !!
    !!
    !!-------------------------------------------------------------------------------------
    @Test
    subroutine testElement_djinv_dx(self)
        class(test_element_linearC_dx),    intent(inout)   :: self

        integer(ik) :: inode, inode_diff, idir, irow
        real(rk)    :: test_djinv_dx(8,3,8), test_djinv_dx_trans(8,3)


        test_djinv_dx(1,:,:) = reshape((/ &
        -0.10995660140686181_rk, -0.07775105849101827_rk, -7.806255641895632e-18_rk,   &
        0.04024690942871116_rk, -0.02083333333333333_rk, 0.06970969197815066_rk,   &
        0.02946278254943948_rk, -0.005582274842315056_rk, 2.6020852139652106e-18_rk,   &
        0.040246909428711175_rk, -0.020833333333333325_rk, -0.06970969197815066_rk,   &
        -0.02946278254943948_rk, 0.07775105849101827_rk, -2.6020852139652106e-18_rk,   &
        0.010784126879271695_rk, 0.02083333333333333_rk, 0.018678655670167778_rk,   &
        0.007894528790896088_rk, 0.005582274842315056_rk, 8.673617379884035e-19_rk,   &
        0.010784126879271702_rk, 0.020833333333333325_rk, -0.018678655670167778_rk   &
        /),(/3,8/))
        test_djinv_dx(2,:,:) = reshape((/ &
        -0.06970969197815066_rk, -0.020833333333333336_rk, -0.04024690942871119_rk,   &
        7.806255641895632e-18_rk, -0.07775105849101828_rk, 0.10995660140686185_rk,   &
        0.06970969197815066_rk, -0.020833333333333336_rk, -0.040246909428711175_rk,   &
        -2.6020852139652106e-18_rk, -0.005582274842315058_rk, -0.02946278254943947_rk,   &
        -0.018678655670167778_rk, 0.020833333333333336_rk, -0.010784126879271699_rk,   &
        2.6020852139652106e-18_rk, 0.07775105849101828_rk, 0.029462782549439483_rk,   &
        0.018678655670167778_rk, 0.020833333333333336_rk, -0.010784126879271699_rk,   &
        -8.673617379884035e-19_rk, 0.005582274842315058_rk, -0.007894528790896081_rk   &
        /),(/3,8/))
        test_djinv_dx(3,:,:) = reshape((/ &
        -0.06970969197815066_rk, -0.020833333333333346_rk, 0.04024690942871119_rk,   &
        2.6020852139652106e-18_rk, -0.00558227484231506_rk, 0.029462782549439487_rk,   &
        0.06970969197815066_rk, -0.02083333333333334_rk, 0.040246909428711175_rk,   &
        -7.806255641895632e-18_rk, -0.0777510584910183_rk, -0.10995660140686185_rk,   &
        -0.018678655670167778_rk, 0.020833333333333346_rk, 0.010784126879271697_rk,   &
        8.673617379884035e-19_rk, 0.00558227484231506_rk, 0.007894528790896093_rk,   &
        0.018678655670167778_rk, 0.02083333333333334_rk, 0.010784126879271697_rk,   &
        -2.6020852139652106e-18_rk, 0.0777510584910183_rk, -0.029462782549439473_rk   &
        /),(/3,8/))
        test_djinv_dx(4,:,:) = reshape((/ &
        -0.02946278254943948_rk, -0.005582274842315056_rk, 0.0_rk,   &
        -0.040246909428711175_rk, -0.02083333333333335_rk, 0.06970969197815068_rk,   &
        0.10995660140686184_rk, -0.0777510584910183_rk, 0.0_rk,   &
        -0.040246909428711175_rk, -0.020833333333333343_rk, -0.06970969197815068_rk,   &
        -0.007894528790896084_rk, 0.005582274842315056_rk, 0.0_rk,   &
        -0.0107841268792717_rk, 0.02083333333333335_rk, 0.018678655670167785_rk,   &
        0.02946278254943948_rk, 0.0777510584910183_rk, 0.0_rk,   &
        -0.010784126879271697_rk, 0.020833333333333343_rk, -0.018678655670167785_rk   &
        /),(/3,8/))
        test_djinv_dx(5,:,:) = reshape((/ &
        -0.02946278254943948_rk, -0.07775105849101827_rk, 0.0_rk,   &
        0.010784126879271697_rk, -0.02083333333333333_rk, 0.018678655670167785_rk,   &
        0.007894528790896084_rk, -0.005582274842315056_rk, 0.0_rk,   &
        0.0107841268792717_rk, -0.020833333333333325_rk, -0.018678655670167785_rk,   &
        -0.10995660140686184_rk, 0.07775105849101827_rk, 0.0_rk,   &
        0.040246909428711175_rk, 0.02083333333333333_rk, 0.06970969197815065_rk,   &
        0.02946278254943948_rk, 0.005582274842315056_rk, 0.0_rk,   &
        0.040246909428711175_rk, 0.020833333333333325_rk, -0.06970969197815065_rk   &
        /),(/3,8/))
        test_djinv_dx(6,:,:) = reshape((/ &
        -0.018678655670167785_rk, -0.02083333333333333_rk, -0.010784126879271699_rk,   &
        -2.6020852139652106e-18_rk, -0.07775105849101827_rk, 0.029462782549439483_rk,   &
        0.018678655670167785_rk, -0.020833333333333325_rk, -0.010784126879271699_rk,   &
        8.673617379884035e-19_rk, -0.005582274842315056_rk, -0.007894528790896081_rk,   &
        -0.06970969197815065_rk, 0.02083333333333333_rk, -0.04024690942871119_rk,   &
        -7.806255641895632e-18_rk, 0.07775105849101827_rk, 0.10995660140686185_rk,   &
        0.06970969197815065_rk, 0.020833333333333325_rk, -0.040246909428711175_rk,   &
        2.6020852139652106e-18_rk, 0.005582274842315056_rk, -0.02946278254943947_rk   &
        /),(/3,8/))
        test_djinv_dx(7,:,:) = reshape((/ &
        -0.018678655670167785_rk, -0.020833333333333336_rk, 0.010784126879271699_rk,   &
        0.0_rk, -0.005582274842315058_rk, 0.007894528790896086_rk,   &
        0.018678655670167785_rk, -0.020833333333333336_rk, 0.010784126879271695_rk,   &
        0.0_rk, -0.07775105849101828_rk, -0.029462782549439483_rk,   &
        -0.06970969197815065_rk, 0.020833333333333336_rk, 0.04024690942871119_rk,   &
        0.0_rk, 0.005582274842315058_rk, 0.029462782549439483_rk,   &
        0.06970969197815065_rk, 0.020833333333333336_rk, 0.04024690942871116_rk,   &
        0.0_rk, 0.07775105849101828_rk, -0.10995660140686185_rk   &
        /),(/3,8/))
        test_djinv_dx(8,:,:) = reshape((/ &
        -0.007894528790896081_rk, -0.005582274842315063_rk, 1.734723475976807e-18_rk,   &
        -0.010784126879271699_rk, -0.020833333333333343_rk, 0.018678655670167785_rk,   &
        0.029462782549439483_rk, -0.0777510584910183_rk, -1.734723475976807e-18_rk,   &
        -0.010784126879271699_rk, -0.020833333333333336_rk, -0.018678655670167785_rk,   &
        -0.02946278254943947_rk, 0.005582274842315063_rk, 1.734723475976807e-18_rk,   &
        -0.040246909428711175_rk, 0.020833333333333343_rk, 0.06970969197815068_rk,   &
        0.10995660140686185_rk, 0.0777510584910183_rk, -8.673617379884035e-18_rk,   &
        -0.04024690942871119_rk, 0.020833333333333336_rk, -0.06970969197815068_rk   &
        /),(/3,8/))
        
        
        do inode = 1,self%elem%basis_s%nnodes_elem()
            @assertEqual(transpose(test_djinv_dx(inode,:,:)),self%elem%djinv_dx(inode,:,:), 1.e-14_rk)
        end do
        
    end subroutine testElement_djinv_dx
    !***************************************************************************************





    !> Test element dmetric_dx entries at quadrature points
    !!
    !!
    !!-------------------------------------------------------------------------------------
    @Test
    subroutine testElement_dmetric_dx(self)
        class(test_element_linearC_dx),    intent(inout)   :: self

        real(rk)    :: test_metric(3,3,self%elem%basis_s%nnodes_elem())
        real(rk)    :: test_dmetric_dx(3,3,8,8,3), test_dmetric_dx_trans(3,3)
        integer(ik) :: inode, inode_diff, idir, irow
        

        test_dmetric_dx(:,:,1,1,1) = reshape((/ &
        1.2440169358562922_rk, 0.8796528112548946_rk, 1.249000902703301e-16_rk,   &
        1.2440169358562925_rk, 0.8796528112548948_rk, 0.0_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,1,1,2) = reshape((/ &
        -1.0683126035464235e-17_rk, -7.554110863947318e-18_rk, -9.62964972193618e-34_rk,   &
        -1.068312603546424e-17_rk, -7.554110863947321e-18_rk, -8.666684749742561e-34_rk,   &
        1.7593056225097896_rk, 1.2440169358562925_rk, 1.3877787807814457e-16_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,1,1,3) = reshape((/ &
        1.2440169358562927_rk, 0.8796528112548949_rk, 1.3877787807814457e-16_rk,   &
        -1.2440169358562925_rk, -0.8796528112548948_rk, 0.0_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,1,2,1) = reshape((/ &
        -0.4553418012614794_rk, 0.23570226039551584_rk, -0.7886751345948129_rk,   &
        -0.45534180126147944_rk, 0.23570226039551587_rk, -0.788675134594813_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,1,2,2) = reshape((/ &
        3.910295520810845e-18_rk, -2.0241179055298548e-18_rk, 6.7728305146533914e-18_rk,   &
        3.910295520810848e-18_rk, -2.0241179055298556e-18_rk, 6.772830514653392e-18_rk,   &
        -0.6439505508593788_rk, 0.33333333333333337_rk, -1.1153550716504108_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,1,2,3) = reshape((/ &
        -0.45534180126147966_rk, 0.2357022603955159_rk, -0.7886751345948132_rk,   &
        0.45534180126147944_rk, -0.23570226039551587_rk, 0.788675134594813_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,1,3,1) = reshape((/ &
        -0.33333333333333326_rk, 0.06315623032716867_rk, -4.163336342344337e-17_rk,   &
        -0.3333333333333333_rk, 0.06315623032716869_rk, 0.0_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,1,3,2) = reshape((/ &
        2.8625349938425434e-18_rk, -5.423607581721004e-19_rk, 1.925929944387236e-34_rk,   &
        2.8625349938425445e-18_rk, -5.423607581721005e-19_rk, 2.8888949165808538e-34_rk,   &
        -0.4714045207910316_rk, 0.08931639747704093_rk, -2.7755575615628914e-17_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,1,3,3) = reshape((/ &
        -0.3333333333333334_rk, 0.06315623032716872_rk, -2.7755575615628914e-17_rk,   &
        0.3333333333333333_rk, -0.06315623032716869_rk, 0.0_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,1,4,1) = reshape((/ &
        -0.4553418012614796_rk, 0.23570226039551584_rk, 0.7886751345948129_rk,   &
        -0.45534180126147966_rk, 0.23570226039551587_rk, 0.788675134594813_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,1,4,2) = reshape((/ &
        3.910295520810847e-18_rk, -2.024117905529855e-18_rk, -6.7728305146533914e-18_rk,   &
        3.910295520810847e-18_rk, -2.0241179055298556e-18_rk, -6.772830514653392e-18_rk,   &
        -0.643950550859379_rk, 0.33333333333333337_rk, 1.1153550716504108_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,1,4,3) = reshape((/ &
        -0.4553418012614796_rk, 0.2357022603955159_rk, 0.7886751345948132_rk,   &
        0.45534180126147966_rk, -0.23570226039551587_rk, -0.788675134594813_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,1,5,1) = reshape((/ &
        0.33333333333333337_rk, -0.8796528112548946_rk, 4.163336342344337e-17_rk,   &
        0.3333333333333333_rk, -0.8796528112548948_rk, 0.0_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,1,5,2) = reshape((/ &
        -2.8625349938425434e-18_rk, 7.554110863947318e-18_rk, -1.925929944387236e-34_rk,   &
        -2.8625349938425445e-18_rk, 7.554110863947321e-18_rk, -2.8888949165808538e-34_rk,   &
        0.47140452079103184_rk, -1.2440169358562925_rk, 2.7755575615628914e-17_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,1,5,3) = reshape((/ &
        0.33333333333333354_rk, -0.8796528112548949_rk, 2.7755575615628914e-17_rk,   &
        -0.3333333333333333_rk, 0.8796528112548948_rk, 0.0_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,1,6,1) = reshape((/ &
        -0.12200846792814624_rk, -0.23570226039551584_rk, -0.21132486540518713_rk,   &
        -0.12200846792814618_rk, -0.23570226039551587_rk, -0.21132486540518722_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,1,6,2) = reshape((/ &
        1.0477605269683028e-18_rk, 2.0241179055298548e-18_rk, 1.814774466874242e-18_rk,   &
        1.0477605269683028e-18_rk, 2.0241179055298556e-18_rk, 1.8147744668742414e-18_rk,   &
        -0.17254603006834718_rk, -0.33333333333333337_rk, -0.29885849072268456_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,1,6,3) = reshape((/ &
        -0.12200846792814624_rk, -0.2357022603955159_rk, -0.21132486540518725_rk,   &
        0.12200846792814618_rk, 0.23570226039551587_rk, 0.21132486540518722_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,1,7,1) = reshape((/ &
        -0.08931639747704087_rk, -0.06315623032716867_rk, -1.3877787807814457e-17_rk,   &
        -0.08931639747704093_rk, -0.06315623032716869_rk, 0.0_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,1,7,2) = reshape((/ &
        7.67013939905938e-19_rk, 5.423607581721004e-19_rk, 1.925929944387236e-34_rk,   &
        7.67013939905939e-19_rk, 5.423607581721005e-19_rk, 9.62964972193618e-35_rk,   &
        -0.1263124606543373_rk, -0.08931639747704093_rk, -2.7755575615628914e-17_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,1,7,3) = reshape((/ &
        -0.08931639747704095_rk, -0.06315623032716872_rk, -2.7755575615628914e-17_rk,   &
        0.08931639747704093_rk, 0.06315623032716869_rk, 0.0_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,1,8,1) = reshape((/ &
        -0.12200846792814624_rk, -0.23570226039551584_rk, 0.21132486540518713_rk,   &
        -0.12200846792814618_rk, -0.23570226039551587_rk, 0.21132486540518722_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,1,8,2) = reshape((/ &
        1.0477605269683028e-18_rk, 2.024117905529855e-18_rk, -1.814774466874242e-18_rk,   &
        1.0477605269683032e-18_rk, 2.0241179055298556e-18_rk, -1.8147744668742414e-18_rk,   &
        -0.17254603006834723_rk, -0.33333333333333337_rk, 0.29885849072268467_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,1,8,3) = reshape((/ &
        -0.12200846792814629_rk, -0.2357022603955159_rk, 0.2113248654051873_rk,   &
        0.12200846792814618_rk, 0.23570226039551587_rk, -0.21132486540518722_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,2,1,1) = reshape((/ &
        0.7886751345948129_rk, 0.23570226039551587_rk, 0.45534180126147966_rk,   &
        0.7886751345948129_rk, 0.23570226039551584_rk, 0.4553418012614796_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,2,1,2) = reshape((/ &
        4.378026466882528e-17_rk, 1.3084103822364794e-17_rk, 2.5276547591739343e-17_rk,   &
        4.378026466882528e-17_rk, 1.3084103822364792e-17_rk, 2.527654759173934e-17_rk,   &
        1.1153550716504106_rk, 0.33333333333333337_rk, 0.643950550859379_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,2,1,3) = reshape((/ &
        0.7886751345948129_rk, 0.23570226039551587_rk, 0.45534180126147966_rk,   &
        -0.7886751345948129_rk, -0.23570226039551584_rk, -0.4553418012614796_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,2,2,1) = reshape((/ &
        -1.249000902703301e-16_rk, 0.8796528112548948_rk, -1.2440169358562925_rk,   &
        -1.249000902703301e-16_rk, 0.8796528112548946_rk, -1.2440169358562922_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,2,2,2) = reshape((/ &
        -6.933347799794049e-33_rk, 4.883054023657156e-17_rk, -6.905681226056462e-17_rk,   &
        -6.933347799794049e-33_rk, 4.883054023657155e-17_rk, -6.905681226056461e-17_rk,   &
        -1.249000902703301e-16_rk, 1.2440169358562925_rk, -1.7593056225097896_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,2,2,3) = reshape((/ &
        -1.249000902703301e-16_rk, 0.8796528112548948_rk, -1.2440169358562925_rk,   &
        1.249000902703301e-16_rk, -0.8796528112548946_rk, 1.2440169358562922_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,2,3,1) = reshape((/ &
        -0.7886751345948129_rk, 0.23570226039551587_rk, 0.45534180126147944_rk,   &
        -0.7886751345948128_rk, 0.23570226039551584_rk, 0.4553418012614794_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,2,3,2) = reshape((/ &
        -4.378026466882528e-17_rk, 1.3084103822364794e-17_rk, 2.527654759173933e-17_rk,   &
        -4.378026466882527e-17_rk, 1.3084103822364792e-17_rk, 2.5276547591739328e-17_rk,   &
        -1.1153550716504106_rk, 0.33333333333333337_rk, 0.6439505508593788_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,2,3,3) = reshape((/ &
        -0.7886751345948129_rk, 0.23570226039551587_rk, 0.45534180126147944_rk,   &
        0.7886751345948128_rk, -0.23570226039551584_rk, -0.4553418012614794_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,2,4,1) = reshape((/ &
        4.163336342344337e-17_rk, 0.06315623032716869_rk, 0.3333333333333333_rk,   &
        4.163336342344337e-17_rk, 0.06315623032716867_rk, 0.33333333333333326_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,2,4,2) = reshape((/ &
        2.311115933264683e-33_rk, 3.505875052887613e-18_rk, 1.850371707708594e-17_rk,   &
        2.311115933264683e-33_rk, 3.505875052887612e-18_rk, 1.8503717077085938e-17_rk,   &
        4.163336342344337e-17_rk, 0.08931639747704093_rk, 0.4714045207910315_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,2,4,3) = reshape((/ &
        4.163336342344337e-17_rk, 0.06315623032716869_rk, 0.3333333333333333_rk,   &
        -4.163336342344337e-17_rk, -0.06315623032716867_rk, -0.33333333333333326_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,2,5,1) = reshape((/ &
        0.21132486540518713_rk, -0.23570226039551587_rk, 0.12200846792814618_rk,   &
        0.21132486540518713_rk, -0.23570226039551584_rk, 0.12200846792814624_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,2,5,2) = reshape((/ &
        1.1730886562432548e-17_rk, -1.3084103822364794e-17_rk, 6.772830514653393e-18_rk,   &
        1.1730886562432548e-17_rk, -1.3084103822364792e-17_rk, 6.772830514653396e-18_rk,   &
        0.29885849072268444_rk, -0.33333333333333337_rk, 0.17254603006834718_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,2,5,3) = reshape((/ &
        0.21132486540518713_rk, -0.23570226039551587_rk, 0.12200846792814618_rk,   &
        -0.21132486540518713_rk, 0.23570226039551584_rk, -0.12200846792814624_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,2,6,1) = reshape((/ &
        -4.163336342344337e-17_rk, -0.8796528112548948_rk, -0.3333333333333333_rk,   &
        -4.163336342344337e-17_rk, -0.8796528112548946_rk, -0.33333333333333337_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,2,6,2) = reshape((/ &
        -2.311115933264683e-33_rk, -4.883054023657156e-17_rk, -1.850371707708594e-17_rk,   &
        -2.311115933264683e-33_rk, -4.883054023657155e-17_rk, -1.8503717077085944e-17_rk,   &
        -4.163336342344337e-17_rk, -1.2440169358562925_rk, -0.47140452079103173_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,2,6,3) = reshape((/ &
        -4.163336342344337e-17_rk, -0.8796528112548948_rk, -0.3333333333333333_rk,   &
        4.163336342344337e-17_rk, 0.8796528112548946_rk, 0.33333333333333337_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,2,7,1) = reshape((/ &
        -0.21132486540518713_rk, -0.23570226039551587_rk, 0.12200846792814618_rk,   &
        -0.21132486540518708_rk, -0.23570226039551584_rk, 0.12200846792814624_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,2,7,2) = reshape((/ &
        -1.1730886562432548e-17_rk, -1.3084103822364794e-17_rk, 6.772830514653393e-18_rk,   &
        -1.1730886562432545e-17_rk, -1.3084103822364792e-17_rk, 6.772830514653396e-18_rk,   &
        -0.29885849072268444_rk, -0.33333333333333337_rk, 0.17254603006834718_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,2,7,3) = reshape((/ &
        -0.21132486540518713_rk, -0.23570226039551587_rk, 0.12200846792814618_rk,   &
        0.21132486540518708_rk, 0.23570226039551584_rk, -0.12200846792814624_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,2,8,1) = reshape((/ &
        1.3877787807814457e-17_rk, -0.06315623032716869_rk, 0.08931639747704093_rk,   &
        1.3877787807814457e-17_rk, -0.06315623032716867_rk, 0.08931639747704087_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,2,8,2) = reshape((/ &
        7.703719777548943e-34_rk, -3.505875052887613e-18_rk, 4.958056047779154e-18_rk,   &
        7.703719777548943e-34_rk, -3.505875052887612e-18_rk, 4.958056047779151e-18_rk,   &
        1.3877787807814457e-17_rk, -0.08931639747704093_rk, 0.1263124606543373_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,2,8,3) = reshape((/ &
        1.3877787807814457e-17_rk, -0.06315623032716869_rk, 0.08931639747704093_rk,   &
        -1.3877787807814457e-17_rk, 0.06315623032716867_rk, -0.08931639747704087_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,3,1,1) = reshape((/ &
        0.7886751345948126_rk, 0.23570226039551584_rk, -0.4553418012614796_rk,   &
        0.7886751345948124_rk, 0.23570226039551573_rk, -0.4553418012614794_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,3,1,2) = reshape((/ &
        4.3780264668825266e-17_rk, 1.3084103822364792e-17_rk, -2.527654759173934e-17_rk,   &
        4.3780264668825254e-17_rk, 1.3084103822364786e-17_rk, -2.5276547591739328e-17_rk,   &
        1.1153550716504104_rk, 0.33333333333333337_rk, -0.643950550859379_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,3,1,3) = reshape((/ &
        0.7886751345948126_rk, 0.23570226039551584_rk, -0.4553418012614796_rk,   &
        -0.7886751345948128_rk, -0.23570226039551587_rk, 0.45534180126147966_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,3,2,1) = reshape((/ &
        -1.3877787807814457e-17_rk, 0.06315623032716867_rk, -0.33333333333333326_rk,   &
        -1.3877787807814457e-17_rk, 0.06315623032716866_rk, -0.33333333333333326_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,3,2,2) = reshape((/ &
        -7.703719777548943e-34_rk, 3.505875052887612e-18_rk, -1.8503717077085938e-17_rk,   &
        -7.703719777548943e-34_rk, 3.5058750528876115e-18_rk, -1.8503717077085938e-17_rk,   &
        -4.163336342344337e-17_rk, 0.08931639747704093_rk, -0.4714045207910316_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,3,2,3) = reshape((/ &
        -1.3877787807814457e-17_rk, 0.06315623032716867_rk, -0.33333333333333326_rk,   &
        4.163336342344337e-17_rk, -0.06315623032716869_rk, 0.3333333333333333_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,3,3,1) = reshape((/ &
        -0.7886751345948126_rk, 0.23570226039551584_rk, -0.4553418012614794_rk,   &
        -0.7886751345948124_rk, 0.23570226039551578_rk, -0.4553418012614794_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,3,3,2) = reshape((/ &
        -4.3780264668825266e-17_rk, 1.3084103822364792e-17_rk, -2.5276547591739328e-17_rk,   &
        -4.3780264668825254e-17_rk, 1.3084103822364789e-17_rk, -2.5276547591739328e-17_rk,   &
        -1.1153550716504104_rk, 0.33333333333333337_rk, -0.6439505508593788_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,3,3,3) = reshape((/ &
        -0.7886751345948126_rk, 0.23570226039551584_rk, -0.4553418012614794_rk,   &
        0.7886751345948129_rk, -0.23570226039551587_rk, 0.45534180126147944_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,3,4,1) = reshape((/ &
        9.71445146547012e-17_rk, 0.8796528112548946_rk, 1.2440169358562922_rk,   &
        4.163336342344337e-17_rk, 0.8796528112548945_rk, 1.2440169358562918_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,3,4,2) = reshape((/ &
        5.3926038442842604e-33_rk, 4.883054023657155e-17_rk, 6.905681226056461e-17_rk,   &
        2.311115933264683e-33_rk, 4.8830540236571544e-17_rk, 6.905681226056458e-17_rk,   &
        1.249000902703301e-16_rk, 1.2440169358562925_rk, 1.7593056225097896_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,3,4,3) = reshape((/ &
        9.71445146547012e-17_rk, 0.8796528112548946_rk, 1.2440169358562922_rk,   &
        -1.249000902703301e-16_rk, -0.8796528112548948_rk, -1.2440169358562925_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,3,5,1) = reshape((/ &
        0.21132486540518708_rk, -0.23570226039551584_rk, -0.12200846792814624_rk,   &
        0.21132486540518702_rk, -0.23570226039551573_rk, -0.12200846792814612_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,3,5,2) = reshape((/ &
        1.1730886562432545e-17_rk, -1.3084103822364792e-17_rk, -6.772830514653396e-18_rk,   &
        1.1730886562432542e-17_rk, -1.3084103822364786e-17_rk, -6.77283051465339e-18_rk,   &
        0.29885849072268456_rk, -0.33333333333333337_rk, -0.17254603006834723_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,3,5,3) = reshape((/ &
        0.21132486540518708_rk, -0.23570226039551584_rk, -0.12200846792814624_rk,   &
        -0.21132486540518708_rk, 0.23570226039551587_rk, 0.12200846792814618_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,3,6,1) = reshape((/ &
        1.3877787807814457e-17_rk, -0.06315623032716867_rk, -0.08931639747704087_rk,   &
        -4.163336342344337e-17_rk, -0.06315623032716866_rk, -0.08931639747704098_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,3,6,2) = reshape((/ &
        7.703719777548943e-34_rk, -3.505875052887612e-18_rk, -4.958056047779151e-18_rk,   &
        -2.311115933264683e-33_rk, -3.5058750528876115e-18_rk, -4.958056047779157e-18_rk,   &
        -1.3877787807814457e-17_rk, -0.08931639747704093_rk, -0.1263124606543373_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,3,6,3) = reshape((/ &
        1.3877787807814457e-17_rk, -0.06315623032716867_rk, -0.08931639747704087_rk,   &
        1.3877787807814457e-17_rk, 0.06315623032716869_rk, 0.08931639747704093_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,3,7,1) = reshape((/ &
        -0.21132486540518708_rk, -0.23570226039551584_rk, -0.12200846792814624_rk,   &
        -0.21132486540518702_rk, -0.23570226039551578_rk, -0.12200846792814612_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,3,7,2) = reshape((/ &
        -1.1730886562432545e-17_rk, -1.3084103822364792e-17_rk, -6.772830514653396e-18_rk,   &
        -1.1730886562432542e-17_rk, -1.3084103822364789e-17_rk, -6.77283051465339e-18_rk,   &
        -0.29885849072268456_rk, -0.33333333333333337_rk, -0.17254603006834718_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,3,7,3) = reshape((/ &
        -0.21132486540518708_rk, -0.23570226039551584_rk, -0.12200846792814624_rk,   &
        0.21132486540518713_rk, 0.23570226039551587_rk, 0.12200846792814618_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,3,8,1) = reshape((/ &
        1.3877787807814457e-17_rk, -0.8796528112548946_rk, 0.33333333333333337_rk,   &
        1.3877787807814457e-17_rk, -0.8796528112548945_rk, 0.33333333333333326_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,3,8,2) = reshape((/ &
        7.703719777548943e-34_rk, -4.883054023657155e-17_rk, 1.8503717077085944e-17_rk,   &
        7.703719777548943e-34_rk, -4.8830540236571544e-17_rk, 1.8503717077085938e-17_rk,   &
        4.163336342344337e-17_rk, -1.2440169358562925_rk, 0.47140452079103184_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,3,8,3) = reshape((/ &
        1.3877787807814457e-17_rk, -0.8796528112548946_rk, 0.33333333333333337_rk,   &
        -4.163336342344337e-17_rk, 0.8796528112548948_rk, -0.3333333333333333_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,4,1,1) = reshape((/ &
        0.3333333333333332_rk, 0.06315623032716874_rk, 0.0_rk,   &
        0.3333333333333332_rk, 0.06315623032716874_rk, 0.0_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,4,1,2) = reshape((/ &
        3.986996914801441e-17_rk, 7.554110863947337e-18_rk, 0.0_rk,   &
        3.986996914801441e-17_rk, 7.554110863947337e-18_rk, 0.0_rk,   &
        0.47140452079103157_rk, 0.08931639747704082_rk, 0.0_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,4,1,3) = reshape((/ &
        0.33333333333333326_rk, 0.06315623032716877_rk, 0.0_rk,   &
        -0.33333333333333326_rk, -0.06315623032716877_rk, 0.0_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,4,2,1) = reshape((/ &
        0.45534180126147933_rk, 0.23570226039551587_rk, -0.7886751345948128_rk,   &
        0.45534180126147933_rk, 0.23570226039551587_rk, -0.7886751345948128_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,4,2,2) = reshape((/ &
        5.446339070428949e-17_rk, 2.8192325550259443e-17_rk, -9.433335985230393e-17_rk,   &
        5.446339070428949e-17_rk, 2.8192325550259443e-17_rk, -9.433335985230393e-17_rk,   &
        0.6439505508593787_rk, 0.33333333333333337_rk, -1.1153550716504106_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,4,2,3) = reshape((/ &
        0.45534180126147944_rk, 0.23570226039551595_rk, -0.788675134594813_rk,   &
        -0.45534180126147944_rk, -0.23570226039551595_rk, 0.788675134594813_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,4,3,1) = reshape((/ &
        -1.2440169358562918_rk, 0.8796528112548943_rk, 0.0_rk,   &
        -1.2440169358562918_rk, 0.8796528112548943_rk, 0.0_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,4,3,2) = reshape((/ &
        -1.487967505565934e-16_rk, 1.0521519133709038e-16_rk, 0.0_rk,   &
        -1.487967505565934e-16_rk, 1.0521519133709038e-16_rk, 0.0_rk,   &
        -1.759305622509789_rk, 1.244016935856292_rk, 0.0_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,4,3,3) = reshape((/ &
        -1.2440169358562922_rk, 0.8796528112548945_rk, 0.0_rk,   &
        1.2440169358562922_rk, -0.8796528112548945_rk, 0.0_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,4,4,1) = reshape((/ &
        0.45534180126147933_rk, 0.23570226039551587_rk, 0.7886751345948128_rk,   &
        0.45534180126147933_rk, 0.23570226039551587_rk, 0.7886751345948128_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,4,4,2) = reshape((/ &
        5.446339070428949e-17_rk, 2.819232555025944e-17_rk, 9.433335985230393e-17_rk,   &
        5.446339070428949e-17_rk, 2.819232555025944e-17_rk, 9.433335985230393e-17_rk,   &
        0.6439505508593787_rk, 0.33333333333333337_rk, 1.1153550716504106_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,4,4,3) = reshape((/ &
        0.4553418012614794_rk, 0.23570226039551595_rk, 0.788675134594813_rk,   &
        -0.4553418012614794_rk, -0.23570226039551595_rk, -0.788675134594813_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,4,5,1) = reshape((/ &
        0.08931639747704084_rk, -0.06315623032716863_rk, 0.0_rk,   &
        0.08931639747704084_rk, -0.06315623032716863_rk, 0.0_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,4,5,2) = reshape((/ &
        1.0683126035464238e-17_rk, -7.554110863947324e-18_rk, 0.0_rk,   &
        1.0683126035464238e-17_rk, -7.554110863947324e-18_rk, 0.0_rk,   &
        0.12631246065433732_rk, -0.08931639747704082_rk, 0.0_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,4,5,3) = reshape((/ &
        0.0893163974770409_rk, -0.06315623032716866_rk, 0.0_rk,   &
        -0.0893163974770409_rk, 0.06315623032716866_rk, 0.0_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,4,6,1) = reshape((/ &
        0.12200846792814618_rk, -0.23570226039551576_rk, -0.21132486540518705_rk,   &
        0.12200846792814618_rk, -0.23570226039551576_rk, -0.21132486540518705_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,4,6,2) = reshape((/ &
        1.459342155627509e-17_rk, -2.819232555025942e-17_rk, -2.527654759173933e-17_rk,   &
        1.459342155627509e-17_rk, -2.819232555025942e-17_rk, -2.527654759173933e-17_rk,   &
        0.17254603006834712_rk, -0.33333333333333337_rk, -0.2988584907226846_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,4,6,3) = reshape((/ &
        0.12200846792814612_rk, -0.23570226039551584_rk, -0.21132486540518722_rk,   &
        -0.12200846792814612_rk, 0.23570226039551584_rk, 0.21132486540518722_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,4,7,1) = reshape((/ &
        -0.33333333333333315_rk, -0.8796528112548946_rk, 0.0_rk,   &
        -0.33333333333333315_rk, -0.8796528112548946_rk, 0.0_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,4,7,2) = reshape((/ &
        -3.986996914801442e-17_rk, -1.0521519133709041e-16_rk, 0.0_rk,   &
        -3.986996914801442e-17_rk, -1.0521519133709041e-16_rk, 0.0_rk,   &
        -0.47140452079103146_rk, -1.2440169358562922_rk, 0.0_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,4,7,3) = reshape((/ &
        -0.33333333333333315_rk, -0.8796528112548947_rk, 0.0_rk,   &
        0.33333333333333315_rk, 0.8796528112548947_rk, 0.0_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,4,8,1) = reshape((/ &
        0.12200846792814618_rk, -0.23570226039551576_rk, 0.21132486540518705_rk,   &
        0.12200846792814618_rk, -0.23570226039551576_rk, 0.21132486540518705_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,4,8,2) = reshape((/ &
        1.4593421556275084e-17_rk, -2.8192325550259425e-17_rk, 2.527654759173933e-17_rk,   &
        1.4593421556275084e-17_rk, -2.8192325550259425e-17_rk, 2.527654759173933e-17_rk,   &
        0.17254603006834712_rk, -0.33333333333333326_rk, 0.2988584907226846_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,4,8,3) = reshape((/ &
        0.12200846792814618_rk, -0.23570226039551584_rk, 0.21132486540518722_rk,   &
        -0.12200846792814618_rk, 0.23570226039551584_rk, -0.21132486540518722_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,5,1,1) = reshape((/ &
        0.33333333333333354_rk, 0.8796528112548948_rk, 0.0_rk,   &
        0.33333333333333354_rk, 0.8796528112548948_rk, 0.0_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,5,1,2) = reshape((/ &
        -2.8625349938425445e-18_rk, -7.554110863947321e-18_rk, 0.0_rk,   &
        -2.8625349938425445e-18_rk, -7.554110863947321e-18_rk, 0.0_rk,   &
        0.4714045207910316_rk, 1.2440169358562925_rk, 0.0_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,5,1,3) = reshape((/ &
        0.33333333333333354_rk, 0.8796528112548948_rk, 0.0_rk,   &
        -0.33333333333333354_rk, -0.8796528112548948_rk, 0.0_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,5,2,1) = reshape((/ &
        -0.12200846792814624_rk, 0.23570226039551587_rk, -0.21132486540518722_rk,   &
        -0.12200846792814624_rk, 0.23570226039551587_rk, -0.21132486540518722_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,5,2,2) = reshape((/ &
        1.0477605269683028e-18_rk, -2.0241179055298556e-18_rk, 1.814774466874242e-18_rk,   &
        1.0477605269683028e-18_rk, -2.0241179055298556e-18_rk, 1.814774466874242e-18_rk,   &
        -0.17254603006834718_rk, 0.33333333333333337_rk, -0.2988584907226846_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,5,2,3) = reshape((/ &
        -0.12200846792814624_rk, 0.23570226039551587_rk, -0.21132486540518722_rk,   &
        0.12200846792814624_rk, -0.23570226039551587_rk, 0.21132486540518722_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,5,3,1) = reshape((/ &
        -0.08931639747704095_rk, 0.06315623032716869_rk, 0.0_rk,   &
        -0.08931639747704095_rk, 0.06315623032716869_rk, 0.0_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,5,3,2) = reshape((/ &
        7.67013939905939e-19_rk, -5.423607581721005e-19_rk, 0.0_rk,   &
        7.67013939905939e-19_rk, -5.423607581721005e-19_rk, 0.0_rk,   &
        -0.12631246065433738_rk, 0.08931639747704093_rk, 0.0_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,5,3,3) = reshape((/ &
        -0.08931639747704095_rk, 0.06315623032716869_rk, 0.0_rk,   &
        0.08931639747704095_rk, -0.06315623032716869_rk, 0.0_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,5,4,1) = reshape((/ &
        -0.12200846792814629_rk, 0.23570226039551587_rk, 0.21132486540518722_rk,   &
        -0.12200846792814629_rk, 0.23570226039551587_rk, 0.21132486540518722_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,5,4,2) = reshape((/ &
        1.0477605269683032e-18_rk, -2.0241179055298556e-18_rk, -1.814774466874242e-18_rk,   &
        1.0477605269683032e-18_rk, -2.0241179055298556e-18_rk, -1.814774466874242e-18_rk,   &
        -0.17254603006834712_rk, 0.33333333333333337_rk, 0.2988584907226846_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,5,4,3) = reshape((/ &
        -0.12200846792814629_rk, 0.23570226039551587_rk, 0.21132486540518722_rk,   &
        0.12200846792814629_rk, -0.23570226039551587_rk, -0.21132486540518722_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,5,5,1) = reshape((/ &
        1.2440169358562927_rk, -0.8796528112548948_rk, 0.0_rk,   &
        1.2440169358562927_rk, -0.8796528112548948_rk, 0.0_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,5,5,2) = reshape((/ &
        -1.068312603546424e-17_rk, 7.554110863947321e-18_rk, 0.0_rk,   &
        -1.068312603546424e-17_rk, 7.554110863947321e-18_rk, 0.0_rk,   &
        1.7593056225097896_rk, -1.2440169358562925_rk, 0.0_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,5,5,3) = reshape((/ &
        1.2440169358562927_rk, -0.8796528112548948_rk, 0.0_rk,   &
        -1.2440169358562927_rk, 0.8796528112548948_rk, 0.0_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,5,6,1) = reshape((/ &
        -0.45534180126147966_rk, -0.23570226039551587_rk, -0.788675134594813_rk,   &
        -0.45534180126147966_rk, -0.23570226039551587_rk, -0.788675134594813_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,5,6,2) = reshape((/ &
        3.910295520810848e-18_rk, 2.0241179055298556e-18_rk, 6.7728305146533914e-18_rk,   &
        3.910295520810848e-18_rk, 2.0241179055298556e-18_rk, 6.7728305146533914e-18_rk,   &
        -0.6439505508593788_rk, -0.33333333333333337_rk, -1.1153550716504106_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,5,6,3) = reshape((/ &
        -0.45534180126147966_rk, -0.23570226039551587_rk, -0.788675134594813_rk,   &
        0.45534180126147966_rk, 0.23570226039551587_rk, 0.788675134594813_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,5,7,1) = reshape((/ &
        -0.3333333333333334_rk, -0.06315623032716869_rk, 0.0_rk,   &
        -0.3333333333333334_rk, -0.06315623032716869_rk, 0.0_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,5,7,2) = reshape((/ &
        2.8625349938425445e-18_rk, 5.423607581721005e-19_rk, 0.0_rk,   &
        2.8625349938425445e-18_rk, 5.423607581721005e-19_rk, 0.0_rk,   &
        -0.47140452079103184_rk, -0.08931639747704093_rk, 0.0_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,5,7,3) = reshape((/ &
        -0.3333333333333334_rk, -0.06315623032716869_rk, 0.0_rk,   &
        0.3333333333333334_rk, 0.06315623032716869_rk, 0.0_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,5,8,1) = reshape((/ &
        -0.4553418012614796_rk, -0.23570226039551587_rk, 0.788675134594813_rk,   &
        -0.4553418012614796_rk, -0.23570226039551587_rk, 0.788675134594813_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,5,8,2) = reshape((/ &
        3.910295520810847e-18_rk, 2.0241179055298556e-18_rk, -6.7728305146533914e-18_rk,   &
        3.910295520810847e-18_rk, 2.0241179055298556e-18_rk, -6.7728305146533914e-18_rk,   &
        -0.6439505508593788_rk, -0.33333333333333337_rk, 1.1153550716504106_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,5,8,3) = reshape((/ &
        -0.4553418012614796_rk, -0.23570226039551587_rk, 0.788675134594813_rk,   &
        0.4553418012614796_rk, 0.23570226039551587_rk, -0.788675134594813_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,6,1,1) = reshape((/ &
        0.21132486540518702_rk, 0.23570226039551584_rk, 0.12200846792814618_rk,   &
        0.21132486540518713_rk, 0.23570226039551587_rk, 0.12200846792814624_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,6,1,2) = reshape((/ &
        1.1730886562432542e-17_rk, 1.3084103822364792e-17_rk, 6.772830514653393e-18_rk,   &
        1.1730886562432548e-17_rk, 1.3084103822364794e-17_rk, 6.772830514653396e-18_rk,   &
        0.2988584907226845_rk, 0.33333333333333337_rk, 0.17254603006834715_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,6,1,3) = reshape((/ &
        0.21132486540518722_rk, 0.2357022603955159_rk, 0.12200846792814626_rk,   &
        -0.21132486540518713_rk, -0.23570226039551587_rk, -0.12200846792814624_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,6,2,1) = reshape((/ &
        4.163336342344337e-17_rk, 0.8796528112548946_rk, -0.3333333333333333_rk,   &
        4.163336342344337e-17_rk, 0.8796528112548948_rk, -0.33333333333333354_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,6,2,2) = reshape((/ &
        2.311115933264683e-33_rk, 4.883054023657155e-17_rk, -1.850371707708594e-17_rk,   &
        2.311115933264683e-33_rk, 4.883054023657156e-17_rk, -1.8503717077085954e-17_rk,   &
        4.163336342344337e-17_rk, 1.2440169358562925_rk, -0.47140452079103157_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,6,2,3) = reshape((/ &
        0.0_rk, 0.8796528112548949_rk, -0.3333333333333336_rk,   &
        -4.163336342344337e-17_rk, -0.8796528112548948_rk, 0.33333333333333354_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,6,3,1) = reshape((/ &
        -0.21132486540518713_rk, 0.23570226039551584_rk, 0.12200846792814618_rk,   &
        -0.21132486540518708_rk, 0.23570226039551587_rk, 0.12200846792814629_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,6,3,2) = reshape((/ &
        -1.1730886562432548e-17_rk, 1.3084103822364792e-17_rk, 6.772830514653393e-18_rk,   &
        -1.1730886562432545e-17_rk, 1.3084103822364794e-17_rk, 6.772830514653399e-18_rk,   &
        -0.2988584907226845_rk, 0.33333333333333337_rk, 0.1725460300683471_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,6,3,3) = reshape((/ &
        -0.21132486540518722_rk, 0.2357022603955159_rk, 0.12200846792814626_rk,   &
        0.21132486540518708_rk, -0.23570226039551587_rk, -0.12200846792814629_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,6,4,1) = reshape((/ &
        -1.3877787807814457e-17_rk, 0.06315623032716867_rk, 0.08931639747704093_rk,   &
        -1.3877787807814457e-17_rk, 0.06315623032716869_rk, 0.08931639747704095_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,6,4,2) = reshape((/ &
        -7.703719777548943e-34_rk, 3.505875052887612e-18_rk, 4.958056047779154e-18_rk,   &
        -7.703719777548943e-34_rk, 3.505875052887613e-18_rk, 4.9580560477791554e-18_rk,   &
        -1.3877787807814457e-17_rk, 0.08931639747704093_rk, 0.1263124606543375_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,6,4,3) = reshape((/ &
        0.0_rk, 0.06315623032716872_rk, 0.08931639747704101_rk,   &
        1.3877787807814457e-17_rk, -0.06315623032716869_rk, -0.08931639747704095_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,6,5,1) = reshape((/ &
        0.7886751345948128_rk, -0.23570226039551584_rk, 0.45534180126147966_rk,   &
        0.7886751345948129_rk, -0.23570226039551587_rk, 0.45534180126147966_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,6,5,2) = reshape((/ &
        4.378026466882527e-17_rk, -1.3084103822364792e-17_rk, 2.5276547591739343e-17_rk,   &
        4.378026466882528e-17_rk, -1.3084103822364794e-17_rk, 2.5276547591739343e-17_rk,   &
        1.1153550716504104_rk, -0.33333333333333337_rk, 0.6439505508593789_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,6,5,3) = reshape((/ &
        0.788675134594813_rk, -0.2357022603955159_rk, 0.45534180126147983_rk,   &
        -0.7886751345948129_rk, 0.23570226039551587_rk, -0.45534180126147966_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,6,6,1) = reshape((/ &
        1.249000902703301e-16_rk, -0.8796528112548946_rk, -1.2440169358562925_rk,   &
        1.249000902703301e-16_rk, -0.8796528112548948_rk, -1.2440169358562927_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,6,6,2) = reshape((/ &
        6.933347799794049e-33_rk, -4.883054023657155e-17_rk, -6.905681226056462e-17_rk,   &
        6.933347799794049e-33_rk, -4.883054023657156e-17_rk, -6.905681226056463e-17_rk,   &
        1.249000902703301e-16_rk, -1.2440169358562925_rk, -1.7593056225097896_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,6,6,3) = reshape((/ &
        0.0_rk, -0.8796528112548949_rk, -1.244016935856293_rk,   &
        -1.249000902703301e-16_rk, 0.8796528112548948_rk, 1.2440169358562927_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,6,7,1) = reshape((/ &
        -0.7886751345948129_rk, -0.23570226039551584_rk, 0.45534180126147944_rk,   &
        -0.7886751345948129_rk, -0.23570226039551587_rk, 0.4553418012614796_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,6,7,2) = reshape((/ &
        -4.378026466882528e-17_rk, -1.3084103822364792e-17_rk, 2.527654759173933e-17_rk,   &
        -4.378026466882528e-17_rk, -1.3084103822364794e-17_rk, 2.527654759173934e-17_rk,   &
        -1.1153550716504104_rk, -0.33333333333333337_rk, 0.6439505508593788_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,6,7,3) = reshape((/ &
        -0.788675134594813_rk, -0.2357022603955159_rk, 0.4553418012614796_rk,   &
        0.7886751345948129_rk, 0.23570226039551587_rk, -0.4553418012614796_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,6,8,1) = reshape((/ &
        -4.163336342344337e-17_rk, -0.06315623032716867_rk, 0.3333333333333333_rk,   &
        -4.163336342344337e-17_rk, -0.06315623032716869_rk, 0.3333333333333334_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,6,8,2) = reshape((/ &
        -2.311115933264683e-33_rk, -3.505875052887612e-18_rk, 1.850371707708594e-17_rk,   &
        -2.311115933264683e-33_rk, -3.505875052887613e-18_rk, 1.8503717077085947e-17_rk,   &
        -4.163336342344337e-17_rk, -0.08931639747704093_rk, 0.4714045207910318_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,6,8,3) = reshape((/ &
        0.0_rk, -0.06315623032716872_rk, 0.3333333333333335_rk,   &
        4.163336342344337e-17_rk, 0.06315623032716869_rk, -0.3333333333333334_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,7,1,1) = reshape((/ &
        0.21132486540518705_rk, 0.23570226039551584_rk, -0.12200846792814632_rk,   &
        0.21132486540518705_rk, 0.23570226039551584_rk, -0.12200846792814632_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,7,1,2) = reshape((/ &
        1.1730886562432544e-17_rk, 1.3084103822364792e-17_rk, -6.772830514653401e-18_rk,   &
        1.1730886562432544e-17_rk, 1.3084103822364792e-17_rk, -6.772830514653401e-18_rk,   &
        0.29885849072268456_rk, 0.33333333333333337_rk, -0.17254603006834718_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,7,1,3) = reshape((/ &
        0.21132486540518705_rk, 0.23570226039551584_rk, -0.12200846792814632_rk,   &
        -0.21132486540518722_rk, -0.2357022603955159_rk, 0.12200846792814632_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,7,2,1) = reshape((/ &
        0.0_rk, 0.06315623032716867_rk, -0.08931639747704093_rk,   &
        0.0_rk, 0.06315623032716867_rk, -0.08931639747704093_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,7,2,2) = reshape((/ &
        0.0_rk, 3.505875052887612e-18_rk, -4.958056047779154e-18_rk,   &
        0.0_rk, 3.505875052887612e-18_rk, -4.958056047779154e-18_rk,   &
        0.0_rk, 0.08931639747704093_rk, -0.12631246065433738_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,7,2,3) = reshape((/ &
        0.0_rk, 0.06315623032716867_rk, -0.08931639747704093_rk,   &
        0.0_rk, -0.06315623032716872_rk, 0.08931639747704101_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,7,3,1) = reshape((/ &
        -0.21132486540518705_rk, 0.23570226039551584_rk, -0.12200846792814615_rk,   &
        -0.21132486540518705_rk, 0.23570226039551584_rk, -0.12200846792814615_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,7,3,2) = reshape((/ &
        -1.1730886562432544e-17_rk, 1.3084103822364792e-17_rk, -6.7728305146533914e-18_rk,   &
        -1.1730886562432544e-17_rk, 1.3084103822364792e-17_rk, -6.7728305146533914e-18_rk,   &
        -0.29885849072268456_rk, 0.33333333333333337_rk, -0.17254603006834712_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,7,3,3) = reshape((/ &
        -0.21132486540518705_rk, 0.23570226039551584_rk, -0.12200846792814615_rk,   &
        0.21132486540518722_rk, -0.2357022603955159_rk, 0.12200846792814626_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,7,4,1) = reshape((/ &
        0.0_rk, 0.8796528112548946_rk, 0.33333333333333337_rk,   &
        0.0_rk, 0.8796528112548946_rk, 0.33333333333333337_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,7,4,2) = reshape((/ &
        0.0_rk, 4.883054023657155e-17_rk, 1.8503717077085944e-17_rk,   &
        0.0_rk, 4.883054023657155e-17_rk, 1.8503717077085944e-17_rk,   &
        0.0_rk, 1.2440169358562925_rk, 0.47140452079103173_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,7,4,3) = reshape((/ &
        0.0_rk, 0.8796528112548946_rk, 0.33333333333333337_rk,   &
        0.0_rk, -0.8796528112548949_rk, -0.3333333333333335_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,7,5,1) = reshape((/ &
        0.7886751345948128_rk, -0.23570226039551584_rk, -0.4553418012614797_rk,   &
        0.7886751345948128_rk, -0.23570226039551584_rk, -0.4553418012614797_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,7,5,2) = reshape((/ &
        4.378026466882527e-17_rk, -1.3084103822364792e-17_rk, -2.5276547591739347e-17_rk,   &
        4.378026466882527e-17_rk, -1.3084103822364792e-17_rk, -2.5276547591739347e-17_rk,   &
        1.1153550716504104_rk, -0.33333333333333337_rk, -0.643950550859379_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,7,5,3) = reshape((/ &
        0.7886751345948128_rk, -0.23570226039551584_rk, -0.4553418012614797_rk,   &
        -0.788675134594813_rk, 0.2357022603955159_rk, 0.45534180126147983_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,7,6,1) = reshape((/ &
        0.0_rk, -0.06315623032716867_rk, -0.33333333333333337_rk,   &
        0.0_rk, -0.06315623032716867_rk, -0.33333333333333337_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,7,6,2) = reshape((/ &
        0.0_rk, -3.505875052887612e-18_rk, -1.8503717077085944e-17_rk,   &
        0.0_rk, -3.505875052887612e-18_rk, -1.8503717077085944e-17_rk,   &
        0.0_rk, -0.08931639747704093_rk, -0.47140452079103173_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,7,6,3) = reshape((/ &
        0.0_rk, -0.06315623032716867_rk, -0.33333333333333337_rk,   &
        0.0_rk, 0.06315623032716872_rk, 0.3333333333333335_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,7,7,1) = reshape((/ &
        -0.7886751345948128_rk, -0.23570226039551584_rk, -0.4553418012614794_rk,   &
        -0.7886751345948128_rk, -0.23570226039551584_rk, -0.4553418012614794_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,7,7,2) = reshape((/ &
        -4.378026466882527e-17_rk, -1.3084103822364792e-17_rk, -2.5276547591739328e-17_rk,   &
        -4.378026466882527e-17_rk, -1.3084103822364792e-17_rk, -2.5276547591739328e-17_rk,   &
        -1.1153550716504104_rk, -0.33333333333333337_rk, -0.6439505508593786_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,7,7,3) = reshape((/ &
        -0.7886751345948128_rk, -0.23570226039551584_rk, -0.4553418012614794_rk,   &
        0.788675134594813_rk, 0.2357022603955159_rk, 0.4553418012614796_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,7,8,1) = reshape((/ &
        0.0_rk, -0.8796528112548946_rk, 1.2440169358562925_rk,   &
        0.0_rk, -0.8796528112548946_rk, 1.2440169358562925_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,7,8,2) = reshape((/ &
        0.0_rk, -4.883054023657155e-17_rk, 6.905681226056462e-17_rk,   &
        0.0_rk, -4.883054023657155e-17_rk, 6.905681226056462e-17_rk,   &
        0.0_rk, -1.2440169358562925_rk, 1.7593056225097896_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,7,8,3) = reshape((/ &
        0.0_rk, -0.8796528112548946_rk, 1.2440169358562925_rk,   &
        0.0_rk, 0.8796528112548949_rk, -1.244016935856293_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,8,1,1) = reshape((/ &
        0.08931639747704098_rk, 0.0631562303271687_rk, -1.3877787807814457e-17_rk,   &
        0.08931639747704084_rk, 0.06315623032716869_rk, 1.3877787807814457e-17_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,8,1,2) = reshape((/ &
        1.0683126035464241e-17_rk, 7.554110863947324e-18_rk, -1.5407439555097887e-33_rk,   &
        1.0683126035464244e-17_rk, 7.554110863947324e-18_rk, -3.0814879110195774e-33_rk,   &
        0.1263124606543374_rk, 0.08931639747704093_rk, -1.3877787807814457e-17_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,8,1,3) = reshape((/ &
        0.08931639747704098_rk, 0.0631562303271687_rk, -1.3877787807814457e-17_rk,   &
        -0.08931639747704087_rk, -0.06315623032716872_rk, 1.3877787807814457e-17_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,8,2,1) = reshape((/ &
        0.12200846792814618_rk, 0.23570226039551584_rk, -0.21132486540518713_rk,   &
        0.12200846792814618_rk, 0.2357022603955158_rk, -0.21132486540518708_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,8,2,2) = reshape((/ &
        1.4593421556275077e-17_rk, 2.819232555025945e-17_rk, -2.527654759173934e-17_rk,   &
        1.4593421556275087e-17_rk, 2.819232555025944e-17_rk, -2.5276547591739322e-17_rk,   &
        0.17254603006834712_rk, 0.33333333333333326_rk, -0.2988584907226845_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,8,2,3) = reshape((/ &
        0.12200846792814618_rk, 0.23570226039551584_rk, -0.21132486540518713_rk,   &
        -0.12200846792814624_rk, -0.2357022603955159_rk, 0.21132486540518708_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,8,3,1) = reshape((/ &
        -0.3333333333333332_rk, 0.8796528112548946_rk, 4.163336342344337e-17_rk,   &
        -0.33333333333333315_rk, 0.8796528112548944_rk, 1.3877787807814457e-17_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,8,3,2) = reshape((/ &
        -3.986996914801441e-17_rk, 1.0521519133709041e-16_rk, 4.622231866529366e-33_rk,   &
        -3.986996914801443e-17_rk, 1.0521519133709038e-16_rk, 3.0814879110195774e-33_rk,   &
        -0.4714045207910317_rk, 1.2440169358562922_rk, 4.163336342344337e-17_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,8,3,3) = reshape((/ &
        -0.3333333333333332_rk, 0.8796528112548946_rk, 4.163336342344337e-17_rk,   &
        0.33333333333333337_rk, -0.8796528112548947_rk, -4.163336342344337e-17_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,8,4,1) = reshape((/ &
        0.12200846792814612_rk, 0.23570226039551584_rk, 0.21132486540518702_rk,   &
        0.12200846792814618_rk, 0.2357022603955158_rk, 0.21132486540518713_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,8,4,2) = reshape((/ &
        1.4593421556275084e-17_rk, 2.8192325550259443e-17_rk, 2.527654759173934e-17_rk,   &
        1.4593421556275087e-17_rk, 2.819232555025944e-17_rk, 2.5276547591739328e-17_rk,   &
        0.17254603006834712_rk, 0.33333333333333326_rk, 0.2988584907226845_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,8,4,3) = reshape((/ &
        0.12200846792814612_rk, 0.23570226039551584_rk, 0.21132486540518702_rk,   &
        -0.12200846792814624_rk, -0.2357022603955159_rk, -0.21132486540518713_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,8,5,1) = reshape((/ &
        0.3333333333333333_rk, -0.06315623032716859_rk, -4.163336342344337e-17_rk,   &
        0.3333333333333332_rk, -0.06315623032716858_rk, -1.3877787807814457e-17_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,8,5,2) = reshape((/ &
        3.986996914801441e-17_rk, -7.554110863947312e-18_rk, -4.622231866529366e-33_rk,   &
        3.9869969148014415e-17_rk, -7.554110863947312e-18_rk, -3.0814879110195774e-33_rk,   &
        0.4714045207910317_rk, -0.08931639747704093_rk, -4.163336342344337e-17_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,8,5,3) = reshape((/ &
        0.3333333333333333_rk, -0.06315623032716859_rk, -4.163336342344337e-17_rk,   &
        -0.33333333333333326_rk, 0.0631562303271686_rk, 4.163336342344337e-17_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,8,6,1) = reshape((/ &
        0.4553418012614794_rk, -0.23570226039551573_rk, -0.7886751345948129_rk,   &
        0.45534180126147933_rk, -0.2357022603955157_rk, -0.7886751345948128_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,8,6,2) = reshape((/ &
        5.446339070428949e-17_rk, -2.819232555025944e-17_rk, -9.433335985230395e-17_rk,   &
        5.446339070428948e-17_rk, -2.8192325550259425e-17_rk, -9.433335985230392e-17_rk,   &
        0.6439505508593786_rk, -0.33333333333333326_rk, -1.1153550716504104_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,8,6,3) = reshape((/ &
        0.4553418012614794_rk, -0.23570226039551573_rk, -0.7886751345948129_rk,   &
        -0.4553418012614794_rk, 0.23570226039551578_rk, 0.7886751345948129_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,8,7,1) = reshape((/ &
        -1.2440169358562922_rk, -0.8796528112548948_rk, 1.249000902703301e-16_rk,   &
        -1.2440169358562918_rk, -0.8796528112548947_rk, 9.71445146547012e-17_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,8,7,2) = reshape((/ &
        -1.487967505565934e-16_rk, -1.0521519133709043e-16_rk, 1.3866695599588098e-32_rk,   &
        -1.487967505565934e-16_rk, -1.0521519133709043e-16_rk, 1.5407439555097887e-32_rk,   &
        -1.759305622509789_rk, -1.2440169358562925_rk, 1.249000902703301e-16_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,8,7,3) = reshape((/ &
        -1.2440169358562922_rk, -0.8796528112548948_rk, 1.249000902703301e-16_rk,   &
        1.2440169358562922_rk, 0.879652811254895_rk, -1.249000902703301e-16_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,8,8,1) = reshape((/ &
        0.45534180126147944_rk, -0.23570226039551573_rk, 0.7886751345948128_rk,   &
        0.45534180126147933_rk, -0.2357022603955157_rk, 0.7886751345948128_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,8,8,2) = reshape((/ &
        5.44633907042895e-17_rk, -2.819232555025943e-17_rk, 9.433335985230395e-17_rk,   &
        5.446339070428951e-17_rk, -2.8192325550259425e-17_rk, 9.433335985230392e-17_rk,   &
        0.6439505508593788_rk, -0.33333333333333315_rk, 1.1153550716504104_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,8,8,3) = reshape((/ &
        0.45534180126147944_rk, -0.23570226039551573_rk, 0.7886751345948128_rk,   &
        -0.4553418012614796_rk, 0.23570226039551578_rk, -0.7886751345948129_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk   &
        /),(/3,3/))

        
        

        do inode = 1,self%elem%basis_s%nnodes_elem()
            do inode_diff = 1,self%elem%nterms_c
                do idir = 1,3
                    @assertEqual(transpose(test_dmetric_dx(:,:,inode,inode_diff,idir)),self%elem%dmetric_dx(:,:,inode,inode_diff,idir), 1.e-14_rk)
                end do
            end do
        end do 


    end subroutine testElement_dmetric_dx
    !***************************************************************************************





    !> Test cartesian dgrad1_dx 
    !!
    !!
    !------------------------------------------------------------------------------------------
    @Test
    subroutine testElement_dgrad1_dx(self)
        class(test_element_linearC_dx),    intent(inout)   :: self
        
        
        real(rk), dimension(self%elem%basis_s%nnodes_elem(),self%elem%nterms_s,self%elem%nterms_c,3) :: test_dgrad1_dx, test_dgrad2_dx, test_dgrad3_dx
        
        real(rk)        :: tol = 1.e-13_rk
        integer(ik)     :: inode_diff, idir, inode
        
       
        !
        ! dgrad1_dx
        ! 
        test_dgrad1_dx(:,:,1,1) = reshape((/ &
        0.0_rk, 1.2440169358562925_rk, 0.0_rk, 1.2440169358562922_rk, -1.4364670255861678_rk, -0.7182335127930837_rk, -0.7182335127930839_rk, 0.8293446239041948_rk,   &
        0.0_rk, 0.7886751345948129_rk, 0.0_rk, 0.7886751345948129_rk, -8.756052933765056e-17_rk, -0.45534180126147955_rk, -0.4553418012614795_rk, 4.378026466882528e-17_rk,   &
        0.0_rk, 0.7886751345948124_rk, 0.0_rk, 0.7886751345948126_rk, 1.8503717077085944e-17_rk, -0.4553418012614794_rk, -0.4553418012614793_rk, -4.378026466882528e-17_rk,   &
        0.0_rk, 0.3333333333333332_rk, 0.0_rk, 0.3333333333333332_rk, 0.38490017945975036_rk, -0.19245008972987518_rk, -0.19245008972987518_rk, -0.2222222222222221_rk,   &
        0.0_rk, 0.33333333333333354_rk, 0.0_rk, 0.33333333333333354_rk, -0.38490017945975047_rk, 0.19245008972987523_rk, 0.19245008972987523_rk, -0.22222222222222215_rk,   &
        0.0_rk, 0.21132486540518713_rk, 0.0_rk, 0.21132486540518702_rk, 2.3461773124865097e-17_rk, 0.12200846792814624_rk, 0.12200846792814621_rk, 1.1730886562432548e-17_rk,   &
        0.0_rk, 0.21132486540518705_rk, 0.0_rk, 0.21132486540518705_rk, 0.0_rk, 0.1220084679281462_rk, 0.1220084679281462_rk, 0.0_rk,   &
        0.0_rk, 0.08931639747704084_rk, 0.0_rk, 0.08931639747704098_rk, 0.10313369225283436_rk, 0.05156684612641718_rk, 0.05156684612641718_rk, 0.05954426498469395_rk   &
        /),(/8,8/))
        test_dgrad1_dx(:,:,1,2) = reshape((/ &
        0.0_rk, -1.068312603546424e-17_rk, 1.7593056225097896_rk, -1.0683126035464235e-17_rk, 1.2335811384723955e-17_rk, -1.015735574742849_rk, -1.015735574742849_rk, 0.5864352075032632_rk,   &
        0.0_rk, 4.378026466882528e-17_rk, 1.1153550716504106_rk, 4.378026466882528e-17_rk, -4.860585785951308e-33_rk, 0.6439505508593788_rk, -0.6439505508593788_rk, -0.3717850238834702_rk,   &
        0.0_rk, 4.3780264668825254e-17_rk, 1.1153550716504104_rk, 4.3780264668825266e-17_rk, 1.0271626370065259e-33_rk, -0.6439505508593786_rk, 0.6439505508593786_rk, -0.3717850238834701_rk,   &
        0.0_rk, 3.986996914801441e-17_rk, 0.47140452079103157_rk, 3.986996914801441e-17_rk, 4.603787484037638e-17_rk, 0.2721655269759085_rk, 0.2721655269759085_rk, 0.1571348402636772_rk,   &
        0.0_rk, -2.8625349938425445e-18_rk, 0.4714045207910316_rk, -2.8625349938425445e-18_rk, 3.305370698519434e-18_rk, -0.27216552697590857_rk, -0.27216552697590857_rk, 0.15713484026367724_rk,   &
        0.0_rk, 1.1730886562432548e-17_rk, 0.2988584907226845_rk, 1.1730886562432542e-17_rk, 1.3023900360878469e-33_rk, 0.17254603006834723_rk, -0.17254603006834723_rk, -0.0996194969075615_rk,   &
        0.0_rk, 1.1730886562432544e-17_rk, 0.29885849072268456_rk, 1.1730886562432544e-17_rk, 0.0_rk, -0.17254603006834718_rk, 0.17254603006834718_rk, -0.09961949690756151_rk,   &
        0.0_rk, 1.0683126035464244e-17_rk, 0.1263124606543374_rk, 1.0683126035464241e-17_rk, 1.2335811384723958e-17_rk, 0.07292653316078573_rk, 0.07292653316078573_rk, 0.04210415355144577_rk   &
        /),(/8,8/))
        test_dgrad1_dx(:,:,1,3) = reshape((/ &
        0.0_rk, -1.2440169358562925_rk, 0.0_rk, 1.2440169358562927_rk, -6.905681226056462e-17_rk, -0.718233512793084_rk, 0.7182335127930839_rk, 6.905681226056462e-17_rk,   &
        0.0_rk, -0.7886751345948129_rk, 0.0_rk, 0.7886751345948129_rk, -0.910683602522959_rk, -0.45534180126147955_rk, 0.4553418012614795_rk, 0.5257834230632086_rk,   &
        0.0_rk, -0.7886751345948128_rk, 0.0_rk, 0.7886751345948126_rk, 0.9106836025229588_rk, -0.4553418012614794_rk, 0.4553418012614795_rk, -0.5257834230632085_rk,   &
        0.0_rk, -0.33333333333333326_rk, 0.0_rk, 0.33333333333333326_rk, 0.0_rk, -0.1924500897298752_rk, 0.1924500897298752_rk, 0.0_rk,   &
        0.0_rk, -0.33333333333333354_rk, 0.0_rk, 0.33333333333333354_rk, 0.0_rk, 0.19245008972987523_rk, -0.19245008972987523_rk, 0.0_rk,   &
        0.0_rk, -0.21132486540518713_rk, 0.0_rk, 0.21132486540518722_rk, -0.24401693585629242_rk, 0.12200846792814624_rk, -0.12200846792814621_rk, -0.1408832436034581_rk,   &
        0.0_rk, -0.21132486540518722_rk, 0.0_rk, 0.21132486540518705_rk, 0.24401693585629244_rk, 0.1220084679281462_rk, -0.12200846792814624_rk, 0.1408832436034581_rk,   &
        0.0_rk, -0.08931639747704087_rk, 0.0_rk, 0.08931639747704098_rk, -9.916112095558308e-18_rk, 0.05156684612641718_rk, -0.05156684612641721_rk, -4.958056047779154e-18_rk   &
        /),(/8,8/))
        test_dgrad1_dx(:,:,2,1) = reshape((/ &
        0.0_rk, -0.45534180126147944_rk, 0.0_rk, -0.4553418012614794_rk, 0.5257834230632086_rk, 0.2628917115316042_rk, 0.2628917115316043_rk, -0.30356120084098626_rk,   &
        0.0_rk, -1.249000902703301e-16_rk, 0.0_rk, -1.249000902703301e-16_rk, 0.0_rk, 6.245004513516506e-17_rk, 9.020562075079397e-17_rk, 0.0_rk,   &
        0.0_rk, -1.3877787807814457e-17_rk, 0.0_rk, -1.3877787807814457e-17_rk, -1.8503717077085944e-17_rk, 1.3877787807814457e-17_rk, 0.0_rk, 0.0_rk,   &
        0.0_rk, 0.45534180126147933_rk, 0.0_rk, 0.45534180126147933_rk, 0.5257834230632084_rk, -0.2628917115316042_rk, -0.2628917115316042_rk, -0.30356120084098615_rk,   &
        0.0_rk, -0.12200846792814624_rk, 0.0_rk, -0.12200846792814624_rk, 0.1408832436034581_rk, -0.07044162180172905_rk, -0.07044162180172905_rk, 0.08133897861876414_rk,   &
        0.0_rk, 4.163336342344337e-17_rk, 0.0_rk, 4.163336342344337e-17_rk, 0.0_rk, 2.0816681711721685e-17_rk, 2.0816681711721685e-17_rk, 0.0_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk,   &
        0.0_rk, 0.12200846792814618_rk, 0.0_rk, 0.12200846792814618_rk, 0.140883243603458_rk, 0.07044162180172896_rk, 0.070441621801729_rk, 0.08133897861876409_rk   &
        /),(/8,8/))
        test_dgrad1_dx(:,:,2,2) = reshape((/ &
        0.0_rk, 3.910295520810848e-18_rk, -0.6439505508593788_rk, 3.910295520810845e-18_rk, -4.5152203431022594e-18_rk, 0.3717850238834701_rk, 0.3717850238834701_rk, -0.21465018361979293_rk,   &
        0.0_rk, -6.933347799794049e-33_rk, -1.249000902703301e-16_rk, -6.933347799794049e-33_rk, 0.0_rk, -9.71445146547012e-17_rk, 9.71445146547012e-17_rk, 4.85722573273506e-17_rk,   &
        0.0_rk, -7.703719777548943e-34_rk, -4.163336342344337e-17_rk, -7.703719777548943e-34_rk, -1.0271626370065259e-33_rk, 1.3877787807814457e-17_rk, -1.3877787807814457e-17_rk, 1.3877787807814457e-17_rk,   &
        0.0_rk, 5.446339070428949e-17_rk, 0.6439505508593787_rk, 5.446339070428949e-17_rk, 6.28889065682026e-17_rk, 0.37178502388347_rk, 0.37178502388347_rk, 0.21465018361979288_rk,   &
        0.0_rk, 1.0477605269683028e-18_rk, -0.17254603006834718_rk, 1.0477605269683028e-18_rk, -1.2098496445828277e-18_rk, 0.0996194969075615_rk, 0.0996194969075615_rk, -0.05751534335611573_rk,   &
        0.0_rk, 2.311115933264683e-33_rk, 4.163336342344337e-17_rk, 2.311115933264683e-33_rk, 0.0_rk, 1.3877787807814457e-17_rk, -1.3877787807814457e-17_rk, -6.938893903907228e-18_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk,   &
        0.0_rk, 1.4593421556275087e-17_rk, 0.17254603006834712_rk, 1.4593421556275077e-17_rk, 1.6851031727826222e-17_rk, 0.0996194969075615_rk, 0.0996194969075615_rk, 0.057515343356115745_rk   &
        /),(/8,8/))
        test_dgrad1_dx(:,:,2,3) = reshape((/ &
        0.0_rk, 0.45534180126147944_rk, 0.0_rk, -0.45534180126147966_rk, 6.905681226056462e-17_rk, 0.2628917115316043_rk, -0.2628917115316043_rk, -2.5276547591739334e-17_rk,   &
        0.0_rk, 1.249000902703301e-16_rk, 0.0_rk, -1.249000902703301e-16_rk, 0.0_rk, 6.245004513516506e-17_rk, -9.020562075079397e-17_rk, -1.3183898417423734e-16_rk,   &
        0.0_rk, 4.163336342344337e-17_rk, 0.0_rk, -1.3877787807814457e-17_rk, -6.938893903907228e-17_rk, 1.3877787807814457e-17_rk, -2.0816681711721685e-17_rk, 0.0_rk,   &
        0.0_rk, -0.45534180126147944_rk, 0.0_rk, 0.45534180126147944_rk, 0.0_rk, -0.2628917115316042_rk, 0.2628917115316042_rk, 0.0_rk,   &
        0.0_rk, 0.12200846792814624_rk, 0.0_rk, -0.12200846792814624_rk, 0.0_rk, -0.07044162180172905_rk, 0.07044162180172905_rk, 0.0_rk,   &
        0.0_rk, -4.163336342344337e-17_rk, 0.0_rk, 0.0_rk, -4.163336342344337e-17_rk, 0.0_rk, -2.0816681711721685e-17_rk, 0.0_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk,   &
        0.0_rk, -0.12200846792814624_rk, 0.0_rk, 0.12200846792814618_rk, -1.3545661029306789e-17_rk, 0.07044162180172896_rk, -0.07044162180172903_rk, -6.7728305146533945e-18_rk   &
        /),(/8,8/))
        test_dgrad1_dx(:,:,3,1) = reshape((/ &
        0.0_rk, -0.3333333333333333_rk, 0.0_rk, -0.33333333333333326_rk, 0.3849001794597505_rk, 0.19245008972987526_rk, 0.19245008972987523_rk, -0.2222222222222222_rk,   &
        0.0_rk, -0.7886751345948128_rk, 0.0_rk, -0.7886751345948129_rk, 8.756052933765056e-17_rk, 0.45534180126147955_rk, 0.4553418012614795_rk, -4.378026466882528e-17_rk,   &
        0.0_rk, -0.7886751345948124_rk, 0.0_rk, -0.7886751345948126_rk, -6.905681226056462e-17_rk, 0.4553418012614794_rk, 0.4553418012614793_rk, 4.378026466882528e-17_rk,   &
        0.0_rk, -1.2440169358562918_rk, 0.0_rk, -1.2440169358562918_rk, -1.436467025586167_rk, 0.7182335127930835_rk, 0.7182335127930835_rk, 0.8293446239041944_rk,   &
        0.0_rk, -0.08931639747704095_rk, 0.0_rk, -0.08931639747704095_rk, 0.10313369225283436_rk, -0.05156684612641718_rk, -0.05156684612641718_rk, 0.059544264984693965_rk,   &
        0.0_rk, -0.21132486540518708_rk, 0.0_rk, -0.21132486540518713_rk, -2.3461773124865097e-17_rk, -0.12200846792814621_rk, -0.12200846792814621_rk, -1.1730886562432548e-17_rk,   &
        0.0_rk, -0.21132486540518705_rk, 0.0_rk, -0.21132486540518705_rk, 0.0_rk, -0.1220084679281462_rk, -0.1220084679281462_rk, 0.0_rk,   &
        0.0_rk, -0.33333333333333315_rk, 0.0_rk, -0.3333333333333332_rk, -0.38490017945975036_rk, -0.19245008972987515_rk, -0.19245008972987518_rk, -0.22222222222222215_rk   &
        /),(/8,8/))
        test_dgrad1_dx(:,:,3,2) = reshape((/ &
        0.0_rk, 2.8625349938425445e-18_rk, -0.4714045207910316_rk, 2.8625349938425434e-18_rk, -3.305370698519433e-18_rk, 0.2721655269759087_rk, 0.2721655269759087_rk, -0.15713484026367724_rk,   &
        0.0_rk, -4.378026466882527e-17_rk, -1.1153550716504106_rk, -4.378026466882528e-17_rk, 4.860585785951308e-33_rk, -0.6439505508593788_rk, 0.6439505508593788_rk, 0.3717850238834702_rk,   &
        0.0_rk, -4.3780264668825254e-17_rk, -1.1153550716504104_rk, -4.3780264668825266e-17_rk, -3.833423148944782e-33_rk, 0.6439505508593786_rk, -0.6439505508593786_rk, 0.3717850238834701_rk,   &
        0.0_rk, -1.487967505565934e-16_rk, -1.759305622509789_rk, -1.487967505565934e-16_rk, -1.7181568797678155e-16_rk, -1.0157355747428485_rk, -1.0157355747428485_rk, -0.5864352075032628_rk,   &
        0.0_rk, 7.67013939905939e-19_rk, -0.12631246065433738_rk, 7.67013939905939e-19_rk, -8.856714093537786e-19_rk, 0.07292653316078568_rk, 0.07292653316078568_rk, -0.04210415355144577_rk,   &
        0.0_rk, -1.1730886562432545e-17_rk, -0.2988584907226845_rk, -1.1730886562432548e-17_rk, -1.3023900360878469e-33_rk, -0.17254603006834718_rk, 0.17254603006834718_rk, 0.0996194969075615_rk,   &
        0.0_rk, -1.1730886562432544e-17_rk, -0.29885849072268456_rk, -1.1730886562432544e-17_rk, 0.0_rk, 0.17254603006834718_rk, -0.17254603006834718_rk, 0.09961949690756151_rk,   &
        0.0_rk, -3.986996914801443e-17_rk, -0.4714045207910317_rk, -3.986996914801441e-17_rk, -4.603787484037639e-17_rk, -0.2721655269759086_rk, -0.2721655269759086_rk, -0.15713484026367724_rk   &
        /),(/8,8/))
        test_dgrad1_dx(:,:,3,3) = reshape((/ &
        0.0_rk, 0.3333333333333333_rk, 0.0_rk, -0.3333333333333334_rk, 1.8503717077085944e-17_rk, 0.1924500897298753_rk, -0.19245008972987523_rk, -1.8503717077085944e-17_rk,   &
        0.0_rk, 0.7886751345948128_rk, 0.0_rk, -0.7886751345948129_rk, 0.910683602522959_rk, 0.45534180126147955_rk, -0.4553418012614795_rk, -0.5257834230632086_rk,   &
        0.0_rk, 0.7886751345948129_rk, 0.0_rk, -0.7886751345948126_rk, -0.910683602522959_rk, 0.4553418012614794_rk, -0.4553418012614795_rk, 0.5257834230632085_rk,   &
        0.0_rk, 1.2440169358562922_rk, 0.0_rk, -1.2440169358562922_rk, 0.0_rk, 0.7182335127930835_rk, -0.7182335127930835_rk, 0.0_rk,   &
        0.0_rk, 0.08931639747704095_rk, 0.0_rk, -0.08931639747704095_rk, 0.0_rk, -0.05156684612641718_rk, 0.05156684612641718_rk, 0.0_rk,   &
        0.0_rk, 0.21132486540518708_rk, 0.0_rk, -0.21132486540518722_rk, 0.24401693585629242_rk, -0.12200846792814624_rk, 0.12200846792814621_rk, 0.1408832436034581_rk,   &
        0.0_rk, 0.21132486540518722_rk, 0.0_rk, -0.21132486540518705_rk, -0.24401693585629244_rk, -0.1220084679281462_rk, 0.12200846792814624_rk, -0.1408832436034581_rk,   &
        0.0_rk, 0.33333333333333337_rk, 0.0_rk, -0.3333333333333332_rk, 3.700743415417189e-17_rk, -0.19245008972987515_rk, 0.19245008972987526_rk, 1.8503717077085944e-17_rk   &
        /),(/8,8/))
        test_dgrad1_dx(:,:,4,1) = reshape((/ &
        0.0_rk, -0.45534180126147966_rk, 0.0_rk, -0.4553418012614796_rk, 0.5257834230632086_rk, 0.2628917115316043_rk, 0.2628917115316044_rk, -0.3035612008409864_rk,   &
        0.0_rk, 4.163336342344337e-17_rk, 0.0_rk, 4.163336342344337e-17_rk, 0.0_rk, -2.0816681711721685e-17_rk, -2.0816681711721685e-17_rk, 0.0_rk,   &
        0.0_rk, 4.163336342344337e-17_rk, 0.0_rk, 9.71445146547012e-17_rk, 6.905681226056462e-17_rk, -6.938893903907228e-17_rk, 0.0_rk, 0.0_rk,   &
        0.0_rk, 0.45534180126147933_rk, 0.0_rk, 0.45534180126147933_rk, 0.5257834230632084_rk, -0.2628917115316042_rk, -0.2628917115316042_rk, -0.3035612008409862_rk,   &
        0.0_rk, -0.12200846792814629_rk, 0.0_rk, -0.12200846792814629_rk, 0.14088324360345805_rk, -0.07044162180172903_rk, -0.07044162180172903_rk, 0.08133897861876412_rk,   &
        0.0_rk, -1.3877787807814457e-17_rk, 0.0_rk, -1.3877787807814457e-17_rk, 0.0_rk, 2.0816681711721685e-17_rk, -6.938893903907228e-18_rk, 0.0_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk,   &
        0.0_rk, 0.12200846792814618_rk, 0.0_rk, 0.12200846792814612_rk, 0.140883243603458_rk, 0.07044162180172898_rk, 0.070441621801729_rk, 0.08133897861876409_rk   &
        /),(/8,8/))
        test_dgrad1_dx(:,:,4,2) = reshape((/ &
        0.0_rk, 3.910295520810847e-18_rk, -0.643950550859379_rk, 3.910295520810847e-18_rk, -4.515220343102261e-18_rk, 0.37178502388347023_rk, 0.37178502388347023_rk, -0.21465018361979293_rk,   &
        0.0_rk, 2.311115933264683e-33_rk, 4.163336342344337e-17_rk, 2.311115933264683e-33_rk, 0.0_rk, 1.3877787807814457e-17_rk, -1.3877787807814457e-17_rk, -6.938893903907228e-18_rk,   &
        0.0_rk, 2.311115933264683e-33_rk, 1.249000902703301e-16_rk, 5.3926038442842604e-33_rk, 3.833423148944782e-33_rk, -6.938893903907228e-17_rk, 6.938893903907228e-17_rk, -1.3877787807814457e-17_rk,   &
        0.0_rk, 5.446339070428949e-17_rk, 0.6439505508593787_rk, 5.446339070428949e-17_rk, 6.28889065682026e-17_rk, 0.37178502388347_rk, 0.37178502388347_rk, 0.21465018361979288_rk,   &
        0.0_rk, 1.0477605269683032e-18_rk, -0.17254603006834712_rk, 1.0477605269683032e-18_rk, -1.2098496445828277e-18_rk, 0.09961949690756147_rk, 0.09961949690756147_rk, -0.05751534335611573_rk,   &
        0.0_rk, -7.703719777548943e-34_rk, -1.3877787807814457e-17_rk, -7.703719777548943e-34_rk, 0.0_rk, 1.3877787807814457e-17_rk, -1.3877787807814457e-17_rk, -6.938893903907228e-18_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk,   &
        0.0_rk, 1.4593421556275087e-17_rk, 0.17254603006834712_rk, 1.4593421556275084e-17_rk, 1.6851031727826216e-17_rk, 0.09961949690756147_rk, 0.09961949690756147_rk, 0.057515343356115745_rk   &
        /),(/8,8/))
        test_dgrad1_dx(:,:,4,3) = reshape((/ &
        0.0_rk, 0.45534180126147966_rk, 0.0_rk, -0.4553418012614796_rk, -1.8503717077085944e-17_rk, 0.2628917115316043_rk, -0.2628917115316044_rk, -2.5276547591739334e-17_rk,   &
        0.0_rk, -4.163336342344337e-17_rk, 0.0_rk, 4.163336342344337e-17_rk, 0.0_rk, -2.0816681711721685e-17_rk, 2.0816681711721685e-17_rk, 3.469446951953614e-17_rk,   &
        0.0_rk, -1.249000902703301e-16_rk, 0.0_rk, 9.71445146547012e-17_rk, 3.191891195797325e-16_rk, -6.938893903907228e-17_rk, 9.020562075079397e-17_rk, 0.0_rk,   &
        0.0_rk, -0.4553418012614794_rk, 0.0_rk, 0.4553418012614794_rk, 0.0_rk, -0.2628917115316042_rk, 0.2628917115316042_rk, 0.0_rk,   &
        0.0_rk, 0.12200846792814629_rk, 0.0_rk, -0.12200846792814629_rk, 0.0_rk, -0.07044162180172903_rk, 0.07044162180172903_rk, 0.0_rk,   &
        0.0_rk, 1.3877787807814457e-17_rk, 0.0_rk, 0.0_rk, 1.3877787807814457e-17_rk, 0.0_rk, 6.938893903907228e-18_rk, 0.0_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk,   &
        0.0_rk, -0.12200846792814624_rk, 0.0_rk, 0.12200846792814612_rk, -1.3545661029306789e-17_rk, 0.07044162180172898_rk, -0.07044162180172903_rk, -6.7728305146533945e-18_rk   &
        /),(/8,8/))
        test_dgrad1_dx(:,:,5,1) = reshape((/ &
        0.0_rk, 0.3333333333333333_rk, 0.0_rk, 0.33333333333333337_rk, -0.3849001794597505_rk, -0.19245008972987526_rk, -0.19245008972987523_rk, 0.22222222222222227_rk,   &
        0.0_rk, 0.21132486540518713_rk, 0.0_rk, 0.21132486540518713_rk, -2.3461773124865097e-17_rk, -0.12200846792814618_rk, -0.12200846792814624_rk, 1.1730886562432548e-17_rk,   &
        0.0_rk, 0.21132486540518702_rk, 0.0_rk, 0.21132486540518708_rk, 4.958056047779154e-18_rk, -0.12200846792814617_rk, -0.12200846792814618_rk, -1.1730886562432548e-17_rk,   &
        0.0_rk, 0.08931639747704084_rk, 0.0_rk, 0.08931639747704084_rk, 0.10313369225283436_rk, -0.05156684612641718_rk, -0.05156684612641718_rk, -0.05954426498469395_rk,   &
        0.0_rk, 1.2440169358562927_rk, 0.0_rk, 1.2440169358562927_rk, -1.436467025586168_rk, 0.718233512793084_rk, 0.718233512793084_rk, -0.829344623904195_rk,   &
        0.0_rk, 0.7886751345948129_rk, 0.0_rk, 0.7886751345948128_rk, 8.756052933765056e-17_rk, 0.4553418012614795_rk, 0.4553418012614795_rk, 4.378026466882528e-17_rk,   &
        0.0_rk, 0.7886751345948128_rk, 0.0_rk, 0.7886751345948128_rk, 0.0_rk, 0.45534180126147944_rk, 0.45534180126147944_rk, 0.0_rk,   &
        0.0_rk, 0.3333333333333332_rk, 0.0_rk, 0.3333333333333333_rk, 0.38490017945975036_rk, 0.19245008972987515_rk, 0.19245008972987518_rk, 0.22222222222222215_rk   &
        /),(/8,8/))
        test_dgrad1_dx(:,:,5,2) = reshape((/ &
        0.0_rk, -2.8625349938425445e-18_rk, 0.47140452079103184_rk, -2.8625349938425434e-18_rk, 3.305370698519433e-18_rk, -0.2721655269759087_rk, -0.2721655269759087_rk, 0.15713484026367724_rk,   &
        0.0_rk, 1.1730886562432548e-17_rk, 0.29885849072268444_rk, 1.1730886562432548e-17_rk, -1.3023900360878469e-33_rk, 0.17254603006834718_rk, -0.17254603006834718_rk, -0.0996194969075615_rk,   &
        0.0_rk, 1.1730886562432542e-17_rk, 0.29885849072268456_rk, 1.1730886562432545e-17_rk, 2.752273990813211e-34_rk, -0.17254603006834712_rk, 0.17254603006834712_rk, -0.09961949690756146_rk,   &
        0.0_rk, 1.0683126035464238e-17_rk, 0.12631246065433732_rk, 1.0683126035464238e-17_rk, 1.2335811384723955e-17_rk, 0.07292653316078568_rk, 0.07292653316078568_rk, 0.04210415355144577_rk,   &
        0.0_rk, -1.068312603546424e-17_rk, 1.7593056225097896_rk, -1.068312603546424e-17_rk, 1.2335811384723956e-17_rk, -1.0157355747428491_rk, -1.0157355747428491_rk, 0.5864352075032632_rk,   &
        0.0_rk, 4.378026466882528e-17_rk, 1.1153550716504104_rk, 4.378026466882527e-17_rk, 4.860585785951308e-33_rk, 0.6439505508593789_rk, -0.6439505508593789_rk, -0.3717850238834702_rk,   &
        0.0_rk, 4.378026466882527e-17_rk, 1.1153550716504104_rk, 4.378026466882527e-17_rk, 0.0_rk, -0.6439505508593788_rk, 0.6439505508593788_rk, -0.3717850238834701_rk,   &
        0.0_rk, 3.9869969148014415e-17_rk, 0.4714045207910317_rk, 3.986996914801441e-17_rk, 4.603787484037639e-17_rk, 0.2721655269759087_rk, 0.2721655269759087_rk, 0.15713484026367724_rk   &
        /),(/8,8/))
        test_dgrad1_dx(:,:,5,3) = reshape((/ &
        0.0_rk, -0.3333333333333333_rk, 0.0_rk, 0.33333333333333354_rk, -1.8503717077085944e-17_rk, -0.19245008972987523_rk, 0.19245008972987523_rk, 1.8503717077085944e-17_rk,   &
        0.0_rk, -0.21132486540518713_rk, 0.0_rk, 0.21132486540518713_rk, -0.24401693585629244_rk, -0.12200846792814618_rk, 0.12200846792814624_rk, 0.1408832436034581_rk,   &
        0.0_rk, -0.21132486540518708_rk, 0.0_rk, 0.21132486540518708_rk, 0.24401693585629236_rk, -0.12200846792814617_rk, 0.12200846792814626_rk, -0.14088324360345805_rk,   &
        0.0_rk, -0.0893163974770409_rk, 0.0_rk, 0.0893163974770409_rk, 0.0_rk, -0.05156684612641721_rk, 0.05156684612641721_rk, 0.0_rk,   &
        0.0_rk, -1.2440169358562927_rk, 0.0_rk, 1.2440169358562927_rk, 0.0_rk, 0.718233512793084_rk, -0.718233512793084_rk, 0.0_rk,   &
        0.0_rk, -0.7886751345948129_rk, 0.0_rk, 0.788675134594813_rk, -0.910683602522959_rk, 0.4553418012614796_rk, -0.4553418012614795_rk, -0.5257834230632087_rk,   &
        0.0_rk, -0.788675134594813_rk, 0.0_rk, 0.7886751345948128_rk, 0.910683602522959_rk, 0.45534180126147944_rk, -0.4553418012614796_rk, 0.5257834230632086_rk,   &
        0.0_rk, -0.33333333333333326_rk, 0.0_rk, 0.3333333333333333_rk, -3.700743415417189e-17_rk, 0.19245008972987515_rk, -0.19245008972987526_rk, -1.8503717077085944e-17_rk   &
        /),(/8,8/))
        test_dgrad1_dx(:,:,6,1) = reshape((/ &
        0.0_rk, -0.12200846792814618_rk, 0.0_rk, -0.12200846792814624_rk, 0.14088324360345808_rk, 0.07044162180172903_rk, 0.07044162180172905_rk, -0.0813389786187641_rk,   &
        0.0_rk, -4.163336342344337e-17_rk, 0.0_rk, -4.163336342344337e-17_rk, 0.0_rk, 2.0816681711721685e-17_rk, 2.0816681711721685e-17_rk, 0.0_rk,   &
        0.0_rk, -4.163336342344337e-17_rk, 0.0_rk, 1.3877787807814457e-17_rk, -4.958056047779154e-18_rk, 1.3877787807814457e-17_rk, 0.0_rk, 0.0_rk,   &
        0.0_rk, 0.12200846792814618_rk, 0.0_rk, 0.12200846792814618_rk, 0.140883243603458_rk, -0.070441621801729_rk, -0.070441621801729_rk, -0.0813389786187641_rk,   &
        0.0_rk, -0.45534180126147966_rk, 0.0_rk, -0.45534180126147966_rk, 0.5257834230632086_rk, -0.2628917115316043_rk, -0.2628917115316043_rk, 0.30356120084098637_rk,   &
        0.0_rk, 1.249000902703301e-16_rk, 0.0_rk, 1.249000902703301e-16_rk, 0.0_rk, 9.020562075079397e-17_rk, 6.245004513516506e-17_rk, 0.0_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk,   &
        0.0_rk, 0.45534180126147933_rk, 0.0_rk, 0.4553418012614794_rk, 0.5257834230632084_rk, 0.2628917115316041_rk, 0.2628917115316042_rk, 0.3035612008409861_rk   &
        /),(/8,8/))
        test_dgrad1_dx(:,:,6,2) = reshape((/ &
        0.0_rk, 1.0477605269683028e-18_rk, -0.17254603006834718_rk, 1.0477605269683028e-18_rk, -1.2098496445828273e-18_rk, 0.09961949690756147_rk, 0.09961949690756147_rk, -0.057515343356115745_rk,   &
        0.0_rk, -2.311115933264683e-33_rk, -4.163336342344337e-17_rk, -2.311115933264683e-33_rk, 0.0_rk, -1.3877787807814457e-17_rk, 1.3877787807814457e-17_rk, 6.938893903907228e-18_rk,   &
        0.0_rk, -2.311115933264683e-33_rk, -1.3877787807814457e-17_rk, 7.703719777548943e-34_rk, -2.752273990813211e-34_rk, 1.3877787807814457e-17_rk, -1.3877787807814457e-17_rk, 1.3877787807814457e-17_rk,   &
        0.0_rk, 1.459342155627509e-17_rk, 0.17254603006834712_rk, 1.459342155627509e-17_rk, 1.685103172782622e-17_rk, 0.09961949690756147_rk, 0.09961949690756147_rk, 0.0575153433561157_rk,   &
        0.0_rk, 3.910295520810848e-18_rk, -0.6439505508593788_rk, 3.910295520810848e-18_rk, -4.515220343102261e-18_rk, 0.3717850238834701_rk, 0.3717850238834701_rk, -0.21465018361979293_rk,   &
        0.0_rk, 6.933347799794049e-33_rk, 1.249000902703301e-16_rk, 6.933347799794049e-33_rk, 0.0_rk, 9.71445146547012e-17_rk, -9.71445146547012e-17_rk, -4.85722573273506e-17_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk,   &
        0.0_rk, 5.446339070428948e-17_rk, 0.6439505508593786_rk, 5.446339070428949e-17_rk, 6.28889065682026e-17_rk, 0.3717850238834701_rk, 0.3717850238834701_rk, 0.21465018361979293_rk   &
        /),(/8,8/))
        test_dgrad1_dx(:,:,6,3) = reshape((/ &
        0.0_rk, 0.12200846792814618_rk, 0.0_rk, -0.12200846792814624_rk, 1.8503717077085944e-17_rk, 0.07044162180172905_rk, -0.07044162180172905_rk, -6.7728305146533945e-18_rk,   &
        0.0_rk, 4.163336342344337e-17_rk, 0.0_rk, -4.163336342344337e-17_rk, 0.0_rk, 2.0816681711721685e-17_rk, -2.0816681711721685e-17_rk, -3.469446951953614e-17_rk,   &
        0.0_rk, 1.3877787807814457e-17_rk, 0.0_rk, 1.3877787807814457e-17_rk, 1.3877787807814457e-17_rk, 1.3877787807814457e-17_rk, 2.0816681711721685e-17_rk, 0.0_rk,   &
        0.0_rk, -0.12200846792814612_rk, 0.0_rk, 0.12200846792814612_rk, 0.0_rk, -0.07044162180172897_rk, 0.07044162180172897_rk, 0.0_rk,   &
        0.0_rk, 0.45534180126147966_rk, 0.0_rk, -0.45534180126147966_rk, 0.0_rk, -0.2628917115316043_rk, 0.2628917115316043_rk, 0.0_rk,   &
        0.0_rk, -1.249000902703301e-16_rk, 0.0_rk, 0.0_rk, -1.249000902703301e-16_rk, 0.0_rk, -6.245004513516506e-17_rk, 0.0_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk,   &
        0.0_rk, -0.4553418012614794_rk, 0.0_rk, 0.4553418012614794_rk, -5.055309518347867e-17_rk, 0.2628917115316041_rk, -0.2628917115316042_rk, -2.5276547591739334e-17_rk   &
        /),(/8,8/))
        test_dgrad1_dx(:,:,7,1) = reshape((/ &
        0.0_rk, -0.08931639747704093_rk, 0.0_rk, -0.08931639747704087_rk, 0.10313369225283434_rk, 0.05156684612641721_rk, 0.05156684612641714_rk, -0.05954426498469395_rk,   &
        0.0_rk, -0.21132486540518708_rk, 0.0_rk, -0.21132486540518713_rk, 2.3461773124865097e-17_rk, 0.12200846792814621_rk, 0.12200846792814626_rk, -1.1730886562432548e-17_rk,   &
        0.0_rk, -0.21132486540518702_rk, 0.0_rk, -0.21132486540518708_rk, -1.8503717077085944e-17_rk, 0.12200846792814614_rk, 0.12200846792814618_rk, 1.1730886562432548e-17_rk,   &
        0.0_rk, -0.33333333333333315_rk, 0.0_rk, -0.33333333333333315_rk, -0.38490017945975036_rk, 0.19245008972987518_rk, 0.19245008972987518_rk, 0.2222222222222221_rk,   &
        0.0_rk, -0.3333333333333334_rk, 0.0_rk, -0.3333333333333334_rk, 0.3849001794597506_rk, -0.1924500897298753_rk, -0.1924500897298753_rk, 0.22222222222222227_rk,   &
        0.0_rk, -0.7886751345948129_rk, 0.0_rk, -0.7886751345948129_rk, -8.756052933765056e-17_rk, -0.4553418012614795_rk, -0.4553418012614795_rk, -4.378026466882528e-17_rk,   &
        0.0_rk, -0.7886751345948128_rk, 0.0_rk, -0.7886751345948128_rk, 0.0_rk, -0.45534180126147944_rk, -0.45534180126147944_rk, 0.0_rk,   &
        0.0_rk, -1.2440169358562918_rk, 0.0_rk, -1.2440169358562922_rk, -1.436467025586167_rk, -0.7182335127930835_rk, -0.7182335127930835_rk, -0.8293446239041945_rk   &
        /),(/8,8/))
        test_dgrad1_dx(:,:,7,2) = reshape((/ &
        0.0_rk, 7.67013939905939e-19_rk, -0.1263124606543373_rk, 7.67013939905938e-19_rk, -8.85671409353778e-19_rk, 0.07292653316078573_rk, 0.07292653316078573_rk, -0.04210415355144577_rk,   &
        0.0_rk, -1.1730886562432545e-17_rk, -0.29885849072268444_rk, -1.1730886562432548e-17_rk, 1.3023900360878469e-33_rk, -0.17254603006834718_rk, 0.17254603006834718_rk, 0.09961949690756153_rk,   &
        0.0_rk, -1.1730886562432542e-17_rk, -0.29885849072268456_rk, -1.1730886562432545e-17_rk, -1.0271626370065259e-33_rk, 0.17254603006834712_rk, -0.17254603006834712_rk, 0.09961949690756146_rk,   &
        0.0_rk, -3.986996914801442e-17_rk, -0.47140452079103146_rk, -3.986996914801442e-17_rk, -4.603787484037639e-17_rk, -0.2721655269759086_rk, -0.2721655269759086_rk, -0.1571348402636772_rk,   &
        0.0_rk, 2.8625349938425445e-18_rk, -0.47140452079103184_rk, 2.8625349938425445e-18_rk, -3.305370698519434e-18_rk, 0.2721655269759087_rk, 0.2721655269759087_rk, -0.15713484026367724_rk,   &
        0.0_rk, -4.378026466882528e-17_rk, -1.1153550716504104_rk, -4.378026466882528e-17_rk, -4.860585785951308e-33_rk, -0.6439505508593789_rk, 0.6439505508593789_rk, 0.3717850238834702_rk,   &
        0.0_rk, -4.378026466882527e-17_rk, -1.1153550716504104_rk, -4.378026466882527e-17_rk, 0.0_rk, 0.6439505508593788_rk, -0.6439505508593788_rk, 0.3717850238834701_rk,   &
        0.0_rk, -1.487967505565934e-16_rk, -1.759305622509789_rk, -1.487967505565934e-16_rk, -1.718156879767816e-16_rk, -1.0157355747428491_rk, -1.0157355747428491_rk, -0.5864352075032631_rk   &
        /),(/8,8/))
        test_dgrad1_dx(:,:,7,3) = reshape((/ &
        0.0_rk, 0.08931639747704093_rk, 0.0_rk, -0.08931639747704095_rk, 4.958056047779154e-18_rk, 0.05156684612641718_rk, -0.05156684612641714_rk, -4.958056047779154e-18_rk,   &
        0.0_rk, 0.21132486540518708_rk, 0.0_rk, -0.21132486540518713_rk, 0.24401693585629244_rk, 0.12200846792814621_rk, -0.12200846792814626_rk, -0.14088324360345805_rk,   &
        0.0_rk, 0.21132486540518713_rk, 0.0_rk, -0.21132486540518708_rk, -0.24401693585629247_rk, 0.12200846792814614_rk, -0.12200846792814624_rk, 0.14088324360345805_rk,   &
        0.0_rk, 0.33333333333333315_rk, 0.0_rk, -0.33333333333333315_rk, 0.0_rk, 0.19245008972987515_rk, -0.19245008972987515_rk, 0.0_rk,   &
        0.0_rk, 0.3333333333333334_rk, 0.0_rk, -0.3333333333333334_rk, 0.0_rk, -0.1924500897298753_rk, 0.1924500897298753_rk, 0.0_rk,   &
        0.0_rk, 0.7886751345948129_rk, 0.0_rk, -0.788675134594813_rk, 0.910683602522959_rk, -0.4553418012614796_rk, 0.4553418012614795_rk, 0.5257834230632087_rk,   &
        0.0_rk, 0.788675134594813_rk, 0.0_rk, -0.7886751345948128_rk, -0.910683602522959_rk, -0.45534180126147944_rk, 0.4553418012614796_rk, -0.5257834230632086_rk,   &
        0.0_rk, 1.2440169358562922_rk, 0.0_rk, -1.2440169358562922_rk, 1.3811362452112924e-16_rk, -0.7182335127930835_rk, 0.7182335127930837_rk, 6.905681226056462e-17_rk   &
        /),(/8,8/))
        test_dgrad1_dx(:,:,8,1) = reshape((/ &
        0.0_rk, -0.12200846792814618_rk, 0.0_rk, -0.12200846792814624_rk, 0.14088324360345814_rk, 0.07044162180172903_rk, 0.07044162180172908_rk, -0.08133897861876413_rk,   &
        0.0_rk, 1.3877787807814457e-17_rk, 0.0_rk, 1.3877787807814457e-17_rk, 0.0_rk, -6.938893903907228e-18_rk, 2.0816681711721685e-17_rk, 0.0_rk,   &
        0.0_rk, 1.3877787807814457e-17_rk, 0.0_rk, 1.3877787807814457e-17_rk, 1.8503717077085944e-17_rk, -1.3877787807814457e-17_rk, 0.0_rk, 0.0_rk,   &
        0.0_rk, 0.12200846792814618_rk, 0.0_rk, 0.12200846792814618_rk, 0.140883243603458_rk, -0.070441621801729_rk, -0.070441621801729_rk, -0.08133897861876407_rk,   &
        0.0_rk, -0.4553418012614796_rk, 0.0_rk, -0.4553418012614796_rk, 0.5257834230632086_rk, -0.2628917115316043_rk, -0.2628917115316043_rk, 0.30356120084098637_rk,   &
        0.0_rk, -4.163336342344337e-17_rk, 0.0_rk, -4.163336342344337e-17_rk, 0.0_rk, -2.0816681711721685e-17_rk, -2.0816681711721685e-17_rk, 0.0_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk,   &
        0.0_rk, 0.45534180126147933_rk, 0.0_rk, 0.45534180126147944_rk, 0.5257834230632084_rk, 0.2628917115316042_rk, 0.2628917115316042_rk, 0.3035612008409863_rk   &
        /),(/8,8/))
        test_dgrad1_dx(:,:,8,2) = reshape((/ &
        0.0_rk, 1.0477605269683032e-18_rk, -0.17254603006834723_rk, 1.0477605269683028e-18_rk, -1.2098496445828273e-18_rk, 0.09961949690756147_rk, 0.09961949690756147_rk, -0.057515343356115745_rk,   &
        0.0_rk, 7.703719777548943e-34_rk, 1.3877787807814457e-17_rk, 7.703719777548943e-34_rk, 0.0_rk, -1.3877787807814457e-17_rk, 1.3877787807814457e-17_rk, 6.938893903907228e-18_rk,   &
        0.0_rk, 7.703719777548943e-34_rk, 4.163336342344337e-17_rk, 7.703719777548943e-34_rk, 1.0271626370065259e-33_rk, -1.3877787807814457e-17_rk, 1.3877787807814457e-17_rk, -1.3877787807814457e-17_rk,   &
        0.0_rk, 1.4593421556275084e-17_rk, 0.17254603006834712_rk, 1.4593421556275084e-17_rk, 1.6851031727826213e-17_rk, 0.09961949690756144_rk, 0.09961949690756144_rk, 0.0575153433561157_rk,   &
        0.0_rk, 3.910295520810847e-18_rk, -0.6439505508593788_rk, 3.910295520810847e-18_rk, -4.515220343102261e-18_rk, 0.3717850238834702_rk, 0.3717850238834702_rk, -0.21465018361979293_rk,   &
        0.0_rk, -2.311115933264683e-33_rk, -4.163336342344337e-17_rk, -2.311115933264683e-33_rk, 0.0_rk, -1.3877787807814457e-17_rk, 1.3877787807814457e-17_rk, 6.938893903907228e-18_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk,   &
        0.0_rk, 5.446339070428951e-17_rk, 0.6439505508593788_rk, 5.44633907042895e-17_rk, 6.288890656820261e-17_rk, 0.3717850238834702_rk, 0.3717850238834702_rk, 0.21465018361979293_rk   &
        /),(/8,8/))
        test_dgrad1_dx(:,:,8,3) = reshape((/ &
        0.0_rk, 0.12200846792814618_rk, 0.0_rk, -0.12200846792814629_rk, -4.958056047779154e-18_rk, 0.07044162180172903_rk, -0.07044162180172908_rk, -6.7728305146533945e-18_rk,   &
        0.0_rk, -1.3877787807814457e-17_rk, 0.0_rk, 1.3877787807814457e-17_rk, 0.0_rk, -6.938893903907228e-18_rk, -2.0816681711721685e-17_rk, 2.0816681711721685e-17_rk,   &
        0.0_rk, -4.163336342344337e-17_rk, 0.0_rk, 1.3877787807814457e-17_rk, 6.938893903907228e-17_rk, -1.3877787807814457e-17_rk, 2.0816681711721685e-17_rk, 0.0_rk,   &
        0.0_rk, -0.12200846792814618_rk, 0.0_rk, 0.12200846792814618_rk, 0.0_rk, -0.070441621801729_rk, 0.070441621801729_rk, 0.0_rk,   &
        0.0_rk, 0.4553418012614796_rk, 0.0_rk, -0.4553418012614796_rk, 0.0_rk, -0.2628917115316043_rk, 0.2628917115316043_rk, 0.0_rk,   &
        0.0_rk, 4.163336342344337e-17_rk, 0.0_rk, 0.0_rk, 4.163336342344337e-17_rk, 0.0_rk, 2.0816681711721685e-17_rk, 0.0_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk,   &
        0.0_rk, -0.4553418012614796_rk, 0.0_rk, 0.45534180126147944_rk, -5.055309518347867e-17_rk, 0.2628917115316042_rk, -0.2628917115316043_rk, -2.5276547591739334e-17_rk   &
        /),(/8,8/))
        
        
        
        do inode_diff = 1,self%elem%nterms_c 
            do idir =1,3
                @assertEqual(transpose(test_dgrad1_dx(:,:,inode_diff,idir)),self%elem%dgrad1_dx(:,:,inode_diff,idir),tol)
            end do
        end do

    end subroutine testElement_dgrad1_dx
    !*******************************************************************************************






    !> Test cartesian dgrad2_dx 
    !!
    !!
    !------------------------------------------------------------------------------------------
    @Test
    subroutine testElement_dgrad2_dx(self)
        class(test_element_linearC_dx),    intent(inout)   :: self
        
        
        real(rk), dimension(self%elem%basis_s%nnodes_elem(),self%elem%nterms_s,self%elem%nterms_c,3) :: test_dgrad2_dx
        
        real(rk)        :: tol = 1.e-13_rk
        integer(ik)     :: inode_diff, idir, inode
        
       
       
        !
        ! dgrad2_dx
        ! 
        test_dgrad2_dx(:,:,1,1) = reshape((/ &
        0.0_rk, 0.8796528112548948_rk, 0.0_rk, 0.8796528112548946_rk, -1.0157355747428491_rk, -0.5078677873714245_rk, -0.5078677873714246_rk, 0.5864352075032632_rk,   &
        0.0_rk, 0.23570226039551584_rk, 0.0_rk, 0.23570226039551587_rk, -1.8503717077085944e-17_rk, -0.13608276348795434_rk, -0.13608276348795434_rk, 9.251858538542972e-18_rk,   &
        0.0_rk, 0.23570226039551573_rk, 0.0_rk, 0.23570226039551584_rk, 1.8503717077085944e-17_rk, -0.13608276348795434_rk, -0.1360827634879543_rk, -9.251858538542972e-18_rk,   &
        0.0_rk, 0.06315623032716874_rk, 0.0_rk, 0.06315623032716874_rk, 0.07292653316078579_rk, -0.036463266580392895_rk, -0.036463266580392895_rk, -0.04210415355144578_rk,   &
        0.0_rk, 0.8796528112548948_rk, 0.0_rk, 0.8796528112548948_rk, -1.0157355747428491_rk, 0.5078677873714246_rk, 0.5078677873714246_rk, -0.5864352075032632_rk,   &
        0.0_rk, 0.23570226039551587_rk, 0.0_rk, 0.23570226039551584_rk, 1.8503717077085944e-17_rk, 0.13608276348795434_rk, 0.13608276348795434_rk, 9.251858538542972e-18_rk,   &
        0.0_rk, 0.23570226039551584_rk, 0.0_rk, 0.23570226039551584_rk, 0.0_rk, 0.13608276348795434_rk, 0.13608276348795434_rk, 0.0_rk,   &
        0.0_rk, 0.06315623032716869_rk, 0.0_rk, 0.0631562303271687_rk, 0.07292653316078568_rk, 0.03646326658039285_rk, 0.03646326658039284_rk, 0.04210415355144578_rk   &
        /),(/8,8/))
        test_dgrad2_dx(:,:,1,2) = reshape((/ &
        0.0_rk, -7.554110863947321e-18_rk, 1.2440169358562925_rk, -7.554110863947318e-18_rk, 8.722735881576523e-18_rk, -0.7182335127930838_rk, -0.7182335127930838_rk, 0.4146723119520974_rk,   &
        0.0_rk, 1.3084103822364792e-17_rk, 0.33333333333333337_rk, 1.3084103822364794e-17_rk, -1.0271626370065259e-33_rk, 0.19245008972987526_rk, -0.19245008972987526_rk, -0.1111111111111111_rk,   &
        0.0_rk, 1.3084103822364786e-17_rk, 0.33333333333333337_rk, 1.3084103822364792e-17_rk, 1.0271626370065259e-33_rk, -0.19245008972987526_rk, 0.19245008972987526_rk, -0.11111111111111113_rk,   &
        0.0_rk, 7.554110863947337e-18_rk, 0.08931639747704082_rk, 7.554110863947337e-18_rk, 8.722735881576538e-18_rk, 0.05156684612641714_rk, 0.05156684612641714_rk, 0.029772132492347003_rk,   &
        0.0_rk, -7.554110863947321e-18_rk, 1.2440169358562925_rk, -7.554110863947321e-18_rk, 8.722735881576523e-18_rk, -0.7182335127930838_rk, -0.7182335127930838_rk, 0.4146723119520974_rk,   &
        0.0_rk, 1.3084103822364794e-17_rk, 0.33333333333333337_rk, 1.3084103822364792e-17_rk, 1.0271626370065259e-33_rk, 0.19245008972987526_rk, -0.19245008972987526_rk, -0.1111111111111111_rk,   &
        0.0_rk, 1.3084103822364792e-17_rk, 0.33333333333333337_rk, 1.3084103822364792e-17_rk, 0.0_rk, -0.19245008972987526_rk, 0.19245008972987526_rk, -0.11111111111111113_rk,   &
        0.0_rk, 7.554110863947324e-18_rk, 0.08931639747704093_rk, 7.554110863947324e-18_rk, 8.722735881576535e-18_rk, 0.051566846126417085_rk, 0.051566846126417085_rk, 0.029772132492346996_rk   &
        /),(/8,8/))
        test_dgrad2_dx(:,:,1,3) = reshape((/ &
        0.0_rk, -0.8796528112548948_rk, 0.0_rk, 0.8796528112548949_rk, -6.905681226056462e-17_rk, -0.5078677873714246_rk, 0.5078677873714246_rk, 6.905681226056462e-17_rk,   &
        0.0_rk, -0.23570226039551584_rk, 0.0_rk, 0.23570226039551587_rk, -0.2721655269759087_rk, -0.13608276348795434_rk, 0.13608276348795434_rk, 0.15713484026367724_rk,   &
        0.0_rk, -0.23570226039551587_rk, 0.0_rk, 0.23570226039551584_rk, 0.2721655269759086_rk, -0.13608276348795434_rk, 0.1360827634879543_rk, -0.15713484026367724_rk,   &
        0.0_rk, -0.06315623032716877_rk, 0.0_rk, 0.06315623032716877_rk, 0.0_rk, -0.036463266580392895_rk, 0.036463266580392895_rk, 0.0_rk,   &
        0.0_rk, -0.8796528112548948_rk, 0.0_rk, 0.8796528112548948_rk, 0.0_rk, 0.5078677873714246_rk, -0.5078677873714246_rk, 0.0_rk,   &
        0.0_rk, -0.23570226039551587_rk, 0.0_rk, 0.2357022603955159_rk, -0.2721655269759087_rk, 0.13608276348795437_rk, -0.13608276348795434_rk, -0.15713484026367724_rk,   &
        0.0_rk, -0.2357022603955159_rk, 0.0_rk, 0.23570226039551584_rk, 0.2721655269759086_rk, 0.13608276348795434_rk, -0.13608276348795434_rk, 0.15713484026367724_rk,   &
        0.0_rk, -0.06315623032716872_rk, 0.0_rk, 0.0631562303271687_rk, -4.958056047779148e-18_rk, 0.03646326658039285_rk, -0.03646326658039284_rk, -2.479028023889574e-18_rk   &
        /),(/8,8/))
        test_dgrad2_dx(:,:,2,1) = reshape((/ &
        0.0_rk, 0.23570226039551587_rk, 0.0_rk, 0.23570226039551584_rk, -0.2721655269759087_rk, -0.13608276348795434_rk, -0.13608276348795434_rk, 0.15713484026367724_rk,   &
        0.0_rk, 0.8796528112548946_rk, 0.0_rk, 0.8796528112548948_rk, -6.905681226056462e-17_rk, -0.5078677873714246_rk, -0.5078677873714245_rk, 3.452840613028231e-17_rk,   &
        0.0_rk, 0.06315623032716866_rk, 0.0_rk, 0.06315623032716867_rk, 4.958056047779154e-18_rk, -0.03646326658039285_rk, -0.03646326658039284_rk, -2.479028023889577e-18_rk,   &
        0.0_rk, 0.23570226039551587_rk, 0.0_rk, 0.23570226039551587_rk, 0.2721655269759087_rk, -0.13608276348795434_rk, -0.13608276348795434_rk, -0.15713484026367722_rk,   &
        0.0_rk, 0.23570226039551587_rk, 0.0_rk, 0.23570226039551587_rk, -0.2721655269759087_rk, 0.13608276348795434_rk, 0.13608276348795434_rk, -0.15713484026367724_rk,   &
        0.0_rk, 0.8796528112548948_rk, 0.0_rk, 0.8796528112548946_rk, 6.905681226056462e-17_rk, 0.5078677873714245_rk, 0.5078677873714246_rk, 3.452840613028231e-17_rk,   &
        0.0_rk, 0.06315623032716867_rk, 0.0_rk, 0.06315623032716867_rk, 0.0_rk, 0.03646326658039285_rk, 0.03646326658039285_rk, 0.0_rk,   &
        0.0_rk, 0.2357022603955158_rk, 0.0_rk, 0.23570226039551584_rk, 0.27216552697590873_rk, 0.13608276348795434_rk, 0.13608276348795437_rk, 0.15713484026367722_rk   &
        /),(/8,8/))
        test_dgrad2_dx(:,:,2,2) = reshape((/ &
        0.0_rk, -2.0241179055298556e-18_rk, 0.33333333333333337_rk, -2.0241179055298548e-18_rk, 2.3372500352584067e-18_rk, -0.19245008972987526_rk, -0.19245008972987526_rk, 0.1111111111111111_rk,   &
        0.0_rk, 4.883054023657155e-17_rk, 1.2440169358562925_rk, 4.883054023657156e-17_rk, -3.833423148944782e-33_rk, 0.7182335127930838_rk, -0.7182335127930838_rk, -0.4146723119520974_rk,   &
        0.0_rk, 3.5058750528876115e-18_rk, 0.08931639747704093_rk, 3.505875052887612e-18_rk, 2.752273990813211e-34_rk, -0.05156684612641717_rk, 0.05156684612641717_rk, -0.029772132492346975_rk,   &
        0.0_rk, 2.8192325550259443e-17_rk, 0.33333333333333337_rk, 2.8192325550259443e-17_rk, 3.2553693491047694e-17_rk, 0.19245008972987532_rk, 0.19245008972987532_rk, 0.1111111111111111_rk,   &
        0.0_rk, -2.0241179055298556e-18_rk, 0.33333333333333337_rk, -2.0241179055298556e-18_rk, 2.3372500352584067e-18_rk, -0.19245008972987526_rk, -0.19245008972987526_rk, 0.1111111111111111_rk,   &
        0.0_rk, 4.883054023657156e-17_rk, 1.2440169358562925_rk, 4.883054023657155e-17_rk, 3.833423148944782e-33_rk, 0.7182335127930838_rk, -0.7182335127930838_rk, -0.4146723119520974_rk,   &
        0.0_rk, 3.505875052887612e-18_rk, 0.08931639747704093_rk, 3.505875052887612e-18_rk, 0.0_rk, -0.05156684612641717_rk, 0.05156684612641717_rk, -0.029772132492346975_rk,   &
        0.0_rk, 2.819232555025944e-17_rk, 0.33333333333333326_rk, 2.819232555025945e-17_rk, 3.255369349104771e-17_rk, 0.19245008972987526_rk, 0.19245008972987526_rk, 0.1111111111111111_rk   &
        /),(/8,8/))
        test_dgrad2_dx(:,:,2,3) = reshape((/ &
        0.0_rk, -0.23570226039551587_rk, 0.0_rk, 0.2357022603955159_rk, -1.8503717077085944e-17_rk, -0.13608276348795437_rk, 0.13608276348795434_rk, 1.8503717077085944e-17_rk,   &
        0.0_rk, -0.8796528112548946_rk, 0.0_rk, 0.8796528112548948_rk, -1.0157355747428491_rk, -0.5078677873714246_rk, 0.5078677873714245_rk, 0.5864352075032632_rk,   &
        0.0_rk, -0.06315623032716869_rk, 0.0_rk, 0.06315623032716867_rk, 0.07292653316078568_rk, -0.03646326658039285_rk, 0.03646326658039284_rk, -0.04210415355144577_rk,   &
        0.0_rk, -0.23570226039551595_rk, 0.0_rk, 0.23570226039551595_rk, 0.0_rk, -0.1360827634879544_rk, 0.1360827634879544_rk, 0.0_rk,   &
        0.0_rk, -0.23570226039551587_rk, 0.0_rk, 0.23570226039551587_rk, 0.0_rk, 0.13608276348795434_rk, -0.13608276348795434_rk, 0.0_rk,   &
        0.0_rk, -0.8796528112548948_rk, 0.0_rk, 0.8796528112548949_rk, -1.0157355747428491_rk, 0.5078677873714246_rk, -0.5078677873714246_rk, -0.5864352075032632_rk,   &
        0.0_rk, -0.06315623032716872_rk, 0.0_rk, 0.06315623032716867_rk, 0.07292653316078568_rk, 0.03646326658039285_rk, -0.03646326658039284_rk, 0.04210415355144577_rk,   &
        0.0_rk, -0.2357022603955159_rk, 0.0_rk, 0.23570226039551584_rk, -1.8503717077085938e-17_rk, 0.13608276348795434_rk, -0.13608276348795434_rk, -9.251858538542969e-18_rk   &
        /),(/8,8/))
        test_dgrad2_dx(:,:,3,1) = reshape((/ &
        0.0_rk, 0.06315623032716869_rk, 0.0_rk, 0.06315623032716867_rk, -0.07292653316078568_rk, -0.03646326658039285_rk, -0.03646326658039284_rk, 0.04210415355144577_rk,   &
        0.0_rk, 0.23570226039551584_rk, 0.0_rk, 0.23570226039551587_rk, -1.8503717077085944e-17_rk, -0.1360827634879543_rk, -0.13608276348795434_rk, 9.251858538542972e-18_rk,   &
        0.0_rk, 0.23570226039551578_rk, 0.0_rk, 0.23570226039551584_rk, 1.8503717077085944e-17_rk, -0.13608276348795434_rk, -0.1360827634879543_rk, -9.251858538542972e-18_rk,   &
        0.0_rk, 0.8796528112548943_rk, 0.0_rk, 0.8796528112548943_rk, 1.0157355747428485_rk, -0.5078677873714242_rk, -0.5078677873714242_rk, -0.586435207503263_rk,   &
        0.0_rk, 0.06315623032716869_rk, 0.0_rk, 0.06315623032716869_rk, -0.07292653316078568_rk, 0.03646326658039284_rk, 0.03646326658039284_rk, -0.04210415355144577_rk,   &
        0.0_rk, 0.23570226039551587_rk, 0.0_rk, 0.23570226039551584_rk, 1.8503717077085944e-17_rk, 0.13608276348795434_rk, 0.1360827634879543_rk, 9.251858538542972e-18_rk,   &
        0.0_rk, 0.23570226039551584_rk, 0.0_rk, 0.23570226039551584_rk, 0.0_rk, 0.13608276348795434_rk, 0.13608276348795434_rk, 0.0_rk,   &
        0.0_rk, 0.8796528112548944_rk, 0.0_rk, 0.8796528112548946_rk, 1.0157355747428487_rk, 0.5078677873714244_rk, 0.5078677873714244_rk, 0.586435207503263_rk   &
        /),(/8,8/))
        test_dgrad2_dx(:,:,3,2) = reshape((/ &
        0.0_rk, -5.423607581721005e-19_rk, 0.08931639747704093_rk, -5.423607581721004e-19_rk, 6.262642594571037e-19_rk, -0.05156684612641717_rk, -0.05156684612641717_rk, 0.029772132492346975_rk,   &
        0.0_rk, 1.3084103822364792e-17_rk, 0.33333333333333337_rk, 1.3084103822364794e-17_rk, -1.0271626370065259e-33_rk, 0.19245008972987526_rk, -0.19245008972987526_rk, -0.11111111111111113_rk,   &
        0.0_rk, 1.3084103822364789e-17_rk, 0.33333333333333337_rk, 1.3084103822364792e-17_rk, 1.0271626370065259e-33_rk, -0.19245008972987526_rk, 0.19245008972987526_rk, -0.1111111111111111_rk,   &
        0.0_rk, 1.0521519133709038e-16_rk, 1.244016935856292_rk, 1.0521519133709038e-16_rk, 1.2149203808261421e-16_rk, 0.7182335127930837_rk, 0.7182335127930837_rk, 0.41467231195209725_rk,   &
        0.0_rk, -5.423607581721005e-19_rk, 0.08931639747704093_rk, -5.423607581721005e-19_rk, 6.262642594571037e-19_rk, -0.05156684612641717_rk, -0.05156684612641717_rk, 0.029772132492346975_rk,   &
        0.0_rk, 1.3084103822364794e-17_rk, 0.33333333333333337_rk, 1.3084103822364792e-17_rk, 1.0271626370065259e-33_rk, 0.19245008972987526_rk, -0.19245008972987526_rk, -0.11111111111111113_rk,   &
        0.0_rk, 1.3084103822364792e-17_rk, 0.33333333333333337_rk, 1.3084103822364792e-17_rk, 0.0_rk, -0.19245008972987526_rk, 0.19245008972987526_rk, -0.1111111111111111_rk,   &
        0.0_rk, 1.0521519133709038e-16_rk, 1.2440169358562922_rk, 1.0521519133709041e-16_rk, 1.2149203808261424e-16_rk, 0.7182335127930838_rk, 0.7182335127930838_rk, 0.41467231195209747_rk   &
        /),(/8,8/))
        test_dgrad2_dx(:,:,3,3) = reshape((/ &
        0.0_rk, -0.06315623032716869_rk, 0.0_rk, 0.06315623032716872_rk, -4.958056047779154e-18_rk, -0.03646326658039284_rk, 0.03646326658039284_rk, 4.958056047779154e-18_rk,   &
        0.0_rk, -0.23570226039551584_rk, 0.0_rk, 0.23570226039551587_rk, -0.2721655269759086_rk, -0.1360827634879543_rk, 0.13608276348795434_rk, 0.15713484026367724_rk,   &
        0.0_rk, -0.23570226039551587_rk, 0.0_rk, 0.23570226039551584_rk, 0.2721655269759087_rk, -0.13608276348795434_rk, 0.13608276348795434_rk, -0.15713484026367724_rk,   &
        0.0_rk, -0.8796528112548945_rk, 0.0_rk, 0.8796528112548945_rk, 0.0_rk, -0.5078677873714244_rk, 0.5078677873714244_rk, 0.0_rk,   &
        0.0_rk, -0.06315623032716869_rk, 0.0_rk, 0.06315623032716869_rk, 0.0_rk, 0.03646326658039284_rk, -0.03646326658039284_rk, 0.0_rk,   &
        0.0_rk, -0.23570226039551587_rk, 0.0_rk, 0.2357022603955159_rk, -0.2721655269759086_rk, 0.13608276348795434_rk, -0.1360827634879543_rk, -0.15713484026367727_rk,   &
        0.0_rk, -0.2357022603955159_rk, 0.0_rk, 0.23570226039551584_rk, 0.2721655269759087_rk, 0.13608276348795434_rk, -0.13608276348795437_rk, 0.15713484026367724_rk,   &
        0.0_rk, -0.8796528112548947_rk, 0.0_rk, 0.8796528112548946_rk, -6.905681226056462e-17_rk, 0.5078677873714244_rk, -0.5078677873714245_rk, -3.452840613028231e-17_rk   &
        /),(/8,8/))
        test_dgrad2_dx(:,:,4,1) = reshape((/ &
        0.0_rk, 0.23570226039551587_rk, 0.0_rk, 0.23570226039551584_rk, -0.2721655269759086_rk, -0.13608276348795434_rk, -0.1360827634879543_rk, 0.15713484026367724_rk,   &
        0.0_rk, 0.06315623032716867_rk, 0.0_rk, 0.06315623032716869_rk, -4.958056047779154e-18_rk, -0.03646326658039284_rk, -0.03646326658039285_rk, 2.479028023889577e-18_rk,   &
        0.0_rk, 0.8796528112548945_rk, 0.0_rk, 0.8796528112548946_rk, 6.905681226056462e-17_rk, -0.5078677873714245_rk, -0.5078677873714244_rk, -3.452840613028231e-17_rk,   &
        0.0_rk, 0.23570226039551587_rk, 0.0_rk, 0.23570226039551587_rk, 0.2721655269759087_rk, -0.13608276348795434_rk, -0.13608276348795434_rk, -0.15713484026367722_rk,   &
        0.0_rk, 0.23570226039551587_rk, 0.0_rk, 0.23570226039551587_rk, -0.2721655269759086_rk, 0.1360827634879543_rk, 0.1360827634879543_rk, -0.15713484026367724_rk,   &
        0.0_rk, 0.06315623032716869_rk, 0.0_rk, 0.06315623032716867_rk, 4.958056047779154e-18_rk, 0.03646326658039285_rk, 0.03646326658039284_rk, 2.479028023889577e-18_rk,   &
        0.0_rk, 0.8796528112548946_rk, 0.0_rk, 0.8796528112548946_rk, 0.0_rk, 0.5078677873714245_rk, 0.5078677873714245_rk, 0.0_rk,   &
        0.0_rk, 0.2357022603955158_rk, 0.0_rk, 0.23570226039551584_rk, 0.2721655269759087_rk, 0.13608276348795434_rk, 0.13608276348795434_rk, 0.15713484026367722_rk   &
        /),(/8,8/))
        test_dgrad2_dx(:,:,4,2) = reshape((/ &
        0.0_rk, -2.0241179055298556e-18_rk, 0.33333333333333337_rk, -2.024117905529855e-18_rk, 2.3372500352584067e-18_rk, -0.19245008972987526_rk, -0.19245008972987526_rk, 0.11111111111111113_rk,   &
        0.0_rk, 3.505875052887612e-18_rk, 0.08931639747704093_rk, 3.505875052887613e-18_rk, -2.752273990813211e-34_rk, 0.05156684612641717_rk, -0.05156684612641717_rk, -0.029772132492346975_rk,   &
        0.0_rk, 4.8830540236571544e-17_rk, 1.2440169358562925_rk, 4.883054023657155e-17_rk, 3.833423148944782e-33_rk, -0.7182335127930838_rk, 0.7182335127930838_rk, -0.4146723119520974_rk,   &
        0.0_rk, 2.819232555025944e-17_rk, 0.33333333333333337_rk, 2.819232555025944e-17_rk, 3.25536934910477e-17_rk, 0.19245008972987532_rk, 0.19245008972987532_rk, 0.11111111111111113_rk,   &
        0.0_rk, -2.0241179055298556e-18_rk, 0.33333333333333337_rk, -2.0241179055298556e-18_rk, 2.3372500352584067e-18_rk, -0.19245008972987526_rk, -0.19245008972987526_rk, 0.11111111111111113_rk,   &
        0.0_rk, 3.505875052887613e-18_rk, 0.08931639747704093_rk, 3.505875052887612e-18_rk, 2.752273990813211e-34_rk, 0.05156684612641717_rk, -0.05156684612641717_rk, -0.029772132492346975_rk,   &
        0.0_rk, 4.883054023657155e-17_rk, 1.2440169358562925_rk, 4.883054023657155e-17_rk, 0.0_rk, -0.7182335127930838_rk, 0.7182335127930838_rk, -0.4146723119520974_rk,   &
        0.0_rk, 2.819232555025944e-17_rk, 0.33333333333333326_rk, 2.8192325550259443e-17_rk, 3.25536934910477e-17_rk, 0.19245008972987526_rk, 0.19245008972987526_rk, 0.11111111111111113_rk   &
        /),(/8,8/))
        test_dgrad2_dx(:,:,4,3) = reshape((/ &
        0.0_rk, -0.23570226039551587_rk, 0.0_rk, 0.2357022603955159_rk, -1.8503717077085944e-17_rk, -0.13608276348795434_rk, 0.1360827634879543_rk, 1.8503717077085944e-17_rk,   &
        0.0_rk, -0.06315623032716867_rk, 0.0_rk, 0.06315623032716869_rk, -0.07292653316078568_rk, -0.03646326658039284_rk, 0.03646326658039285_rk, 0.04210415355144577_rk,   &
        0.0_rk, -0.8796528112548948_rk, 0.0_rk, 0.8796528112548946_rk, 1.0157355747428491_rk, -0.5078677873714245_rk, 0.5078677873714246_rk, -0.5864352075032632_rk,   &
        0.0_rk, -0.23570226039551595_rk, 0.0_rk, 0.23570226039551595_rk, 0.0_rk, -0.13608276348795437_rk, 0.13608276348795437_rk, 0.0_rk,   &
        0.0_rk, -0.23570226039551587_rk, 0.0_rk, 0.23570226039551587_rk, 0.0_rk, 0.1360827634879543_rk, -0.1360827634879543_rk, 0.0_rk,   &
        0.0_rk, -0.06315623032716869_rk, 0.0_rk, 0.06315623032716872_rk, -0.07292653316078568_rk, 0.03646326658039284_rk, -0.03646326658039284_rk, -0.04210415355144581_rk,   &
        0.0_rk, -0.8796528112548949_rk, 0.0_rk, 0.8796528112548946_rk, 1.0157355747428491_rk, 0.5078677873714245_rk, -0.5078677873714246_rk, 0.5864352075032632_rk,   &
        0.0_rk, -0.2357022603955159_rk, 0.0_rk, 0.23570226039551584_rk, -1.8503717077085944e-17_rk, 0.13608276348795434_rk, -0.13608276348795437_rk, -9.251858538542972e-18_rk   &
        /),(/8,8/))
        test_dgrad2_dx(:,:,5,1) = reshape((/ &
        0.0_rk, -0.8796528112548948_rk, 0.0_rk, -0.8796528112548946_rk, 1.0157355747428491_rk, 0.5078677873714245_rk, 0.5078677873714246_rk, -0.5864352075032632_rk,   &
        0.0_rk, -0.23570226039551584_rk, 0.0_rk, -0.23570226039551587_rk, 1.8503717077085944e-17_rk, 0.13608276348795434_rk, 0.13608276348795434_rk, -9.251858538542972e-18_rk,   &
        0.0_rk, -0.23570226039551573_rk, 0.0_rk, -0.23570226039551584_rk, -1.8503717077085944e-17_rk, 0.13608276348795434_rk, 0.1360827634879543_rk, 9.251858538542972e-18_rk,   &
        0.0_rk, -0.06315623032716863_rk, 0.0_rk, -0.06315623032716863_rk, -0.07292653316078568_rk, 0.03646326658039284_rk, 0.03646326658039284_rk, 0.04210415355144573_rk,   &
        0.0_rk, -0.8796528112548948_rk, 0.0_rk, -0.8796528112548948_rk, 1.0157355747428491_rk, -0.5078677873714246_rk, -0.5078677873714246_rk, 0.5864352075032632_rk,   &
        0.0_rk, -0.23570226039551587_rk, 0.0_rk, -0.23570226039551584_rk, -1.8503717077085944e-17_rk, -0.13608276348795434_rk, -0.13608276348795434_rk, -9.251858538542972e-18_rk,   &
        0.0_rk, -0.23570226039551584_rk, 0.0_rk, -0.23570226039551584_rk, 0.0_rk, -0.13608276348795434_rk, -0.13608276348795434_rk, 0.0_rk,   &
        0.0_rk, -0.06315623032716858_rk, 0.0_rk, -0.06315623032716859_rk, -0.07292653316078557_rk, -0.0364632665803928_rk, -0.036463266580392784_rk, -0.04210415355144573_rk   &
        /),(/8,8/))
        test_dgrad2_dx(:,:,5,2) = reshape((/ &
        0.0_rk, 7.554110863947321e-18_rk, -1.2440169358562925_rk, 7.554110863947318e-18_rk, -8.722735881576523e-18_rk, 0.7182335127930838_rk, 0.7182335127930838_rk, -0.4146723119520974_rk,   &
        0.0_rk, -1.3084103822364792e-17_rk, -0.33333333333333337_rk, -1.3084103822364794e-17_rk, 1.0271626370065259e-33_rk, -0.19245008972987526_rk, 0.19245008972987526_rk, 0.1111111111111111_rk,   &
        0.0_rk, -1.3084103822364786e-17_rk, -0.33333333333333337_rk, -1.3084103822364792e-17_rk, -1.0271626370065259e-33_rk, 0.19245008972987526_rk, -0.19245008972987526_rk, 0.11111111111111113_rk,   &
        0.0_rk, -7.554110863947324e-18_rk, -0.08931639747704082_rk, -7.554110863947324e-18_rk, -8.722735881576526e-18_rk, -0.05156684612641725_rk, -0.05156684612641725_rk, -0.029772132492346948_rk,   &
        0.0_rk, 7.554110863947321e-18_rk, -1.2440169358562925_rk, 7.554110863947321e-18_rk, -8.722735881576523e-18_rk, 0.7182335127930838_rk, 0.7182335127930838_rk, -0.4146723119520974_rk,   &
        0.0_rk, -1.3084103822364794e-17_rk, -0.33333333333333337_rk, -1.3084103822364792e-17_rk, -1.0271626370065259e-33_rk, -0.19245008972987526_rk, 0.19245008972987526_rk, 0.1111111111111111_rk,   &
        0.0_rk, -1.3084103822364792e-17_rk, -0.33333333333333337_rk, -1.3084103822364792e-17_rk, 0.0_rk, 0.19245008972987526_rk, -0.19245008972987526_rk, 0.11111111111111113_rk,   &
        0.0_rk, -7.554110863947312e-18_rk, -0.08931639747704093_rk, -7.554110863947312e-18_rk, -8.722735881576523e-18_rk, -0.051566846126417196_rk, -0.051566846126417196_rk, -0.02977213249234694_rk   &
        /),(/8,8/))
        test_dgrad2_dx(:,:,5,3) = reshape((/ &
        0.0_rk, 0.8796528112548948_rk, 0.0_rk, -0.8796528112548949_rk, 6.905681226056462e-17_rk, 0.5078677873714246_rk, -0.5078677873714246_rk, -6.905681226056462e-17_rk,   &
        0.0_rk, 0.23570226039551584_rk, 0.0_rk, -0.23570226039551587_rk, 0.2721655269759087_rk, 0.13608276348795434_rk, -0.13608276348795434_rk, -0.15713484026367724_rk,   &
        0.0_rk, 0.23570226039551587_rk, 0.0_rk, -0.23570226039551584_rk, -0.2721655269759086_rk, 0.13608276348795434_rk, -0.1360827634879543_rk, 0.15713484026367724_rk,   &
        0.0_rk, 0.06315623032716866_rk, 0.0_rk, -0.06315623032716866_rk, 0.0_rk, 0.03646326658039284_rk, -0.03646326658039284_rk, 0.0_rk,   &
        0.0_rk, 0.8796528112548948_rk, 0.0_rk, -0.8796528112548948_rk, 0.0_rk, -0.5078677873714246_rk, 0.5078677873714246_rk, 0.0_rk,   &
        0.0_rk, 0.23570226039551587_rk, 0.0_rk, -0.2357022603955159_rk, 0.2721655269759087_rk, -0.13608276348795437_rk, 0.13608276348795434_rk, 0.15713484026367724_rk,   &
        0.0_rk, 0.2357022603955159_rk, 0.0_rk, -0.23570226039551584_rk, -0.2721655269759086_rk, -0.13608276348795434_rk, 0.13608276348795434_rk, -0.15713484026367724_rk,   &
        0.0_rk, 0.0631562303271686_rk, 0.0_rk, -0.06315623032716859_rk, 4.958056047779148e-18_rk, -0.0364632665803928_rk, 0.036463266580392784_rk, 2.479028023889574e-18_rk   &
        /),(/8,8/))
        test_dgrad2_dx(:,:,6,1) = reshape((/ &
        0.0_rk, -0.23570226039551587_rk, 0.0_rk, -0.23570226039551584_rk, 0.2721655269759087_rk, 0.13608276348795434_rk, 0.13608276348795434_rk, -0.15713484026367724_rk,   &
        0.0_rk, -0.8796528112548946_rk, 0.0_rk, -0.8796528112548948_rk, 6.905681226056462e-17_rk, 0.5078677873714246_rk, 0.5078677873714245_rk, -3.452840613028231e-17_rk,   &
        0.0_rk, -0.06315623032716866_rk, 0.0_rk, -0.06315623032716867_rk, -4.958056047779154e-18_rk, 0.03646326658039285_rk, 0.03646326658039284_rk, 2.479028023889577e-18_rk,   &
        0.0_rk, -0.23570226039551576_rk, 0.0_rk, -0.23570226039551576_rk, -0.27216552697590857_rk, 0.13608276348795428_rk, 0.13608276348795428_rk, 0.15713484026367716_rk,   &
        0.0_rk, -0.23570226039551587_rk, 0.0_rk, -0.23570226039551587_rk, 0.2721655269759087_rk, -0.13608276348795434_rk, -0.13608276348795434_rk, 0.15713484026367724_rk,   &
        0.0_rk, -0.8796528112548948_rk, 0.0_rk, -0.8796528112548946_rk, -6.905681226056462e-17_rk, -0.5078677873714245_rk, -0.5078677873714246_rk, -3.452840613028231e-17_rk,   &
        0.0_rk, -0.06315623032716867_rk, 0.0_rk, -0.06315623032716867_rk, 0.0_rk, -0.03646326658039285_rk, -0.03646326658039285_rk, 0.0_rk,   &
        0.0_rk, -0.2357022603955157_rk, 0.0_rk, -0.23570226039551573_rk, -0.2721655269759085_rk, -0.13608276348795428_rk, -0.13608276348795426_rk, -0.15713484026367716_rk   &
        /),(/8,8/))
        test_dgrad2_dx(:,:,6,2) = reshape((/ &
        0.0_rk, 2.0241179055298556e-18_rk, -0.33333333333333337_rk, 2.0241179055298548e-18_rk, -2.3372500352584067e-18_rk, 0.19245008972987526_rk, 0.19245008972987526_rk, -0.1111111111111111_rk,   &
        0.0_rk, -4.883054023657155e-17_rk, -1.2440169358562925_rk, -4.883054023657156e-17_rk, 3.833423148944782e-33_rk, -0.7182335127930838_rk, 0.7182335127930838_rk, 0.4146723119520974_rk,   &
        0.0_rk, -3.5058750528876115e-18_rk, -0.08931639747704093_rk, -3.505875052887612e-18_rk, -2.752273990813211e-34_rk, 0.05156684612641717_rk, -0.05156684612641717_rk, 0.029772132492346975_rk,   &
        0.0_rk, -2.819232555025942e-17_rk, -0.33333333333333337_rk, -2.819232555025942e-17_rk, -3.2553693491047694e-17_rk, -0.1924500897298752_rk, -0.1924500897298752_rk, -0.11111111111111105_rk,   &
        0.0_rk, 2.0241179055298556e-18_rk, -0.33333333333333337_rk, 2.0241179055298556e-18_rk, -2.3372500352584067e-18_rk, 0.19245008972987526_rk, 0.19245008972987526_rk, -0.1111111111111111_rk,   &
        0.0_rk, -4.883054023657156e-17_rk, -1.2440169358562925_rk, -4.883054023657155e-17_rk, -3.833423148944782e-33_rk, -0.7182335127930838_rk, 0.7182335127930838_rk, 0.4146723119520974_rk,   &
        0.0_rk, -3.505875052887612e-18_rk, -0.08931639747704093_rk, -3.505875052887612e-18_rk, 0.0_rk, 0.05156684612641717_rk, -0.05156684612641717_rk, 0.029772132492346975_rk,   &
        0.0_rk, -2.8192325550259425e-17_rk, -0.33333333333333326_rk, -2.819232555025944e-17_rk, -3.255369349104769e-17_rk, -0.19245008972987515_rk, -0.19245008972987515_rk, -0.11111111111111105_rk   &
        /),(/8,8/))
        test_dgrad2_dx(:,:,6,3) = reshape((/ &
        0.0_rk, 0.23570226039551587_rk, 0.0_rk, -0.2357022603955159_rk, 1.8503717077085944e-17_rk, 0.13608276348795437_rk, -0.13608276348795434_rk, -1.8503717077085944e-17_rk,   &
        0.0_rk, 0.8796528112548946_rk, 0.0_rk, -0.8796528112548948_rk, 1.0157355747428491_rk, 0.5078677873714246_rk, -0.5078677873714245_rk, -0.5864352075032632_rk,   &
        0.0_rk, 0.06315623032716869_rk, 0.0_rk, -0.06315623032716867_rk, -0.07292653316078568_rk, 0.03646326658039285_rk, -0.03646326658039284_rk, 0.04210415355144577_rk,   &
        0.0_rk, 0.23570226039551584_rk, 0.0_rk, -0.23570226039551584_rk, 0.0_rk, 0.13608276348795434_rk, -0.13608276348795434_rk, 0.0_rk,   &
        0.0_rk, 0.23570226039551587_rk, 0.0_rk, -0.23570226039551587_rk, 0.0_rk, -0.13608276348795434_rk, 0.13608276348795434_rk, 0.0_rk,   &
        0.0_rk, 0.8796528112548948_rk, 0.0_rk, -0.8796528112548949_rk, 1.0157355747428491_rk, -0.5078677873714246_rk, 0.5078677873714246_rk, 0.5864352075032632_rk,   &
        0.0_rk, 0.06315623032716872_rk, 0.0_rk, -0.06315623032716867_rk, -0.07292653316078568_rk, -0.03646326658039285_rk, 0.03646326658039284_rk, -0.04210415355144577_rk,   &
        0.0_rk, 0.23570226039551578_rk, 0.0_rk, -0.23570226039551573_rk, 1.8503717077085938e-17_rk, -0.13608276348795428_rk, 0.13608276348795428_rk, 9.251858538542969e-18_rk   &
        /),(/8,8/))
        test_dgrad2_dx(:,:,7,1) = reshape((/ &
        0.0_rk, -0.06315623032716869_rk, 0.0_rk, -0.06315623032716867_rk, 0.07292653316078568_rk, 0.03646326658039285_rk, 0.03646326658039284_rk, -0.04210415355144577_rk,   &
        0.0_rk, -0.23570226039551584_rk, 0.0_rk, -0.23570226039551587_rk, 1.8503717077085944e-17_rk, 0.1360827634879543_rk, 0.13608276348795434_rk, -9.251858538542972e-18_rk,   &
        0.0_rk, -0.23570226039551578_rk, 0.0_rk, -0.23570226039551584_rk, -1.8503717077085944e-17_rk, 0.13608276348795434_rk, 0.1360827634879543_rk, 9.251858538542972e-18_rk,   &
        0.0_rk, -0.8796528112548946_rk, 0.0_rk, -0.8796528112548946_rk, -1.0157355747428487_rk, 0.5078677873714244_rk, 0.5078677873714244_rk, 0.5864352075032631_rk,   &
        0.0_rk, -0.06315623032716869_rk, 0.0_rk, -0.06315623032716869_rk, 0.07292653316078568_rk, -0.03646326658039284_rk, -0.03646326658039284_rk, 0.04210415355144577_rk,   &
        0.0_rk, -0.23570226039551587_rk, 0.0_rk, -0.23570226039551584_rk, -1.8503717077085944e-17_rk, -0.13608276348795434_rk, -0.1360827634879543_rk, -9.251858538542972e-18_rk,   &
        0.0_rk, -0.23570226039551584_rk, 0.0_rk, -0.23570226039551584_rk, 0.0_rk, -0.13608276348795434_rk, -0.13608276348795434_rk, 0.0_rk,   &
        0.0_rk, -0.8796528112548947_rk, 0.0_rk, -0.8796528112548948_rk, -1.015735574742849_rk, -0.5078677873714245_rk, -0.5078677873714245_rk, -0.5864352075032631_rk   &
        /),(/8,8/))
        test_dgrad2_dx(:,:,7,2) = reshape((/ &
        0.0_rk, 5.423607581721005e-19_rk, -0.08931639747704093_rk, 5.423607581721004e-19_rk, -6.262642594571037e-19_rk, 0.05156684612641717_rk, 0.05156684612641717_rk, -0.029772132492346975_rk,   &
        0.0_rk, -1.3084103822364792e-17_rk, -0.33333333333333337_rk, -1.3084103822364794e-17_rk, 1.0271626370065259e-33_rk, -0.19245008972987526_rk, 0.19245008972987526_rk, 0.11111111111111113_rk,   &
        0.0_rk, -1.3084103822364789e-17_rk, -0.33333333333333337_rk, -1.3084103822364792e-17_rk, -1.0271626370065259e-33_rk, 0.19245008972987526_rk, -0.19245008972987526_rk, 0.1111111111111111_rk,   &
        0.0_rk, -1.0521519133709041e-16_rk, -1.2440169358562922_rk, -1.0521519133709041e-16_rk, -1.2149203808261426e-16_rk, -0.7182335127930837_rk, -0.7182335127930837_rk, -0.4146723119520974_rk,   &
        0.0_rk, 5.423607581721005e-19_rk, -0.08931639747704093_rk, 5.423607581721005e-19_rk, -6.262642594571037e-19_rk, 0.05156684612641717_rk, 0.05156684612641717_rk, -0.029772132492346975_rk,   &
        0.0_rk, -1.3084103822364794e-17_rk, -0.33333333333333337_rk, -1.3084103822364792e-17_rk, -1.0271626370065259e-33_rk, -0.19245008972987526_rk, 0.19245008972987526_rk, 0.11111111111111113_rk,   &
        0.0_rk, -1.3084103822364792e-17_rk, -0.33333333333333337_rk, -1.3084103822364792e-17_rk, 0.0_rk, 0.19245008972987526_rk, -0.19245008972987526_rk, 0.1111111111111111_rk,   &
        0.0_rk, -1.0521519133709043e-16_rk, -1.2440169358562925_rk, -1.0521519133709043e-16_rk, -1.2149203808261426e-16_rk, -0.718233512793084_rk, -0.718233512793084_rk, -0.41467231195209764_rk   &
        /),(/8,8/))
        test_dgrad2_dx(:,:,7,3) = reshape((/ &
        0.0_rk, 0.06315623032716869_rk, 0.0_rk, -0.06315623032716872_rk, 4.958056047779154e-18_rk, 0.03646326658039284_rk, -0.03646326658039284_rk, -4.958056047779154e-18_rk,   &
        0.0_rk, 0.23570226039551584_rk, 0.0_rk, -0.23570226039551587_rk, 0.2721655269759086_rk, 0.1360827634879543_rk, -0.13608276348795434_rk, -0.15713484026367724_rk,   &
        0.0_rk, 0.23570226039551587_rk, 0.0_rk, -0.23570226039551584_rk, -0.2721655269759087_rk, 0.13608276348795434_rk, -0.13608276348795434_rk, 0.15713484026367724_rk,   &
        0.0_rk, 0.8796528112548947_rk, 0.0_rk, -0.8796528112548947_rk, 0.0_rk, 0.5078677873714246_rk, -0.5078677873714246_rk, 0.0_rk,   &
        0.0_rk, 0.06315623032716869_rk, 0.0_rk, -0.06315623032716869_rk, 0.0_rk, -0.03646326658039284_rk, 0.03646326658039284_rk, 0.0_rk,   &
        0.0_rk, 0.23570226039551587_rk, 0.0_rk, -0.2357022603955159_rk, 0.2721655269759086_rk, -0.13608276348795434_rk, 0.1360827634879543_rk, 0.15713484026367727_rk,   &
        0.0_rk, 0.2357022603955159_rk, 0.0_rk, -0.23570226039551584_rk, -0.2721655269759087_rk, -0.13608276348795434_rk, 0.13608276348795437_rk, -0.15713484026367724_rk,   &
        0.0_rk, 0.879652811254895_rk, 0.0_rk, -0.8796528112548948_rk, 6.905681226056463e-17_rk, -0.5078677873714245_rk, 0.5078677873714246_rk, 3.4528406130282316e-17_rk   &
        /),(/8,8/))
        test_dgrad2_dx(:,:,8,1) = reshape((/ &
        0.0_rk, -0.23570226039551587_rk, 0.0_rk, -0.23570226039551584_rk, 0.2721655269759086_rk, 0.13608276348795434_rk, 0.1360827634879543_rk, -0.15713484026367724_rk,   &
        0.0_rk, -0.06315623032716867_rk, 0.0_rk, -0.06315623032716869_rk, 4.958056047779154e-18_rk, 0.03646326658039284_rk, 0.03646326658039285_rk, -2.479028023889577e-18_rk,   &
        0.0_rk, -0.8796528112548945_rk, 0.0_rk, -0.8796528112548946_rk, -6.905681226056462e-17_rk, 0.5078677873714245_rk, 0.5078677873714244_rk, 3.452840613028231e-17_rk,   &
        0.0_rk, -0.23570226039551576_rk, 0.0_rk, -0.23570226039551576_rk, -0.27216552697590857_rk, 0.13608276348795428_rk, 0.13608276348795428_rk, 0.15713484026367716_rk,   &
        0.0_rk, -0.23570226039551587_rk, 0.0_rk, -0.23570226039551587_rk, 0.2721655269759086_rk, -0.1360827634879543_rk, -0.1360827634879543_rk, 0.15713484026367724_rk,   &
        0.0_rk, -0.06315623032716869_rk, 0.0_rk, -0.06315623032716867_rk, -4.958056047779154e-18_rk, -0.03646326658039285_rk, -0.03646326658039284_rk, -2.479028023889577e-18_rk,   &
        0.0_rk, -0.8796528112548946_rk, 0.0_rk, -0.8796528112548946_rk, 0.0_rk, -0.5078677873714245_rk, -0.5078677873714245_rk, 0.0_rk,   &
        0.0_rk, -0.2357022603955157_rk, 0.0_rk, -0.23570226039551573_rk, -0.27216552697590857_rk, -0.13608276348795428_rk, -0.13608276348795428_rk, -0.15713484026367716_rk   &
        /),(/8,8/))
        test_dgrad2_dx(:,:,8,2) = reshape((/ &
        0.0_rk, 2.0241179055298556e-18_rk, -0.33333333333333337_rk, 2.024117905529855e-18_rk, -2.3372500352584067e-18_rk, 0.19245008972987526_rk, 0.19245008972987526_rk, -0.11111111111111113_rk,   &
        0.0_rk, -3.505875052887612e-18_rk, -0.08931639747704093_rk, -3.505875052887613e-18_rk, 2.752273990813211e-34_rk, -0.05156684612641717_rk, 0.05156684612641717_rk, 0.029772132492346975_rk,   &
        0.0_rk, -4.8830540236571544e-17_rk, -1.2440169358562925_rk, -4.883054023657155e-17_rk, -3.833423148944782e-33_rk, 0.7182335127930838_rk, -0.7182335127930838_rk, 0.4146723119520974_rk,   &
        0.0_rk, -2.8192325550259425e-17_rk, -0.33333333333333326_rk, -2.8192325550259425e-17_rk, -3.255369349104769e-17_rk, -0.1924500897298752_rk, -0.1924500897298752_rk, -0.11111111111111108_rk,   &
        0.0_rk, 2.0241179055298556e-18_rk, -0.33333333333333337_rk, 2.0241179055298556e-18_rk, -2.3372500352584067e-18_rk, 0.19245008972987526_rk, 0.19245008972987526_rk, -0.11111111111111113_rk,   &
        0.0_rk, -3.505875052887613e-18_rk, -0.08931639747704093_rk, -3.505875052887612e-18_rk, -2.752273990813211e-34_rk, -0.05156684612641717_rk, 0.05156684612641717_rk, 0.029772132492346975_rk,   &
        0.0_rk, -4.883054023657155e-17_rk, -1.2440169358562925_rk, -4.883054023657155e-17_rk, 0.0_rk, 0.7182335127930838_rk, -0.7182335127930838_rk, 0.4146723119520974_rk,   &
        0.0_rk, -2.8192325550259425e-17_rk, -0.33333333333333315_rk, -2.819232555025943e-17_rk, -3.255369349104769e-17_rk, -0.19245008972987515_rk, -0.19245008972987515_rk, -0.11111111111111108_rk   &
        /),(/8,8/))
        test_dgrad2_dx(:,:,8,3) = reshape((/ &
        0.0_rk, 0.23570226039551587_rk, 0.0_rk, -0.2357022603955159_rk, 1.8503717077085944e-17_rk, 0.13608276348795434_rk, -0.1360827634879543_rk, -1.8503717077085944e-17_rk,   &
        0.0_rk, 0.06315623032716867_rk, 0.0_rk, -0.06315623032716869_rk, 0.07292653316078568_rk, 0.03646326658039284_rk, -0.03646326658039285_rk, -0.04210415355144577_rk,   &
        0.0_rk, 0.8796528112548948_rk, 0.0_rk, -0.8796528112548946_rk, -1.0157355747428491_rk, 0.5078677873714245_rk, -0.5078677873714246_rk, 0.5864352075032632_rk,   &
        0.0_rk, 0.23570226039551584_rk, 0.0_rk, -0.23570226039551584_rk, 0.0_rk, 0.1360827634879543_rk, -0.1360827634879543_rk, 0.0_rk,   &
        0.0_rk, 0.23570226039551587_rk, 0.0_rk, -0.23570226039551587_rk, 0.0_rk, -0.1360827634879543_rk, 0.1360827634879543_rk, 0.0_rk,   &
        0.0_rk, 0.06315623032716869_rk, 0.0_rk, -0.06315623032716872_rk, 0.07292653316078568_rk, -0.03646326658039284_rk, 0.03646326658039284_rk, 0.04210415355144581_rk,   &
        0.0_rk, 0.8796528112548949_rk, 0.0_rk, -0.8796528112548946_rk, -1.0157355747428491_rk, -0.5078677873714245_rk, 0.5078677873714246_rk, -0.5864352075032632_rk,   &
        0.0_rk, 0.23570226039551578_rk, 0.0_rk, -0.23570226039551573_rk, 1.8503717077085932e-17_rk, -0.13608276348795428_rk, 0.1360827634879543_rk, 9.251858538542966e-18_rk   &
        /),(/8,8/))
        
        
        
        do inode_diff = 1,self%elem%nterms_c 
            do idir =1,3
                @assertEqual(transpose(test_dgrad2_dx(:,:,inode_diff,idir)),self%elem%dgrad2_dx(:,:,inode_diff,idir),tol)
            end do
        end do

    end subroutine testElement_dgrad2_dx
    !*******************************************************************************************







    !> Test cartesian dgrad3_dx 
    !!
    !!
    !------------------------------------------------------------------------------------------
    @Test
    subroutine testElement_dgrad3_dx(self)
        class(test_element_linearC_dx),    intent(inout)   :: self
        
        
        real(rk), dimension(self%elem%basis_s%nnodes_elem(),self%elem%nterms_s,self%elem%nterms_c,3) :: test_dgrad3_dx
        
        real(rk)        :: tol = 1.e-13_rk
        integer(ik)     :: inode_diff, idir, inode
        
       
        !
        ! dgrad3_dx
        ! 
        test_dgrad3_dx(:,:,1,1) = reshape((/ &
        0.0_rk, 0.0_rk, 0.0_rk, 1.249000902703301e-16_rk, -1.249000902703301e-16_rk, -6.245004513516506e-17_rk, 0.0_rk, 0.0_rk,   &
        0.0_rk, 0.4553418012614796_rk, 0.0_rk, 0.45534180126147966_rk, -5.055309518347867e-17_rk, -0.2628917115316044_rk, -0.2628917115316043_rk, 2.5276547591739334e-17_rk,   &
        0.0_rk, -0.4553418012614794_rk, 0.0_rk, -0.4553418012614796_rk, -5.055309518347867e-17_rk, 0.2628917115316043_rk, 0.26289171153160423_rk, 2.5276547591739334e-17_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk,   &
        0.0_rk, 0.12200846792814624_rk, 0.0_rk, 0.12200846792814618_rk, -4.958056047779154e-18_rk, 0.07044162180172905_rk, 0.07044162180172905_rk, 6.7728305146533945e-18_rk,   &
        0.0_rk, -0.12200846792814632_rk, 0.0_rk, -0.12200846792814632_rk, 0.0_rk, -0.07044162180172904_rk, -0.07044162180172904_rk, 0.0_rk,   &
        0.0_rk, 1.3877787807814457e-17_rk, 0.0_rk, -1.3877787807814457e-17_rk, 1.3877787807814457e-17_rk, 2.0816681711721685e-17_rk, -1.3877787807814457e-17_rk, 0.0_rk   &
        /),(/8,8/))
        test_dgrad3_dx(:,:,1,2) = reshape((/ &
        0.0_rk, -8.666684749742561e-34_rk, 1.3877787807814457e-16_rk, -9.62964972193618e-34_rk, 8.666684749742561e-34_rk, -5.551115123125783e-17_rk, -5.551115123125783e-17_rk, 6.245004513516506e-17_rk,   &
        0.0_rk, 2.527654759173934e-17_rk, 0.643950550859379_rk, 2.5276547591739343e-17_rk, -2.806260511938256e-33_rk, 0.3717850238834702_rk, -0.3717850238834702_rk, -0.21465018361979293_rk,   &
        0.0_rk, -2.5276547591739328e-17_rk, -0.643950550859379_rk, -2.527654759173934e-17_rk, -2.806260511938256e-33_rk, 0.37178502388347023_rk, -0.37178502388347023_rk, 0.21465018361979293_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk,   &
        0.0_rk, 6.772830514653396e-18_rk, 0.17254603006834715_rk, 6.772830514653393e-18_rk, -2.752273990813211e-34_rk, 0.0996194969075615_rk, -0.0996194969075615_rk, -0.05751534335611572_rk,   &
        0.0_rk, -6.772830514653401e-18_rk, -0.17254603006834718_rk, -6.772830514653401e-18_rk, 0.0_rk, 0.0996194969075615_rk, -0.0996194969075615_rk, 0.057515343356115786_rk,   &
        0.0_rk, -3.0814879110195774e-33_rk, -1.3877787807814457e-17_rk, -1.5407439555097887e-33_rk, -4.622231866529366e-33_rk, 0.0_rk, 0.0_rk, -2.0816681711721685e-17_rk   &
        /),(/8,8/))
        test_dgrad3_dx(:,:,1,3) = reshape((/ &
        0.0_rk, 0.0_rk, 0.0_rk, 1.3877787807814457e-16_rk, -6.905681226056462e-17_rk, -6.938893903907228e-17_rk, 0.0_rk, 0.0_rk,   &
        0.0_rk, -0.4553418012614796_rk, 0.0_rk, 0.45534180126147966_rk, -0.5257834230632086_rk, -0.2628917115316044_rk, 0.2628917115316043_rk, 0.3035612008409864_rk,   &
        0.0_rk, 0.45534180126147966_rk, 0.0_rk, -0.4553418012614796_rk, -0.5257834230632086_rk, 0.2628917115316043_rk, -0.2628917115316044_rk, 0.3035612008409864_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk,   &
        0.0_rk, -0.12200846792814624_rk, 0.0_rk, 0.12200846792814626_rk, -0.14088324360345808_rk, 0.07044162180172904_rk, -0.07044162180172905_rk, -0.08133897861876419_rk,   &
        0.0_rk, 0.12200846792814632_rk, 0.0_rk, -0.12200846792814632_rk, -0.1408832436034581_rk, -0.07044162180172904_rk, 0.07044162180172904_rk, -0.08133897861876414_rk,   &
        0.0_rk, 1.3877787807814457e-17_rk, 0.0_rk, -1.3877787807814457e-17_rk, 0.0_rk, 2.0816681711721685e-17_rk, 6.938893903907228e-18_rk, 0.0_rk   &
        /),(/8,8/))
        test_dgrad3_dx(:,:,2,1) = reshape((/ &
        0.0_rk, -0.788675134594813_rk, 0.0_rk, -0.7886751345948129_rk, 0.9106836025229591_rk, 0.45534180126147955_rk, 0.4553418012614796_rk, -0.5257834230632087_rk,   &
        0.0_rk, -1.2440169358562922_rk, 0.0_rk, -1.2440169358562925_rk, 1.3811362452112924e-16_rk, 0.7182335127930839_rk, 0.7182335127930837_rk, -6.905681226056462e-17_rk,   &
        0.0_rk, -0.33333333333333326_rk, 0.0_rk, -0.33333333333333326_rk, -3.700743415417189e-17_rk, 0.19245008972987526_rk, 0.19245008972987515_rk, 1.8503717077085944e-17_rk,   &
        0.0_rk, -0.7886751345948128_rk, 0.0_rk, -0.7886751345948128_rk, -0.9106836025229589_rk, 0.45534180126147944_rk, 0.45534180126147944_rk, 0.5257834230632085_rk,   &
        0.0_rk, -0.21132486540518722_rk, 0.0_rk, -0.21132486540518722_rk, 0.24401693585629247_rk, -0.12200846792814624_rk, -0.12200846792814624_rk, 0.1408832436034581_rk,   &
        0.0_rk, -0.33333333333333354_rk, 0.0_rk, -0.3333333333333333_rk, -1.8503717077085944e-17_rk, -0.1924500897298753_rk, -0.19245008972987523_rk, -1.8503717077085944e-17_rk,   &
        0.0_rk, -0.08931639747704093_rk, 0.0_rk, -0.08931639747704093_rk, 0.0_rk, -0.05156684612641721_rk, -0.05156684612641721_rk, 0.0_rk,   &
        0.0_rk, -0.21132486540518708_rk, 0.0_rk, -0.21132486540518713_rk, -0.24401693585629247_rk, -0.12200846792814621_rk, -0.12200846792814615_rk, -0.14088324360345805_rk   &
        /),(/8,8/))
        test_dgrad3_dx(:,:,2,2) = reshape((/ &
        0.0_rk, 6.772830514653392e-18_rk, -1.1153550716504108_rk, 6.7728305146533914e-18_rk, -7.820591041621695e-18_rk, 0.6439505508593789_rk, 0.6439505508593789_rk, -0.37178502388347023_rk,   &
        0.0_rk, -6.905681226056461e-17_rk, -1.7593056225097896_rk, -6.905681226056462e-17_rk, 7.666846297889565e-33_rk, -1.0157355747428491_rk, 1.0157355747428491_rk, 0.5864352075032631_rk,   &
        0.0_rk, -1.8503717077085938e-17_rk, -0.4714045207910316_rk, -1.8503717077085938e-17_rk, -2.0543252740130518e-33_rk, 0.2721655269759087_rk, -0.2721655269759087_rk, 0.15713484026367724_rk,   &
        0.0_rk, -9.433335985230393e-17_rk, -1.1153550716504106_rk, -9.433335985230393e-17_rk, -1.0892678140857902e-16_rk, -0.6439505508593788_rk, -0.6439505508593788_rk, -0.3717850238834701_rk,   &
        0.0_rk, 1.814774466874242e-18_rk, -0.2988584907226846_rk, 1.814774466874242e-18_rk, -2.0955210539366063e-18_rk, 0.17254603006834715_rk, 0.17254603006834715_rk, -0.0996194969075615_rk,   &
        0.0_rk, -1.8503717077085954e-17_rk, -0.47140452079103157_rk, -1.850371707708594e-17_rk, -1.0271626370065259e-33_rk, -0.27216552697590857_rk, 0.27216552697590857_rk, 0.15713484026367727_rk,   &
        0.0_rk, -4.958056047779154e-18_rk, -0.12631246065433738_rk, -4.958056047779154e-18_rk, 0.0_rk, 0.07292653316078569_rk, -0.07292653316078569_rk, 0.04210415355144577_rk,   &
        0.0_rk, -2.5276547591739322e-17_rk, -0.2988584907226845_rk, -2.527654759173934e-17_rk, -2.9186843112550186e-17_rk, -0.17254603006834712_rk, -0.17254603006834712_rk, -0.0996194969075615_rk   &
        /),(/8,8/))
        test_dgrad3_dx(:,:,2,3) = reshape((/ &
        0.0_rk, 0.788675134594813_rk, 0.0_rk, -0.7886751345948132_rk, 6.905681226056462e-17_rk, 0.4553418012614797_rk, -0.4553418012614796_rk, -4.378026466882528e-17_rk,   &
        0.0_rk, 1.2440169358562922_rk, 0.0_rk, -1.2440169358562925_rk, 1.4364670255861678_rk, 0.7182335127930839_rk, -0.7182335127930837_rk, -0.829344623904195_rk,   &
        0.0_rk, 0.3333333333333333_rk, 0.0_rk, -0.33333333333333326_rk, -0.3849001794597505_rk, 0.19245008972987526_rk, -0.19245008972987523_rk, 0.2222222222222222_rk,   &
        0.0_rk, 0.788675134594813_rk, 0.0_rk, -0.788675134594813_rk, 0.0_rk, 0.4553418012614796_rk, -0.4553418012614796_rk, 0.0_rk,   &
        0.0_rk, 0.21132486540518722_rk, 0.0_rk, -0.21132486540518722_rk, 0.0_rk, -0.12200846792814624_rk, 0.12200846792814624_rk, 0.0_rk,   &
        0.0_rk, 0.33333333333333354_rk, 0.0_rk, -0.3333333333333336_rk, 0.38490017945975064_rk, -0.19245008972987532_rk, 0.19245008972987523_rk, 0.22222222222222224_rk,   &
        0.0_rk, 0.08931639747704101_rk, 0.0_rk, -0.08931639747704093_rk, -0.10313369225283436_rk, -0.05156684612641721_rk, 0.05156684612641724_rk, -0.059544264984693965_rk,   &
        0.0_rk, 0.21132486540518708_rk, 0.0_rk, -0.21132486540518713_rk, 2.3461773124865097e-17_rk, -0.12200846792814621_rk, 0.12200846792814621_rk, 1.1730886562432548e-17_rk   &
        /),(/8,8/))
        test_dgrad3_dx(:,:,3,1) = reshape((/ &
        0.0_rk, 0.0_rk, 0.0_rk, -4.163336342344337e-17_rk, 4.163336342344337e-17_rk, 2.0816681711721685e-17_rk, 0.0_rk, 0.0_rk,   &
        0.0_rk, 0.4553418012614794_rk, 0.0_rk, 0.45534180126147944_rk, -5.055309518347867e-17_rk, -0.2628917115316043_rk, -0.2628917115316042_rk, 2.5276547591739334e-17_rk,   &
        0.0_rk, -0.4553418012614794_rk, 0.0_rk, -0.4553418012614794_rk, -5.055309518347867e-17_rk, 0.2628917115316042_rk, 0.2628917115316041_rk, 2.5276547591739334e-17_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk,   &
        0.0_rk, 0.12200846792814629_rk, 0.0_rk, 0.12200846792814618_rk, 1.8503717077085944e-17_rk, 0.07044162180172905_rk, 0.07044162180172903_rk, 6.7728305146533945e-18_rk,   &
        0.0_rk, -0.12200846792814615_rk, 0.0_rk, -0.12200846792814615_rk, 0.0_rk, -0.07044162180172901_rk, -0.07044162180172901_rk, 0.0_rk,   &
        0.0_rk, 1.3877787807814457e-17_rk, 0.0_rk, 4.163336342344337e-17_rk, 6.938893903907228e-17_rk, 2.0816681711721685e-17_rk, 1.3877787807814457e-17_rk, 0.0_rk   &
        /),(/8,8/))
        test_dgrad3_dx(:,:,3,2) = reshape((/ &
        0.0_rk, 2.8888949165808538e-34_rk, -2.7755575615628914e-17_rk, 1.925929944387236e-34_rk, -2.8888949165808538e-34_rk, 2.7755575615628914e-17_rk, 2.7755575615628914e-17_rk, -2.0816681711721685e-17_rk,   &
        0.0_rk, 2.5276547591739328e-17_rk, 0.6439505508593788_rk, 2.527654759173933e-17_rk, -2.806260511938256e-33_rk, 0.3717850238834701_rk, -0.3717850238834701_rk, -0.21465018361979293_rk,   &
        0.0_rk, -2.5276547591739328e-17_rk, -0.6439505508593788_rk, -2.5276547591739328e-17_rk, -2.806260511938256e-33_rk, 0.3717850238834701_rk, -0.3717850238834701_rk, 0.21465018361979293_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk,   &
        0.0_rk, 6.772830514653399e-18_rk, 0.1725460300683471_rk, 6.772830514653393e-18_rk, 1.0271626370065259e-33_rk, 0.09961949690756147_rk, -0.09961949690756147_rk, -0.05751534335611572_rk,   &
        0.0_rk, -6.7728305146533914e-18_rk, -0.17254603006834712_rk, -6.7728305146533914e-18_rk, 0.0_rk, 0.0996194969075615_rk, -0.0996194969075615_rk, 0.0575153433561157_rk,   &
        0.0_rk, 3.0814879110195774e-33_rk, 4.163336342344337e-17_rk, 4.622231866529366e-33_rk, 7.703719777548943e-33_rk, 2.7755575615628914e-17_rk, 2.7755575615628914e-17_rk, 6.938893903907228e-18_rk   &
        /),(/8,8/))
        test_dgrad3_dx(:,:,3,3) = reshape((/ &
        0.0_rk, 0.0_rk, 0.0_rk, -2.7755575615628914e-17_rk, 1.8503717077085944e-17_rk, 1.3877787807814457e-17_rk, 0.0_rk, 0.0_rk,   &
        0.0_rk, -0.4553418012614794_rk, 0.0_rk, 0.45534180126147944_rk, -0.5257834230632086_rk, -0.2628917115316043_rk, 0.2628917115316042_rk, 0.30356120084098626_rk,   &
        0.0_rk, 0.45534180126147944_rk, 0.0_rk, -0.4553418012614794_rk, -0.5257834230632086_rk, 0.2628917115316042_rk, -0.2628917115316043_rk, 0.30356120084098626_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk,   &
        0.0_rk, -0.12200846792814629_rk, 0.0_rk, 0.12200846792814626_rk, -0.14088324360345802_rk, 0.07044162180172901_rk, -0.07044162180172903_rk, -0.0813389786187641_rk,   &
        0.0_rk, 0.12200846792814626_rk, 0.0_rk, -0.12200846792814615_rk, -0.14088324360345805_rk, -0.07044162180172901_rk, 0.07044162180172904_rk, -0.08133897861876412_rk,   &
        0.0_rk, -4.163336342344337e-17_rk, 0.0_rk, 4.163336342344337e-17_rk, 0.0_rk, 2.0816681711721685e-17_rk, -2.0816681711721685e-17_rk, 0.0_rk   &
        /),(/8,8/))
        test_dgrad3_dx(:,:,4,1) = reshape((/ &
        0.0_rk, 0.788675134594813_rk, 0.0_rk, 0.7886751345948129_rk, -0.9106836025229591_rk, -0.45534180126147955_rk, -0.4553418012614796_rk, 0.5257834230632087_rk,   &
        0.0_rk, 0.33333333333333326_rk, 0.0_rk, 0.3333333333333333_rk, -3.700743415417189e-17_rk, -0.19245008972987523_rk, -0.19245008972987526_rk, 1.8503717077085944e-17_rk,   &
        0.0_rk, 1.2440169358562918_rk, 0.0_rk, 1.2440169358562922_rk, 1.3811362452112924e-16_rk, -0.7182335127930837_rk, -0.7182335127930835_rk, -6.905681226056462e-17_rk,   &
        0.0_rk, 0.7886751345948128_rk, 0.0_rk, 0.7886751345948128_rk, 0.9106836025229589_rk, -0.45534180126147944_rk, -0.45534180126147944_rk, -0.5257834230632085_rk,   &
        0.0_rk, 0.21132486540518722_rk, 0.0_rk, 0.21132486540518722_rk, -0.24401693585629247_rk, 0.12200846792814624_rk, 0.12200846792814624_rk, -0.1408832436034581_rk,   &
        0.0_rk, 0.08931639747704095_rk, 0.0_rk, 0.08931639747704093_rk, 4.958056047779154e-18_rk, 0.05156684612641714_rk, 0.05156684612641718_rk, 4.958056047779154e-18_rk,   &
        0.0_rk, 0.33333333333333337_rk, 0.0_rk, 0.33333333333333337_rk, 0.0_rk, 0.19245008972987526_rk, 0.19245008972987526_rk, 0.0_rk,   &
        0.0_rk, 0.21132486540518713_rk, 0.0_rk, 0.21132486540518702_rk, 0.2440169358562923_rk, 0.12200846792814624_rk, 0.12200846792814618_rk, 0.14088324360345805_rk   &
        /),(/8,8/))
        test_dgrad3_dx(:,:,4,2) = reshape((/ &
        0.0_rk, -6.772830514653392e-18_rk, 1.1153550716504108_rk, -6.7728305146533914e-18_rk, 7.820591041621695e-18_rk, -0.6439505508593789_rk, -0.6439505508593789_rk, 0.3717850238834702_rk,   &
        0.0_rk, 1.8503717077085938e-17_rk, 0.4714045207910315_rk, 1.850371707708594e-17_rk, -2.0543252740130518e-33_rk, 0.2721655269759087_rk, -0.2721655269759087_rk, -0.15713484026367724_rk,   &
        0.0_rk, 6.905681226056458e-17_rk, 1.7593056225097896_rk, 6.905681226056461e-17_rk, 7.666846297889565e-33_rk, -1.015735574742849_rk, 1.015735574742849_rk, -0.5864352075032632_rk,   &
        0.0_rk, 9.433335985230393e-17_rk, 1.1153550716504106_rk, 9.433335985230393e-17_rk, 1.0892678140857902e-16_rk, 0.6439505508593788_rk, 0.6439505508593788_rk, 0.3717850238834701_rk,   &
        0.0_rk, -1.814774466874242e-18_rk, 0.2988584907226846_rk, -1.814774466874242e-18_rk, 2.0955210539366063e-18_rk, -0.17254603006834715_rk, -0.17254603006834715_rk, 0.0996194969075615_rk,   &
        0.0_rk, 4.9580560477791554e-18_rk, 0.1263124606543375_rk, 4.958056047779154e-18_rk, 2.752273990813211e-34_rk, 0.07292653316078566_rk, -0.07292653316078566_rk, -0.0421041535514458_rk,   &
        0.0_rk, 1.8503717077085944e-17_rk, 0.47140452079103173_rk, 1.8503717077085944e-17_rk, 0.0_rk, -0.2721655269759087_rk, 0.2721655269759087_rk, -0.15713484026367724_rk,   &
        0.0_rk, 2.5276547591739328e-17_rk, 0.2988584907226845_rk, 2.527654759173934e-17_rk, 2.9186843112550173e-17_rk, 0.17254603006834712_rk, 0.17254603006834712_rk, 0.0996194969075615_rk   &
        /),(/8,8/))
        test_dgrad3_dx(:,:,4,3) = reshape((/ &
        0.0_rk, -0.788675134594813_rk, 0.0_rk, 0.7886751345948132_rk, -1.8503717077085944e-17_rk, -0.4553418012614797_rk, 0.4553418012614796_rk, 4.378026466882528e-17_rk,   &
        0.0_rk, -0.33333333333333326_rk, 0.0_rk, 0.3333333333333333_rk, -0.3849001794597505_rk, -0.19245008972987523_rk, 0.19245008972987526_rk, 0.2222222222222222_rk,   &
        0.0_rk, -1.2440169358562925_rk, 0.0_rk, 1.2440169358562922_rk, 1.4364670255861678_rk, -0.7182335127930837_rk, 0.7182335127930839_rk, -0.8293446239041948_rk,   &
        0.0_rk, -0.788675134594813_rk, 0.0_rk, 0.788675134594813_rk, 0.0_rk, -0.4553418012614796_rk, 0.4553418012614796_rk, 0.0_rk,   &
        0.0_rk, -0.21132486540518722_rk, 0.0_rk, 0.21132486540518722_rk, 0.0_rk, 0.12200846792814624_rk, -0.12200846792814624_rk, 0.0_rk,   &
        0.0_rk, -0.08931639747704095_rk, 0.0_rk, 0.08931639747704101_rk, -0.10313369225283447_rk, 0.05156684612641724_rk, -0.05156684612641718_rk, -0.05954426498469398_rk,   &
        0.0_rk, -0.3333333333333335_rk, 0.0_rk, 0.33333333333333337_rk, 0.3849001794597506_rk, 0.19245008972987526_rk, -0.19245008972987532_rk, 0.2222222222222222_rk,   &
        0.0_rk, -0.21132486540518713_rk, 0.0_rk, 0.21132486540518702_rk, -2.3461773124865097e-17_rk, 0.12200846792814624_rk, -0.12200846792814621_rk, -1.1730886562432548e-17_rk   &
        /),(/8,8/))
        test_dgrad3_dx(:,:,5,1) = reshape((/ &
        0.0_rk, 0.0_rk, 0.0_rk, 4.163336342344337e-17_rk, -4.163336342344337e-17_rk, -2.0816681711721685e-17_rk, 0.0_rk, 0.0_rk,   &
        0.0_rk, 0.12200846792814624_rk, 0.0_rk, 0.12200846792814618_rk, -1.3545661029306789e-17_rk, -0.07044162180172905_rk, -0.07044162180172903_rk, 6.7728305146533945e-18_rk,   &
        0.0_rk, -0.12200846792814612_rk, 0.0_rk, -0.12200846792814624_rk, -1.3545661029306789e-17_rk, 0.07044162180172903_rk, 0.07044162180172898_rk, 6.7728305146533945e-18_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk,   &
        0.0_rk, 0.45534180126147966_rk, 0.0_rk, 0.45534180126147966_rk, -1.8503717077085944e-17_rk, 0.2628917115316044_rk, 0.2628917115316043_rk, 2.5276547591739334e-17_rk,   &
        0.0_rk, -0.4553418012614797_rk, 0.0_rk, -0.4553418012614797_rk, 0.0_rk, -0.26289171153160434_rk, -0.26289171153160434_rk, 0.0_rk,   &
        0.0_rk, -1.3877787807814457e-17_rk, 0.0_rk, -4.163336342344337e-17_rk, -6.938893903907228e-17_rk, -2.0816681711721685e-17_rk, -1.3877787807814457e-17_rk, 0.0_rk   &
        /),(/8,8/))
        test_dgrad3_dx(:,:,5,2) = reshape((/ &
        0.0_rk, -2.8888949165808538e-34_rk, 2.7755575615628914e-17_rk, -1.925929944387236e-34_rk, 2.8888949165808538e-34_rk, -2.7755575615628914e-17_rk, -2.7755575615628914e-17_rk, 2.0816681711721685e-17_rk,   &
        0.0_rk, 6.772830514653396e-18_rk, 0.17254603006834718_rk, 6.772830514653393e-18_rk, -7.519352379252047e-34_rk, 0.09961949690756147_rk, -0.09961949690756147_rk, -0.057515343356115745_rk,   &
        0.0_rk, -6.77283051465339e-18_rk, -0.17254603006834723_rk, -6.772830514653396e-18_rk, -7.519352379252047e-34_rk, 0.09961949690756147_rk, -0.09961949690756147_rk, 0.057515343356115745_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk,   &
        0.0_rk, 2.5276547591739343e-17_rk, 0.6439505508593789_rk, 2.5276547591739343e-17_rk, -1.0271626370065259e-33_rk, 0.37178502388347023_rk, -0.37178502388347023_rk, -0.21465018361979302_rk,   &
        0.0_rk, -2.5276547591739347e-17_rk, -0.643950550859379_rk, -2.5276547591739347e-17_rk, 0.0_rk, 0.3717850238834703_rk, -0.3717850238834703_rk, 0.21465018361979304_rk,   &
        0.0_rk, -3.0814879110195774e-33_rk, -4.163336342344337e-17_rk, -4.622231866529366e-33_rk, -7.703719777548943e-33_rk, -2.7755575615628914e-17_rk, -2.7755575615628914e-17_rk, -6.938893903907228e-18_rk   &
        /),(/8,8/))
        test_dgrad3_dx(:,:,5,3) = reshape((/ &
        0.0_rk, 0.0_rk, 0.0_rk, 2.7755575615628914e-17_rk, -1.8503717077085944e-17_rk, -1.3877787807814457e-17_rk, 0.0_rk, 0.0_rk,   &
        0.0_rk, -0.12200846792814624_rk, 0.0_rk, 0.12200846792814618_rk, -0.14088324360345808_rk, -0.07044162180172905_rk, 0.07044162180172903_rk, 0.08133897861876416_rk,   &
        0.0_rk, 0.12200846792814618_rk, 0.0_rk, -0.12200846792814624_rk, -0.14088324360345814_rk, 0.07044162180172903_rk, -0.07044162180172908_rk, 0.08133897861876413_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk,   &
        0.0_rk, -0.45534180126147966_rk, 0.0_rk, 0.45534180126147983_rk, -0.5257834230632087_rk, 0.26289171153160434_rk, -0.2628917115316043_rk, -0.3035612008409865_rk,   &
        0.0_rk, 0.45534180126147983_rk, 0.0_rk, -0.4553418012614797_rk, -0.5257834230632088_rk, -0.26289171153160434_rk, 0.2628917115316044_rk, -0.3035612008409865_rk,   &
        0.0_rk, 4.163336342344337e-17_rk, 0.0_rk, -4.163336342344337e-17_rk, 0.0_rk, -2.0816681711721685e-17_rk, 2.0816681711721685e-17_rk, 0.0_rk   &
        /),(/8,8/))
        test_dgrad3_dx(:,:,6,1) = reshape((/ &
        0.0_rk, -0.21132486540518722_rk, 0.0_rk, -0.21132486540518713_rk, 0.24401693585629236_rk, 0.12200846792814618_rk, 0.12200846792814624_rk, -0.1408832436034581_rk,   &
        0.0_rk, -0.33333333333333337_rk, 0.0_rk, -0.3333333333333333_rk, 3.700743415417189e-17_rk, 0.1924500897298753_rk, 0.19245008972987526_rk, -1.8503717077085944e-17_rk,   &
        0.0_rk, -0.08931639747704098_rk, 0.0_rk, -0.08931639747704087_rk, -9.916112095558308e-18_rk, 0.05156684612641721_rk, 0.05156684612641718_rk, 4.958056047779154e-18_rk,   &
        0.0_rk, -0.21132486540518705_rk, 0.0_rk, -0.21132486540518705_rk, -0.2440169358562924_rk, 0.1220084679281462_rk, 0.1220084679281462_rk, 0.14088324360345805_rk,   &
        0.0_rk, -0.788675134594813_rk, 0.0_rk, -0.788675134594813_rk, 0.9106836025229592_rk, -0.4553418012614796_rk, -0.4553418012614796_rk, 0.5257834230632087_rk,   &
        0.0_rk, -1.2440169358562927_rk, 0.0_rk, -1.2440169358562925_rk, -6.905681226056462e-17_rk, -0.7182335127930839_rk, -0.718233512793084_rk, -6.905681226056462e-17_rk,   &
        0.0_rk, -0.33333333333333337_rk, 0.0_rk, -0.33333333333333337_rk, 0.0_rk, -0.19245008972987526_rk, -0.19245008972987526_rk, 0.0_rk,   &
        0.0_rk, -0.7886751345948128_rk, 0.0_rk, -0.7886751345948129_rk, -0.9106836025229589_rk, -0.4553418012614795_rk, -0.45534180126147933_rk, -0.5257834230632085_rk   &
        /),(/8,8/))
        test_dgrad3_dx(:,:,6,2) = reshape((/ &
        0.0_rk, 1.8147744668742414e-18_rk, -0.29885849072268456_rk, 1.814774466874242e-18_rk, -2.0955210539366063e-18_rk, 0.17254603006834715_rk, 0.17254603006834715_rk, -0.09961949690756156_rk,   &
        0.0_rk, -1.8503717077085944e-17_rk, -0.47140452079103173_rk, -1.850371707708594e-17_rk, 2.0543252740130518e-33_rk, -0.2721655269759086_rk, 0.2721655269759086_rk, 0.15713484026367724_rk,   &
        0.0_rk, -4.958056047779157e-18_rk, -0.1263124606543373_rk, -4.958056047779151e-18_rk, -5.504547981626422e-34_rk, 0.07292653316078573_rk, -0.07292653316078573_rk, 0.04210415355144577_rk,   &
        0.0_rk, -2.527654759173933e-17_rk, -0.2988584907226846_rk, -2.527654759173933e-17_rk, -2.9186843112550173e-17_rk, -0.17254603006834718_rk, -0.17254603006834718_rk, -0.09961949690756151_rk,   &
        0.0_rk, 6.7728305146533914e-18_rk, -1.1153550716504106_rk, 6.7728305146533914e-18_rk, -7.820591041621695e-18_rk, 0.6439505508593789_rk, 0.6439505508593789_rk, -0.3717850238834702_rk,   &
        0.0_rk, -6.905681226056463e-17_rk, -1.7593056225097896_rk, -6.905681226056462e-17_rk, -3.833423148944782e-33_rk, -1.0157355747428491_rk, 1.0157355747428491_rk, 0.5864352075032632_rk,   &
        0.0_rk, -1.8503717077085944e-17_rk, -0.47140452079103173_rk, -1.8503717077085944e-17_rk, 0.0_rk, 0.2721655269759087_rk, -0.2721655269759087_rk, 0.15713484026367724_rk,   &
        0.0_rk, -9.433335985230392e-17_rk, -1.1153550716504104_rk, -9.433335985230395e-17_rk, -1.0892678140857902e-16_rk, -0.6439505508593789_rk, -0.6439505508593789_rk, -0.3717850238834702_rk   &
        /),(/8,8/))
        test_dgrad3_dx(:,:,6,3) = reshape((/ &
        0.0_rk, 0.21132486540518722_rk, 0.0_rk, -0.21132486540518725_rk, 1.8503717077085944e-17_rk, 0.12200846792814625_rk, -0.12200846792814624_rk, -1.1730886562432548e-17_rk,   &
        0.0_rk, 0.33333333333333337_rk, 0.0_rk, -0.3333333333333333_rk, 0.3849001794597505_rk, 0.1924500897298753_rk, -0.19245008972987526_rk, -0.2222222222222222_rk,   &
        0.0_rk, 0.08931639747704093_rk, 0.0_rk, -0.08931639747704087_rk, -0.10313369225283434_rk, 0.05156684612641721_rk, -0.05156684612641714_rk, 0.05954426498469395_rk,   &
        0.0_rk, 0.21132486540518722_rk, 0.0_rk, -0.21132486540518722_rk, 0.0_rk, 0.12200846792814624_rk, -0.12200846792814624_rk, 0.0_rk,   &
        0.0_rk, 0.788675134594813_rk, 0.0_rk, -0.788675134594813_rk, 0.0_rk, -0.4553418012614796_rk, 0.4553418012614796_rk, 0.0_rk,   &
        0.0_rk, 1.2440169358562927_rk, 0.0_rk, -1.244016935856293_rk, 1.436467025586168_rk, -0.718233512793084_rk, 0.718233512793084_rk, 0.8293446239041952_rk,   &
        0.0_rk, 0.3333333333333335_rk, 0.0_rk, -0.33333333333333337_rk, -0.3849001794597506_rk, -0.19245008972987526_rk, 0.19245008972987532_rk, -0.22222222222222227_rk,   &
        0.0_rk, 0.7886751345948129_rk, 0.0_rk, -0.7886751345948129_rk, 8.756052933765056e-17_rk, -0.4553418012614795_rk, 0.4553418012614795_rk, 4.378026466882528e-17_rk   &
        /),(/8,8/))
        test_dgrad3_dx(:,:,7,1) = reshape((/ &
        0.0_rk, 0.0_rk, 0.0_rk, -1.3877787807814457e-17_rk, 1.3877787807814457e-17_rk, 6.938893903907228e-18_rk, 0.0_rk, 0.0_rk,   &
        0.0_rk, 0.12200846792814624_rk, 0.0_rk, 0.12200846792814618_rk, -1.3545661029306789e-17_rk, -0.07044162180172905_rk, -0.07044162180172903_rk, 6.7728305146533945e-18_rk,   &
        0.0_rk, -0.12200846792814612_rk, 0.0_rk, -0.12200846792814624_rk, -1.3545661029306789e-17_rk, 0.07044162180172903_rk, 0.07044162180172898_rk, 6.7728305146533945e-18_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk,   &
        0.0_rk, 0.4553418012614796_rk, 0.0_rk, 0.45534180126147944_rk, 6.905681226056462e-17_rk, 0.2628917115316043_rk, 0.2628917115316043_rk, 2.5276547591739334e-17_rk,   &
        0.0_rk, -0.4553418012614794_rk, 0.0_rk, -0.4553418012614794_rk, 0.0_rk, -0.2628917115316042_rk, -0.2628917115316042_rk, 0.0_rk,   &
        0.0_rk, 9.71445146547012e-17_rk, 0.0_rk, 1.249000902703301e-16_rk, 3.191891195797325e-16_rk, 9.020562075079397e-17_rk, 6.938893903907228e-17_rk, 0.0_rk   &
        /),(/8,8/))
        test_dgrad3_dx(:,:,7,2) = reshape((/ &
        0.0_rk, 9.62964972193618e-35_rk, -2.7755575615628914e-17_rk, 1.925929944387236e-34_rk, -9.62964972193618e-35_rk, 0.0_rk, 0.0_rk, -6.938893903907228e-18_rk,   &
        0.0_rk, 6.772830514653396e-18_rk, 0.17254603006834718_rk, 6.772830514653393e-18_rk, -7.519352379252047e-34_rk, 0.0996194969075615_rk, -0.0996194969075615_rk, -0.057515343356115745_rk,   &
        0.0_rk, -6.77283051465339e-18_rk, -0.17254603006834718_rk, -6.772830514653396e-18_rk, -7.519352379252047e-34_rk, 0.09961949690756147_rk, -0.09961949690756147_rk, 0.057515343356115745_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk,   &
        0.0_rk, 2.527654759173934e-17_rk, 0.6439505508593788_rk, 2.527654759173933e-17_rk, 3.833423148944782e-33_rk, 0.3717850238834701_rk, -0.3717850238834701_rk, -0.2146501836197929_rk,   &
        0.0_rk, -2.5276547591739328e-17_rk, -0.6439505508593786_rk, -2.5276547591739328e-17_rk, 0.0_rk, 0.37178502388347007_rk, -0.37178502388347007_rk, 0.21465018361979288_rk,   &
        0.0_rk, 1.5407439555097887e-32_rk, 1.249000902703301e-16_rk, 1.3866695599588098e-32_rk, 2.9274135154685985e-32_rk, 5.551115123125783e-17_rk, 5.551115123125783e-17_rk, 2.0816681711721685e-17_rk   &
        /),(/8,8/))
        test_dgrad3_dx(:,:,7,3) = reshape((/ &
        0.0_rk, 0.0_rk, 0.0_rk, -2.7755575615628914e-17_rk, 4.958056047779154e-18_rk, 1.3877787807814457e-17_rk, 0.0_rk, 0.0_rk,   &
        0.0_rk, -0.12200846792814624_rk, 0.0_rk, 0.12200846792814618_rk, -0.14088324360345814_rk, -0.07044162180172905_rk, 0.07044162180172903_rk, 0.0813389786187641_rk,   &
        0.0_rk, 0.12200846792814618_rk, 0.0_rk, -0.12200846792814624_rk, -0.14088324360345808_rk, 0.07044162180172903_rk, -0.07044162180172905_rk, 0.0813389786187641_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk,   &
        0.0_rk, -0.4553418012614796_rk, 0.0_rk, 0.4553418012614796_rk, -0.5257834230632086_rk, 0.2628917115316043_rk, -0.2628917115316043_rk, -0.30356120084098637_rk,   &
        0.0_rk, 0.4553418012614796_rk, 0.0_rk, -0.4553418012614794_rk, -0.5257834230632084_rk, -0.2628917115316042_rk, 0.2628917115316043_rk, -0.30356120084098626_rk,   &
        0.0_rk, -1.249000902703301e-16_rk, 0.0_rk, 1.249000902703301e-16_rk, 0.0_rk, 9.020562075079397e-17_rk, -6.245004513516506e-17_rk, 0.0_rk   &
        /),(/8,8/))
        test_dgrad3_dx(:,:,8,1) = reshape((/ &
        0.0_rk, 0.21132486540518722_rk, 0.0_rk, 0.21132486540518713_rk, -0.24401693585629242_rk, -0.12200846792814621_rk, -0.12200846792814624_rk, 0.1408832436034581_rk,   &
        0.0_rk, 0.08931639747704087_rk, 0.0_rk, 0.08931639747704093_rk, -9.916112095558308e-18_rk, -0.05156684612641714_rk, -0.05156684612641721_rk, 4.958056047779154e-18_rk,   &
        0.0_rk, 0.33333333333333326_rk, 0.0_rk, 0.33333333333333337_rk, 3.700743415417189e-17_rk, -0.19245008972987526_rk, -0.1924500897298751_rk, -1.8503717077085944e-17_rk,   &
        0.0_rk, 0.21132486540518705_rk, 0.0_rk, 0.21132486540518705_rk, 0.2440169358562924_rk, -0.1220084679281462_rk, -0.1220084679281462_rk, -0.14088324360345805_rk,   &
        0.0_rk, 0.788675134594813_rk, 0.0_rk, 0.788675134594813_rk, -0.9106836025229592_rk, 0.4553418012614796_rk, 0.4553418012614796_rk, -0.5257834230632087_rk,   &
        0.0_rk, 0.3333333333333334_rk, 0.0_rk, 0.3333333333333333_rk, 1.8503717077085944e-17_rk, 0.19245008972987523_rk, 0.1924500897298753_rk, 1.8503717077085944e-17_rk,   &
        0.0_rk, 1.2440169358562925_rk, 0.0_rk, 1.2440169358562925_rk, 0.0_rk, 0.7182335127930838_rk, 0.7182335127930838_rk, 0.0_rk,   &
        0.0_rk, 0.7886751345948128_rk, 0.0_rk, 0.7886751345948128_rk, 0.9106836025229587_rk, 0.4553418012614795_rk, 0.45534180126147933_rk, 0.5257834230632085_rk   &
        /),(/8,8/))
        test_dgrad3_dx(:,:,8,2) = reshape((/ &
        0.0_rk, -1.8147744668742414e-18_rk, 0.29885849072268467_rk, -1.814774466874242e-18_rk, 2.0955210539366063e-18_rk, -0.17254603006834715_rk, -0.17254603006834715_rk, 0.0996194969075615_rk,   &
        0.0_rk, 4.958056047779151e-18_rk, 0.1263124606543373_rk, 4.958056047779154e-18_rk, -5.504547981626422e-34_rk, 0.07292653316078573_rk, -0.07292653316078573_rk, -0.04210415355144577_rk,   &
        0.0_rk, 1.8503717077085938e-17_rk, 0.47140452079103184_rk, 1.8503717077085944e-17_rk, 2.0543252740130518e-33_rk, -0.2721655269759087_rk, 0.2721655269759087_rk, -0.15713484026367724_rk,   &
        0.0_rk, 2.527654759173933e-17_rk, 0.2988584907226846_rk, 2.527654759173933e-17_rk, 2.9186843112550173e-17_rk, 0.17254603006834718_rk, 0.17254603006834718_rk, 0.09961949690756151_rk,   &
        0.0_rk, -6.7728305146533914e-18_rk, 1.1153550716504106_rk, -6.7728305146533914e-18_rk, 7.820591041621695e-18_rk, -0.6439505508593789_rk, -0.6439505508593789_rk, 0.3717850238834702_rk,   &
        0.0_rk, 1.8503717077085947e-17_rk, 0.4714045207910318_rk, 1.850371707708594e-17_rk, 1.0271626370065259e-33_rk, 0.2721655269759087_rk, -0.2721655269759087_rk, -0.15713484026367727_rk,   &
        0.0_rk, 6.905681226056462e-17_rk, 1.7593056225097896_rk, 6.905681226056462e-17_rk, 0.0_rk, -1.015735574742849_rk, 1.015735574742849_rk, -0.5864352075032632_rk,   &
        0.0_rk, 9.433335985230392e-17_rk, 1.1153550716504104_rk, 9.433335985230395e-17_rk, 1.0892678140857899e-16_rk, 0.6439505508593789_rk, 0.6439505508593789_rk, 0.3717850238834702_rk   &
        /),(/8,8/))
        test_dgrad3_dx(:,:,8,3) = reshape((/ &
        0.0_rk, -0.21132486540518722_rk, 0.0_rk, 0.2113248654051873_rk, -4.958056047779154e-18_rk, -0.12200846792814628_rk, 0.12200846792814624_rk, 1.1730886562432548e-17_rk,   &
        0.0_rk, -0.08931639747704087_rk, 0.0_rk, 0.08931639747704093_rk, -0.10313369225283434_rk, -0.05156684612641714_rk, 0.05156684612641721_rk, 0.05954426498469395_rk,   &
        0.0_rk, -0.3333333333333333_rk, 0.0_rk, 0.33333333333333337_rk, 0.3849001794597505_rk, -0.19245008972987526_rk, 0.19245008972987523_rk, -0.22222222222222227_rk,   &
        0.0_rk, -0.21132486540518722_rk, 0.0_rk, 0.21132486540518722_rk, 0.0_rk, -0.12200846792814624_rk, 0.12200846792814624_rk, 0.0_rk,   &
        0.0_rk, -0.788675134594813_rk, 0.0_rk, 0.788675134594813_rk, 0.0_rk, 0.4553418012614796_rk, -0.4553418012614796_rk, 0.0_rk,   &
        0.0_rk, -0.3333333333333334_rk, 0.0_rk, 0.3333333333333335_rk, -0.38490017945975064_rk, 0.19245008972987532_rk, -0.1924500897298753_rk, -0.2222222222222223_rk,   &
        0.0_rk, -1.244016935856293_rk, 0.0_rk, 1.2440169358562925_rk, 1.436467025586168_rk, 0.7182335127930838_rk, -0.718233512793084_rk, 0.829344623904195_rk,   &
        0.0_rk, -0.7886751345948129_rk, 0.0_rk, 0.7886751345948128_rk, -8.756052933765056e-17_rk, 0.4553418012614795_rk, -0.4553418012614795_rk, -4.378026466882528e-17_rk   &
        /),(/8,8/))
        
        
        do inode_diff = 1,self%elem%nterms_c 
            do idir =1,3
                @assertEqual(transpose(test_dgrad3_dx(:,:,inode_diff,idir)),self%elem%dgrad3_dx(:,:,inode_diff,idir),tol)
            end do
        end do

    end subroutine testElement_dgrad3_dx
    !*******************************************************************************************







    !> Test cartesian dinvmass_dx 
    !!
    !!
    !------------------------------------------------------------------------------------------
    @Test
    subroutine testElement_dinvmass_dx(self)
        class(test_element_linearC_dx),    intent(inout)   :: self
        
        
        real(rk), dimension(self%elem%nterms_s,self%elem%nterms_s,self%elem%nterms_c,3) :: test_dinvmass_dx
        
        real(rk)        :: tol = 1.e-13_rk
        integer(ik)     :: inode_diff, idir, inode
        
       
        !
        ! dinvmass_dx
        ! 
        test_dinvmass_dx(:,:,1,1) = reshape((/ &
        0.3535533905932738_rk, -0.17677669529663698_rk, -0.35355339059327373_rk, -0.17677669529663687_rk, 6.938893903907228e-17_rk, 0.17677669529663687_rk, 0.1767766952966371_rk, -2.636779683484747e-16_rk,   &
        -0.176776695296637_rk, 1.0606601717798212_rk, 0.17677669529663695_rk, 8.673617379884035e-17_rk, -0.5303300858899106_rk, -1.3183898417423734e-16_rk, -1.0606601717798207_rk, 0.5303300858899103_rk,   &
        -0.35355339059327373_rk, 0.1767766952966368_rk, 1.060660171779821_rk, 0.1767766952966368_rk, -9.020562075079397e-17_rk, -0.5303300858899106_rk, -0.5303300858899112_rk, 8.326672684688674e-17_rk,   &
        -0.17677669529663687_rk, 7.632783294297951e-17_rk, 0.17677669529663678_rk, 1.0606601717798212_rk, -0.5303300858899112_rk, -1.060660171779821_rk, -4.85722573273506e-16_rk, 0.5303300858899113_rk,   &
        6.591949208711867e-17_rk, -0.5303300858899103_rk, -7.632783294297951e-17_rk, -0.530330085889911_rk, 3.181980515339463_rk, 0.530330085889911_rk, 0.5303300858899105_rk, -3.1819805153394616_rk,   &
        0.1767766952966368_rk, 7.632783294297951e-17_rk, -0.5303300858899104_rk, -1.0606601717798207_rk, 0.530330085889911_rk, 3.181980515339464_rk, 3.7470027081099033e-16_rk, -1.5909902576697328_rk,   &
        0.1767766952966371_rk, -1.0606601717798205_rk, -0.530330085889911_rk, -4.85722573273506e-17_rk, 0.5303300858899103_rk, 4.3021142204224816e-16_rk, 3.181980515339464_rk, -1.5909902576697315_rk,   &
        -9.71445146547012e-17_rk, 0.5303300858899105_rk, 1.1102230246251565e-16_rk, 0.5303300858899112_rk, -3.181980515339463_rk, -1.590990257669734_rk, -1.5909902576697328_rk, 9.545941546018394_rk   &
        /),(/8,8/))
        test_dinvmass_dx(:,:,1,2) = reshape((/ &
        0.25_rk, -0.25_rk, -9.307642840465526e-17_rk, -0.25_rk, 0.25_rk, -3.573134319923942e-17_rk, 1.0651598183085876e-16_rk, -1.439208540877748e-16_rk,   &
        -0.25000000000000006_rk, 0.75_rk, -6.001747186291472e-17_rk, 0.25000000000000006_rk, -0.75_rk, 7.118485693334925e-17_rk, 1.3363490206851433e-16_rk, -2.390330137719556e-16_rk,   &
        -2.7156936317536592e-17_rk, -1.1205917614221894e-16_rk, 0.75_rk, -7.042581271877557e-17_rk, -2.5959657721351936e-17_rk, -0.75_rk, -0.7500000000000001_rk, 0.75_rk,   &
        -0.25_rk, 0.25_rk, -7.042581271877557e-17_rk, 0.75_rk, -0.7500000000000002_rk, 9.200153864507095e-17_rk, -2.271875809346616e-16_rk, -8.637734788599659e-17_rk,   &
        0.25_rk, -0.7499999999999999_rk, 5.730706912553478e-17_rk, -0.7500000000000001_rk, 2.2499999999999996_rk, -3.639331040422857e-16_rk, -1.9739965034851224e-16_rk, 1.4764332613111634e-15_rk,   &
        -6.348691881486834e-17_rk, 1.613904776841432e-16_rk, -0.7499999999999998_rk, 2.4465720453102996e-16_rk, 1.217894692312203e-16_rk, 2.2500000000000004_rk, 0.7500000000000002_rk, -2.250000000000001_rk,   &
        -1.1445214535564106e-17_rk, 3.140461435701022e-16_rk, -0.75_rk, 7.118485693334922e-17_rk, -1.698840884692428e-17_rk, 0.7500000000000003_rk, 2.2500000000000004_rk, -2.25_rk,   &
        -1.369819601838676e-16_rk, -2.390330137719556e-16_rk, 0.7500000000000001_rk, -1.698840884692428e-17_rk, 2.829435098391201e-16_rk, -2.2500000000000013_rk, -2.250000000000001_rk, 6.750000000000003_rk   &
        /),(/8,8/))
        test_dinvmass_dx(:,:,1,3) = reshape((/ &
        1.0408340855860843e-17_rk, -0.1767766952966369_rk, -6.938893903907228e-18_rk, 0.17677669529663692_rk, -4.85722573273506e-17_rk, -0.17677669529663678_rk, 0.17677669529663675_rk, -6.245004513516506e-17_rk,   &
        -0.17677669529663692_rk, 3.8163916471489756e-17_rk, 0.17677669529663687_rk, -7.979727989493313e-17_rk, 0.5303300858899106_rk, 1.1796119636642288e-16_rk, -1.8735013540549517e-16_rk, -0.5303300858899103_rk,   &
        -3.469446951953614e-17_rk, 0.17677669529663692_rk, 6.938893903907228e-17_rk, -0.1767766952966369_rk, 6.938893903907228e-17_rk, 0.5303300858899105_rk, -0.5303300858899106_rk, 6.938893903907228e-17_rk,   &
        0.17677669529663692_rk, -3.469446951953614e-18_rk, -0.1767766952966368_rk, 7.979727989493313e-17_rk, -0.5303300858899107_rk, -2.42861286636753e-16_rk, 6.245004513516506e-17_rk, 0.5303300858899105_rk,   &
        -5.551115123125783e-17_rk, 0.5303300858899105_rk, 3.469446951953614e-17_rk, -0.5303300858899106_rk, 3.608224830031759e-16_rk, 0.5303300858899104_rk, -0.5303300858899103_rk, -6.38378239159465e-16_rk,   &
        -0.17677669529663684_rk, -1.3877787807814457e-17_rk, 0.5303300858899106_rk, -7.632783294297951e-17_rk, 0.5303300858899106_rk, 4.0245584642661925e-16_rk, -8.326672684688674e-17_rk, -1.5909902576697321_rk,   &
        0.1767766952966368_rk, -8.326672684688674e-17_rk, -0.5303300858899106_rk, 6.245004513516506e-17_rk, -0.5303300858899105_rk, -1.249000902703301e-16_rk, 2.498001805406602e-16_rk, 1.5909902576697323_rk,   &
        -5.551115123125783e-17_rk, -0.5303300858899105_rk, -1.8041124150158794e-16_rk, 0.5303300858899107_rk, -3.0531133177191805e-16_rk, -1.5909902576697321_rk, 1.5909902576697315_rk, 3.3306690738754696e-16_rk   &
        /),(/8,8/))
        test_dinvmass_dx(:,:,2,1) = reshape((/ &
        -3.903127820947816e-17_rk, 0.17677669529663684_rk, 4.85722573273506e-17_rk, 0.17677669529663684_rk, 0.0_rk, -0.17677669529663687_rk, -0.17677669529663687_rk, -1.3877787807814457e-17_rk,   &
        0.17677669529663687_rk, -4.163336342344337e-17_rk, -0.17677669529663678_rk, 1.0408340855860843e-17_rk, 0.5303300858899106_rk, 4.85722573273506e-17_rk, 1.3877787807814457e-16_rk, -0.5303300858899103_rk,   &
        2.7755575615628914e-17_rk, -0.17677669529663684_rk, -8.673617379884035e-17_rk, -0.17677669529663678_rk, 6.938893903907228e-18_rk, 0.5303300858899105_rk, 0.5303300858899106_rk, -1.6653345369377348e-16_rk,   &
        0.17677669529663684_rk, 3.469446951953614e-17_rk, -0.17677669529663684_rk, -5.204170427930421e-17_rk, 0.5303300858899105_rk, 1.3183898417423734e-16_rk, 6.938893903907228e-17_rk, -0.5303300858899107_rk,   &
        -7.979727989493313e-17_rk, 0.5303300858899104_rk, 2.0816681711721685e-17_rk, 0.5303300858899106_rk, -2.3592239273284576e-16_rk, -0.5303300858899102_rk, -0.5303300858899103_rk, 3.3306690738754696e-16_rk,   &
        -0.1767766952966368_rk, -4.85722573273506e-17_rk, 0.5303300858899104_rk, 1.1796119636642288e-16_rk, -0.5303300858899105_rk, -4.3021142204224816e-16_rk, -2.3592239273284576e-16_rk, 1.5909902576697315_rk,   &
        -0.17677669529663675_rk, 7.632783294297951e-17_rk, 0.5303300858899105_rk, -3.469446951953614e-17_rk, -0.5303300858899103_rk, -3.469446951953614e-16_rk, -3.7470027081099033e-16_rk, 1.5909902576697317_rk,   &
        1.3877787807814457e-17_rk, -0.5303300858899105_rk, -1.942890293094024e-16_rk, -0.5303300858899105_rk, 7.355227538141662e-16_rk, 1.5909902576697315_rk, 1.590990257669732_rk, -4.718447854656915e-16_rk   &
        /),(/8,8/))
        test_dinvmass_dx(:,:,2,2) = reshape((/ &
        0.25_rk, -0.25_rk, -3.838303366229523e-17_rk, 0.25_rk, -0.25000000000000006_rk, -6.559371796620378e-18_rk, -1.0028818748573995e-17_rk, -2.157630625935405e-16_rk,   &
        -0.25_rk, 0.75_rk, -6.553996997983182e-17_rk, -0.25_rk, 0.75_rk, 1.3220436235398016e-17_rk, 2.2832614725652213e-16_rk, 2.370609590547063e-16_rk,   &
        1.3658670617008983e-17_rk, -8.288720473959989e-17_rk, 0.75_rk, 3.7952210728685365e-19_rk, -2.841292718804534e-17_rk, 0.75_rk, -0.7500000000000001_rk, -0.7500000000000003_rk,   &
        0.25_rk, -0.24999999999999992_rk, -2.7376053508342066e-17_rk, 0.75_rk, -0.7500000000000001_rk, 7.567048137056307e-17_rk, -2.435186382091694e-16_rk, -4.151950679125732e-16_rk,   &
        -0.25000000000000006_rk, 0.7500000000000001_rk, -1.1167965403493206e-16_rk, -0.7500000000000001_rk, 2.2499999999999996_rk, -3.041727654500575e-16_rk, 4.174722005562942e-16_rk, 1.524584604142341e-15_rk,   &
        -3.431494741224929e-17_rk, -7.698518451539592e-17_rk, 0.75_rk, 2.005705716408932e-16_rk, 4.2771929745303907e-17_rk, 2.2500000000000004_rk, -0.7500000000000001_rk, -2.250000000000001_rk,   &
        -3.0899248446667667e-18_rk, 2.977150862955944e-16_rk, -0.75_rk, -4.2290714995859774e-17_rk, -4.0494797101582834e-17_rk, -0.7500000000000001_rk, 2.2500000000000004_rk, 2.250000000000001_rk,   &
        -2.841292718804534e-17_rk, 1.2603865659219067e-16_rk, -0.7500000000000003_rk, 1.5016354129675018e-17_rk, 7.196729112891024e-16_rk, -2.250000000000001_rk, 2.25_rk, 6.750000000000003_rk   &
        /),(/8,8/))
        test_dinvmass_dx(:,:,2,3) = reshape((/ &
        -0.35355339059327384_rk, 0.17677669529663692_rk, 0.35355339059327384_rk, -0.1767766952966369_rk, -6.938893903907228e-18_rk, 0.1767766952966368_rk, -0.17677669529663692_rk, 3.677613769070831e-16_rk,   &
        0.17677669529663692_rk, -1.0606601717798212_rk, -0.17677669529663692_rk, -1.734723475976807e-17_rk, -0.5303300858899105_rk, -6.245004513516506e-17_rk, 1.060660171779821_rk, 0.5303300858899103_rk,   &
        0.3535533905932738_rk, -0.17677669529663687_rk, -1.0606601717798212_rk, 0.17677669529663684_rk, 4.163336342344337e-17_rk, -0.5303300858899105_rk, 0.5303300858899109_rk, 6.938893903907228e-17_rk,   &
        -0.17677669529663692_rk, -9.367506770274758e-17_rk, 0.17677669529663687_rk, -1.0606601717798212_rk, 0.5303300858899109_rk, 1.0606601717798212_rk, 3.5388358909926865e-16_rk, -0.5303300858899109_rk,   &
        8.326672684688674e-17_rk, -0.5303300858899106_rk, 2.0816681711721685e-17_rk, 0.5303300858899109_rk, -3.181980515339464_rk, -0.5303300858899109_rk, 0.53033008588991_rk, 3.181980515339462_rk,   &
        0.17677669529663687_rk, -1.3877787807814457e-17_rk, -0.5303300858899105_rk, 1.060660171779821_rk, -0.5303300858899109_rk, -3.1819805153394642_rk, -5.551115123125783e-17_rk, 1.5909902576697326_rk,   &
        -0.17677669529663698_rk, 1.060660171779821_rk, 0.5303300858899109_rk, 2.0816681711721685e-17_rk, 0.5303300858899106_rk, 4.163336342344337e-17_rk, -3.1819805153394642_rk, -1.5909902576697323_rk,   &
        1.6653345369377348e-16_rk, 0.5303300858899105_rk, 2.3592239273284576e-16_rk, -0.5303300858899109_rk, 3.1819805153394634_rk, 1.590990257669734_rk, -1.5909902576697306_rk, -9.545941546018396_rk   &
        /),(/8,8/))
        test_dinvmass_dx(:,:,3,1) = reshape((/ &
        -0.3535533905932738_rk, -0.17677669529663675_rk, 0.35355339059327373_rk, -0.1767766952966368_rk, 2.7755575615628914e-17_rk, 0.1767766952966368_rk, 0.17677669529663673_rk, 6.938893903907228e-17_rk,   &
        -0.17677669529663678_rk, -1.0606601717798212_rk, 0.1767766952966367_rk, 1.734723475976807e-17_rk, -0.5303300858899106_rk, -1.3183898417423734e-16_rk, 1.0606601717798203_rk, 0.5303300858899104_rk,   &
        0.35355339059327373_rk, 0.17677669529663678_rk, -1.060660171779821_rk, 0.17677669529663684_rk, -1.734723475976807e-16_rk, -0.5303300858899104_rk, -0.53033008588991_rk, 4.996003610813204e-16_rk,   &
        -0.1767766952966368_rk, -2.0816681711721685e-17_rk, 0.1767766952966369_rk, -1.0606601717798212_rk, -0.53033008588991_rk, 1.0606601717798205_rk, 6.938893903907228e-17_rk, 0.53033008588991_rk,   &
        1.7694179454963432e-16_rk, -0.5303300858899105_rk, -1.5959455978986625e-16_rk, -0.5303300858899102_rk, -3.181980515339463_rk, 0.5303300858899094_rk, 0.53033008588991_rk, 3.1819805153394616_rk,   &
        0.17677669529663684_rk, -1.734723475976807e-16_rk, -0.5303300858899104_rk, 1.0606601717798203_rk, 0.5303300858899099_rk, -3.181980515339463_rk, 3.191891195797325e-16_rk, -1.5909902576697306_rk,   &
        0.17677669529663653_rk, 1.0606601717798205_rk, -0.5303300858899099_rk, -7.632783294297951e-17_rk, 0.5303300858899104_rk, 4.85722573273506e-16_rk, -3.181980515339463_rk, -1.590990257669732_rk,   &
        -1.249000902703301e-16_rk, 0.5303300858899104_rk, 5.828670879282072e-16_rk, 0.53033008588991_rk, 3.1819805153394616_rk, -1.5909902576697295_rk, -1.590990257669731_rk, -9.54594154601839_rk   &
        /),(/8,8/))
        test_dinvmass_dx(:,:,3,2) = reshape((/ &
        0.25_rk, 0.24999999999999997_rk, -3.8324321387971136e-17_rk, 0.24999999999999994_rk, 0.24999999999999994_rk, 7.216723369036808e-18_rk, 8.00751093600627e-17_rk, -7.42010865335136e-18_rk,   &
        0.24999999999999994_rk, 0.75_rk, -1.706940529463849e-17_rk, 0.24999999999999994_rk, 0.7499999999999997_rk, 1.5217445113651492e-16_rk, 2.701356475029378e-16_rk, 1.5348915428134777e-16_rk,   &
        6.778488987425855e-18_rk, 6.966676850420186e-17_rk, 0.7499999999999998_rk, 8.354455631201632e-17_rk, 1.3829666332870046e-16_rk, 0.7499999999999997_rk, 0.7499999999999996_rk, 0.7499999999999996_rk,   &
        0.24999999999999997_rk, 0.25000000000000006_rk, -1.3599958342684877e-17_rk, 0.75_rk, 0.7499999999999997_rk, 3.1176901092638117e-16_rk, 1.0360219380916432e-16_rk, 3.616559713985646e-16_rk,   &
        0.24999999999999986_rk, 0.7499999999999998_rk, 2.2156339017558715e-16_rk, 0.7499999999999996_rk, 2.2499999999999996_rk, 4.726782738610802e-16_rk, 4.726782738610803e-16_rk, 1.5806241658425157e-15_rk,   &
        4.8850086792480174e-17_rk, 2.4238007188730884e-16_rk, 0.7499999999999996_rk, 3.8115794996545345e-16_rk, 3.477781835907502e-16_rk, 2.2499999999999996_rk, 0.7499999999999994_rk, 2.2499999999999996_rk,   &
        1.0089179107178439e-16_rk, 3.950357377732679e-16_rk, 0.7499999999999994_rk, 2.076856023677727e-16_rk, 2.0900030551260558e-16_rk, 0.7499999999999996_rk, 2.2499999999999996_rk, 2.2500000000000004_rk,   &
        -2.823679036507302e-17_rk, 2.6451145674386333e-16_rk, 0.7499999999999997_rk, 9.797800305008991e-17_rk, 3.8713441437047247e-16_rk, 2.2499999999999987_rk, 2.2499999999999987_rk, 6.750000000000001_rk   &
        /),(/8,8/))
        test_dinvmass_dx(:,:,3,3) = reshape((/ &
        1.0408340855860843e-17_rk, -0.17677669529663684_rk, -6.938893903907228e-18_rk, 0.17677669529663692_rk, -3.469446951953614e-17_rk, -0.17677669529663687_rk, 0.1767766952966367_rk, -6.938893903907228e-18_rk,   &
        -0.1767766952966368_rk, 1.0408340855860843e-17_rk, 0.17677669529663687_rk, -2.42861286636753e-17_rk, 0.5303300858899104_rk, 1.734723475976807e-16_rk, 3.469446951953614e-17_rk, -0.5303300858899103_rk,   &
        2.0816681711721685e-17_rk, 0.1767766952966368_rk, 1.3877787807814457e-17_rk, -0.1767766952966368_rk, 6.938893903907228e-17_rk, 0.5303300858899105_rk, -0.5303300858899104_rk, -4.163336342344337e-17_rk,   &
        0.17677669529663692_rk, -3.469446951953614e-18_rk, -0.17677669529663684_rk, 1.0408340855860843e-17_rk, -0.5303300858899105_rk, -1.3183898417423734e-16_rk, 3.469446951953614e-17_rk, 0.5303300858899103_rk,   &
        -1.1102230246251565e-16_rk, 0.5303300858899105_rk, 3.469446951953614e-17_rk, -0.5303300858899104_rk, 3.0531133177191805e-16_rk, 0.5303300858899103_rk, -0.5303300858899103_rk, 2.498001805406602e-16_rk,   &
        -0.1767766952966368_rk, 4.163336342344337e-17_rk, 0.5303300858899104_rk, -7.632783294297951e-17_rk, 0.5303300858899104_rk, 2.636779683484747e-16_rk, -2.220446049250313e-16_rk, -1.5909902576697317_rk,   &
        0.1767766952966368_rk, -8.326672684688674e-17_rk, -0.5303300858899104_rk, 6.245004513516506e-17_rk, -0.5303300858899105_rk, -2.636779683484747e-16_rk, 2.220446049250313e-16_rk, 1.590990257669732_rk,   &
        2.7755575615628914e-17_rk, -0.5303300858899105_rk, -3.191891195797325e-16_rk, 0.5303300858899106_rk, 3.608224830031759e-16_rk, -1.5909902576697317_rk, 1.5909902576697315_rk, 3.3306690738754696e-16_rk   &
        /),(/8,8/))
        test_dinvmass_dx(:,:,4,1) = reshape((/ &
        -1.474514954580286e-17_rk, 0.1767766952966369_rk, -3.469446951953614e-17_rk, 0.17677669529663684_rk, -9.71445146547012e-17_rk, -0.1767766952966368_rk, -0.17677669529663692_rk, 2.0816681711721685e-16_rk,   &
        0.17677669529663692_rk, -4.163336342344337e-17_rk, -0.17677669529663687_rk, -1.1449174941446927e-16_rk, 0.5303300858899106_rk, 2.1510571102112408e-16_rk, 2.7755575615628914e-17_rk, -0.5303300858899104_rk,   &
        0.0_rk, -0.17677669529663673_rk, -4.5102810375396984e-17_rk, -0.17677669529663687_rk, 2.5673907444456745e-16_rk, 0.5303300858899105_rk, 0.5303300858899106_rk, -4.163336342344337e-16_rk,   &
        0.17677669529663684_rk, -9.020562075079397e-17_rk, -0.17677669529663684_rk, 3.469446951953614e-18_rk, 0.5303300858899107_rk, 1.3183898417423734e-16_rk, 3.469446951953614e-16_rk, -0.5303300858899106_rk,   &
        -1.6306400674181987e-16_rk, 0.5303300858899104_rk, 2.1510571102112408e-16_rk, 0.5303300858899106_rk, -1.8041124150158794e-16_rk, -0.5303300858899103_rk, -0.5303300858899103_rk, -1.1102230246251565e-16_rk,   &
        -0.1767766952966368_rk, 1.457167719820518e-16_rk, 0.5303300858899104_rk, 1.1796119636642288e-16_rk, -0.5303300858899105_rk, -2.636779683484747e-16_rk, -4.579669976578771e-16_rk, 1.590990257669732_rk,   &
        -0.17677669529663687_rk, 7.632783294297951e-17_rk, 0.5303300858899105_rk, 1.5959455978986625e-16_rk, -0.5303300858899103_rk, -5.689893001203927e-16_rk, -3.191891195797325e-16_rk, 1.5909902576697317_rk,   &
        2.0816681711721685e-16_rk, -0.5303300858899105_rk, -4.996003610813204e-16_rk, -0.5303300858899107_rk, 6.938893903907228e-17_rk, 1.590990257669732_rk, 1.590990257669732_rk, -1.1379786002407855e-15_rk   &
        /),(/8,8/))
        test_dinvmass_dx(:,:,4,2) = reshape((/ &
        0.25_rk, 0.25_rk, -5.226082147010969e-17_rk, -0.25_rk, -0.24999999999999994_rk, -2.0437159604434838e-17_rk, 1.0099348371394167e-16_rk, -1.880074869779116e-16_rk,   &
        0.24999999999999997_rk, 0.75_rk, -2.3906606556388452e-17_rk, -0.2499999999999999_rk, -0.7499999999999998_rk, -1.2555744184274651e-16_rk, 2.5608172287215105e-16_rk, -5.956063094141611e-16_rk,   &
        6.719776713101753e-18_rk, 1.4257309915101317e-17_rk, 0.7499999999999998_rk, -6.900941693178543e-17_rk, -8.392407841930316e-17_rk, -0.7499999999999998_rk, 0.7499999999999997_rk, -0.7500000000000002_rk,   &
        -0.25_rk, -0.24999999999999992_rk, -5.513162912397098e-17_rk, 0.75_rk, 0.7499999999999998_rk, 1.8669278383307874e-16_rk, -2.990297894404272e-16_rk, 3.619610493250364e-16_rk,   &
        -0.24999999999999997_rk, -0.7499999999999997_rk, -5.616850280367422e-17_rk, 0.7499999999999997_rk, 2.2499999999999996_rk, 1.95427595631263e-16_rk, -4.70706219143831e-16_rk, 1.4135623016798253e-15_rk,   &
        -1.1758167425913603e-16_rk, 6.281542331490849e-18_rk, -0.7499999999999996_rk, 2.8383729848777996e-16_rk, 1.5379423220781956e-16_rk, 2.2499999999999996_rk, -0.7499999999999994_rk, 2.25_rk,   &
        8.017680200221998e-17_rk, 2.1444835944870765e-16_rk, 0.7499999999999996_rk, -1.2555744184274651e-16_rk, -1.5151709956409846e-16_rk, -0.7499999999999993_rk, 2.2499999999999996_rk, -2.25_rk,   &
        -2.841292718804533e-17_rk, 7.052750536093284e-17_rk, -0.7499999999999996_rk, -9.600594833284064e-17_rk, 3.866060039015555e-16_rk, 2.2499999999999987_rk, -2.25_rk, 6.750000000000001_rk   &
        /),(/8,8/))
        test_dinvmass_dx(:,:,4,3) = reshape((/ &
        0.35355339059327384_rk, 0.1767766952966368_rk, -0.35355339059327384_rk, -0.17677669529663695_rk, 9.020562075079397e-17_rk, 0.17677669529663684_rk, -0.17677669529663653_rk, -2.983724378680108e-16_rk,   &
        0.1767766952966368_rk, 1.0606601717798212_rk, -0.17677669529663675_rk, 1.214306433183765e-16_rk, -0.5303300858899105_rk, -2.2898349882893854e-16_rk, -1.060660171779821_rk, 0.5303300858899103_rk,   &
        -0.3535533905932738_rk, -0.17677669529663687_rk, 1.0606601717798212_rk, 0.17677669529663684_rk, -1.8041124150158794e-16_rk, -0.5303300858899105_rk, 0.53033008588991_rk, -9.71445146547012e-17_rk,   &
        -0.17677669529663692_rk, 1.0061396160665481e-16_rk, 0.17677669529663675_rk, 1.0606601717798212_rk, 0.5303300858899103_rk, -1.0606601717798207_rk, -4.510281037539698e-16_rk, -0.5303300858899099_rk,   &
        8.326672684688674e-17_rk, -0.5303300858899104_rk, -9.020562075079397e-17_rk, 0.53033008588991_rk, 3.181980515339463_rk, -0.5303300858899096_rk, 0.5303300858899105_rk, -3.1819805153394625_rk,   &
        0.17677669529663678_rk, -1.3877787807814457e-17_rk, -0.5303300858899105_rk, -1.060660171779821_rk, -0.53033008588991_rk, 3.1819805153394634_rk, 3.608224830031759e-16_rk, 1.5909902576697312_rk,   &
        -0.1767766952966367_rk, -1.060660171779821_rk, 0.53033008588991_rk, -1.457167719820518e-16_rk, 0.5303300858899105_rk, 3.469446951953614e-16_rk, 3.1819805153394634_rk, -1.590990257669732_rk,   &
        -1.3877787807814457e-16_rk, 0.5303300858899106_rk, 2.636779683484747e-16_rk, -0.5303300858899104_rk, -3.181980515339464_rk, 1.59099025766973_rk, -1.5909902576697323_rk, 9.545941546018396_rk   &
        /),(/8,8/))
        test_dinvmass_dx(:,:,5,1) = reshape((/ &
        0.3535533905932738_rk, -0.17677669529663698_rk, 0.35355339059327373_rk, -0.17677669529663692_rk, -4.163336342344337e-17_rk, -0.17677669529663692_rk, -0.17677669529663684_rk, -9.71445146547012e-17_rk,   &
        -0.17677669529663695_rk, 1.0606601717798212_rk, -0.17677669529663698_rk, 9.367506770274758e-17_rk, -0.5303300858899106_rk, 2.983724378680108e-16_rk, 1.0606601717798216_rk, -0.5303300858899112_rk,   &
        0.35355339059327373_rk, -0.17677669529663695_rk, 1.060660171779821_rk, -0.17677669529663695_rk, 3.469446951953614e-17_rk, -0.5303300858899106_rk, -0.5303300858899112_rk, -3.3306690738754696e-16_rk,   &
        -0.17677669529663692_rk, 7.632783294297951e-17_rk, -0.17677669529663695_rk, 1.0606601717798212_rk, -0.5303300858899107_rk, 1.0606601717798214_rk, -6.938893903907228e-17_rk, -0.530330085889911_rk,   &
        3.122502256758253e-17_rk, -0.5303300858899105_rk, 1.8735013540549517e-16_rk, -0.530330085889911_rk, 3.1819805153394647_rk, -0.5303300858899114_rk, -0.5303300858899108_rk, 3.181980515339466_rk,   &
        -0.17677669529663698_rk, 2.2898349882893854e-16_rk, -0.5303300858899106_rk, 1.0606601717798216_rk, -0.5303300858899109_rk, 3.181980515339464_rk, 2.636779683484747e-16_rk, -1.5909902576697332_rk,   &
        -0.17677669529663698_rk, 1.0606601717798214_rk, -0.530330085889911_rk, 2.1510571102112408e-16_rk, -0.5303300858899106_rk, 5.412337245047638e-16_rk, 3.181980515339464_rk, -1.590990257669732_rk,   &
        -1.3877787807814457e-17_rk, -0.5303300858899108_rk, 3.885780586188048e-16_rk, -0.5303300858899113_rk, 3.181980515339465_rk, -1.590990257669734_rk, -1.5909902576697328_rk, 9.545941546018398_rk   &
        /),(/8,8/))
        test_dinvmass_dx(:,:,5,2) = reshape((/ &
        -0.25_rk, 0.25_rk, 9.307642840465526e-17_rk, 0.25_rk, -0.25000000000000006_rk, 3.573134319923942e-17_rk, -1.0651598183085876e-16_rk, 1.439208540877748e-16_rk,   &
        0.25000000000000006_rk, -0.75_rk, 6.001747186291472e-17_rk, -0.2500000000000001_rk, 0.75_rk, -7.118485693334926e-17_rk, -1.336349020685143e-16_rk, 2.390330137719556e-16_rk,   &
        2.7156936317536592e-17_rk, 1.1205917614221894e-16_rk, -0.75_rk, 7.042581271877557e-17_rk, 2.5959657721351936e-17_rk, 0.7500000000000001_rk, 0.7500000000000002_rk, -0.7500000000000002_rk,   &
        0.25_rk, -0.25000000000000006_rk, 7.042581271877557e-17_rk, -0.75_rk, 0.7500000000000003_rk, -9.200153864507095e-17_rk, 2.271875809346616e-16_rk, 8.637734788599659e-17_rk,   &
        -0.25000000000000006_rk, 0.75_rk, -5.730706912553478e-17_rk, 0.7500000000000002_rk, -2.2499999999999996_rk, 3.6393310404228575e-16_rk, 1.9739965034851224e-16_rk, -1.4764332613111634e-15_rk,   &
        6.348691881486834e-17_rk, -1.613904776841432e-16_rk, 0.7499999999999999_rk, -2.4465720453102996e-16_rk, -1.217894692312203e-16_rk, -2.2500000000000004_rk, -0.7500000000000004_rk, 2.250000000000001_rk,   &
        1.1445214535564131e-17_rk, -3.140461435701022e-16_rk, 0.7500000000000001_rk, -7.118485693334924e-17_rk, 1.698840884692428e-17_rk, -0.7500000000000004_rk, -2.2500000000000004_rk, 2.2500000000000004_rk,   &
        1.369819601838676e-16_rk, 2.390330137719556e-16_rk, -0.7500000000000003_rk, 1.6988408846924304e-17_rk, -2.8294350983912e-16_rk, 2.2500000000000013_rk, 2.250000000000001_rk, -6.750000000000003_rk   &
        /),(/8,8/))
        test_dinvmass_dx(:,:,5,3) = reshape((/ &
        3.469446951953614e-18_rk, -0.1767766952966369_rk, 6.938893903907228e-18_rk, 0.17677669529663692_rk, -3.469446951953614e-17_rk, 0.17677669529663698_rk, -0.17677669529663687_rk, 6.938893903907228e-18_rk,   &
        -0.17677669529663692_rk, 1.734723475976807e-17_rk, -0.17677669529663692_rk, -4.5102810375396984e-17_rk, 0.5303300858899108_rk, -6.245004513516506e-17_rk, 1.8735013540549517e-16_rk, 0.5303300858899113_rk,   &
        -2.0816681711721685e-17_rk, -0.17677669529663692_rk, 1.3877787807814457e-17_rk, 0.17677669529663687_rk, -1.3877787807814457e-17_rk, 0.5303300858899105_rk, -0.5303300858899108_rk, 1.3877787807814457e-17_rk,   &
        0.17677669529663692_rk, 3.469446951953614e-18_rk, 0.17677669529663695_rk, -1.0408340855860843e-17_rk, -0.5303300858899107_rk, 2.0816681711721685e-17_rk, -6.938893903907228e-18_rk, -0.5303300858899113_rk,   &
        -5.551115123125783e-17_rk, 0.5303300858899107_rk, -6.245004513516506e-17_rk, -0.5303300858899106_rk, 1.942890293094024e-16_rk, -0.530330085889911_rk, 0.530330085889911_rk, 6.38378239159465e-16_rk,   &
        0.17677669529663695_rk, -6.938893903907228e-17_rk, 0.5303300858899108_rk, 7.632783294297951e-17_rk, -0.5303300858899108_rk, 2.3592239273284576e-16_rk, -2.220446049250313e-16_rk, -1.5909902576697326_rk,   &
        -0.17677669529663698_rk, 8.326672684688674e-17_rk, -0.5303300858899106_rk, -6.245004513516506e-17_rk, 0.5303300858899107_rk, -2.3592239273284576e-16_rk, 2.220446049250313e-16_rk, 1.5909902576697328_rk,   &
        -8.326672684688674e-17_rk, 0.5303300858899107_rk, -2.914335439641036e-16_rk, -0.5303300858899109_rk, -1.3877787807814457e-16_rk, -1.5909902576697326_rk, 1.5909902576697328_rk, 5.551115123125783e-16_rk   &
        /),(/8,8/))
        test_dinvmass_dx(:,:,6,1) = reshape((/ &
        4.336808689942018e-18_rk, 0.17677669529663684_rk, 6.938893903907228e-18_rk, 0.1767766952966369_rk, -2.7755575615628914e-17_rk, 0.17677669529663687_rk, 0.1767766952966368_rk, -1.8041124150158794e-16_rk,   &
        0.1767766952966368_rk, -2.7755575615628914e-17_rk, 0.1767766952966368_rk, -7.979727989493313e-17_rk, 0.5303300858899106_rk, -2.706168622523819e-16_rk, -1.3877787807814457e-16_rk, 0.5303300858899108_rk,   &
        -2.7755575615628914e-17_rk, 0.17677669529663684_rk, -9.367506770274758e-17_rk, 0.17677669529663692_rk, -1.1796119636642288e-16_rk, 0.5303300858899105_rk, 0.5303300858899106_rk, -2.498001805406602e-16_rk,   &
        0.1767766952966369_rk, -2.0816681711721685e-17_rk, 0.1767766952966369_rk, 3.8163916471489756e-17_rk, 0.5303300858899105_rk, -1.3183898417423734e-16_rk, -1.249000902703301e-16_rk, 0.5303300858899107_rk,   &
        -1.2836953722228372e-16_rk, 0.5303300858899106_rk, -1.3183898417423734e-16_rk, 0.5303300858899106_rk, -1.3877787807814457e-17_rk, 0.5303300858899106_rk, 0.5303300858899107_rk, 1.1102230246251565e-16_rk,   &
        0.1767766952966369_rk, -1.457167719820518e-16_rk, 0.5303300858899106_rk, -1.1796119636642288e-16_rk, 0.5303300858899106_rk, -2.636779683484747e-16_rk, -2.914335439641036e-16_rk, 1.590990257669732_rk,   &
        0.17677669529663687_rk, -7.632783294297951e-17_rk, 0.5303300858899105_rk, -1.8735013540549517e-16_rk, 0.5303300858899107_rk, -4.0245584642661925e-16_rk, -1.5265566588595902e-16_rk, 1.5909902576697321_rk,   &
        -1.249000902703301e-16_rk, 0.5303300858899109_rk, -4.163336342344337e-16_rk, 0.5303300858899107_rk, -2.914335439641036e-16_rk, 1.5909902576697315_rk, 1.590990257669732_rk, 3.608224830031759e-16_rk   &
        /),(/8,8/))
        test_dinvmass_dx(:,:,6,2) = reshape((/ &
        -0.25_rk, 0.25_rk, 3.838303366229523e-17_rk, -0.24999999999999997_rk, 0.25000000000000006_rk, 6.559371796620379e-18_rk, 1.0028818748573995e-17_rk, 2.157630625935405e-16_rk,   &
        0.25000000000000006_rk, -0.75_rk, 6.553996997983182e-17_rk, 0.25000000000000006_rk, -0.75_rk, -1.3220436235398016e-17_rk, -2.283261472565221e-16_rk, -2.370609590547063e-16_rk,   &
        -1.3658670617008983e-17_rk, 8.288720473959989e-17_rk, -0.75_rk, -3.795221072868475e-19_rk, 2.841292718804534e-17_rk, -0.7499999999999999_rk, 0.7500000000000002_rk, 0.7500000000000004_rk,   &
        -0.25_rk, 0.24999999999999997_rk, 2.7376053508342066e-17_rk, -0.75_rk, 0.7500000000000002_rk, -7.567048137056307e-17_rk, 2.435186382091694e-16_rk, 4.151950679125732e-16_rk,   &
        0.2500000000000001_rk, -0.75_rk, 1.1167965403493206e-16_rk, 0.7500000000000002_rk, -2.2499999999999996_rk, 3.041727654500575e-16_rk, -4.174722005562942e-16_rk, -1.524584604142341e-15_rk,   &
        3.431494741224929e-17_rk, 7.698518451539592e-17_rk, -0.7499999999999999_rk, -2.005705716408932e-16_rk, -4.2771929745303907e-17_rk, -2.2500000000000004_rk, 0.7500000000000002_rk, 2.250000000000001_rk,   &
        3.0899248446667667e-18_rk, -2.977150862955944e-16_rk, 0.7500000000000001_rk, 4.2290714995859787e-17_rk, 4.0494797101582834e-17_rk, 0.7500000000000002_rk, -2.2500000000000004_rk, -2.2500000000000004_rk,   &
        2.841292718804534e-17_rk, -1.2603865659219062e-16_rk, 0.7500000000000004_rk, -1.5016354129674993e-17_rk, -7.196729112891024e-16_rk, 2.2500000000000013_rk, -2.25_rk, -6.750000000000003_rk   &
        /),(/8,8/))
        test_dinvmass_dx(:,:,6,3) = reshape((/ &
        -0.35355339059327384_rk, 0.17677669529663692_rk, -0.3535533905932736_rk, -0.1767766952966369_rk, 9.020562075079397e-17_rk, -0.1767766952966369_rk, 0.17677669529663687_rk, 2.983724378680108e-16_rk,   &
        0.17677669529663692_rk, -1.0606601717798212_rk, 0.17677669529663703_rk, -2.42861286636753e-17_rk, -0.5303300858899107_rk, 6.938893903907228e-18_rk, -1.0606601717798216_rk, -0.5303300858899109_rk,   &
        -0.3535533905932737_rk, 0.17677669529663692_rk, -1.0606601717798212_rk, -0.1767766952966369_rk, 6.938893903907228e-17_rk, -0.5303300858899105_rk, 0.5303300858899112_rk, 6.245004513516506e-16_rk,   &
        -0.17677669529663692_rk, -7.28583859910259e-17_rk, -0.17677669529663687_rk, -1.0606601717798212_rk, 0.5303300858899109_rk, -1.0606601717798216_rk, 2.0122792321330962e-16_rk, 0.5303300858899112_rk,   &
        1.3877787807814457e-16_rk, -0.5303300858899108_rk, 6.245004513516506e-17_rk, 0.5303300858899109_rk, -3.1819805153394656_rk, 0.5303300858899116_rk, -0.530330085889911_rk, -3.1819805153394665_rk,   &
        -0.17677669529663687_rk, -1.3877787807814457e-17_rk, -0.5303300858899107_rk, -1.0606601717798214_rk, 0.5303300858899109_rk, -3.1819805153394642_rk, 2.498001805406602e-16_rk, 1.590990257669733_rk,   &
        0.17677669529663698_rk, -1.0606601717798214_rk, 0.5303300858899109_rk, 3.469446951953614e-17_rk, -0.5303300858899109_rk, 9.71445146547012e-17_rk, -3.1819805153394642_rk, -1.5909902576697328_rk,   &
        2.498001805406602e-16_rk, -0.5303300858899109_rk, 2.3592239273284576e-16_rk, 0.5303300858899113_rk, -3.181980515339465_rk, 1.5909902576697343_rk, -1.5909902576697315_rk, -9.545941546018396_rk   &
        /),(/8,8/))
        test_dinvmass_dx(:,:,7,1) = reshape((/ &
        -0.3535533905932738_rk, -0.17677669529663675_rk, -0.35355339059327373_rk, -0.17677669529663687_rk, 1.1102230246251565e-16_rk, -0.17677669529663687_rk, -0.1767766952966368_rk, 2.3592239273284576e-16_rk,   &
        -0.17677669529663673_rk, -1.0606601717798212_rk, -0.17677669529663664_rk, 5.204170427930421e-17_rk, -0.5303300858899106_rk, 7.632783294297951e-17_rk, -1.0606601717798212_rk, -0.5303300858899106_rk,   &
        -0.35355339059327373_rk, -0.1767766952966368_rk, -1.060660171779821_rk, -0.17677669529663687_rk, 6.245004513516506e-17_rk, -0.5303300858899104_rk, -0.53033008588991_rk, 6.938893903907228e-16_rk,   &
        -0.17677669529663687_rk, -4.85722573273506e-17_rk, -0.17677669529663684_rk, -1.0606601717798212_rk, -0.5303300858899105_rk, -1.060660171779821_rk, 2.0816681711721685e-16_rk, -0.5303300858899105_rk,   &
        1.97758476261356e-16_rk, -0.5303300858899107_rk, -6.938893903907228e-18_rk, -0.5303300858899102_rk, -3.1819805153394647_rk, -0.5303300858899102_rk, -0.5303300858899107_rk, -3.181980515339466_rk,   &
        -0.17677669529663684_rk, -7.632783294297951e-17_rk, -0.5303300858899106_rk, -1.0606601717798212_rk, -0.5303300858899105_rk, -3.181980515339463_rk, 2.0816681711721685e-16_rk, -1.590990257669731_rk,   &
        -0.17677669529663684_rk, -1.0606601717798214_rk, -0.5303300858899099_rk, 7.632783294297951e-17_rk, -0.5303300858899107_rk, 1.5265566588595902e-16_rk, -3.181980515339463_rk, -1.5909902576697323_rk,   &
        1.8041124150158794e-16_rk, -0.5303300858899112_rk, 2.498001805406602e-16_rk, -0.5303300858899104_rk, -3.1819805153394642_rk, -1.5909902576697295_rk, -1.590990257669731_rk, -9.545941546018394_rk   &
        /),(/8,8/))
        test_dinvmass_dx(:,:,7,2) = reshape((/ &
        -0.25_rk, -0.25_rk, 3.8324321387971136e-17_rk, -0.25_rk, -0.24999999999999997_rk, -7.21672336903681e-18_rk, -8.00751093600627e-17_rk, 7.42010865335136e-18_rk,   &
        -0.25_rk, -0.75_rk, 1.706940529463849e-17_rk, -0.25_rk, -0.7499999999999999_rk, -1.5217445113651492e-16_rk, -2.701356475029378e-16_rk, -1.5348915428134777e-16_rk,   &
        -6.778488987425855e-18_rk, -6.966676850420188e-17_rk, -0.7499999999999998_rk, -8.354455631201632e-17_rk, -1.3829666332870046e-16_rk, -0.7499999999999999_rk, -0.7499999999999998_rk, -0.7499999999999998_rk,   &
        -0.25000000000000006_rk, -0.2500000000000001_rk, 1.3599958342684877e-17_rk, -0.75_rk, -0.7499999999999999_rk, -3.1176901092638117e-16_rk, -1.0360219380916432e-16_rk, -3.6165597139856467e-16_rk,   &
        -0.24999999999999992_rk, -0.75_rk, -2.2156339017558718e-16_rk, -0.7499999999999997_rk, -2.2499999999999996_rk, -4.726782738610803e-16_rk, -4.726782738610803e-16_rk, -1.5806241658425157e-15_rk,   &
        -4.8850086792480174e-17_rk, -2.423800718873089e-16_rk, -0.7499999999999998_rk, -3.8115794996545345e-16_rk, -3.477781835907502e-16_rk, -2.2499999999999996_rk, -0.7499999999999997_rk, -2.25_rk,   &
        -1.0089179107178441e-16_rk, -3.950357377732679e-16_rk, -0.7499999999999997_rk, -2.0768560236777272e-16_rk, -2.0900030551260563e-16_rk, -0.7499999999999997_rk, -2.2499999999999996_rk, -2.250000000000001_rk,   &
        2.823679036507302e-17_rk, -2.6451145674386343e-16_rk, -0.7499999999999999_rk, -9.797800305008996e-17_rk, -3.8713441437047247e-16_rk, -2.249999999999999_rk, -2.249999999999999_rk, -6.750000000000001_rk   &
        /),(/8,8/))
        test_dinvmass_dx(:,:,7,3) = reshape((/ &
        3.469446951953614e-18_rk, -0.17677669529663684_rk, 6.938893903907228e-18_rk, 0.17677669529663692_rk, 6.938893903907228e-18_rk, 0.17677669529663684_rk, -0.17677669529663692_rk, -4.85722573273506e-17_rk,   &
        -0.1767766952966368_rk, 4.5102810375396984e-17_rk, -0.1767766952966368_rk, 1.0408340855860843e-17_rk, 0.5303300858899106_rk, -6.245004513516506e-17_rk, -3.469446951953614e-17_rk, 0.530330085889911_rk,   &
        3.469446951953614e-17_rk, -0.1767766952966368_rk, 6.938893903907228e-17_rk, 0.1767766952966369_rk, 4.163336342344337e-17_rk, 0.5303300858899105_rk, -0.5303300858899106_rk, -9.71445146547012e-17_rk,   &
        0.17677669529663692_rk, 3.469446951953614e-18_rk, 0.17677669529663687_rk, 5.898059818321144e-17_rk, -0.5303300858899105_rk, 1.3183898417423734e-16_rk, 2.0816681711721685e-17_rk, -0.5303300858899108_rk,   &
        -5.551115123125783e-17_rk, 0.5303300858899107_rk, -6.245004513516506e-17_rk, -0.5303300858899104_rk, 2.498001805406602e-16_rk, -0.5303300858899107_rk, 0.5303300858899108_rk, -2.498001805406602e-16_rk,   &
        0.17677669529663687_rk, -6.938893903907228e-17_rk, 0.5303300858899106_rk, 7.632783294297951e-17_rk, -0.5303300858899106_rk, 3.7470027081099033e-16_rk, -1.942890293094024e-16_rk, -1.5909902576697321_rk,   &
        -0.17677669529663687_rk, 8.326672684688674e-17_rk, -0.5303300858899104_rk, -6.938893903907228e-18_rk, 0.5303300858899106_rk, -2.0816681711721685e-16_rk, 2.498001805406602e-16_rk, 1.5909902576697323_rk,   &
        0.0_rk, 0.5303300858899106_rk, -2.636779683484747e-16_rk, -0.5303300858899105_rk, 5.273559366969494e-16_rk, -1.5909902576697321_rk, 1.590990257669732_rk, 5.551115123125783e-16_rk   &
        /),(/8,8/))
        test_dinvmass_dx(:,:,8,1) = reshape((/ &
        -1.9949319973733282e-17_rk, 0.1767766952966369_rk, -7.632783294297951e-17_rk, 0.1767766952966369_rk, -4.163336342344337e-17_rk, 0.17677669529663692_rk, 0.17677669529663687_rk, 4.163336342344337e-17_rk,   &
        0.17677669529663687_rk, -2.7755575615628914e-17_rk, 0.1767766952966368_rk, -6.591949208711867e-17_rk, 0.5303300858899106_rk, -1.0408340855860843e-16_rk, -2.498001805406602e-16_rk, 0.5303300858899109_rk,   &
        -5.551115123125783e-17_rk, 0.17677669529663695_rk, -1.3530843112619095e-16_rk, 0.1767766952966369_rk, 2.0816681711721685e-17_rk, 0.5303300858899105_rk, 0.5303300858899106_rk, -1.1102230246251565e-16_rk,   &
        0.1767766952966369_rk, -6.938893903907228e-18_rk, 0.1767766952966369_rk, -1.734723475976807e-17_rk, 0.5303300858899107_rk, -1.3183898417423734e-16_rk, -1.3877787807814457e-17_rk, 0.5303300858899108_rk,   &
        -1.0061396160665481e-16_rk, 0.5303300858899106_rk, -4.85722573273506e-17_rk, 0.5303300858899106_rk, -6.938893903907228e-17_rk, 0.5303300858899109_rk, 0.5303300858899107_rk, -3.3306690738754696e-16_rk,   &
        0.17677669529663695_rk, -6.938893903907228e-18_rk, 0.5303300858899106_rk, -1.1796119636642288e-16_rk, 0.5303300858899108_rk, -4.3021142204224816e-16_rk, -1.8041124150158794e-16_rk, 1.5909902576697323_rk,   &
        0.17677669529663695_rk, -7.632783294297951e-17_rk, 0.5303300858899105_rk, -1.0408340855860843e-16_rk, 0.5303300858899107_rk, -2.914335439641036e-16_rk, -2.0816681711721685e-16_rk, 1.5909902576697321_rk,   &
        -4.163336342344337e-17_rk, 0.5303300858899109_rk, -2.220446049250313e-16_rk, 0.5303300858899109_rk, -6.938893903907228e-17_rk, 1.590990257669732_rk, 1.590990257669732_rk, -2.525757381022231e-15_rk   &
        /),(/8,8/))
        test_dinvmass_dx(:,:,8,2) = reshape((/ &
        -0.25_rk, -0.24999999999999997_rk, 5.226082147010969e-17_rk, 0.25_rk, 0.25_rk, 2.0437159604434838e-17_rk, -1.0099348371394167e-16_rk, 1.880074869779116e-16_rk,   &
        -0.24999999999999994_rk, -0.75_rk, 2.3906606556388452e-17_rk, 0.24999999999999994_rk, 0.7499999999999998_rk, 1.2555744184274656e-16_rk, -2.5608172287215105e-16_rk, 5.956063094141611e-16_rk,   &
        -6.719776713101756e-18_rk, -1.4257309915101292e-17_rk, -0.7499999999999998_rk, 6.900941693178545e-17_rk, 8.392407841930317e-17_rk, 0.7499999999999999_rk, -0.7499999999999996_rk, 0.7500000000000003_rk,   &
        0.25_rk, 0.24999999999999997_rk, 5.513162912397098e-17_rk, -0.75_rk, -0.7499999999999997_rk, -1.8669278383307874e-16_rk, 2.990297894404272e-16_rk, -3.619610493250364e-16_rk,   &
        0.25_rk, 0.7499999999999998_rk, 5.616850280367424e-17_rk, -0.7499999999999996_rk, -2.2499999999999996_rk, -1.9542759563126296e-16_rk, 4.70706219143831e-16_rk, -1.4135623016798253e-15_rk,   &
        1.1758167425913603e-16_rk, -6.2815423314908e-18_rk, 0.7499999999999997_rk, -2.8383729848777996e-16_rk, -1.5379423220781956e-16_rk, -2.2499999999999996_rk, 0.7499999999999996_rk, -2.25_rk,   &
        -8.017680200221998e-17_rk, -2.1444835944870765e-16_rk, -0.7499999999999994_rk, 1.2555744184274651e-16_rk, 1.5151709956409851e-16_rk, 0.7499999999999994_rk, -2.2499999999999996_rk, 2.2500000000000004_rk,   &
        2.841292718804534e-17_rk, -7.052750536093281e-17_rk, 0.7499999999999997_rk, 9.600594833284066e-17_rk, -3.866060039015555e-16_rk, -2.2499999999999987_rk, 2.25_rk, -6.750000000000001_rk   &
        /),(/8,8/))
        test_dinvmass_dx(:,:,8,3) = reshape((/ &
        0.35355339059327384_rk, 0.1767766952966368_rk, 0.3535533905932736_rk, -0.17677669529663695_rk, -6.245004513516506e-17_rk, -0.17677669529663692_rk, 0.17677669529663692_rk, -2.5673907444456745e-16_rk,   &
        0.1767766952966368_rk, 1.0606601717798212_rk, 0.17677669529663675_rk, 5.898059818321144e-17_rk, -0.5303300858899107_rk, 1.1796119636642288e-16_rk, 1.0606601717798216_rk, -0.5303300858899114_rk,   &
        0.3535533905932737_rk, 0.1767766952966368_rk, 1.0606601717798212_rk, -0.1767766952966369_rk, -9.71445146547012e-17_rk, -0.5303300858899105_rk, 0.5303300858899103_rk, -5.412337245047638e-16_rk,   &
        -0.17677669529663692_rk, 6.591949208711867e-17_rk, -0.17677669529663698_rk, 1.0606601717798212_rk, 0.5303300858899103_rk, 1.0606601717798212_rk, -2.1510571102112408e-16_rk, 0.5303300858899109_rk,   &
        -2.7755575615628914e-17_rk, -0.5303300858899106_rk, 6.245004513516506e-17_rk, 0.53033008588991_rk, 3.1819805153394647_rk, 0.5303300858899103_rk, -0.5303300858899108_rk, 3.181980515339466_rk,   &
        -0.17677669529663695_rk, 1.5265566588595902e-16_rk, -0.5303300858899107_rk, 1.0606601717798214_rk, 0.5303300858899105_rk, 3.1819805153394634_rk, 1.6653345369377348e-16_rk, 1.5909902576697317_rk,   &
        0.1767766952966368_rk, 1.0606601717798214_rk, 0.53033008588991_rk, 3.469446951953614e-17_rk, -0.5303300858899105_rk, 3.469446951953614e-16_rk, 3.1819805153394634_rk, -1.5909902576697323_rk,   &
        -1.6653345369377348e-16_rk, -0.5303300858899105_rk, 3.191891195797325e-16_rk, 0.5303300858899102_rk, 3.1819805153394647_rk, 1.5909902576697303_rk, -1.5909902576697332_rk, 9.545941546018396_rk   &
        /),(/8,8/))
        
        
        
        
        do inode_diff = 1,self%elem%nterms_c 
            do idir =1,3
                @assertEqual(transpose(test_dinvmass_dx(:,:,inode_diff,idir)),self%elem%dinvmass_dx(:,:,inode_diff,idir),tol)
            end do
        end do

    end subroutine testElement_dinvmass_dx
    !*******************************************************************************************








    !> Test cartesian dmass_dx 
    !!
    !!
    !------------------------------------------------------------------------------------------
    @Test
    subroutine testElement_dmass_dx(self)
        class(test_element_linearC_dx),    intent(inout)   :: self
        
        
        real(rk), dimension(self%elem%nterms_s,self%elem%nterms_s,self%elem%nterms_c,3) :: test_dmass_dx
        
        real(rk)        :: tol = 1.e-13_rk
        integer(ik)     :: inode_diff, idir, inode
        
       
        !
        ! dmass_dx
        ! 
        test_dmass_dx(:,:,1,1) = reshape((/ &
        -0.35355339059327373_rk, 0.05892556509887893_rk, 0.11785113019775788_rk, 0.058925565098878946_rk, 8.239936510889834e-18_rk, -0.01964185503295964_rk, -0.01964185503295964_rk, -9.107298248878237e-18_rk,   &
        0.05892556509887893_rk, -0.11785113019775792_rk, -0.01964185503295964_rk, 8.239936510889834e-18_rk, 0.019641855032959645_rk, -9.107298248878237e-18_rk, 0.0392837100659193_rk, -0.006547285010986546_rk,   &
        0.11785113019775788_rk, -0.01964185503295964_rk, -0.11785113019775792_rk, -0.01964185503295964_rk, -9.107298248878237e-18_rk, 0.019641855032959645_rk, 0.019641855032959638_rk, 2.8189256484623115e-18_rk,   &
        0.058925565098878946_rk, 8.239936510889834e-18_rk, -0.01964185503295964_rk, -0.11785113019775792_rk, 0.019641855032959638_rk, 0.0392837100659193_rk, -9.107298248878237e-18_rk, -0.0065472850109865475_rk,   &
        8.239936510889834e-18_rk, 0.019641855032959645_rk, -9.107298248878237e-18_rk, 0.019641855032959638_rk, -0.0392837100659193_rk, -0.006547285010986548_rk, -0.0065472850109865475_rk, 0.0130945700219731_rk,   &
        -0.01964185503295964_rk, -9.107298248878237e-18_rk, 0.019641855032959645_rk, 0.0392837100659193_rk, -0.006547285010986548_rk, -0.0392837100659193_rk, 3.144186300207963e-18_rk, 0.006547285010986547_rk,   &
        -0.01964185503295964_rk, 0.0392837100659193_rk, 0.019641855032959638_rk, -9.107298248878237e-18_rk, -0.0065472850109865475_rk, 3.144186300207963e-18_rk, -0.0392837100659193_rk, 0.006547285010986547_rk,   &
        -9.107298248878237e-18_rk, -0.006547285010986546_rk, 2.8189256484623115e-18_rk, -0.0065472850109865475_rk, 0.0130945700219731_rk, 0.006547285010986547_rk, 0.006547285010986547_rk, -0.0130945700219731_rk   &
        /),(/8,8/))
        test_dmass_dx(:,:,1,2) = reshape((/ &
        -0.24999999999999997_rk, 0.0833333333333333_rk, -1.9954643269744055e-19_rk, 0.08333333333333331_rk, -0.02777777777777777_rk, 1.8499316626105043e-18_rk, 1.4162507936163021e-18_rk, -6.651547756581365e-20_rk,   &
        0.0833333333333333_rk, -0.08333333333333334_rk, 1.4162507936163021e-18_rk, -0.02777777777777777_rk, 0.027777777777777766_rk, -6.651547756581365e-20_rk, 2.9692506053935984e-18_rk, -1.0457994436076056e-18_rk,   &
        -1.9954643269744055e-19_rk, 1.4162507936163021e-18_rk, -0.08333333333333334_rk, 1.8499316626105043e-18_rk, -6.651547756581365e-20_rk, 0.027777777777777766_rk, 0.027777777777777762_rk, -0.009259259259259252_rk,   &
        0.08333333333333331_rk, -0.02777777777777777_rk, 1.8499316626105043e-18_rk, -0.08333333333333334_rk, 0.027777777777777762_rk, 2.9692506053935984e-18_rk, -6.651547756581365e-20_rk, -8.289590091105049e-19_rk,   &
        -0.02777777777777777_rk, 0.027777777777777766_rk, -6.651547756581365e-20_rk, 0.027777777777777762_rk, -0.027777777777777776_rk, -1.913161181596009e-18_rk, -2.1300016160931098e-18_rk, 2.363072953612838e-18_rk,   &
        1.8499316626105043e-18_rk, -6.651547756581365e-20_rk, 0.027777777777777766_rk, 2.9692506053935984e-18_rk, -1.913161181596009e-18_rk, -0.027777777777777776_rk, -0.009259259259259254_rk, 0.009259259259259255_rk,   &
        1.4162507936163021e-18_rk, 2.9692506053935984e-18_rk, 0.027777777777777762_rk, -6.651547756581365e-20_rk, -2.1300016160931098e-18_rk, -0.009259259259259254_rk, -0.027777777777777776_rk, 0.009259259259259255_rk,   &
        -6.651547756581365e-20_rk, -1.0457994436076056e-18_rk, -0.009259259259259252_rk, -8.289590091105049e-19_rk, 2.363072953612838e-18_rk, 0.009259259259259255_rk, 0.009259259259259255_rk, -0.009259259259259257_rk   &
        /),(/8,8/))
        test_dmass_dx(:,:,1,3) = reshape((/ &
        -3.469446951953614e-18_rk, 0.058925565098878974_rk, 2.0816681711721685e-17_rk, -0.058925565098878974_rk, -6.071532165918825e-18_rk, 0.019641855032959652_rk, -0.019641855032959656_rk, 2.3852447794681098e-18_rk,   &
        0.058925565098878974_rk, 8.673617379884035e-19_rk, -0.019641855032959656_rk, -6.071532165918825e-18_rk, -0.019641855032959656_rk, 2.3852447794681098e-18_rk, -4.553649124439119e-18_rk, 0.006547285010986552_rk,   &
        2.0816681711721685e-17_rk, -0.019641855032959656_rk, 8.673617379884035e-19_rk, 0.019641855032959652_rk, 2.3852447794681098e-18_rk, -0.019641855032959656_rk, 0.019641855032959656_rk, -2.168404344971009e-18_rk,   &
        -0.058925565098878974_rk, -6.071532165918825e-18_rk, 0.019641855032959652_rk, 8.673617379884035e-19_rk, 0.019641855032959656_rk, -4.553649124439119e-18_rk, 2.3852447794681098e-18_rk, -0.006547285010986554_rk,   &
        -6.071532165918825e-18_rk, -0.019641855032959656_rk, 2.3852447794681098e-18_rk, 0.019641855032959656_rk, 4.228388472693467e-18_rk, -0.006547285010986552_rk, 0.006547285010986551_rk, 1.5178830414797062e-18_rk,   &
        0.019641855032959652_rk, 2.3852447794681098e-18_rk, -0.019641855032959656_rk, -4.553649124439119e-18_rk, -0.006547285010986552_rk, 4.228388472693467e-18_rk, -2.710505431213761e-18_rk, 0.006547285010986552_rk,   &
        -0.019641855032959656_rk, -4.553649124439119e-18_rk, 0.019641855032959656_rk, 2.3852447794681098e-18_rk, 0.006547285010986551_rk, -2.710505431213761e-18_rk, 4.228388472693467e-18_rk, -0.006547285010986552_rk,   &
        2.3852447794681098e-18_rk, 0.006547285010986552_rk, -2.168404344971009e-18_rk, -0.006547285010986554_rk, 1.5178830414797062e-18_rk, 0.006547285010986552_rk, -0.006547285010986552_rk, -2.710505431213761e-19_rk   &
        /),(/8,8/))
        test_dmass_dx(:,:,2,1) = reshape((/ &
        4.336808689942018e-18_rk, -0.05892556509887893_rk, -1.474514954580286e-17_rk, -0.058925565098878946_rk, -8.239936510889834e-18_rk, 0.01964185503295964_rk, 0.01964185503295964_rk, 5.637851296924623e-18_rk,   &
        -0.05892556509887893_rk, -1.3444106938820255e-17_rk, 0.01964185503295964_rk, -8.239936510889834e-18_rk, -0.01964185503295965_rk, 5.637851296924623e-18_rk, 2.168404344971009e-18_rk, 0.006547285010986547_rk,   &
        -1.474514954580286e-17_rk, 0.01964185503295964_rk, -1.3444106938820255e-17_rk, 0.01964185503295964_rk, 5.637851296924623e-18_rk, -0.01964185503295965_rk, -0.01964185503295965_rk, -1.5178830414797062e-18_rk,   &
        -0.058925565098878946_rk, -8.239936510889834e-18_rk, 0.01964185503295964_rk, -1.3444106938820255e-17_rk, -0.01964185503295965_rk, 2.168404344971009e-18_rk, 5.637851296924623e-18_rk, 0.006547285010986548_rk,   &
        -8.239936510889834e-18_rk, -0.01964185503295965_rk, 5.637851296924623e-18_rk, -0.01964185503295965_rk, 3.2526065174565133e-19_rk, 0.006547285010986548_rk, 0.006547285010986549_rk, 1.3010426069826053e-18_rk,   &
        0.01964185503295964_rk, 5.637851296924623e-18_rk, -0.01964185503295965_rk, 2.168404344971009e-18_rk, 0.006547285010986548_rk, 3.2526065174565133e-19_rk, -1.8431436932253575e-18_rk, -0.0065472850109865475_rk,   &
        0.01964185503295964_rk, 2.168404344971009e-18_rk, -0.01964185503295965_rk, 5.637851296924623e-18_rk, 0.006547285010986549_rk, -1.8431436932253575e-18_rk, 3.2526065174565133e-19_rk, -0.0065472850109865475_rk,   &
        5.637851296924623e-18_rk, 0.006547285010986547_rk, -1.5178830414797062e-18_rk, 0.006547285010986548_rk, 1.3010426069826053e-18_rk, -0.0065472850109865475_rk, -0.0065472850109865475_rk, -1.1384122811097797e-18_rk   &
        /),(/8,8/))
        test_dmass_dx(:,:,2,2) = reshape((/ &
        -0.24999999999999997_rk, 0.08333333333333331_rk, 7.011932967509053e-18_rk, -0.08333333333333334_rk, 0.027777777777777773_rk, 5.162001304898549e-18_rk, -3.0779352059912845e-18_rk, -5.17982407339648e-18_rk,   &
        0.08333333333333331_rk, -0.08333333333333334_rk, -3.0779352059912845e-18_rk, 0.027777777777777773_rk, -0.027777777777777773_rk, -5.17982407339648e-18_rk, 3.9274741754817575e-18_rk, 3.6722310121067576e-18_rk,   &
        7.011932967509053e-18_rk, -3.0779352059912845e-18_rk, -0.08333333333333334_rk, 5.162001304898549e-18_rk, -5.17982407339648e-18_rk, -0.027777777777777773_rk, 0.027777777777777762_rk, 0.009259259259259254_rk,   &
        -0.08333333333333334_rk, 0.027777777777777773_rk, 5.162001304898549e-18_rk, -0.08333333333333334_rk, 0.027777777777777762_rk, 3.9274741754817575e-18_rk, -5.17982407339648e-18_rk, -3.483503326297572e-18_rk,   &
        0.027777777777777773_rk, -0.027777777777777773_rk, -5.17982407339648e-18_rk, 0.027777777777777762_rk, -0.027777777777777776_rk, -4.134024629788874e-18_rk, 3.8890714466038585e-18_rk, 3.2607219689678274e-18_rk,   &
        5.162001304898549e-18_rk, -5.17982407339648e-18_rk, -0.027777777777777773_rk, 3.9274741754817575e-18_rk, -4.134024629788874e-18_rk, -0.027777777777777776_rk, 0.009259259259259255_rk, 0.009259259259259254_rk,   &
        -3.0779352059912845e-18_rk, 3.9274741754817575e-18_rk, 0.027777777777777762_rk, -5.17982407339648e-18_rk, 3.8890714466038585e-18_rk, 0.009259259259259255_rk, -0.027777777777777776_rk, -0.009259259259259259_rk,   &
        -5.17982407339648e-18_rk, 3.6722310121067576e-18_rk, 0.009259259259259254_rk, -3.483503326297572e-18_rk, 3.2607219689678274e-18_rk, 0.009259259259259254_rk, -0.009259259259259259_rk, -0.009259259259259257_rk   &
        /),(/8,8/))
        test_dmass_dx(:,:,2,3) = reshape((/ &
        0.35355339059327384_rk, -0.058925565098878946_rk, -0.11785113019775792_rk, 0.058925565098878974_rk, 6.071532165918825e-18_rk, -0.019641855032959652_rk, 0.01964185503295964_rk, 2.168404344971009e-19_rk,   &
        -0.058925565098878946_rk, 0.11785113019775793_rk, 0.01964185503295964_rk, 6.071532165918825e-18_rk, 0.019641855032959656_rk, 2.168404344971009e-19_rk, -0.0392837100659193_rk, -0.006547285010986554_rk,   &
        -0.11785113019775792_rk, 0.01964185503295964_rk, 0.11785113019775793_rk, -0.019641855032959652_rk, 2.168404344971009e-19_rk, 0.019641855032959656_rk, -0.019641855032959635_rk, 8.673617379884035e-19_rk,   &
        0.058925565098878974_rk, 6.071532165918825e-18_rk, -0.019641855032959652_rk, 0.11785113019775793_rk, -0.019641855032959635_rk, -0.0392837100659193_rk, 2.168404344971009e-19_rk, 0.006547285010986549_rk,   &
        6.071532165918825e-18_rk, 0.019641855032959656_rk, 2.168404344971009e-19_rk, -0.019641855032959635_rk, 0.03928371006591931_rk, 0.006547285010986547_rk, -0.006547285010986552_rk, -0.0130945700219731_rk,   &
        -0.019641855032959652_rk, 2.168404344971009e-19_rk, 0.019641855032959656_rk, -0.0392837100659193_rk, 0.006547285010986547_rk, 0.03928371006591931_rk, 1.8431436932253575e-18_rk, -0.0065472850109865475_rk,   &
        0.01964185503295964_rk, -0.0392837100659193_rk, -0.019641855032959635_rk, 2.168404344971009e-19_rk, -0.006547285010986552_rk, 1.8431436932253575e-18_rk, 0.03928371006591931_rk, 0.006547285010986552_rk,   &
        2.168404344971009e-19_rk, -0.006547285010986554_rk, 8.673617379884035e-19_rk, 0.006547285010986549_rk, -0.0130945700219731_rk, -0.0065472850109865475_rk, 0.006547285010986552_rk, 0.0130945700219731_rk   &
        /),(/8,8/))
        test_dmass_dx(:,:,3,1) = reshape((/ &
        0.35355339059327373_rk, 0.05892556509887896_rk, -0.11785113019775786_rk, 0.058925565098878946_rk, -2.168404344971009e-18_rk, -0.01964185503295965_rk, -0.01964185503295965_rk, 4.336808689942018e-19_rk,   &
        0.05892556509887896_rk, 0.11785113019775792_rk, -0.01964185503295965_rk, -2.168404344971009e-18_rk, 0.019641855032959652_rk, 4.336808689942018e-19_rk, -0.0392837100659193_rk, -0.00654728501098655_rk,   &
        -0.11785113019775786_rk, -0.01964185503295965_rk, 0.11785113019775792_rk, -0.01964185503295965_rk, 4.336808689942018e-19_rk, 0.019641855032959652_rk, 0.01964185503295966_rk, -2.8189256484623115e-18_rk,   &
        0.058925565098878946_rk, -2.168404344971009e-18_rk, -0.01964185503295965_rk, 0.11785113019775792_rk, 0.01964185503295966_rk, -0.0392837100659193_rk, 4.336808689942018e-19_rk, -0.006547285010986549_rk,   &
        -2.168404344971009e-18_rk, 0.019641855032959652_rk, 4.336808689942018e-19_rk, 0.01964185503295966_rk, 0.0392837100659193_rk, -0.00654728501098655_rk, -0.00654728501098655_rk, -0.013094570021973102_rk,   &
        -0.01964185503295965_rk, 4.336808689942018e-19_rk, 0.019641855032959652_rk, -0.0392837100659193_rk, -0.00654728501098655_rk, 0.0392837100659193_rk, -1.1926223897340549e-18_rk, 0.00654728501098655_rk,   &
        -0.01964185503295965_rk, -0.0392837100659193_rk, 0.01964185503295966_rk, 4.336808689942018e-19_rk, -0.00654728501098655_rk, -1.1926223897340549e-18_rk, 0.0392837100659193_rk, 0.006547285010986548_rk,   &
        4.336808689942018e-19_rk, -0.00654728501098655_rk, -2.8189256484623115e-18_rk, -0.006547285010986549_rk, -0.013094570021973102_rk, 0.00654728501098655_rk, 0.006547285010986548_rk, 0.0130945700219731_rk   &
        /),(/8,8/))
        test_dmass_dx(:,:,3,2) = reshape((/ &
        -0.25_rk, -0.08333333333333333_rk, -1.729376645427428e-17_rk, -0.08333333333333333_rk, -0.027777777777777787_rk, -6.969763844477182e-18_rk, -7.403444713471382e-18_rk, -1.7169007074788762e-18_rk,   &
        -0.08333333333333333_rk, -0.08333333333333334_rk, -7.403444713471382e-18_rk, -0.027777777777777787_rk, -0.027777777777777776_rk, -1.7169007074788762e-18_rk, 1.3188653754805354e-18_rk, 6.402313233013184e-19_rk,   &
        -1.729376645427428e-17_rk, -7.403444713471382e-18_rk, -0.08333333333333334_rk, -6.969763844477182e-18_rk, -1.7169007074788762e-18_rk, -0.027777777777777776_rk, -0.02777777777777778_rk, -0.009259259259259262_rk,   &
        -0.08333333333333333_rk, -0.027777777777777787_rk, -6.969763844477182e-18_rk, -0.08333333333333334_rk, -0.02777777777777778_rk, 1.3188653754805354e-18_rk, -1.7169007074788762e-18_rk, 8.570717577984195e-19_rk,   &
        -0.027777777777777787_rk, -0.027777777777777776_rk, -1.7169007074788762e-18_rk, -0.02777777777777778_rk, -0.027777777777777783_rk, 2.3749547992781257e-18_rk, 2.1581143647810248e-18_rk, 2.391185702300753e-18_rk,   &
        -6.969763844477182e-18_rk, -1.7169007074788762e-18_rk, -0.027777777777777776_rk, 1.3188653754805354e-18_rk, 2.3749547992781257e-18_rk, -0.027777777777777783_rk, -0.009259259259259259_rk, -0.009259259259259259_rk,   &
        -7.403444713471382e-18_rk, 1.3188653754805354e-18_rk, -0.02777777777777778_rk, -1.7169007074788762e-18_rk, 2.1581143647810248e-18_rk, -0.009259259259259259_rk, -0.027777777777777783_rk, -0.009259259259259257_rk,   &
        -1.7169007074788762e-18_rk, 6.402313233013184e-19_rk, -0.009259259259259262_rk, 8.570717577984195e-19_rk, 2.391185702300753e-18_rk, -0.009259259259259259_rk, -0.009259259259259257_rk, -0.009259259259259257_rk   &
        /),(/8,8/))
        test_dmass_dx(:,:,3,3) = reshape((/ &
        1.0408340855860843e-17_rk, 0.05892556509887896_rk, -2.0816681711721685e-17_rk, -0.05892556509887896_rk, -8.673617379884035e-19_rk, 0.01964185503295965_rk, -0.01964185503295964_rk, -2.168404344971009e-19_rk,   &
        0.05892556509887896_rk, 4.336808689942018e-18_rk, -0.01964185503295964_rk, -8.673617379884035e-19_rk, -0.01964185503295965_rk, -2.168404344971009e-19_rk, 2.3852447794681098e-18_rk, 0.006547285010986552_rk,   &
        -2.0816681711721685e-17_rk, -0.01964185503295964_rk, 4.336808689942018e-18_rk, 0.01964185503295965_rk, -2.168404344971009e-19_rk, -0.01964185503295965_rk, 0.01964185503295964_rk, -8.673617379884035e-19_rk,   &
        -0.05892556509887896_rk, -8.673617379884035e-19_rk, 0.01964185503295965_rk, 4.336808689942018e-18_rk, 0.01964185503295964_rk, 2.3852447794681098e-18_rk, -2.168404344971009e-19_rk, -0.006547285010986552_rk,   &
        -8.673617379884035e-19_rk, -0.01964185503295965_rk, -2.168404344971009e-19_rk, 0.01964185503295964_rk, -2.2768245622195593e-18_rk, -0.00654728501098655_rk, 0.006547285010986552_rk, -1.0842021724855044e-18_rk,   &
        0.01964185503295965_rk, -2.168404344971009e-19_rk, -0.01964185503295965_rk, 2.3852447794681098e-18_rk, -0.00654728501098655_rk, -2.2768245622195593e-18_rk, -5.421010862427522e-19_rk, 0.00654728501098655_rk,   &
        -0.01964185503295964_rk, 2.3852447794681098e-18_rk, 0.01964185503295964_rk, -2.168404344971009e-19_rk, 0.006547285010986552_rk, -5.421010862427522e-19_rk, -2.2768245622195593e-18_rk, -0.00654728501098655_rk,   &
        -2.168404344971009e-19_rk, 0.006547285010986552_rk, -8.673617379884035e-19_rk, -0.006547285010986552_rk, -1.0842021724855044e-18_rk, 0.00654728501098655_rk, -0.00654728501098655_rk, -5.421010862427522e-20_rk   &
        /),(/8,8/))
        test_dmass_dx(:,:,4,1) = reshape((/ &
        -2.6020852139652106e-18_rk, -0.05892556509887896_rk, 1.9949319973733282e-17_rk, -0.058925565098878946_rk, 2.168404344971009e-18_rk, 0.01964185503295965_rk, 0.01964185503295965_rk, 3.0357660829594124e-18_rk,   &
        -0.05892556509887896_rk, 4.336808689942018e-19_rk, 0.01964185503295965_rk, 2.168404344971009e-18_rk, -0.01964185503295965_rk, 3.0357660829594124e-18_rk, 2.168404344971009e-18_rk, 0.006547285010986548_rk,   &
        1.9949319973733282e-17_rk, 0.01964185503295965_rk, 4.336808689942018e-19_rk, 0.01964185503295965_rk, 3.0357660829594124e-18_rk, -0.01964185503295965_rk, -0.01964185503295965_rk, 1.5178830414797062e-18_rk,   &
        -0.058925565098878946_rk, 2.168404344971009e-18_rk, 0.01964185503295965_rk, 4.336808689942018e-19_rk, -0.01964185503295965_rk, 2.168404344971009e-18_rk, 3.0357660829594124e-18_rk, 0.006547285010986549_rk,   &
        2.168404344971009e-18_rk, -0.01964185503295965_rk, 3.0357660829594124e-18_rk, -0.01964185503295965_rk, -6.179952383167375e-18_rk, 0.00654728501098655_rk, 0.006547285010986549_rk, -4.336808689942018e-19_rk,   &
        0.01964185503295965_rk, 3.0357660829594124e-18_rk, -0.01964185503295965_rk, 2.168404344971009e-18_rk, 0.00654728501098655_rk, -6.179952383167375e-18_rk, -1.0842021724855044e-19_rk, -0.006547285010986549_rk,   &
        0.01964185503295965_rk, 2.168404344971009e-18_rk, -0.01964185503295965_rk, 3.0357660829594124e-18_rk, 0.006547285010986549_rk, -1.0842021724855044e-19_rk, -6.179952383167375e-18_rk, -0.0065472850109865475_rk,   &
        3.0357660829594124e-18_rk, 0.006547285010986548_rk, 1.5178830414797062e-18_rk, 0.006547285010986549_rk, -4.336808689942018e-19_rk, -0.006547285010986549_rk, -0.0065472850109865475_rk, -2.710505431213761e-19_rk   &
        /),(/8,8/))
        test_dmass_dx(:,:,4,2) = reshape((/ &
        -0.25_rk, -0.08333333333333336_rk, -3.3964078883517895e-18_rk, 0.08333333333333331_rk, 0.027777777777777783_rk, -4.2169123031871686e-20_rk, 2.1262352219391364e-18_rk, -6.914547549373287e-18_rk,   &
        -0.08333333333333336_rk, -0.08333333333333334_rk, 2.1262352219391364e-18_rk, 0.027777777777777783_rk, 0.027777777777777773_rk, -6.914547549373287e-18_rk, 5.662197651458565e-18_rk, -3.2666628918004708e-18_rk,   &
        -3.3964078883517895e-18_rk, 2.1262352219391364e-18_rk, -0.08333333333333334_rk, -4.2169123031871686e-20_rk, -6.914547549373287e-18_rk, 0.027777777777777773_rk, -0.027777777777777783_rk, 0.009259259259259259_rk,   &
        0.08333333333333331_rk, 0.027777777777777783_rk, -4.2169123031871686e-20_rk, -0.08333333333333334_rk, -0.027777777777777783_rk, 5.662197651458565e-18_rk, -6.914547549373287e-18_rk, 3.4553905776096567e-18_rk,   &
        0.027777777777777783_rk, 0.027777777777777773_rk, -6.914547549373287e-18_rk, -0.027777777777777783_rk, -0.027777777777777783_rk, 3.6722310121067576e-18_rk, -3.9171841952917734e-18_rk, 4.128083706956231e-18_rk,   &
        -4.2169123031871686e-20_rk, -6.914547549373287e-18_rk, 0.027777777777777773_rk, 5.662197651458565e-18_rk, 3.6722310121067576e-18_rk, -0.027777777777777783_rk, 0.009259259259259257_rk, -0.009259259259259259_rk,   &
        2.1262352219391364e-18_rk, 5.662197651458565e-18_rk, -0.027777777777777783_rk, -6.914547549373287e-18_rk, -3.9171841952917734e-18_rk, 0.009259259259259257_rk, -0.027777777777777783_rk, 0.009259259259259255_rk,   &
        -6.914547549373287e-18_rk, -3.2666628918004708e-18_rk, 0.009259259259259259_rk, 3.4553905776096567e-18_rk, 4.128083706956231e-18_rk, -0.009259259259259259_rk, 0.009259259259259255_rk, -0.009259259259259257_rk   &
        /),(/8,8/))
        test_dmass_dx(:,:,4,3) = reshape((/ &
        -0.35355339059327384_rk, -0.05892556509887899_rk, 0.11785113019775792_rk, 0.05892556509887896_rk, 8.673617379884035e-19_rk, -0.01964185503295965_rk, 0.019641855032959656_rk, -2.3852447794681098e-18_rk,   &
        -0.05892556509887899_rk, -0.11785113019775793_rk, 0.019641855032959656_rk, 8.673617379884035e-19_rk, 0.01964185503295965_rk, -2.3852447794681098e-18_rk, 0.0392837100659193_rk, -0.00654728501098655_rk,   &
        0.11785113019775792_rk, 0.019641855032959656_rk, -0.11785113019775793_rk, -0.01964185503295965_rk, -2.3852447794681098e-18_rk, 0.01964185503295965_rk, -0.019641855032959663_rk, 2.168404344971009e-18_rk,   &
        0.05892556509887896_rk, 8.673617379884035e-19_rk, -0.01964185503295965_rk, -0.11785113019775793_rk, -0.019641855032959663_rk, 0.0392837100659193_rk, -2.3852447794681098e-18_rk, 0.006547285010986555_rk,   &
        8.673617379884035e-19_rk, 0.01964185503295965_rk, -2.3852447794681098e-18_rk, -0.019641855032959663_rk, -0.03928371006591931_rk, 0.0065472850109865545_rk, -0.00654728501098655_rk, 0.0130945700219731_rk,   &
        -0.01964185503295965_rk, -2.3852447794681098e-18_rk, 0.01964185503295965_rk, 0.0392837100659193_rk, 0.0065472850109865545_rk, -0.03928371006591931_rk, 1.4094628242311558e-18_rk, -0.0065472850109865545_rk,   &
        0.019641855032959656_rk, 0.0392837100659193_rk, -0.019641855032959663_rk, -2.3852447794681098e-18_rk, -0.00654728501098655_rk, 1.4094628242311558e-18_rk, -0.03928371006591931_rk, 0.00654728501098655_rk,   &
        -2.3852447794681098e-18_rk, -0.00654728501098655_rk, 2.168404344971009e-18_rk, 0.006547285010986555_rk, 0.0130945700219731_rk, -0.0065472850109865545_rk, 0.00654728501098655_rk, -0.0130945700219731_rk   &
        /),(/8,8/))
        test_dmass_dx(:,:,5,1) = reshape((/ &
        -0.35355339059327373_rk, 0.05892556509887893_rk, -0.11785113019775788_rk, 0.058925565098878946_rk, -1.3010426069826053e-18_rk, 0.019641855032959652_rk, 0.01964185503295965_rk, -1.3010426069826053e-18_rk,   &
        0.05892556509887893_rk, -0.11785113019775792_rk, 0.01964185503295965_rk, -1.3010426069826053e-18_rk, 0.019641855032959645_rk, -1.3010426069826053e-18_rk, -0.0392837100659193_rk, 0.00654728501098655_rk,   &
        -0.11785113019775788_rk, 0.01964185503295965_rk, -0.11785113019775792_rk, 0.019641855032959652_rk, -1.3010426069826053e-18_rk, 0.019641855032959645_rk, 0.019641855032959638_rk, -6.505213034913027e-19_rk,   &
        0.058925565098878946_rk, -1.3010426069826053e-18_rk, 0.019641855032959652_rk, -0.11785113019775792_rk, 0.019641855032959638_rk, -0.0392837100659193_rk, -1.3010426069826053e-18_rk, 0.006547285010986546_rk,   &
        -1.3010426069826053e-18_rk, 0.019641855032959645_rk, -1.3010426069826053e-18_rk, 0.019641855032959638_rk, -0.0392837100659193_rk, 0.0065472850109865475_rk, 0.006547285010986552_rk, -0.013094570021973097_rk,   &
        0.019641855032959652_rk, -1.3010426069826053e-18_rk, 0.019641855032959645_rk, -0.0392837100659193_rk, 0.0065472850109865475_rk, -0.0392837100659193_rk, 7.589415207398531e-19_rk, 0.006547285010986547_rk,   &
        0.01964185503295965_rk, -0.0392837100659193_rk, 0.019641855032959638_rk, -1.3010426069826053e-18_rk, 0.006547285010986552_rk, 7.589415207398531e-19_rk, -0.0392837100659193_rk, 0.006547285010986548_rk,   &
        -1.3010426069826053e-18_rk, 0.00654728501098655_rk, -6.505213034913027e-19_rk, 0.006547285010986546_rk, -0.013094570021973097_rk, 0.006547285010986547_rk, 0.006547285010986548_rk, -0.0130945700219731_rk   &
        /),(/8,8/))
        test_dmass_dx(:,:,5,2) = reshape((/ &
        0.24999999999999997_rk, -0.08333333333333331_rk, 1.9954643269744055e-19_rk, -0.08333333333333333_rk, 0.027777777777777773_rk, -1.8499316626105035e-18_rk, -1.4162507936163021e-18_rk, 6.651547756581288e-20_rk,   &
        -0.08333333333333331_rk, 0.08333333333333334_rk, -1.4162507936163021e-18_rk, 0.027777777777777773_rk, -0.027777777777777766_rk, 6.651547756581288e-20_rk, -2.9692506053935984e-18_rk, 1.0457994436076056e-18_rk,   &
        1.9954643269744055e-19_rk, -1.4162507936163021e-18_rk, 0.08333333333333334_rk, -1.8499316626105035e-18_rk, 6.651547756581288e-20_rk, -0.027777777777777766_rk, -0.027777777777777762_rk, 0.009259259259259252_rk,   &
        -0.08333333333333333_rk, 0.027777777777777773_rk, -1.8499316626105035e-18_rk, 0.08333333333333334_rk, -0.027777777777777762_rk, -2.9692506053935984e-18_rk, 6.651547756581288e-20_rk, 8.289590091105045e-19_rk,   &
        0.027777777777777773_rk, -0.027777777777777766_rk, 6.651547756581288e-20_rk, -0.027777777777777762_rk, 0.027777777777777776_rk, 1.913161181596009e-18_rk, 2.1300016160931098e-18_rk, -2.363072953612838e-18_rk,   &
        -1.8499316626105035e-18_rk, 6.651547756581288e-20_rk, -0.027777777777777766_rk, -2.9692506053935984e-18_rk, 1.913161181596009e-18_rk, 0.027777777777777776_rk, 0.009259259259259255_rk, -0.009259259259259255_rk,   &
        -1.4162507936163021e-18_rk, -2.9692506053935984e-18_rk, -0.027777777777777762_rk, 6.651547756581288e-20_rk, 2.1300016160931098e-18_rk, 0.009259259259259255_rk, 0.027777777777777776_rk, -0.009259259259259257_rk,   &
        6.651547756581288e-20_rk, 1.0457994436076056e-18_rk, 0.009259259259259252_rk, 8.289590091105045e-19_rk, -2.363072953612838e-18_rk, -0.009259259259259255_rk, -0.009259259259259257_rk, 0.009259259259259257_rk   &
        /),(/8,8/))
        test_dmass_dx(:,:,5,3) = reshape((/ &
        1.0408340855860843e-17_rk, 0.058925565098878974_rk, -6.938893903907228e-18_rk, -0.058925565098878974_rk, -4.336808689942018e-18_rk, -0.019641855032959656_rk, 0.019641855032959656_rk, -2.3852447794681098e-18_rk,   &
        0.058925565098878974_rk, 2.6020852139652106e-18_rk, 0.019641855032959656_rk, -4.336808689942018e-18_rk, -0.019641855032959656_rk, -2.3852447794681098e-18_rk, 4.553649124439119e-18_rk, -0.006547285010986551_rk,   &
        -6.938893903907228e-18_rk, 0.019641855032959656_rk, 2.6020852139652106e-18_rk, -0.019641855032959656_rk, -2.3852447794681098e-18_rk, -0.019641855032959656_rk, 0.019641855032959656_rk, -2.168404344971009e-18_rk,   &
        -0.058925565098878974_rk, -4.336808689942018e-18_rk, -0.019641855032959656_rk, 2.6020852139652106e-18_rk, 0.019641855032959656_rk, 4.553649124439119e-18_rk, -2.3852447794681098e-18_rk, 0.006547285010986552_rk,   &
        -4.336808689942018e-18_rk, -0.019641855032959656_rk, -2.3852447794681098e-18_rk, 0.019641855032959656_rk, 4.0115480381963664e-18_rk, 0.006547285010986552_rk, -0.006547285010986554_rk, 2.168404344971009e-19_rk,   &
        -0.019641855032959656_rk, -2.3852447794681098e-18_rk, -0.019641855032959656_rk, 4.553649124439119e-18_rk, 0.006547285010986552_rk, 4.0115480381963664e-18_rk, -1.1926223897340549e-18_rk, 0.006547285010986552_rk,   &
        0.019641855032959656_rk, 4.553649124439119e-18_rk, 0.019641855032959656_rk, -2.3852447794681098e-18_rk, -0.006547285010986554_rk, -1.1926223897340549e-18_rk, 4.0115480381963664e-18_rk, -0.006547285010986552_rk,   &
        -2.3852447794681098e-18_rk, -0.006547285010986551_rk, -2.168404344971009e-18_rk, 0.006547285010986552_rk, 2.168404344971009e-19_rk, 0.006547285010986552_rk, -0.006547285010986552_rk, 2.710505431213761e-19_rk   &
        /),(/8,8/))
        test_dmass_dx(:,:,6,1) = reshape((/ &
        -7.806255641895632e-18_rk, -0.05892556509887893_rk, 8.673617379884035e-19_rk, -0.058925565098878946_rk, 1.3010426069826053e-18_rk, -0.019641855032959652_rk, -0.01964185503295965_rk, -2.168404344971009e-18_rk,   &
        -0.05892556509887893_rk, -1.2576745200831851e-17_rk, -0.01964185503295965_rk, 1.3010426069826053e-18_rk, -0.01964185503295965_rk, -2.168404344971009e-18_rk, -2.168404344971009e-18_rk, -0.006547285010986549_rk,   &
        8.673617379884035e-19_rk, -0.01964185503295965_rk, -1.2576745200831851e-17_rk, -0.019641855032959652_rk, -2.168404344971009e-18_rk, -0.01964185503295965_rk, -0.01964185503295965_rk, 1.0842021724855044e-18_rk,   &
        -0.058925565098878946_rk, 1.3010426069826053e-18_rk, -0.019641855032959652_rk, -1.2576745200831851e-17_rk, -0.01964185503295965_rk, -2.168404344971009e-18_rk, -2.168404344971009e-18_rk, -0.0065472850109865475_rk,   &
        1.3010426069826053e-18_rk, -0.01964185503295965_rk, -2.168404344971009e-18_rk, -0.01964185503295965_rk, 9.75781955236954e-19_rk, -0.00654728501098655_rk, -0.006547285010986551_rk, -1.3010426069826053e-18_rk,   &
        -0.019641855032959652_rk, -2.168404344971009e-18_rk, -0.01964185503295965_rk, -2.168404344971009e-18_rk, -0.00654728501098655_rk, 9.75781955236954e-19_rk, -3.2526065174565133e-19_rk, -0.0065472850109865475_rk,   &
        -0.01964185503295965_rk, -2.168404344971009e-18_rk, -0.01964185503295965_rk, -2.168404344971009e-18_rk, -0.006547285010986551_rk, -3.2526065174565133e-19_rk, 9.75781955236954e-19_rk, -0.006547285010986549_rk,   &
        -2.168404344971009e-18_rk, -0.006547285010986549_rk, 1.0842021724855044e-18_rk, -0.0065472850109865475_rk, -1.3010426069826053e-18_rk, -0.0065472850109865475_rk, -0.006547285010986549_rk, -2.0057740190981832e-18_rk   &
        /),(/8,8/))
        test_dmass_dx(:,:,6,2) = reshape((/ &
        0.24999999999999997_rk, -0.08333333333333331_rk, -7.011932967509053e-18_rk, 0.08333333333333333_rk, -0.027777777777777776_rk, -5.1620013048985496e-18_rk, 3.0779352059912845e-18_rk, 5.17982407339648e-18_rk,   &
        -0.08333333333333331_rk, 0.08333333333333334_rk, 3.0779352059912845e-18_rk, -0.027777777777777776_rk, 0.027777777777777773_rk, 5.17982407339648e-18_rk, -3.9274741754817575e-18_rk, -3.6722310121067576e-18_rk,   &
        -7.011932967509053e-18_rk, 3.0779352059912845e-18_rk, 0.08333333333333334_rk, -5.1620013048985496e-18_rk, 5.17982407339648e-18_rk, 0.027777777777777773_rk, -0.027777777777777762_rk, -0.009259259259259255_rk,   &
        0.08333333333333333_rk, -0.027777777777777776_rk, -5.1620013048985496e-18_rk, 0.08333333333333334_rk, -0.027777777777777762_rk, -3.9274741754817575e-18_rk, 5.17982407339648e-18_rk, 3.483503326297572e-18_rk,   &
        -0.027777777777777776_rk, 0.027777777777777773_rk, 5.17982407339648e-18_rk, -0.027777777777777762_rk, 0.027777777777777776_rk, 4.134024629788874e-18_rk, -3.8890714466038585e-18_rk, -3.2607219689678274e-18_rk,   &
        -5.1620013048985496e-18_rk, 5.17982407339648e-18_rk, 0.027777777777777773_rk, -3.9274741754817575e-18_rk, 4.134024629788874e-18_rk, 0.027777777777777776_rk, -0.009259259259259257_rk, -0.009259259259259255_rk,   &
        3.0779352059912845e-18_rk, -3.9274741754817575e-18_rk, -0.027777777777777762_rk, 5.17982407339648e-18_rk, -3.8890714466038585e-18_rk, -0.009259259259259257_rk, 0.027777777777777776_rk, 0.009259259259259257_rk,   &
        5.17982407339648e-18_rk, -3.6722310121067576e-18_rk, -0.009259259259259255_rk, 3.483503326297572e-18_rk, -3.2607219689678274e-18_rk, -0.009259259259259255_rk, 0.009259259259259257_rk, 0.009259259259259257_rk   &
        /),(/8,8/))
        test_dmass_dx(:,:,6,3) = reshape((/ &
        0.35355339059327384_rk, -0.058925565098878946_rk, 0.11785113019775789_rk, 0.058925565098878974_rk, 4.336808689942018e-18_rk, 0.019641855032959656_rk, -0.01964185503295964_rk, 3.2526065174565133e-18_rk,   &
        -0.058925565098878946_rk, 0.11785113019775793_rk, -0.01964185503295964_rk, 4.336808689942018e-18_rk, 0.019641855032959656_rk, 3.2526065174565133e-18_rk, 0.039283710065919304_rk, 0.006547285010986551_rk,   &
        0.11785113019775789_rk, -0.01964185503295964_rk, 0.11785113019775793_rk, 0.019641855032959656_rk, 3.2526065174565133e-18_rk, 0.019641855032959656_rk, -0.019641855032959635_rk, 1.734723475976807e-18_rk,   &
        0.058925565098878974_rk, 4.336808689942018e-18_rk, 0.019641855032959656_rk, 0.11785113019775793_rk, -0.019641855032959635_rk, 0.039283710065919304_rk, 3.2526065174565133e-18_rk, -0.006547285010986547_rk,   &
        4.336808689942018e-18_rk, 0.019641855032959656_rk, 3.2526065174565133e-18_rk, -0.019641855032959635_rk, 0.03928371006591931_rk, -0.006547285010986548_rk, 0.006547285010986554_rk, 0.013094570021973102_rk,   &
        0.019641855032959656_rk, 3.2526065174565133e-18_rk, 0.019641855032959656_rk, 0.039283710065919304_rk, -0.006547285010986548_rk, 0.03928371006591931_rk, 2.0599841277224584e-18_rk, -0.0065472850109865475_rk,   &
        -0.01964185503295964_rk, 0.039283710065919304_rk, -0.019641855032959635_rk, 3.2526065174565133e-18_rk, 0.006547285010986554_rk, 2.0599841277224584e-18_rk, 0.03928371006591931_rk, 0.006547285010986552_rk,   &
        3.2526065174565133e-18_rk, 0.006547285010986551_rk, 1.734723475976807e-18_rk, -0.006547285010986547_rk, 0.013094570021973102_rk, -0.0065472850109865475_rk, 0.006547285010986552_rk, 0.0130945700219731_rk   &
        /),(/8,8/))
        test_dmass_dx(:,:,7,1) = reshape((/ &
        0.35355339059327373_rk, 0.05892556509887896_rk, 0.11785113019775789_rk, 0.058925565098878946_rk, 5.637851296924623e-18_rk, 0.01964185503295965_rk, 0.019641855032959656_rk, 6.5052130349130266e-18_rk,   &
        0.05892556509887896_rk, 0.11785113019775792_rk, 0.019641855032959656_rk, 5.637851296924623e-18_rk, 0.019641855032959652_rk, 6.5052130349130266e-18_rk, 0.0392837100659193_rk, 0.006547285010986548_rk,   &
        0.11785113019775789_rk, 0.019641855032959656_rk, 0.11785113019775792_rk, 0.01964185503295965_rk, 6.5052130349130266e-18_rk, 0.019641855032959652_rk, 0.01964185503295966_rk, -2.168404344971009e-19_rk,   &
        0.058925565098878946_rk, 5.637851296924623e-18_rk, 0.01964185503295965_rk, 0.11785113019775792_rk, 0.01964185503295966_rk, 0.0392837100659193_rk, 6.5052130349130266e-18_rk, 0.006547285010986551_rk,   &
        5.637851296924623e-18_rk, 0.019641855032959652_rk, 6.5052130349130266e-18_rk, 0.01964185503295966_rk, 0.0392837100659193_rk, 0.006547285010986555_rk, 0.006547285010986551_rk, 0.013094570021973097_rk,   &
        0.01964185503295965_rk, 6.5052130349130266e-18_rk, 0.019641855032959652_rk, 0.0392837100659193_rk, 0.006547285010986555_rk, 0.0392837100659193_rk, 1.6263032587282567e-18_rk, 0.00654728501098655_rk,   &
        0.019641855032959656_rk, 0.0392837100659193_rk, 0.01964185503295966_rk, 6.5052130349130266e-18_rk, 0.006547285010986551_rk, 1.6263032587282567e-18_rk, 0.0392837100659193_rk, 0.00654728501098655_rk,   &
        6.5052130349130266e-18_rk, 0.006547285010986548_rk, -2.168404344971009e-19_rk, 0.006547285010986551_rk, 0.013094570021973097_rk, 0.00654728501098655_rk, 0.00654728501098655_rk, 0.0130945700219731_rk   &
        /),(/8,8/))
        test_dmass_dx(:,:,7,2) = reshape((/ &
        0.25_rk, 0.08333333333333336_rk, 1.729376645427428e-17_rk, 0.08333333333333334_rk, 0.02777777777777779_rk, 6.969763844477182e-18_rk, 7.403444713471382e-18_rk, 1.716900707478877e-18_rk,   &
        0.08333333333333336_rk, 0.08333333333333334_rk, 7.403444713471382e-18_rk, 0.02777777777777779_rk, 0.027777777777777783_rk, 1.716900707478877e-18_rk, -1.3188653754805354e-18_rk, -6.402313233013184e-19_rk,   &
        1.729376645427428e-17_rk, 7.403444713471382e-18_rk, 0.08333333333333334_rk, 6.969763844477182e-18_rk, 1.716900707478877e-18_rk, 0.027777777777777783_rk, 0.027777777777777787_rk, 0.009259259259259262_rk,   &
        0.08333333333333334_rk, 0.02777777777777779_rk, 6.969763844477182e-18_rk, 0.08333333333333334_rk, 0.027777777777777787_rk, -1.3188653754805354e-18_rk, 1.716900707478877e-18_rk, -8.570717577984191e-19_rk,   &
        0.02777777777777779_rk, 0.027777777777777783_rk, 1.716900707478877e-18_rk, 0.027777777777777787_rk, 0.027777777777777783_rk, -2.3749547992781257e-18_rk, -2.1581143647810248e-18_rk, -2.391185702300753e-18_rk,   &
        6.969763844477182e-18_rk, 1.716900707478877e-18_rk, 0.027777777777777783_rk, -1.3188653754805354e-18_rk, -2.3749547992781257e-18_rk, 0.027777777777777783_rk, 0.00925925925925926_rk, 0.00925925925925926_rk,   &
        7.403444713471382e-18_rk, -1.3188653754805354e-18_rk, 0.027777777777777787_rk, 1.716900707478877e-18_rk, -2.1581143647810248e-18_rk, 0.00925925925925926_rk, 0.027777777777777783_rk, 0.009259259259259259_rk,   &
        1.716900707478877e-18_rk, -6.402313233013184e-19_rk, 0.009259259259259262_rk, -8.570717577984191e-19_rk, -2.391185702300753e-18_rk, 0.00925925925925926_rk, 0.009259259259259259_rk, 0.009259259259259257_rk   &
        /),(/8,8/))
        test_dmass_dx(:,:,7,3) = reshape((/ &
        -3.469446951953614e-18_rk, 0.05892556509887896_rk, 6.938893903907228e-18_rk, -0.05892556509887896_rk, -2.6020852139652106e-18_rk, -0.019641855032959652_rk, 0.01964185503295964_rk, -3.2526065174565133e-18_rk,   &
        0.05892556509887896_rk, -8.673617379884035e-19_rk, 0.01964185503295964_rk, -2.6020852139652106e-18_rk, -0.01964185503295965_rk, -3.2526065174565133e-18_rk, -2.3852447794681098e-18_rk, -0.006547285010986549_rk,   &
        6.938893903907228e-18_rk, 0.01964185503295964_rk, -8.673617379884035e-19_rk, -0.019641855032959652_rk, -3.2526065174565133e-18_rk, -0.01964185503295965_rk, 0.01964185503295964_rk, -1.734723475976807e-18_rk,   &
        -0.05892556509887896_rk, -2.6020852139652106e-18_rk, -0.019641855032959652_rk, -8.673617379884035e-19_rk, 0.01964185503295964_rk, -2.3852447794681098e-18_rk, -3.2526065174565133e-18_rk, 0.006547285010986547_rk,   &
        -2.6020852139652106e-18_rk, -0.01964185503295965_rk, -3.2526065174565133e-18_rk, 0.01964185503295964_rk, -3.3610267347050637e-18_rk, 0.006547285010986551_rk, -0.006547285010986552_rk, 1.0842021724855044e-18_rk,   &
        -0.019641855032959652_rk, -3.2526065174565133e-18_rk, -0.01964185503295965_rk, -2.3852447794681098e-18_rk, 0.006547285010986551_rk, -3.3610267347050637e-18_rk, -1.6263032587282567e-18_rk, 0.00654728501098655_rk,   &
        0.01964185503295964_rk, -2.3852447794681098e-18_rk, 0.01964185503295964_rk, -3.2526065174565133e-18_rk, -0.006547285010986552_rk, -1.6263032587282567e-18_rk, -3.3610267347050637e-18_rk, -0.00654728501098655_rk,   &
        -3.2526065174565133e-18_rk, -0.006547285010986549_rk, -1.734723475976807e-18_rk, 0.006547285010986547_rk, 1.0842021724855044e-18_rk, 0.00654728501098655_rk, -0.00654728501098655_rk, 5.421010862427522e-20_rk   &
        /),(/8,8/))
        test_dmass_dx(:,:,8,1) = reshape((/ &
        -8.673617379884035e-19_rk, -0.05892556509887896_rk, -1.9949319973733282e-17_rk, -0.058925565098878946_rk, -5.637851296924623e-18_rk, -0.01964185503295965_rk, -0.019641855032959656_rk, -3.0357660829594124e-18_rk,   &
        -0.05892556509887896_rk, 1.3010426069826053e-18_rk, -0.019641855032959656_rk, -5.637851296924623e-18_rk, -0.01964185503295965_rk, -3.0357660829594124e-18_rk, -2.168404344971009e-18_rk, -0.006547285010986548_rk,   &
        -1.9949319973733282e-17_rk, -0.019641855032959656_rk, 1.3010426069826053e-18_rk, -0.01964185503295965_rk, -3.0357660829594124e-18_rk, -0.01964185503295965_rk, -0.01964185503295965_rk, -2.168404344971009e-19_rk,   &
        -0.058925565098878946_rk, -5.637851296924623e-18_rk, -0.01964185503295965_rk, 1.3010426069826053e-18_rk, -0.01964185503295965_rk, -2.168404344971009e-18_rk, -3.0357660829594124e-18_rk, -0.006547285010986548_rk,   &
        -5.637851296924623e-18_rk, -0.01964185503295965_rk, -3.0357660829594124e-18_rk, -0.01964185503295965_rk, -6.396792817664476e-18_rk, -0.006547285010986553_rk, -0.006547285010986551_rk, 4.336808689942018e-19_rk,   &
        -0.01964185503295965_rk, -3.0357660829594124e-18_rk, -0.01964185503295965_rk, -2.168404344971009e-18_rk, -0.006547285010986553_rk, -6.396792817664476e-18_rk, -2.0599841277224584e-18_rk, -0.006547285010986549_rk,   &
        -0.019641855032959656_rk, -2.168404344971009e-18_rk, -0.01964185503295965_rk, -3.0357660829594124e-18_rk, -0.006547285010986551_rk, -2.0599841277224584e-18_rk, -6.396792817664476e-18_rk, -0.006547285010986549_rk,   &
        -3.0357660829594124e-18_rk, -0.006547285010986548_rk, -2.168404344971009e-19_rk, -0.006547285010986548_rk, 4.336808689942018e-19_rk, -0.006547285010986549_rk, -0.006547285010986549_rk, 5.963111948670274e-19_rk   &
        /),(/8,8/))
        test_dmass_dx(:,:,8,2) = reshape((/ &
        0.25_rk, 0.08333333333333334_rk, 3.3964078883517895e-18_rk, -0.08333333333333333_rk, -0.027777777777777787_rk, 4.21691230318713e-20_rk, -2.1262352219391364e-18_rk, 6.914547549373286e-18_rk,   &
        0.08333333333333334_rk, 0.08333333333333334_rk, -2.1262352219391364e-18_rk, -0.027777777777777787_rk, -0.027777777777777773_rk, 6.914547549373286e-18_rk, -5.662197651458565e-18_rk, 3.2666628918004708e-18_rk,   &
        3.3964078883517895e-18_rk, -2.1262352219391364e-18_rk, 0.08333333333333334_rk, 4.21691230318713e-20_rk, 6.914547549373286e-18_rk, -0.027777777777777773_rk, 0.027777777777777783_rk, -0.00925925925925926_rk,   &
        -0.08333333333333333_rk, -0.027777777777777787_rk, 4.21691230318713e-20_rk, 0.08333333333333334_rk, 0.027777777777777783_rk, -5.662197651458565e-18_rk, 6.914547549373286e-18_rk, -3.4553905776096567e-18_rk,   &
        -0.027777777777777787_rk, -0.027777777777777773_rk, 6.914547549373286e-18_rk, 0.027777777777777783_rk, 0.027777777777777783_rk, -3.6722310121067576e-18_rk, 3.9171841952917734e-18_rk, -4.128083706956231e-18_rk,   &
        4.21691230318713e-20_rk, 6.914547549373286e-18_rk, -0.027777777777777773_rk, -5.662197651458565e-18_rk, -3.6722310121067576e-18_rk, 0.027777777777777783_rk, -0.009259259259259259_rk, 0.009259259259259259_rk,   &
        -2.1262352219391364e-18_rk, -5.662197651458565e-18_rk, 0.027777777777777783_rk, 6.914547549373286e-18_rk, 3.9171841952917734e-18_rk, -0.009259259259259259_rk, 0.027777777777777783_rk, -0.009259259259259257_rk,   &
        6.914547549373286e-18_rk, 3.2666628918004708e-18_rk, -0.00925925925925926_rk, -3.4553905776096567e-18_rk, -4.128083706956231e-18_rk, 0.009259259259259259_rk, -0.009259259259259257_rk, 0.009259259259259257_rk   &
        /),(/8,8/))
        test_dmass_dx(:,:,8,3) = reshape((/ &
        -0.35355339059327384_rk, -0.05892556509887899_rk, -0.11785113019775789_rk, 0.05892556509887896_rk, 2.6020852139652106e-18_rk, 0.019641855032959652_rk, -0.019641855032959656_rk, 2.3852447794681098e-18_rk,   &
        -0.05892556509887899_rk, -0.11785113019775793_rk, -0.019641855032959656_rk, 2.6020852139652106e-18_rk, 0.01964185503295965_rk, 2.3852447794681098e-18_rk, -0.039283710065919304_rk, 0.006547285010986549_rk,   &
        -0.11785113019775789_rk, -0.019641855032959656_rk, -0.11785113019775793_rk, 0.019641855032959652_rk, 2.3852447794681098e-18_rk, 0.01964185503295965_rk, -0.019641855032959663_rk, 2.168404344971009e-18_rk,   &
        0.05892556509887896_rk, 2.6020852139652106e-18_rk, 0.019641855032959652_rk, -0.11785113019775793_rk, -0.019641855032959663_rk, -0.039283710065919304_rk, 2.3852447794681098e-18_rk, -0.006547285010986553_rk,   &
        2.6020852139652106e-18_rk, 0.01964185503295965_rk, 2.3852447794681098e-18_rk, -0.019641855032959663_rk, -0.03928371006591931_rk, -0.006547285010986554_rk, 0.006547285010986551_rk, -0.013094570021973102_rk,   &
        0.019641855032959652_rk, 2.3852447794681098e-18_rk, 0.01964185503295965_rk, -0.039283710065919304_rk, -0.006547285010986554_rk, -0.03928371006591931_rk, 7.589415207398531e-19_rk, -0.0065472850109865545_rk,   &
        -0.019641855032959656_rk, -0.039283710065919304_rk, -0.019641855032959663_rk, 2.3852447794681098e-18_rk, 0.006547285010986551_rk, 7.589415207398531e-19_rk, -0.03928371006591931_rk, 0.00654728501098655_rk,   &
        2.3852447794681098e-18_rk, 0.006547285010986549_rk, 2.168404344971009e-18_rk, -0.006547285010986553_rk, -0.013094570021973102_rk, -0.0065472850109865545_rk, 0.00654728501098655_rk, -0.0130945700219731_rk   &
        /),(/8,8/))
        
        
        do inode_diff = 1,self%elem%nterms_c 
            do idir =1,3
                @assertEqual(transpose(test_dmass_dx(:,:,inode_diff,idir)),self%elem%dmass_dx(:,:,inode_diff,idir),tol)
            end do
        end do

    end subroutine testElement_dmass_dx
    !*******************************************************************************************








    !> Test the interpolation coordinates derivatives given by
    !! elem%basis_c%get_coord_derivatives 
    !!
    !!
    !------------------------------------------------------------------------------------------
    @Test
    subroutine testElement_vol_dcoords_dx(self)
        class(test_element_linearC_dx),    intent(inout)   :: self
        
        
        real(rk), dimension(self%elem%nterms_c*3,self%elem%basis_s%nnodes_elem()) :: test_dcoords_dx
        real(rk), dimension(self%elem%basis_s%nnodes_elem(),self%elem%nterms_c*3) :: dcoords_dx
        
        real(rk)        :: tol = 1.e-13_rk
        integer(ik)     :: inode_diff, idir, inode

        !
        ! Refrence X-coordinates
        !
        test_dcoords_dx = reshape((/ &
        0.4905626121623441_rk, 0.13144585576580214_rk, 0.03522081090086451_rk, 0.13144585576580214_rk, 0.13144585576580214_rk, 0.03522081090086453_rk, 0.00943738783765594_rk, 0.03522081090086453_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk,   &
        0.13144585576580214_rk, 0.4905626121623441_rk, 0.13144585576580214_rk, 0.03522081090086451_rk, 0.03522081090086453_rk, 0.13144585576580214_rk, 0.03522081090086453_rk, 0.00943738783765594_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk,   &
        0.13144585576580214_rk, 0.03522081090086451_rk, 0.13144585576580214_rk, 0.4905626121623441_rk, 0.03522081090086453_rk, 0.00943738783765594_rk, 0.03522081090086453_rk, 0.13144585576580214_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk,   &
        0.03522081090086451_rk, 0.13144585576580214_rk, 0.4905626121623441_rk, 0.13144585576580214_rk, 0.00943738783765594_rk, 0.03522081090086453_rk, 0.13144585576580214_rk, 0.03522081090086453_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk,   &
        0.13144585576580214_rk, 0.03522081090086453_rk, 0.00943738783765594_rk, 0.03522081090086453_rk, 0.4905626121623441_rk, 0.13144585576580214_rk, 0.03522081090086451_rk, 0.13144585576580214_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk,   &
        0.03522081090086453_rk, 0.13144585576580214_rk, 0.03522081090086453_rk, 0.00943738783765594_rk, 0.13144585576580214_rk, 0.4905626121623441_rk, 0.13144585576580214_rk, 0.03522081090086451_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk,   &
        0.03522081090086453_rk, 0.00943738783765594_rk, 0.03522081090086453_rk, 0.13144585576580214_rk, 0.13144585576580214_rk, 0.03522081090086451_rk, 0.13144585576580214_rk, 0.4905626121623441_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk,   &
        0.00943738783765594_rk, 0.03522081090086453_rk, 0.13144585576580214_rk, 0.03522081090086453_rk, 0.03522081090086451_rk, 0.13144585576580214_rk, 0.4905626121623441_rk, 0.13144585576580214_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk   &
        /),(/24,8/))


        
        !
        ! Computed X-coordiantes
        !
        do inode = 1,self%elem%basis_s%nnodes_elem()
            dcoords_dx(inode,:) = self%elem%basis_c%get_coord_derivatives('element','1',inode,0)
        end do
        
        
        !
        ! TEST
        ! 
        @assertEqual(transpose(test_dcoords_dx),dcoords_dx,tol)
        
        
        
        !
        ! Refrence Y-coordinates
        !
        test_dcoords_dx = reshape((/ &
        0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.4905626121623441_rk, 0.13144585576580214_rk, 0.03522081090086451_rk, 0.13144585576580214_rk, 0.13144585576580214_rk, 0.03522081090086453_rk, 0.00943738783765594_rk, 0.03522081090086453_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.13144585576580214_rk, 0.4905626121623441_rk, 0.13144585576580214_rk, 0.03522081090086451_rk, 0.03522081090086453_rk, 0.13144585576580214_rk, 0.03522081090086453_rk, 0.00943738783765594_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.13144585576580214_rk, 0.03522081090086451_rk, 0.13144585576580214_rk, 0.4905626121623441_rk, 0.03522081090086453_rk, 0.00943738783765594_rk, 0.03522081090086453_rk, 0.13144585576580214_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.03522081090086451_rk, 0.13144585576580214_rk, 0.4905626121623441_rk, 0.13144585576580214_rk, 0.00943738783765594_rk, 0.03522081090086453_rk, 0.13144585576580214_rk, 0.03522081090086453_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.13144585576580214_rk, 0.03522081090086453_rk, 0.00943738783765594_rk, 0.03522081090086453_rk, 0.4905626121623441_rk, 0.13144585576580214_rk, 0.03522081090086451_rk, 0.13144585576580214_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.03522081090086453_rk, 0.13144585576580214_rk, 0.03522081090086453_rk, 0.00943738783765594_rk, 0.13144585576580214_rk, 0.4905626121623441_rk, 0.13144585576580214_rk, 0.03522081090086451_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.03522081090086453_rk, 0.00943738783765594_rk, 0.03522081090086453_rk, 0.13144585576580214_rk, 0.13144585576580214_rk, 0.03522081090086451_rk, 0.13144585576580214_rk, 0.4905626121623441_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.00943738783765594_rk, 0.03522081090086453_rk, 0.13144585576580214_rk, 0.03522081090086453_rk, 0.03522081090086451_rk, 0.13144585576580214_rk, 0.4905626121623441_rk, 0.13144585576580214_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk   &
        /),(/24,8/))
        
        
        
        
        !
        ! Computed Y-coordiantes
        !
        do inode = 1,self%elem%basis_s%nnodes_elem()
            dcoords_dx(inode,:) = self%elem%basis_c%get_coord_derivatives('element','2',inode,0)
        end do
        
        
        !
        ! TEST
        ! 
        @assertEqual(transpose(test_dcoords_dx),dcoords_dx,tol)
        
        
        !
        ! Refrence Z-coordinates
        !
        test_dcoords_dx = reshape((/ &
        0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.4905626121623441_rk, 0.13144585576580214_rk, 0.03522081090086451_rk, 0.13144585576580214_rk, 0.13144585576580214_rk, 0.03522081090086453_rk, 0.00943738783765594_rk, 0.03522081090086453_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.13144585576580214_rk, 0.4905626121623441_rk, 0.13144585576580214_rk, 0.03522081090086451_rk, 0.03522081090086453_rk, 0.13144585576580214_rk, 0.03522081090086453_rk, 0.00943738783765594_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.13144585576580214_rk, 0.03522081090086451_rk, 0.13144585576580214_rk, 0.4905626121623441_rk, 0.03522081090086453_rk, 0.00943738783765594_rk, 0.03522081090086453_rk, 0.13144585576580214_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.03522081090086451_rk, 0.13144585576580214_rk, 0.4905626121623441_rk, 0.13144585576580214_rk, 0.00943738783765594_rk, 0.03522081090086453_rk, 0.13144585576580214_rk, 0.03522081090086453_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.13144585576580214_rk, 0.03522081090086453_rk, 0.00943738783765594_rk, 0.03522081090086453_rk, 0.4905626121623441_rk, 0.13144585576580214_rk, 0.03522081090086451_rk, 0.13144585576580214_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.03522081090086453_rk, 0.13144585576580214_rk, 0.03522081090086453_rk, 0.00943738783765594_rk, 0.13144585576580214_rk, 0.4905626121623441_rk, 0.13144585576580214_rk, 0.03522081090086451_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.03522081090086453_rk, 0.00943738783765594_rk, 0.03522081090086453_rk, 0.13144585576580214_rk, 0.13144585576580214_rk, 0.03522081090086451_rk, 0.13144585576580214_rk, 0.4905626121623441_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.00943738783765594_rk, 0.03522081090086453_rk, 0.13144585576580214_rk, 0.03522081090086453_rk, 0.03522081090086451_rk, 0.13144585576580214_rk, 0.4905626121623441_rk, 0.13144585576580214_rk   &
        /),(/24,8/))
        
        
        
        !
        ! Computed Z-coordiantes
        !
        do inode = 1,self%elem%basis_s%nnodes_elem()
            dcoords_dx(inode,:) = self%elem%basis_c%get_coord_derivatives('element','3',inode,0)
        end do
        
        
        !
        ! TEST
        ! 
        @assertEqual(transpose(test_dcoords_dx),dcoords_dx,tol)

    end subroutine testElement_vol_dcoords_dx
    !*******************************************************************************************


!------------------------------------------------------------------------------
!                                Face tests
!------------------------------------------------------------------------------







    !> Test the interpolation coordinates derivatives given by
    !! elem%basis_c%get_coord_derivatives 
    !!
    !!
    !------------------------------------------------------------------------------------------
    @Test
    subroutine testElement_etamax_dcoords_dx(self)
        class(test_element_linearC_dx),    intent(inout)   :: self
        
        
        real(rk), dimension(self%elem%nterms_c*3,self%elem%basis_s%nnodes_face()) :: test_dcoords_dx
        real(rk), dimension(self%elem%basis_s%nnodes_face(),self%elem%nterms_c*3) :: dcoords_dx
        
        real(rk)        :: tol = 1.e-13_rk
        integer(ik)     :: inode_diff, idir, inode

        !
        ! Refrence X-coordinates
        !
        test_dcoords_dx = reshape((/                                                                                 &
                                        -6.938893903907228378e-18_rk, 0.000000000000000000e+00_rk, 1.666666666666666852e-01_rk,6.220084679281462359e-01_rk,6.938893903907228378e-18_rk,0.000000000000000000e+00_rk,4.465819873852045624e-02_rk,1.666666666666666574e-01_rk,0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,  &
                                        0.000000000000000000e+00_rk, -6.938893903907228378e-18_rk, 6.220084679281462359e-01_rk,1.666666666666666852e-01_rk,0.000000000000000000e+00_rk,6.938893903907228378e-18_rk,1.666666666666666574e-01_rk,4.465819873852045624e-02_rk,0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,  &
                                        6.938893903907228378e-18_rk, 0.000000000000000000e+00_rk, 4.465819873852045624e-02_rk,1.666666666666666574e-01_rk,-6.938893903907228378e-18_rk,0.000000000000000000e+00_rk,1.666666666666666852e-01_rk,6.220084679281462359e-01_rk,0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,  &
                                        0.000000000000000000e+00_rk, 6.938893903907228378e-18_rk, 1.666666666666666574e-01_rk,4.465819873852045624e-02_rk,0.000000000000000000e+00_rk,-6.938893903907228378e-18_rk,6.220084679281462359e-01_rk,1.666666666666666852e-01_rk,0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk  &
                                        /),(/24,4/))

                
        

        !
        ! Computed X-coordiantes
        !
        do inode = 1,self%elem%basis_s%nnodes_face()
            dcoords_dx(inode,:) = self%elem%basis_c%get_coord_derivatives('face interior','1',inode,4)
        end do
        
        
        !
        ! TEST
        ! 
        @assertEqual(transpose(test_dcoords_dx),dcoords_dx,tol)
        
        
        
        !
        ! Refrence Y-coordinates
        !
        test_dcoords_dx = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-6.938893903907228378e-18_rk, 0.000000000000000000e+00_rk, 1.666666666666666852e-01_rk,6.220084679281462359e-01_rk,6.938893903907228378e-18_rk,0.000000000000000000e+00_rk,4.465819873852045624e-02_rk,1.666666666666666574e-01_rk,0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,  &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk, -6.938893903907228378e-18_rk, 6.220084679281462359e-01_rk,1.666666666666666852e-01_rk,0.000000000000000000e+00_rk,6.938893903907228378e-18_rk,1.666666666666666574e-01_rk,4.465819873852045624e-02_rk,0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,  &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,6.938893903907228378e-18_rk, 0.000000000000000000e+00_rk, 4.465819873852045624e-02_rk,1.666666666666666574e-01_rk,-6.938893903907228378e-18_rk,0.000000000000000000e+00_rk,1.666666666666666852e-01_rk,6.220084679281462359e-01_rk,0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,  &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk, 6.938893903907228378e-18_rk, 1.666666666666666574e-01_rk,4.465819873852045624e-02_rk,0.000000000000000000e+00_rk,-6.938893903907228378e-18_rk,6.220084679281462359e-01_rk,1.666666666666666852e-01_rk,0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk  &
                                        /),(/24,4/))

        
        
        
        !
        ! Computed Y-coordiantes
        !
        do inode = 1,self%elem%basis_s%nnodes_face()
            dcoords_dx(inode,:) = self%elem%basis_c%get_coord_derivatives('face interior','2',inode,4)
        end do
        
        
        !
        ! TEST
        ! 
        @assertEqual(transpose(test_dcoords_dx),dcoords_dx,tol)
        
        
        !
        ! Refrence Z-coordinates
        !
        test_dcoords_dx = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-6.938893903907228378e-18_rk, 0.000000000000000000e+00_rk, 1.666666666666666852e-01_rk,6.220084679281462359e-01_rk,6.938893903907228378e-18_rk,0.000000000000000000e+00_rk,4.465819873852045624e-02_rk,1.666666666666666574e-01_rk,  &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk, -6.938893903907228378e-18_rk, 6.220084679281462359e-01_rk,1.666666666666666852e-01_rk,0.000000000000000000e+00_rk,6.938893903907228378e-18_rk,1.666666666666666574e-01_rk,4.465819873852045624e-02_rk,  &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,6.938893903907228378e-18_rk, 0.000000000000000000e+00_rk, 4.465819873852045624e-02_rk,1.666666666666666574e-01_rk,-6.938893903907228378e-18_rk,0.000000000000000000e+00_rk,1.666666666666666852e-01_rk,6.220084679281462359e-01_rk,  &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk, 6.938893903907228378e-18_rk, 1.666666666666666574e-01_rk,4.465819873852045624e-02_rk,0.000000000000000000e+00_rk,-6.938893903907228378e-18_rk,6.220084679281462359e-01_rk,1.666666666666666852e-01_rk  &
                                        /),(/24,4/))

        
        
        !
        ! Computed Z-coordiantes
        !
        do inode = 1,self%elem%basis_s%nnodes_face()
            dcoords_dx(inode,:) = self%elem%basis_c%get_coord_derivatives('face interior','3',inode,4)
        end do
        
        
        !
        ! TEST
        ! 
        @assertEqual(transpose(test_dcoords_dx),dcoords_dx,tol)

    end subroutine testElement_etamax_dcoords_dx
    !*******************************************************************************************




    !> Test cartesian dbr2_vol_dx 
    !!
    !!
    !------------------------------------------------------------------------------------------
    @Test
    subroutine testElement_dbr2_vol_dx(self)
        class(test_element_linearC_dx),    intent(inout)   :: self
        
        real(rk), dimension(self%faces(XI_MIN)%basis_s%nnodes_face(),  self%elem%basis_s%nnodes_elem(),self%elem%nterms_c,3)   :: test_dbr2_vol_face1_dx
        real(rk), dimension(self%faces(XI_MAX)%basis_s%nnodes_face(),  self%elem%basis_s%nnodes_elem(),self%elem%nterms_c,3)   :: test_dbr2_vol_face2_dx
        real(rk), dimension(self%faces(ETA_MIN)%basis_s%nnodes_face(), self%elem%basis_s%nnodes_elem(),self%elem%nterms_c,3)  :: test_dbr2_vol_face3_dx
        real(rk), dimension(self%faces(ETA_MAX)%basis_s%nnodes_face(), self%elem%basis_s%nnodes_elem(),self%elem%nterms_c,3)  :: test_dbr2_vol_face4_dx
        real(rk), dimension(self%faces(ZETA_MIN)%basis_s%nnodes_face(),self%elem%basis_s%nnodes_elem(),self%elem%nterms_c,3) :: test_dbr2_vol_face5_dx
        real(rk), dimension(self%faces(ZETA_MAX)%basis_s%nnodes_face(),self%elem%basis_s%nnodes_elem(),self%elem%nterms_c,3) :: test_dbr2_vol_face6_dx
        
        real(rk)        :: tol = 1.e-13_rk
        integer(ik)     :: inode_diff, idir, inode
        
       
        !
        ! dbr2_vol_face1_dx
        ! 
        test_dbr2_vol_face1_dx(:,:,1,1) = reshape((/ &
        9.613024693476675_rk, 1.6100990945994187e-16_rk, -4.831038969434949e-16_rk, 5.462622040732875e-16_rk,   &
        -1.6329931618554518_rk, 7.027727799132502e-16_rk, 5.737177655186307e-16_rk, -7.529890009420075e-19_rk,   &
        -3.841019517261236e-16_rk, 6.0944134484570895_rk, 2.0064595838596269e-16_rk, -3.535836170783114e-16_rk,   &
        4.512027458008122e-16_rk, -0.6901841202733883_rk, 9.318289328096785e-18_rk, 3.691538592975648e-16_rk,   &
        -1.3676406030620448e-15_rk, 1.7118456116549682e-16_rk, 2.5758022034375165_rk, 4.38000867961263e-17_rk,   &
        1.4268212797099756e-15_rk, -1.6337138034972665e-16_rk, -0.43755919896471424_rk, 1.862296222884032e-17_rk,   &
        9.041103056742816e-16_rk, -1.83965586051015e-16_rk, -7.308132903779409e-16_rk, 1.632993161855452_rk,   &
        -1.4864127561190572e-16_rk, 1.0906166435343818e-16_rk, 2.437302569524939e-16_rk, -0.18493427765603926_rk   &
        /),(/4,8/))
        test_dbr2_vol_face1_dx(:,:,1,2) = reshape((/ &
        6.797434948471089_rk, -2.388977664586096e-17_rk, -5.439867802163615e-16_rk, 4.626706120362786e-16_rk,   &
        -0.4880338717125846_rk, 4.68378555293482e-16_rk, 3.741479558240687e-16_rk, -1.858236059880478e-16_rk,   &
        -3.4113583602115423e-16_rk, 1.8213672050459178_rk, 1.8374689138943153e-16_rk, -2.6395367576102137e-16_rk,   &
        4.681531631695043e-16_rk, -0.13076828180442152_rk, 3.9809017756425124e-16_rk, 3.6856096458311397e-16_rk,   &
        -1.0534925602222468e-15_rk, 4.527122979364782e-16_rk, 6.79743494847109_rk, -2.9446964080956446e-16_rk,   &
        9.695175333482157e-16_rk, -1.8767263391588563e-16_rk, -0.48803387171258544_rk, 3.037161748337253e-18_rk,   &
        6.753486752249586e-16_rk, -8.340083132197785e-17_rk, -9.100789598656654e-16_rk, 1.8213672050459178_rk,   &
        -1.5181834470047056e-17_rk, 1.108374326179415e-16_rk, 1.0582172756027697e-16_rk, -0.13076828180442132_rk   &
        /),(/4,8/))
        test_dbr2_vol_face1_dx(:,:,1,3) = reshape((/ &
        9.992007221626409e-16_rk, -3.3086302584466085e-20_rk, 6.534548105859698e-17_rk, 1.0114099569238978e-17_rk,   &
        -0.9428090415820637_rk, -2.429840761652286e-16_rk, -5.603194270979555e-17_rk, 1.2855222989744234e-16_rk,   &
        -1.0342148980482798e-16_rk, -3.518611245019577_rk, 5.306399569105098e-17_rk, 2.64922624568975e-17_rk,   &
        -8.735202632286885e-17_rk, 1.0326937708090499e-16_rk, 9.66490215203782e-17_rk, -1.01248483537668e-16_rk,   &
        -8.231357692392313e-17_rk, 5.14147497963896e-17_rk, -1.837924768348585e-17_rk, 1.126369569906999e-16_rk,   &
        1.1057088733452766e-16_rk, -1.441390152679879e-16_rk, -0.25262492130867487_rk, -2.3081213587734274e-17_rk,   &
        -8.358146084930565e-17_rk, 9.720792542984261e-17_rk, -6.590493620235201e-18_rk, -0.9428090415820634_rk,   &
        -1.0597965425476306e-17_rk, 3.6577708447580984e-17_rk, -3.34047536549193e-17_rk, -1.6858478196470287e-16_rk   &
        /),(/4,8/))
        test_dbr2_vol_face1_dx(:,:,2,1) = reshape((/ &
        -3.518611245019579_rk, 1.6055295820314446e-17_rk, 1.5906407458684403e-16_rk, -2.427613374951953e-16_rk,   &
        1.9746376525120107e-16_rk, -5.4730972481828516e-17_rk, 1.3744926273999918e-16_rk, 1.7538730580703943e-16_rk,   &
        2.502380348162681e-17_rk, -2.282432486383271e-16_rk, 3.898113108800833e-17_rk, 7.090412759556991e-17_rk,   &
        8.063448970588238e-17_rk, -0.9428090415820627_rk, -1.944820234648539e-16_rk, -1.364862820068197e-17_rk,   &
        5.664945176805279e-16_rk, -1.9095192755743982e-16_rk, -0.9428090415820636_rk, 7.282249663493597e-17_rk,   &
        -3.66187100023644e-16_rk, 2.7525297284983653e-17_rk, -2.8373112469650136e-17_rk, 5.626117133823903e-17_rk,   &
        -2.0434916350953317e-16_rk, -1.4477944718908951e-16_rk, 8.40722826220027e-18_rk, 3.943915360011667e-17_rk,   &
        -7.061315908598636e-17_rk, -5.72236008371273e-17_rk, -5.62942576408235e-17_rk, -0.25262492130867464_rk   &
        /),(/4,8/))
        test_dbr2_vol_face1_dx(:,:,2,2) = reshape((/ &
        1.8213672050459184_rk, 2.2418753189877385e-16_rk, -3.828120162708024e-17_rk, 2.062070802632098e-16_rk,   &
        -1.8213672050459182_rk, 3.0779494888940924e-16_rk, 2.392678356298549e-16_rk, 2.1232880967969038e-16_rk,   &
        -5.896948228250311e-16_rk, 0.4880338717125847_rk, 1.8057562516600325e-16_rk, -2.4468294474402955e-16_rk,   &
        2.4611482706291326e-16_rk, -0.48803387171258455_rk, 6.089491625323209e-17_rk, 1.221146255636555e-16_rk,   &
        -3.663204811420446e-16_rk, 2.5009469440852716e-16_rk, 1.8213672050459189_rk, 1.6282347502318005e-16_rk,   &
        7.875643154235374e-16_rk, -6.596561129502696e-16_rk, -1.8213672050459186_rk, 1.3821974435369686e-16_rk,   &
        4.0669261472945994e-16_rk, -3.533057369298071e-18_rk, -6.299539529394763e-16_rk, 0.48803387171258517_rk,   &
        -1.6489224107851773e-16_rk, 2.0411217403123548e-16_rk, -1.1443608754040342e-16_rk, -0.48803387171258483_rk   &
        /),(/4,8/))
        test_dbr2_vol_face1_dx(:,:,2,3) = reshape((/ &
        -6.094413448457097_rk, -1.7703211897767187e-16_rk, 2.5869434129805393e-16_rk, -3.1361496614733106e-16_rk,   &
        2.5758022034375156_rk, -4.050577312661934e-16_rk, -6.551350855488345e-16_rk, -3.031865467035399e-16_rk,   &
        4.624996380493249e-16_rk, -2.5758022034375143_rk, -2.9269108516502204e-16_rk, 2.5618722702584404e-16_rk,   &
        -4.444852091838257e-16_rk, 1.6329931618554512_rk, 8.851471261637898e-17_rk, -2.5425674755921496e-16_rk,   &
        8.834596623054398e-16_rk, -3.1647383404446404e-17_rk, -1.6329931618554527_rk, -2.292595404217622e-16_rk,   &
        -1.1712050670208594e-15_rk, 2.799850983327308e-16_rk, 0.6901841202733887_rk, -5.180291997934512e-17_rk,   &
        -6.161796813154427e-16_rk, 2.31537107810262e-16_rk, 7.289965557359758e-16_rk, -0.6901841202733887_rk,   &
        2.298524001233684e-16_rk, -8.841577196389187e-17_rk, -1.5403124565675114e-16_rk, 0.43755919896471424_rk   &
        /),(/4,8/))
        test_dbr2_vol_face1_dx(:,:,3,1) = reshape((/ &
        -2.575802203437516_rk, -1.931205011005708e-16_rk, 1.649757477698067e-16_rk, -6.07395290828968e-17_rk,   &
        1.6329931618554518_rk, -5.933108349495934e-16_rk, -8.486162909986291e-16_rk, -3.500216226131369e-16_rk,   &
        3.3405434476287e-16_rk, -6.0944134484570895_rk, -2.7860822056197936e-16_rk, 2.1177536188717166e-16_rk,   &
        -6.124717252125769e-16_rk, 2.5758022034375134_rk, 3.796457576016111e-16_rk, -3.4185660289620087e-16_rk,   &
        2.346515677009888e-16_rk, 2.107192939493829e-16_rk, -0.6901841202733894_rk, -1.8944508006599827e-16_rk,   &
        -6.944470796626875e-16_rk, 1.083207857797593e-16_rk, 0.43755919896471424_rk, -1.3114530490531845e-16_rk,   &
        -4.95411978655215e-16_rk, 4.735244804291941e-16_rk, 7.139988338535404e-16_rk, -1.632993161855452_rk,   &
        2.8986759378387857e-16_rk, 5.385537320816398e-18_rk, -1.3114174167084692e-16_rk, 0.6901841202733885_rk   &
        /),(/4,8/))
        test_dbr2_vol_face1_dx(:,:,3,2) = reshape((/ &
        0.48803387171258483_rk, -7.392587520625826e-18_rk, -8.372668928204544e-17_rk, -9.643805909344378e-17_rk,   &
        -0.4880338717125847_rk, 2.564714803163476e-16_rk, 4.493292421288287e-16_rk, 1.4356819101183137e-16_rk,   &
        -2.156387694718113e-16_rk, 1.8213672050459173_rk, 1.0098232898194568e-16_rk, -9.565178861730271e-18_rk,   &
        8.058380512830443e-16_rk, -1.8213672050459166_rk, -1.532572312585734e-16_rk, 2.336043889236945e-16_rk,   &
        2.0749981893248678e-16_rk, -7.021528171370222e-17_rk, 0.48803387171258505_rk, -4.723748139487984e-17_rk,   &
        5.147769916358035e-16_rk, -6.402000620077895e-17_rk, -0.4880338717125852_rk, 8.316060701431904e-17_rk,   &
        4.779915901559326e-16_rk, -2.731884075690827e-16_rk, -3.955334644312315e-16_rk, 1.8213672050459178_rk,   &
        -5.667072294970436e-16_rk, 6.482922214492709e-17_rk, 1.0223561027469521e-16_rk, -1.8213672050459175_rk   &
        /),(/4,8/))
        test_dbr2_vol_face1_dx(:,:,3,3) = reshape((/ &
        -3.3306690738754696e-16_rk, -3.308630258450306e-20_rk, 6.534548105859703e-17_rk, 1.0114099569238929e-17_rk,   &
        -0.9428090415820635_rk, -2.4298407616522853e-16_rk, -5.603194270979555e-17_rk, 1.2855222989744234e-16_rk,   &
        -1.0342148980482795e-16_rk, -3.5186112450195752_rk, 5.306399569105098e-17_rk, 2.64922624568975e-17_rk,   &
        -8.735202632286898e-17_rk, 1.0326937708090499e-16_rk, 9.66490215203782e-17_rk, -1.0124848353766805e-16_rk,   &
        -8.231357692392293e-17_rk, 5.1414749796389554e-17_rk, -1.837924768348585e-17_rk, 1.126369569906999e-16_rk,   &
        1.1057088733452757e-16_rk, -1.441390152679878e-16_rk, -0.25262492130867464_rk, -2.308121358773428e-17_rk,   &
        -8.358146084930565e-17_rk, 9.720792542984247e-17_rk, -6.590493620235201e-18_rk, -0.9428090415820634_rk,   &
        -1.0597965425476294e-17_rk, 3.6577708447580984e-17_rk, -3.340475365491933e-17_rk, -1.6858478196470287e-16_rk   &
        /),(/4,8/))
        test_dbr2_vol_face1_dx(:,:,4,1) = reshape((/ &
        -3.518611245019579_rk, 1.6055295820314508e-17_rk, 1.5906407458684413e-16_rk, -2.427613374951953e-16_rk,   &
        -1.356031421363459e-16_rk, -5.473097248182838e-17_rk, 1.3744926273999923e-16_rk, 1.7538730580703948e-16_rk,   &
        2.502380348162679e-17_rk, 2.158459612117355e-16_rk, 3.898113108800833e-17_rk, 7.090412759556986e-17_rk,   &
        8.06344897058823e-17_rk, -0.9428090415820625_rk, -1.9448202346485396e-16_rk, -1.3648628200681982e-17_rk,   &
        5.664945176805279e-16_rk, -1.9095192755743992e-16_rk, -0.9428090415820631_rk, 7.282249663493602e-17_rk,   &
        -3.66187100023644e-16_rk, 2.7525297284983702e-17_rk, 8.264918999286551e-17_rk, 5.626117133823907e-17_rk,   &
        -2.0434916350953317e-16_rk, -1.4477944718908956e-16_rk, 8.407228262200245e-18_rk, 3.943915360011667e-17_rk,   &
        -7.061315908598646e-17_rk, -5.722360083712727e-17_rk, -5.62942576408235e-17_rk, -0.25262492130867464_rk   &
        /),(/4,8/))
        test_dbr2_vol_face1_dx(:,:,4,2) = reshape((/ &
        1.8213672050459184_rk, 1.1894962815866726e-16_rk, -2.318466486447434e-16_rk, 2.766358312859718e-16_rk,   &
        -0.1307682818044209_rk, 6.722310837397763e-16_rk, 4.747553412013023e-16_rk, -2.810085485297898e-17_rk,   &
        -4.279870004287842e-16_rk, 6.797434948471084_rk, 5.686366871617264e-17_rk, -2.9151749789167384e-16_rk,   &
        4.865307243147779e-16_rk, -0.4880338717125851_rk, -1.3664015501996588e-16_rk, 3.200332038068064e-16_rk,   &
        -3.3970165915546994e-16_rk, 7.001557968544697e-17_rk, 1.8213672050459193_rk, -1.6251310821098622e-17_rk,   &
        3.9950431833069074e-16_rk, 1.0490757728525471e-17_rk, -0.13076828180442157_rk, 2.7252583373690587e-16_rk,   &
        1.051857451684383e-15_rk, -4.718054928302124e-16_rk, -7.432338655735431e-16_rk, 6.7974349484710865_rk,   &
        -2.942858358678667e-16_rk, -2.938257086916598e-17_rk, 8.653677918156639e-17_rk, -0.4880338717125844_rk   &
        /),(/4,8/))
        test_dbr2_vol_face1_dx(:,:,4,3) = reshape((/ &
        6.094413448457095_rk, 1.770982915828408e-16_rk, -3.893853034152479e-16_rk, 2.933867670088532e-16_rk,   &
        -0.6901841202733882_rk, 8.910258835966505e-16_rk, 7.671989709684255e-16_rk, 4.6082086908655144e-17_rk,   &
        -2.5565665843966893e-16_rk, 9.613024693476667_rk, 1.8656309378292008e-16_rk, -3.091717519396391e-16_rk,   &
        6.191892618295635e-16_rk, -1.6329931618554512_rk, -2.8181275565713537e-16_rk, 4.56753714634551e-16_rk,   &
        -7.188325084575938e-16_rk, -7.118211618833273e-17_rk, 1.6329931618554527_rk, 3.9856264403623574e-18_rk,   &
        9.500632923518039e-16_rk, 8.292932203244884e-18_rk, -0.18493427765603937_rk, 9.796534715481366e-17_rk,   &
        7.833426030140539e-16_rk, -4.2595295866994705e-16_rk, -7.158155684955056e-16_rk, 2.575802203437515_rk,   &
        -2.086564692724158e-16_rk, 1.5260355068729893e-17_rk, 2.2084075296658977e-16_rk, -0.4375591989647141_rk   &
        /),(/4,8/))
        test_dbr2_vol_face1_dx(:,:,5,1) = reshape((/ &
        2.5758022034375156_rk, 4.7839457159127844e-17_rk, -4.772188201047064e-16_rk, 4.494743473841611e-16_rk,   &
        -0.43755919896471324_rk, 6.525975787189542e-16_rk, 4.602979782036094e-16_rk, -1.31772438654333e-16_rk,   &
        -8.179466924995391e-16_rk, 1.6329931618554507_rk, 2.2710632228509958e-16_rk, -3.988542200840897e-16_rk,   &
        7.289244444066877e-16_rk, -0.18493427765603926_rk, 5.001062668562292e-16_rk, 4.647157838119511e-16_rk,   &
        -6.214559065356236e-16_rk, 6.953994559686937e-16_rk, 9.613024693476676_rk, -3.566008752956663e-16_rk,   &
        7.836678455710456e-16_rk, -5.610670286090689e-16_rk, -1.6329931618554525_rk, 2.7611321671703275e-16_rk,   &
        1.0823275928208747e-15_rk, -2.700961129231727e-16_rk, -1.5272231358078013e-15_rk, 6.094413448457092_rk,   &
        -1.9751701257832486e-16_rk, 1.7123862334340253e-16_rk, -1.1380352477394772e-16_rk, -0.690184120273388_rk   &
        /),(/4,8/))
        test_dbr2_vol_face1_dx(:,:,5,2) = reshape((/ &
        -6.797434948471089_rk, 2.388977664586096e-17_rk, 5.439867802163615e-16_rk, -4.626706120362786e-16_rk,   &
        0.4880338717125846_rk, -4.68378555293482e-16_rk, -3.741479558240687e-16_rk, 1.8582360598804786e-16_rk,   &
        3.4113583602115423e-16_rk, -1.8213672050459178_rk, -1.8374689138943153e-16_rk, 2.6395367576102137e-16_rk,   &
        -4.681531631695043e-16_rk, 0.1307682818044213_rk, -3.9809017756425124e-16_rk, -3.6856096458311397e-16_rk,   &
        1.0534925602222468e-15_rk, -4.527122979364782e-16_rk, -6.79743494847109_rk, 2.9446964080956446e-16_rk,   &
        -9.695175333482157e-16_rk, 1.8767263391588563e-16_rk, 0.48803387171258544_rk, -3.037161748337253e-18_rk,   &
        -6.753486752249586e-16_rk, 8.340083132197785e-17_rk, 9.100789598656654e-16_rk, -1.8213672050459178_rk,   &
        1.5181834470047056e-17_rk, -1.108374326179415e-16_rk, -1.0582172756027699e-16_rk, 0.1307682818044211_rk   &
        /),(/4,8/))
        test_dbr2_vol_face1_dx(:,:,5,3) = reshape((/ &
        3.3306690738754696e-16_rk, 7.444752167507102e-17_rk, 7.152595913099798e-17_rk, -5.99147470079329e-17_rk,   &
        -0.252624921308675_rk, -1.4711186096881117e-17_rk, -1.1048286936447992e-16_rk, 4.145721629201495e-17_rk,   &
        -1.0923207982468059e-17_rk, -0.9428090415820625_rk, 3.44135676284791e-17_rk, 6.624767667643566e-18_rk,   &
        -8.264768492897284e-17_rk, 1.1877522784412632e-16_rk, 4.3029366899068057e-17_rk, -3.8701085260864217e-17_rk,   &
        6.349122739001849e-17_rk, 7.592041337437074e-17_rk, 1.837924768348585e-17_rk, 1.39880384193183e-17_rk,   &
        1.6382896811705625e-16_rk, -3.297263813799327e-16_rk, -0.9428090415820638_rk, -7.188753296977941e-17_rk,   &
        -3.7261897034463407e-16_rk, 2.3391068912731006e-16_rk, 8.669148801600357e-17_rk, -3.518611245019579_rk,   &
        1.0209305374312932e-16_rk, 1.2852800904291592e-16_rk, -1.0870452323868582e-16_rk, -2.7550442788535977e-16_rk   &
        /),(/4,8/))
        test_dbr2_vol_face1_dx(:,:,6,1) = reshape((/ &
        -0.9428090415820636_rk, -4.390021519343703e-18_rk, 1.663889568223479e-16_rk, -1.5258819528083065e-16_rk,   &
        1.356031421363459e-16_rk, -9.510995721590955e-17_rk, -8.428806537557618e-17_rk, 5.752786751879778e-17_rk,   &
        6.371602329443284e-17_rk, -2.158459612117355e-16_rk, -9.75045144082788e-17_rk, 1.0897570361777188e-16_rk,   &
        1.5814478458342225e-16_rk, -0.25262492130867437_rk, -1.953794681033971e-16_rk, -8.178008161380895e-17_rk,   &
        3.2516174464434223e-16_rk, -1.7881371008267108e-16_rk, -3.5186112450195792_rk, 1.0199703981458104e-16_rk,   &
        4.4636979298353336e-17_rk, 5.99103142839038e-17_rk, -1.9367149245538117e-16_rk, 3.9466014136586272e-19_rk,   &
        6.479663034201454e-17_rk, 1.0579365039802748e-17_rk, 3.554313807884797e-16_rk, -3.943915360011667e-17_rk,   &
        -3.1937418773419203e-16_rk, 2.469088322140087e-17_rk, 5.375848979005832e-17_rk, -0.9428090415820629_rk   &
        /),(/4,8/))
        test_dbr2_vol_face1_dx(:,:,6,2) = reshape((/ &
        -1.8213672050459184_rk, -2.2418753189877385e-16_rk, 3.828120162708024e-17_rk, -2.062070802632098e-16_rk,   &
        1.8213672050459182_rk, -3.0779494888940924e-16_rk, -2.392678356298549e-16_rk, -2.1232880967969038e-16_rk,   &
        5.896948228250311e-16_rk, -0.4880338717125847_rk, -1.8057562516600325e-16_rk, 2.4468294474402955e-16_rk,   &
        -2.4611482706291326e-16_rk, 0.48803387171258433_rk, -6.089491625323212e-17_rk, -1.221146255636555e-16_rk,   &
        3.663204811420446e-16_rk, -2.5009469440852716e-16_rk, -1.8213672050459189_rk, -1.6282347502318005e-16_rk,   &
        -7.875643154235374e-16_rk, 6.596561129502696e-16_rk, 1.8213672050459186_rk, -1.3821974435369686e-16_rk,   &
        -4.0669261472945994e-16_rk, 3.533057369298071e-18_rk, 6.299539529394763e-16_rk, -0.48803387171258517_rk,   &
        1.6489224107851773e-16_rk, -2.0411217403123548e-16_rk, 1.1443608754040344e-16_rk, 0.4880338717125846_rk   &
        /),(/4,8/))
        test_dbr2_vol_face1_dx(:,:,6,3) = reshape((/ &
        -1.632993161855453_rk, -1.1789695731485514e-16_rk, 2.3930390415136065e-16_rk, -2.369714050953975e-16_rk,   &
        0.6901841202733879_rk, -5.427764354061637e-16_rk, -2.6552704346355335e-16_rk, 3.2787354843520263e-17_rk,   &
        7.651538771875743e-16_rk, -0.6901841202733889_rk, -1.640153755052999e-16_rk, 2.8325374879867433e-16_rk,   &
        -8.044215440611375e-16_rk, 0.43755919896471385_rk, -3.4775616565190026e-16_rk, -3.4423461693727794e-16_rk,   &
        2.328029345012631e-16_rk, -5.925061592603931e-16_rk, -6.094413448457097_rk, 2.40615797061767e-16_rk,   &
        -9.921337929864553e-16_rk, 8.308830957050977e-16_rk, 2.5758022034375165_rk, -2.046203438886193e-16_rk,   &
        -7.745052528182556e-16_rk, 2.560605875606001e-17_rk, 1.085100267003318e-15_rk, -2.575802203437515_rk,   &
        4.147981465693878e-16_rk, -3.244575156077193e-16_rk, 1.6874955822257515e-16_rk, 1.6329931618554523_rk   &
        /),(/4,8/))
        test_dbr2_vol_face1_dx(:,:,7,1) = reshape((/ &
        -0.6901841202733889_rk, -3.9059414120440386e-17_rk, 1.4444090646001067e-16_rk, -1.442979568224998e-16_rk,   &
        0.43755919896471324_rk, -4.623776642871351e-16_rk, -2.91721847452457e-16_rk, 1.6716703616737375e-17_rk,   &
        6.905146459106733e-16_rk, -1.6329931618554507_rk, -3.209729346854197e-17_rk, 1.8090281284854597e-16_rk,   &
        -1.0452140135735322e-15_rk, 0.690184120273388_rk, -1.0934733064943512e-16_rk, -3.011556205843333e-16_rk,   &
        -2.886758275306067e-17_rk, -3.377720358033516e-16_rk, -2.5758022034375165_rk, 1.526067956665041e-16_rk,   &
        -8.729418041677523e-16_rk, 4.412464000412613e-16_rk, 1.6329931618554525_rk, -2.7690253699976452e-16_rk,   &
        -1.2119208535049039e-15_rk, 2.489373828435672e-16_rk, 8.163603742308418e-16_rk, -6.094413448457092_rk,   &
        8.362653880467091e-16_rk, -2.2062038978620423e-16_rk, 6.286545193831012e-18_rk, 2.5758022034375143_rk   &
        /),(/4,8/))
        test_dbr2_vol_face1_dx(:,:,7,2) = reshape((/ &
        -0.48803387171258483_rk, 7.392587520625826e-18_rk, 8.372668928204544e-17_rk, 9.643805909344378e-17_rk,   &
        0.4880338717125847_rk, -2.564714803163476e-16_rk, -4.493292421288287e-16_rk, -1.4356819101183137e-16_rk,   &
        2.156387694718113e-16_rk, -1.8213672050459173_rk, -1.0098232898194568e-16_rk, 9.565178861730271e-18_rk,   &
        -8.058380512830443e-16_rk, 1.8213672050459173_rk, 1.5325723125857344e-16_rk, -2.336043889236945e-16_rk,   &
        -2.0749981893248678e-16_rk, 7.021528171370222e-17_rk, -0.48803387171258505_rk, 4.723748139487984e-17_rk,   &
        -5.147769916358035e-16_rk, 6.402000620077895e-17_rk, 0.4880338717125852_rk, -8.316060701431904e-17_rk,   &
        -4.779915901559326e-16_rk, 2.731884075690827e-16_rk, 3.955334644312315e-16_rk, -1.8213672050459178_rk,   &
        5.667072294970436e-16_rk, -6.482922214492709e-17_rk, -1.0223561027469523e-16_rk, 1.8213672050459182_rk   &
        /),(/4,8/))
        test_dbr2_vol_face1_dx(:,:,7,3) = reshape((/ &
        -1.1102230246251565e-16_rk, 7.444752167507095e-17_rk, 7.152595913099803e-17_rk, -5.991474700793295e-17_rk,   &
        -0.25262492130867475_rk, -1.4711186096881018e-17_rk, -1.1048286936447992e-16_rk, 4.1457216292014937e-17_rk,   &
        -1.0923207982468084e-17_rk, -0.9428090415820625_rk, 3.441356762847905e-17_rk, 6.624767667643566e-18_rk,   &
        -8.264768492897272e-17_rk, 1.1877522784412632e-16_rk, 4.3029366899068057e-17_rk, -3.8701085260864266e-17_rk,   &
        6.349122739001849e-17_rk, 7.592041337437069e-17_rk, 1.837924768348585e-17_rk, 1.39880384193183e-17_rk,   &
        1.6382896811705635e-16_rk, -3.297263813799326e-16_rk, -0.9428090415820636_rk, -7.188753296977941e-17_rk,   &
        -3.7261897034463367e-16_rk, 2.339106891273099e-16_rk, 8.669148801600357e-17_rk, -3.518611245019577_rk,   &
        1.0209305374312921e-16_rk, 1.2852800904291592e-16_rk, -1.0870452323868575e-16_rk, -7.195936377354224e-16_rk   &
        /),(/4,8/))
        test_dbr2_vol_face1_dx(:,:,8,1) = reshape((/ &
        -0.9428090415820636_rk, -4.39002151934374e-18_rk, 1.663889568223479e-16_rk, -1.5258819528083065e-16_rk,   &
        2.4580839673830245e-17_rk, -9.510995721590948e-17_rk, -8.428806537557621e-17_rk, 5.752786751879783e-17_rk,   &
        6.371602329443305e-17_rk, 2.282432486383271e-16_rk, -9.75045144082788e-17_rk, 1.0897570361777183e-16_rk,   &
        1.5814478458342232e-16_rk, -0.2526249213086745_rk, -1.9537946810339705e-16_rk, -8.178008161380894e-17_rk,   &
        3.2516174464434213e-16_rk, -1.7881371008267108e-16_rk, -3.5186112450195797_rk, 1.0199703981458109e-16_rk,   &
        4.4636979298353336e-17_rk, 5.991031428390395e-17_rk, 1.393954149321658e-16_rk, 3.9466014136587505e-19_rk,   &
        6.479663034201453e-17_rk, 1.0579365039802699e-17_rk, 3.554313807884797e-16_rk, -3.943915360011667e-17_rk,   &
        -3.1937418773419223e-16_rk, 2.4690883221400856e-17_rk, 5.375848979005838e-17_rk, -0.9428090415820634_rk   &
        /),(/4,8/))
        test_dbr2_vol_face1_dx(:,:,8,2) = reshape((/ &
        -1.8213672050459184_rk, -1.1894962815866726e-16_rk, 2.318466486447434e-16_rk, -2.766358312859718e-16_rk,   &
        0.1307682818044209_rk, -6.722310837397763e-16_rk, -4.747553412013023e-16_rk, 2.810085485297898e-17_rk,   &
        4.279870004287842e-16_rk, -6.797434948471084_rk, -5.686366871617264e-17_rk, 2.9151749789167384e-16_rk,   &
        -4.865307243147779e-16_rk, 0.4880338717125849_rk, 1.3664015501996588e-16_rk, -3.200332038068064e-16_rk,   &
        3.3970165915546994e-16_rk, -7.001557968544697e-17_rk, -1.8213672050459193_rk, 1.6251310821098622e-17_rk,   &
        -3.9950431833069074e-16_rk, -1.0490757728525471e-17_rk, 0.13076828180442157_rk, -2.7252583373690587e-16_rk,   &
        -1.051857451684383e-15_rk, 4.718054928302124e-16_rk, 7.432338655735431e-16_rk, -6.7974349484710865_rk,   &
        2.942858358678667e-16_rk, 2.938257086916598e-17_rk, -8.653677918156639e-17_rk, 0.48803387171258417_rk   &
        /),(/4,8/))
        test_dbr2_vol_face1_dx(:,:,8,3) = reshape((/ &
        1.632993161855452_rk, -3.0998086035286844e-17_rk, -3.8235582241335657e-16_rk, 3.5680089911126337e-16_rk,   &
        -0.18493427765603837_rk, 5.721988075999259e-16_rk, 4.864927821925131e-16_rk, -1.1570178742755014e-16_rk,   &
        -7.433074612226383e-16_rk, 2.5758022034375134_rk, 9.51882402483417e-17_rk, -2.9650328413396147e-16_rk,   &
        9.69716913919083e-16_rk, -0.43755919896471385_rk, 2.616974318537641e-16_rk, 4.216367874590064e-16_rk,   &
        -3.597853892813002e-16_rk, 4.406653325116518e-16_rk, 6.094413448457097_rk, -2.6859187390040363e-16_rk,   &
        6.644758567523428e-16_rk, -1.7143033294523257e-16_rk, -0.6901841202733889_rk, 3.483954098281781e-16_rk,   &
        1.5197431935075236e-15_rk, -4.9342743701068e-16_rk, -1.258483243035325e-15_rk, 9.613024693476671_rk,   &
        -6.189842540556463e-16_rk, 6.740149752188746e-17_rk, 4.8659488254796417e-17_rk, -1.6329931618554514_rk   &
        /),(/4,8/))
        
        
        
        
        
        do inode_diff = 1,self%elem%nterms_c 
            do idir =1,3
                @assertEqual(transpose(test_dbr2_vol_face1_dx(:,:,inode_diff,idir)),self%faces(XI_MIN)%dbr2_v_dx(:,:,inode_diff,idir),tol)
            end do
        end do

        
        !
        ! dbr2_vol_face2_dx
        ! 
        test_dbr2_vol_face2_dx(:,:,1,1) = reshape((/ &
        -2.5758022034375156_rk, 2.238409167983612e-16_rk, 6.975470536365032e-16_rk, -2.562639812084866e-17_rk,   &
        6.094413448457095_rk, 4.111574883899728e-17_rk, -3.235104415152995e-16_rk, 2.989563362282655e-16_rk,   &
        6.792525789438602e-17_rk, -1.6329931618554512_rk, 9.450168580385345e-19_rk, -3.975503231321839e-16_rk,   &
        1.8084052173311499e-16_rk, 2.5758022034375134_rk, 3.231577331245761e-16_rk, 3.936249305728704e-17_rk,   &
        1.3748278378736243e-15_rk, -3.1236243762841686e-16_rk, -0.6901841202733894_rk, 1.9345872357438327e-16_rk,   &
        -4.960379246594059e-16_rk, 2.134299495722638e-18_rk, 1.6329931618554527_rk, -2.356869780187227e-16_rk,   &
        -4.50931565421726e-16_rk, 4.664920727033639e-16_rk, 3.89963125965652e-16_rk, -0.43755919896471446_rk,   &
        5.84387524018129e-16_rk, -2.4073397461046033e-16_rk, -6.573875625932502e-16_rk, 0.6901841202733889_rk   &
        /),(/4,8/))
        test_dbr2_vol_face2_dx(:,:,1,2) = reshape((/ &
        -1.8213672050459182_rk, 7.961607691101715e-17_rk, 3.174737460460718e-16_rk, 5.3784755044507264e-17_rk,   &
        1.8213672050459184_rk, 6.031965579830258e-17_rk, -2.397996644366176e-16_rk, 2.4847167342662946e-16_rk,   &
        1.9368471930907318e-16_rk, -0.4880338717125845_rk, 8.785012462981964e-18_rk, -1.5582066329094726e-16_rk,   &
        -4.0265403347108404e-16_rk, 0.4880338717125854_rk, 2.9507227108505517e-16_rk, -6.1468496983323e-17_rk,   &
        8.226268449073833e-16_rk, -3.821385845265835e-16_rk, -1.8213672050459184_rk, -7.588897150994191e-17_rk,   &
        -1.142215533284675e-16_rk, 4.5820431259677204e-17_rk, 1.8213672050459189_rk, -1.8124155844785698e-16_rk,   &
        -4.607879454694396e-16_rk, 4.986589615845553e-17_rk, 5.023020366014731e-16_rk, -0.48803387171258483_rk,   &
        3.9224247583547907e-16_rk, -1.9340302841795257e-17_rk, -4.1232869161505907e-16_rk, 0.48803387171258517_rk   &
        /),(/4,8/))
        test_dbr2_vol_face2_dx(:,:,1,3) = reshape((/ &
        5.551115123125783e-17_rk, -6.932873200931161e-17_rk, -1.2251945244184758e-16_rk, -1.29132109682228e-16_rk,   &
        3.518611245019579_rk, 8.724271422223368e-17_rk, 5.72909611871201e-17_rk, 7.300771627835573e-17_rk,   &
        -4.329469383027631e-18_rk, 0.942809041582063_rk, 5.336382964869247e-17_rk, 2.288967788381569e-16_rk,   &
        2.1701319859118193e-16_rk, 3.3945057178710125e-18_rk, -1.0447431276341156e-16_rk, -4.010337163096596e-17_rk,   &
        3.763915930525785e-16_rk, 2.9945263076703274e-17_rk, 6.242378047190184e-17_rk, 1.0904955392617496e-16_rk,   &
        -3.0275761251476565e-16_rk, 1.909200289996793e-16_rk, 0.942809041582064_rk, -1.2096946545493965e-16_rk,   &
        2.132946380611438e-17_rk, -6.879404895437381e-17_rk, -1.131001652268824e-16_rk, 0.25262492130867464_rk,   &
        1.744866161892911e-16_rk, 2.7722627355666612e-17_rk, 2.4876102864820573e-17_rk, 2.0827368470689336e-16_rk   &
        /),(/4,8/))
        test_dbr2_vol_face2_dx(:,:,2,1) = reshape((/ &
        0.9428090415820635_rk, -8.711274450154344e-17_rk, -1.5834092690928124e-16_rk, 7.014108540174602e-17_rk,   &
        -3.00356647831635e-16_rk, 1.164890504759005e-16_rk, -1.496028356212364e-16_rk, -6.804430493263678e-17_rk,   &
        -1.678612120111146e-17_rk, -1.2385649848327222e-16_rk, -6.262686905405976e-17_rk, 3.43308518720179e-17_rk,   &
        1.0779053544885028e-16_rk, 3.518611245019576_rk, 7.255231672105236e-19_rk, -2.1218094471097674e-17_rk,   &
        2.4284112652771724e-17_rk, 2.1735173932026072e-16_rk, 0.25262492130867475_rk, 1.2285918091575058e-17_rk,   &
        -2.5279628454244393e-17_rk, 1.580277947795527e-16_rk, 2.253398517351489e-16_rk, 1.208019767076359e-16_rk,   &
        1.3407335740780172e-16_rk, 3.798466509067655e-16_rk, -6.143608041628546e-17_rk, -6.910423280705366e-17_rk,   &
        6.683262569578317e-18_rk, -1.364271505943524e-16_rk, 9.081032915626119e-17_rk, 0.942809041582062_rk   &
        /),(/4,8/))
        test_dbr2_vol_face2_dx(:,:,2,2) = reshape((/ &
        -0.4880338717125848_rk, -1.8296107099420537e-16_rk, -1.295088928091198e-16_rk, -7.33449607548505e-17_rk,   &
        6.797434948471089_rk, -1.318395989961995e-16_rk, -2.0712028623417313e-16_rk, 1.8850463058699333e-16_rk,   &
        2.4084513041678504e-16_rk, -0.13076828180442138_rk, 2.3108819807007822e-16_rk, 1.7841848083054188e-16_rk,   &
        1.8385469094683776e-16_rk, 1.8213672050459184_rk, 7.242610078740951e-17_rk, -1.464096250035528e-16_rk,   &
        1.1530212910612259e-15_rk, -1.3859071368676961e-16_rk, -0.48803387171258483_rk, 1.604089796495782e-16_rk,   &
        -6.156550452510684e-16_rk, 6.42833065864967e-16_rk, 6.79743494847109_rk, -3.180751466776378e-16_rk,   &
        -3.287206598024615e-16_rk, 1.5757946847277467e-16_rk, 4.1583605888863435e-16_rk, -0.1307682818044218_rk,   &
        6.280010997258718e-16_rk, -2.2152928802678808e-16_rk, -2.236089119941674e-16_rk, 1.8213672050459178_rk   &
        /),(/4,8/))
        test_dbr2_vol_face2_dx(:,:,2,3) = reshape((/ &
        1.6329931618554523_rk, -6.739944028750614e-17_rk, -4.166866742853746e-16_rk, 8.46174224013306e-17_rk,   &
        -9.613024693476675_rk, -2.448475135371315e-16_rk, 4.158223159494159e-16_rk, -3.0391974757398447e-16_rk,   &
        -4.680966731024688e-17_rk, 0.6901841202733884_rk, 8.31802254732881e-18_rk, 1.3432269242200916e-16_rk,   &
        -5.056442557731474e-16_rk, -6.094413448457091_rk, -2.1940894352837504e-16_rk, 2.1958973044776547e-17_rk,   &
        -1.7755035435789745e-15_rk, 6.506543523145285e-17_rk, 0.4375591989647145_rk, -3.1479419559213326e-16_rk,   &
        8.240751656284159e-16_rk, -3.5108212327495476e-16_rk, -2.5758022034375165_rk, 2.358544667660263e-16_rk,   &
        2.9552874420780997e-16_rk, -7.775446746557558e-16_rk, -2.1542688032248434e-16_rk, 0.1849342776560398_rk,   &
        -7.655574027769984e-16_rk, 3.4943849784914623e-16_rk, 5.417011305721686e-16_rk, -1.6329931618554516_rk   &
        /),(/4,8/))
        test_dbr2_vol_face2_dx(:,:,3,1) = reshape((/ &
        0.6901841202733886_rk, -4.961542779527425e-17_rk, -3.8086519981794066e-16_rk, -1.146557726826433e-16_rk,   &
        -6.094413448457095_rk, -2.740938497907983e-16_rk, 6.227161127577722e-16_rk, -1.628677263629919e-16_rk,   &
        -3.435301549216305e-17_rk, 1.6329931618554512_rk, 1.2430872125008103e-16_rk, 3.288886193881481e-16_rk,   &
        -3.964215926308157e-16_rk, -9.613024693476664_rk, -3.246087794589971e-16_rk, 3.0736958849083075e-18_rk,   &
        -1.4233960631791678e-15_rk, -1.223410410121046e-16_rk, 0.18493427765603976_rk, -2.1803055975753336e-16_rk,   &
        5.465971815678947e-16_rk, -3.1818988905482815e-16_rk, -1.6329931618554527_rk, -5.9169753965491435e-18_rk,   &
        1.8278485060612253e-16_rk, -1.2261853745168948e-15_rk, -2.670909651330811e-16_rk, 0.43755919896471446_rk,   &
        -5.977540491572855e-16_rk, 5.135882757991651e-16_rk, 4.75766904280728e-16_rk, -2.5758022034375134_rk   &
        /),(/4,8/))
        test_dbr2_vol_face2_dx(:,:,3,2) = reshape((/ &
        -0.13076828180442096_rk, 4.5795355985916915e-17_rk, 1.549692453425571e-16_rk, 5.132619349523603e-16_rk,   &
        1.8213672050459184_rk, 1.1758625276171086e-16_rk, -4.458195803084527e-16_rk, -5.748801481574662e-17_rk,   &
        1.9704941874231662e-16_rk, -0.48803387171258494_rk, -9.241017100606131e-17_rk, -2.1617334290628898e-17_rk,   &
        -1.7385249511795674e-16_rk, 6.797434948471082_rk, 1.4254321121182267e-16_rk, -1.8193441146935813e-16_rk,   &
        8.406146302642639e-16_rk, 6.304181749861402e-17_rk, -0.13076828180442135_rk, -6.333174227287955e-17_rk,   &
        -4.282825791995276e-16_rk, 2.6807055695048983e-16_rk, 1.8213672050459193_rk, -1.8916490987236943e-16_rk,   &
        -3.3595513247711217e-16_rk, 7.748871990731027e-16_rk, 2.527391709997085e-16_rk, -0.48803387171258517_rk,   &
        6.940863477912631e-16_rk, -3.5665545126618683e-16_rk, -3.4070385822851915e-16_rk, 6.797434948471085_rk   &
        /),(/4,8/))
        test_dbr2_vol_face2_dx(:,:,3,3) = reshape((/ &
        5.551115123125783e-17_rk, -6.932873200931163e-17_rk, -1.2251945244184758e-16_rk, -1.291321096822279e-16_rk,   &
        3.518611245019579_rk, 8.72427142222337e-17_rk, 5.729096118712007e-17_rk, 7.300771627835572e-17_rk,   &
        -4.3294693830276436e-18_rk, 0.9428090415820626_rk, 5.3363829648692506e-17_rk, 2.288967788381569e-16_rk,   &
        2.1701319859118188e-16_rk, 3.3945057178710125e-18_rk, -1.0447431276341154e-16_rk, -4.0103371630966037e-17_rk,   &
        3.7639159305257847e-16_rk, 2.994526307670325e-17_rk, 6.242378047190184e-17_rk, 1.0904955392617496e-16_rk,   &
        -3.0275761251476555e-16_rk, 1.909200289996793e-16_rk, 0.942809041582064_rk, -1.209694654549396e-16_rk,   &
        2.132946380611433e-17_rk, -6.879404895437364e-17_rk, -1.131001652268824e-16_rk, 0.25262492130867464_rk,   &
        1.744866161892912e-16_rk, 2.7722627355666612e-17_rk, 2.4876102864820555e-17_rk, 2.0827368470689336e-16_rk   &
        /),(/4,8/))
        test_dbr2_vol_face2_dx(:,:,4,1) = reshape((/ &
        0.9428090415820637_rk, -8.711274450154349e-17_rk, -1.5834092690928124e-16_rk, 7.014108540174597e-17_rk,   &
        1.4373256201842764e-16_rk, 1.1648905047590053e-16_rk, -1.496028356212364e-16_rk, -6.804430493263678e-17_rk,   &
        -1.678612120111146e-17_rk, -1.2385649848327222e-16_rk, -6.26268690540598e-17_rk, 3.433085187201795e-17_rk,   &
        1.0779053544885043e-16_rk, 3.518611245019576_rk, 7.255231672105051e-19_rk, -2.121809447109768e-17_rk,   &
        2.4284112652771773e-17_rk, 2.1735173932026072e-16_rk, 0.25262492130867475_rk, 1.2285918091575008e-17_rk,   &
        -2.5279628454244442e-17_rk, 1.5802779477955275e-16_rk, -2.187493581149137e-16_rk, 1.208019767076359e-16_rk,   &
        1.3407335740780175e-16_rk, 3.798466509067655e-16_rk, -6.143608041628548e-17_rk, -6.910423280705366e-17_rk,   &
        6.68326256957828e-18_rk, -1.3642715059435246e-16_rk, 9.081032915626115e-17_rk, 0.9428090415820625_rk   &
        /),(/4,8/))
        test_dbr2_vol_face2_dx(:,:,4,2) = reshape((/ &
        -0.4880338717125848_rk, 7.495421445594363e-17_rk, 2.950129423503313e-16_rk, 3.0246821805535816e-16_rk,   &
        0.48803387171258483_rk, -7.070613816014729e-17_rk, -3.8588679092978e-16_rk, 1.0628566426707489e-16_rk,   &
        3.4556710243668626e-16_rk, -1.821367205045917_rk, -1.9522428058654568e-17_rk, -4.616558753263495e-16_rk,   &
        -3.8587188228951273e-17_rk, 1.821367205045918_rk, 2.15821959591547e-16_rk, 7.036651291927496e-17_rk,   &
        5.974987372170851e-16_rk, -1.953117145626103e-16_rk, -0.48803387171258494_rk, -1.8646843826778065e-16_rk,   &
        -1.802445632903718e-16_rk, -1.6384784000122647e-16_rk, 0.48803387171258505_rk, 1.6557362136601485e-16_rk,   &
        -8.291611308392165e-16_rk, 5.926816692847995e-16_rk, 5.8986592538880065e-16_rk, -1.8213672050459182_rk,   &
        4.3964479097568807e-16_rk, -2.1794317074120626e-16_rk, -2.540649334860243e-16_rk, 1.8213672050459178_rk   &
        /),(/4,8/))
        test_dbr2_vol_face2_dx(:,:,4,3) = reshape((/ &
        -1.6329931618554523_rk, 2.060569043061294e-16_rk, 6.617255791690696e-16_rk, 1.7364679696312529e-16_rk,   &
        2.575802203437516_rk, 7.036208509266413e-17_rk, -5.30404238323656e-16_rk, 1.5790431501727297e-16_rk,   &
        5.546860607630212e-17_rk, -2.575802203437514_rk, -1.1504568184471376e-16_rk, -5.92116250098323e-16_rk,   &
        7.16178585907836e-17_rk, 6.094413448457091_rk, 4.2835756905519817e-16_rk, 5.824777021715544e-17_rk,   &
        1.0227203574738176e-15_rk, -1.2495596138485937e-16_rk, -0.4375591989647145_rk, 9.669508773978335e-17_rk,   &
        -2.1855994059888462e-16_rk, -3.075793472440386e-17_rk, 0.6901841202733887_rk, 6.084464143852873e-18_rk,   &
        -3.381876718200388e-16_rk, 9.151327725645032e-16_rk, 4.4162721077624914e-16_rk, -0.6901841202733892_rk,   &
        4.1658417039841607e-16_rk, -4.0488375256047945e-16_rk, -5.914533363018098e-16_rk, 1.6329931618554516_rk   &
        /),(/4,8/))
        test_dbr2_vol_face2_dx(:,:,5,1) = reshape((/ &
        -0.6901841202733886_rk, -1.8761916172070877e-16_rk, -1.3154234053633192e-16_rk, 2.637041371184444e-16_rk,   &
        1.6329931618554525_rk, -9.90323377750417e-17_rk, -4.349368217377276e-16_rk, 2.60883890716506e-16_rk,   &
        6.206423653983657e-16_rk, -0.4375591989647139_rk, 1.6107845755475841e-16_rk, -2.3092454525440025e-17_rk,   &
        -6.475596805542994e-16_rk, 0.690184120273388_rk, 2.979596326819689e-16_rk, -1.8006267536711385e-16_rk,   &
        1.0263467855650463e-15_rk, -4.64167802584926e-16_rk, -2.5758022034375165_rk, -3.1920875622126983e-16_rk,   &
        -2.282817555164055e-16_rk, 4.01359277121918e-16_rk, 6.094413448457097_rk, -1.2846215469301335e-16_rk,   &
        -1.0194670624143424e-15_rk, 1.345436921129275e-16_rk, 1.0315379195391184e-15_rk, -1.6329931618554518_rk,   &
        7.252667542682312e-16_rk, -9.73712997083835e-17_rk, -2.6349968057881836e-16_rk, 2.5758022034375143_rk   &
        /),(/4,8/))
        test_dbr2_vol_face2_dx(:,:,5,2) = reshape((/ &
        1.8213672050459182_rk, -7.961607691101715e-17_rk, -3.174737460460718e-16_rk, -5.3784755044507214e-17_rk,   &
        -1.8213672050459184_rk, -6.03196557983026e-17_rk, 2.397996644366176e-16_rk, -2.4847167342662946e-16_rk,   &
        -1.9368471930907318e-16_rk, 0.4880338717125845_rk, -8.785012462981952e-18_rk, 1.5582066329094726e-16_rk,   &
        4.0265403347108404e-16_rk, -0.4880338717125845_rk, -2.9507227108505517e-16_rk, 6.146849698332303e-17_rk,   &
        -8.226268449073833e-16_rk, 3.821385845265835e-16_rk, 1.8213672050459184_rk, 7.588897150994191e-17_rk,   &
        1.142215533284675e-16_rk, -4.5820431259677204e-17_rk, -1.8213672050459189_rk, 1.8124155844785698e-16_rk,   &
        4.607879454694396e-16_rk, -4.986589615845543e-17_rk, -5.023020366014731e-16_rk, 0.48803387171258483_rk,   &
        -3.9224247583547907e-16_rk, 1.9340302841795158e-17_rk, 4.1232869161505907e-16_rk, -0.4880338717125843_rk   &
        /),(/4,8/))
        test_dbr2_vol_face2_dx(:,:,5,3) = reshape((/ &
        -5.551115123125783e-17_rk, -1.1304491530415283e-16_rk, -1.77662815961158e-16_rk, -1.3660793751374313e-16_rk,   &
        0.9428090415820636_rk, -1.3047059893680847e-16_rk, 6.91160465321603e-17_rk, -1.4870127651393085e-17_rk,   &
        -6.97201471714724e-17_rk, 0.25262492130867453_rk, 1.238446435243411e-16_rk, 2.2370413886399436e-16_rk,   &
        -5.97230374061028e-17_rk, -3.3945057178710125e-18_rk, 3.0781286089373135e-18_rk, -1.1318050549369588e-16_rk,   &
        1.6422171872682358e-17_rk, 1.0162541278291809e-17_rk, 4.8598521990613813e-17_rk, 1.3622982052366947e-16_rk,   &
        -5.124091879345884e-18_rk, 3.794895097920132e-16_rk, 3.51861124501958_rk, -2.2102185814124689e-16_rk,   &
        3.3253538684416537e-16_rk, -2.38869667749e-16_rk, -9.957533504374734e-18_rk, 0.942809041582064_rk,   &
        -4.129859299276932e-17_rk, -3.025839520643181e-17_rk, -3.3404435399652688e-18_rk, -2.0827368470689336e-16_rk   &
        /),(/4,8/))
        test_dbr2_vol_face2_dx(:,:,6,1) = reshape((/ &
        0.25262492130867475_rk, 6.319788339078726e-17_rk, 4.3432892488491907e-17_rk, 2.547583443115682e-16_rk,   &
        -1.4373256201842764e-16_rk, -7.599545142759772e-17_rk, 3.924756048779879e-18_rk, -1.4830186539326935e-16_rk,   &
        1.916532298701243e-17_rk, -9.818810644175908e-17_rk, -8.928931400317476e-18_rk, 6.056523212191647e-17_rk,   &
        5.3996583866559894e-17_rk, 0.9428090415820627_rk, -1.0857985573158212e-16_rk, -6.396417056381645e-17_rk,   &
        -1.1564827648393503e-17_rk, 9.743834180310986e-17_rk, 0.9428090415820637_rk, -3.406616145134201e-18_rk,   &
        -1.9679505264558595e-16_rk, -8.732237840166942e-19_rk, 2.187493581149137e-16_rk, -1.2640463222963266e-16_rk,   &
        -4.58032288263348e-17_rk, 1.3282082888888755e-16_rk, -1.150315141830692e-16_rk, -4.1918069655461993e-17_rk,   &
        2.0675258614996054e-16_rk, -1.0209067825348165e-16_rk, -4.016392376728202e-17_rk, 3.5186112450195752_rk   &
        /),(/4,8/))
        test_dbr2_vol_face2_dx(:,:,6,2) = reshape((/ &
        0.4880338717125848_rk, 1.8296107099420537e-16_rk, 1.295088928091198e-16_rk, 7.334496075485055e-17_rk,   &
        -6.797434948471089_rk, 1.318395989961995e-16_rk, 2.0712028623417313e-16_rk, -1.8850463058699333e-16_rk,   &
        -2.4084513041678504e-16_rk, 0.13076828180442138_rk, -2.3108819807007822e-16_rk, -1.7841848083054188e-16_rk,   &
        -1.8385469094683776e-16_rk, -1.8213672050459175_rk, -7.242610078740951e-17_rk, 1.464096250035528e-16_rk,   &
        -1.1530212910612259e-15_rk, 1.3859071368676961e-16_rk, 0.48803387171258483_rk, -1.604089796495782e-16_rk,   &
        6.156550452510684e-16_rk, -6.42833065864967e-16_rk, -6.79743494847109_rk, 3.180751466776378e-16_rk,   &
        3.287206598024615e-16_rk, -1.5757946847277457e-16_rk, -4.1583605888863435e-16_rk, 0.1307682818044218_rk,   &
        -6.280010997258718e-16_rk, 2.2152928802678808e-16_rk, 2.236089119941674e-16_rk, -1.8213672050459169_rk   &
        /),(/4,8/))
        test_dbr2_vol_face2_dx(:,:,6,3) = reshape((/ &
        0.43755919896471407_rk, 2.374661936340743e-16_rk, 2.6577226400899804e-16_rk, -3.818545439162696e-16_rk,   &
        -2.5758022034375156_rk, 3.054983881394479e-16_rk, 3.618960191567875e-16_rk, -9.77118976718436e-17_rk,   &
        -5.700875412139058e-16_rk, 0.18493427765603937_rk, -2.75994169678782e-16_rk, -2.6117691646047075e-16_rk,   &
        6.532861340938423e-16_rk, -1.6329931618554518_rk, -1.9245790555932403e-16_rk, 3.572073514246261e-16_rk,   &
        -1.0312041297893352e-15_rk, 3.5656691950352443e-16_rk, 1.6329931618554527_rk, 1.863855518427346e-16_rk,   &
        4.3020090004133735e-16_rk, -7.799755631299145e-16_rk, -9.613024693476676_rk, 4.758886450638929e-16_rk,   &
        7.327349043965121e-16_rk, -2.849485325281515e-17_rk, -9.065488718516746e-16_rk, 0.6901841202733887_rk,   &
        -8.907207474254225e-16_rk, 2.2972037316829707e-16_rk, 3.0700404788606574e-16_rk, -6.094413448457092_rk   &
        /),(/4,8/))
        test_dbr2_vol_face2_dx(:,:,7,1) = reshape((/ &
        0.18493427765603893_rk, 6.12233949391342e-17_rk, 4.4676555559348084e-17_rk, -7.73220825741581e-16_rk,   &
        -1.6329931618554525_rk, 2.5102324063023704e-16_rk, 4.2708730964016795e-16_rk, 3.571984007003266e-17_rk,   &
        -6.589730113723906e-16_rk, 0.4375591989647139_rk, -1.432205947541234e-16_rk, -9.803800971839287e-17_rk,   &
        5.395665128211796e-16_rk, -2.575802203437514_rk, -8.079992121880466e-17_rk, 3.079910164947467e-16_rk,   &
        -1.0032171302682593e-15_rk, 2.6929111897870624e-16_rk, 0.6901841202733889_rk, 3.2602198851153825e-16_rk,   &
        6.218718608075773e-16_rk, -3.996128295538845e-16_rk, -6.094413448457097_rk, 3.8127141915227865e-16_rk,   &
        1.111073520067012e-15_rk, -4.001853498907026e-16_rk, -8.0147489117298015e-16_rk, 1.6329931618554518_rk,   &
        -1.1387719265681522e-15_rk, 3.015526562153468e-16_rk, 3.4382752811338245e-16_rk, -9.613024693476667_rk   &
        /),(/4,8/))
        test_dbr2_vol_face2_dx(:,:,7,2) = reshape((/ &
        0.13076828180442096_rk, -4.5795355985916915e-17_rk, -1.549692453425571e-16_rk, -5.132619349523605e-16_rk,   &
        -1.8213672050459184_rk, -1.1758625276171086e-16_rk, 4.458195803084527e-16_rk, 5.748801481574662e-17_rk,   &
        -1.9704941874231662e-16_rk, 0.48803387171258494_rk, 9.241017100606132e-17_rk, 2.1617334290628898e-17_rk,   &
        1.738524951179568e-16_rk, -6.797434948471085_rk, -1.4254321121182267e-16_rk, 1.8193441146935818e-16_rk,   &
        -8.406146302642639e-16_rk, -6.304181749861402e-17_rk, 0.13076828180442135_rk, 6.333174227287955e-17_rk,   &
        4.282825791995276e-16_rk, -2.6807055695048983e-16_rk, -1.8213672050459193_rk, 1.8916490987236943e-16_rk,   &
        3.3595513247711217e-16_rk, -7.74887199073103e-16_rk, -2.527391709997085e-16_rk, 0.48803387171258517_rk,   &
        -6.940863477912631e-16_rk, 3.5665545126618692e-16_rk, 3.4070385822851915e-16_rk, -6.797434948471087_rk   &
        /),(/4,8/))
        test_dbr2_vol_face2_dx(:,:,7,3) = reshape((/ &
        -5.551115123125783e-17_rk, -1.1304491530415283e-16_rk, -1.77662815961158e-16_rk, -1.3660793751374303e-16_rk,   &
        0.9428090415820636_rk, -1.3047059893680844e-16_rk, 6.911604653216032e-17_rk, -1.487012765139308e-17_rk,   &
        -6.97201471714723e-17_rk, 0.25262492130867453_rk, 1.2384464352434105e-16_rk, 2.2370413886399436e-16_rk,   &
        -5.972303740610286e-17_rk, -3.3945057178710125e-18_rk, 3.0781286089372827e-18_rk, -1.1318050549369586e-16_rk,   &
        1.6422171872682432e-17_rk, 1.0162541278291735e-17_rk, 4.8598521990613813e-17_rk, 1.3622982052366947e-16_rk,   &
        -5.1240918793459336e-18_rk, 3.79489509792013e-16_rk, 3.51861124501958_rk, -2.2102185814124674e-16_rk,   &
        3.32535386844165e-16_rk, -2.3886966774899974e-16_rk, -9.957533504374734e-18_rk, 0.9428090415820631_rk,   &
        -4.129859299276921e-17_rk, -3.025839520643181e-17_rk, -3.340443539965349e-18_rk, 6.799047349932319e-16_rk   &
        /),(/4,8/))
        test_dbr2_vol_face2_dx(:,:,8,1) = reshape((/ &
        0.252624921308675_rk, 6.319788339078731e-17_rk, 4.343289248849192e-17_rk, 2.547583443115684e-16_rk,   &
        3.00356647831635e-16_rk, -7.599545142759764e-17_rk, 3.924756048779879e-18_rk, -1.4830186539326935e-16_rk,   &
        1.916532298701243e-17_rk, -9.818810644175908e-17_rk, -8.928931400317531e-18_rk, 6.056523212191642e-17_rk,   &
        5.3996583866559845e-17_rk, 0.9428090415820627_rk, -1.0857985573158209e-16_rk, -6.396417056381644e-17_rk,   &
        -1.1564827648393552e-17_rk, 9.743834180310986e-17_rk, 0.9428090415820637_rk, -3.4066161451342503e-18_rk,   &
        -1.967950526455859e-16_rk, -8.732237840167435e-19_rk, -2.253398517351489e-16_rk, -1.2640463222963266e-16_rk,   &
        -4.5803228826334826e-17_rk, 1.3282082888888755e-16_rk, -1.1503151418306917e-16_rk, -4.1918069655461993e-17_rk,   &
        2.067525861499606e-16_rk, -1.020906782534816e-16_rk, -4.0163923767282086e-17_rk, 3.518611245019577_rk   &
        /),(/4,8/))
        test_dbr2_vol_face2_dx(:,:,8,2) = reshape((/ &
        0.4880338717125848_rk, -7.495421445594363e-17_rk, -2.950129423503313e-16_rk, -3.0246821805535807e-16_rk,   &
        -0.48803387171258483_rk, 7.07061381601473e-17_rk, 3.8588679092978e-16_rk, -1.0628566426707489e-16_rk,   &
        -3.4556710243668626e-16_rk, 1.821367205045917_rk, 1.9522428058654556e-17_rk, 4.616558753263495e-16_rk,   &
        3.858718822895125e-17_rk, -1.821367205045917_rk, -2.15821959591547e-16_rk, -7.036651291927498e-17_rk,   &
        -5.974987372170851e-16_rk, 1.953117145626103e-16_rk, 0.48803387171258494_rk, 1.8646843826778065e-16_rk,   &
        1.802445632903718e-16_rk, 1.6384784000122647e-16_rk, -0.48803387171258505_rk, -1.6557362136601485e-16_rk,   &
        8.291611308392165e-16_rk, -5.926816692847994e-16_rk, -5.8986592538880065e-16_rk, 1.8213672050459182_rk,   &
        -4.3964479097568807e-16_rk, 2.1794317074120626e-16_rk, 2.540649334860243e-16_rk, -1.8213672050459169_rk   &
        /),(/4,8/))
        test_dbr2_vol_face2_dx(:,:,8,3) = reshape((/ &
        -0.43755919896471396_rk, -1.1376363025768645e-17_rk, 8.955336791331801e-17_rk, 6.550704189437558e-16_rk,   &
        0.6901841202733889_rk, -4.455719026583098e-17_rk, -5.001281122211082e-16_rk, 1.2745215297462974e-16_rk,   &
        7.095278355568506e-16_rk, -0.6901841202733884_rk, 2.830488263009988e-17_rk, -1.8623136126751796e-16_rk,   &
        -5.338400592816366e-16_rk, 1.6329931618554518_rk, 1.8630164834144947e-16_rk, -1.3084634043723438e-16_rk,   &
        9.983597860439704e-16_rk, -3.7689200206010797e-16_rk, -1.6329931618554527_rk, -4.588451928900736e-16_rk,   &
        -4.199527162826456e-16_rk, 2.0996543545888332e-17_rk, 2.5758022034375165_rk, -3.384492878139919e-17_rk,   &
        -1.3978056780848427e-15_rk, 5.062341887508149e-16_rk, 9.264639388604241e-16_rk, -2.5758022034375156_rk,   &
        9.73317933410961e-16_rk, -1.6920358275543342e-16_rk, -3.0032316080613512e-16_rk, 6.094413448457092_rk   &
        /),(/4,8/))
        
        
        



        
        do inode_diff = 1,self%elem%nterms_c 
            do idir =1,3
                @assertEqual(transpose(test_dbr2_vol_face2_dx(:,:,inode_diff,idir)),self%faces(XI_MAX)%dbr2_v_dx(:,:,inode_diff,idir),tol)
            end do
        end do
        
        
        !
        ! dbr2_vol_face3_dx
        ! 
        test_dbr2_vol_face3_dx(:,:,1,1) = reshape((/ &
        9.613024693476673_rk, -1.8707561321771285e-16_rk, -3.465012616433383e-16_rk, 1.0305991596604652e-15_rk,   &
        3.436069319539721e-16_rk, 6.094413448457094_rk, 3.780234263063901e-16_rk, -2.7862650269238655e-16_rk,   &
        -1.6329931618554516_rk, 8.144154088473016e-16_rk, 4.497788470448563e-16_rk, -5.191452229338604e-18_rk,   &
        1.01585836521923e-15_rk, -0.6901841202733879_rk, -4.916708615781026e-18_rk, 2.4149994352822304e-16_rk,   &
        -6.264754372936299e-16_rk, 9.778919868289009e-16_rk, 2.5758022034375165_rk, -7.942866391690599e-17_rk,   &
        1.839078674470278e-15_rk, -3.986326691588804e-16_rk, -8.605518761891283e-16_rk, 1.6329931618554527_rk,   &
        5.599967930096357e-16_rk, 7.531631273505869e-17_rk, -0.43755919896471485_rk, 3.5236449311724816e-16_rk,   &
        -2.3025679520234983e-16_rk, 4.771308021346591e-16_rk, -4.1529009366036734e-17_rk, -0.1849342776560396_rk   &
        /),(/4,8/))
        test_dbr2_vol_face3_dx(:,:,1,2) = reshape((/ &
        6.797434948471087_rk, -3.378469772311543e-16_rk, -5.586829621555272e-16_rk, 7.996900169488785e-16_rk,   &
        2.572965933470528e-16_rk, 1.8213672050459186_rk, 4.067245736436225e-16_rk, -1.7947541954471336e-16_rk,   &
        -0.4880338717125849_rk, 3.807073170296623e-16_rk, 3.4020587694403715e-17_rk, -9.936848618725097e-17_rk,   &
        8.085345228876326e-16_rk, -0.13076828180442152_rk, 6.016185277753164e-16_rk, 1.3810567597785056e-16_rk,   &
        -5.683651187618669e-16_rk, 9.510554034534098e-16_rk, 6.79743494847109_rk, -1.4375306085640545e-16_rk,   &
        1.2516820920432946e-15_rk, -2.4083029823310407e-16_rk, -1.1895305350476359e-15_rk, 1.8213672050459189_rk,   &
        5.252102650954918e-16_rk, -1.5142991915481903e-17_rk, -0.48803387171258517_rk, 4.1728904220963893e-16_rk,   &
        -2.822856754523757e-16_rk, 1.6440367917887347e-16_rk, -2.1885682679308343e-16_rk, -0.13076828180442157_rk   &
        /),(/4,8/))
        test_dbr2_vol_face3_dx(:,:,1,3) = reshape((/ &
        3.3306690738754696e-16_rk, 3.391260738665833e-18_rk, -1.2115468509835934e-16_rk, -2.2622756330847132e-17_rk,   &
        -2.421350732357382e-16_rk, 3.518611245019579_rk, -1.649314205295166e-16_rk, -4.409873300894384e-17_rk,   &
        0.9428090415820628_rk, 2.155503600847641e-16_rk, 6.461584342262377e-17_rk, -1.009002078709737e-16_rk,   &
        1.0398039371429241e-16_rk, 2.5774568594985596e-16_rk, -3.203555358740202e-17_rk, -4.2255402022804705e-17_rk,   &
        2.5755816607247592e-17_rk, 2.0245620306951742e-16_rk, -1.1686250176292056e-18_rk, -8.468272551694201e-17_rk,   &
        2.841506422029279e-17_rk, -4.062949043786391e-16_rk, -1.1355213252535914e-16_rk, 0.942809041582064_rk,   &
        -2.602794718219277e-16_rk, 1.5085188618192084e-17_rk, 0.2526249213086745_rk, 7.136939306613372e-17_rk,   &
        5.49690665583301e-17_rk, 4.3363173704099807e-16_rk, 9.214644292119404e-17_rk, -5.512565324010659e-17_rk   &
        /),(/4,8/))
        test_dbr2_vol_face3_dx(:,:,2,1) = reshape((/ &
        -3.5186112450195783_rk, 8.75889326545467e-17_rk, 2.740711973629032e-17_rk, -1.9183401678951454e-16_rk,   &
        -9.428755063059324e-17_rk, -8.866272449683934e-16_rk, 1.6241575906451518e-16_rk, 9.525765783271579e-17_rk,   &
        2.1886986898323264e-16_rk, -9.516726437302053e-17_rk, 4.431703895494805e-17_rk, 8.804976540108144e-17_rk,   &
        -7.364933594428117e-17_rk, -0.9428090415820626_rk, -1.6820569146431296e-16_rk, -3.549947688964708e-17_rk,   &
        3.129951918462842e-16_rk, 2.4743757654482727e-17_rk, -0.9428090415820636_rk, 3.457781139657755e-17_rk,   &
        -5.128595076527494e-16_rk, 4.329168183009608e-17_rk, 1.651275628553755e-16_rk, 2.7530268570756003e-16_rk,   &
        -3.0458558809443627e-16_rk, -4.195113534113416e-17_rk, -4.210770140599844e-17_rk, -8.801667909849699e-17_rk,   &
        -2.4902699208994653e-17_rk, 1.0463087882827564e-16_rk, 1.72423791512324e-16_rk, -0.25262492130867464_rk   &
        /),(/4,8/))
        test_dbr2_vol_face3_dx(:,:,2,2) = reshape((/ &
        1.8213672050459182_rk, -1.723612840643491e-16_rk, -1.7909527202443745e-16_rk, 7.485194593062283e-16_rk,   &
        -3.079799834750315e-16_rk, 6.797434948471088_rk, 1.2004815405511854e-16_rk, 1.718651795601091e-17_rk,   &
        -0.13076828180442163_rk, 8.441357648186438e-16_rk, 2.377515493024869e-16_rk, 4.384647704395157e-17_rk,   &
        5.819997728932596e-16_rk, -0.4880338717125844_rk, 6.641110602545895e-17_rk, -1.1539133077456092e-17_rk,   &
        -2.3373328948322156e-16_rk, 6.965591069967126e-16_rk, 1.8213672050459189_rk, -3.773973572375413e-16_rk,   &
        9.396480803042439e-16_rk, -9.398113990657831e-16_rk, -1.1047423179578177e-15_rk, 6.79743494847109_rk,   &
        -1.0684043854184564e-16_rk, -1.2645157436272035e-17_rk, -0.1307682818044217_rk, 4.743033273094222e-16_rk,   &
        -2.622730057692383e-16_rk, 9.090608637060593e-16_rk, 1.3312320362050439e-17_rk, -0.4880338717125853_rk   &
        /),(/4,8/))
        test_dbr2_vol_face3_dx(:,:,2,3) = reshape((/ &
        -6.094413448457095_rk, 9.60954198245003e-17_rk, 4.402488270054072e-16_rk, -8.16142386540104e-16_rk,   &
        -7.184308087640714e-18_rk, -9.613024693476673_rk, -3.7550776484138884e-16_rk, 2.2746757786861455e-16_rk,   &
        0.6901841202733888_rk, -9.34798504559045e-16_rk, -5.587117294224281e-16_rk, 1.8041894699230827e-17_rk,   &
        -1.0461894229892411e-15_rk, 1.6329931618554512_rk, 2.0515795366749606e-16_rk, -1.637450646157713e-16_rk,   &
        2.877244288400978e-16_rk, -1.2050919475529009e-15_rk, -1.6329931618554527_rk, 1.2953357803727044e-16_rk,   &
        -1.3546342310378214e-15_rk, 7.616358917074235e-16_rk, 8.089764458591119e-16_rk, -2.5758022034375165_rk,   &
        4.868266906728266e-18_rk, -4.8450366012116626e-17_rk, 0.18493427765604065_rk, -3.35717207084885e-16_rk,   &
        2.001904278530144e-16_rk, -1.0153934180039327e-15_rk, -2.2304122506748133e-16_rk, 0.43755919896471407_rk   &
        /),(/4,8/))
        test_dbr2_vol_face3_dx(:,:,3,1) = reshape((/ &
        -2.5758022034375148_rk, 1.1897747908619452e-17_rk, 2.9168702217075767e-16_rk, -6.469311260814363e-16_rk,   &
        -1.5503183069278553e-16_rk, -6.094413448457093_rk, -7.028549444354204e-16_rk, 8.811118702695497e-17_rk,   &
        1.6329931618554512_rk, -6.240808801012605e-16_rk, -5.384129249547523e-16_rk, -1.7090807857282428e-16_rk,   &
        -8.685596933306675e-16_rk, 2.575802203437513_rk, 3.4132809154440695e-16_rk, -1.7050098974892882e-16_rk,   &
        4.850536010612119e-19_rk, -1.0273795021378661e-15_rk, -0.6901841202733894_rk, 1.0273041123750904e-17_rk,   &
        -8.133596591647791e-16_rk, 3.1204930549868827e-16_rk, 5.302967504783774e-16_rk, -1.6329931618554527_rk,   &
        4.9174383179236806e-17_rk, 8.585957947209659e-18_rk, 0.43755919896471496_rk, -1.7633113492025426e-16_rk,   &
        2.8006219362033903e-16_rk, -6.863925597912107e-16_rk, -3.0331857365861123e-16_rk, 0.6901841202733889_rk   &
        /),(/4,8/))
        test_dbr2_vol_face3_dx(:,:,3,2) = reshape((/ &
        0.48803387171258517_rk, 8.342881596450131e-17_rk, -5.758093804724099e-18_rk, 5.792980973731073e-16_rk,   &
        2.4254108267316325e-16_rk, 1.8213672050459182_rk, 5.145008341423429e-16_rk, 1.5952207859629992e-16_rk,   &
        -0.48803387171258455_rk, 9.964066940907246e-17_rk, 1.2628809086013294e-16_rk, 1.6083407380181103e-16_rk,   &
        7.137148956824852e-16_rk, -1.8213672050459166_rk, -1.758893022591316e-16_rk, -1.0397667390407857e-16_rk,   &
        8.737795403987727e-17_rk, 4.706230130061909e-16_rk, 0.48803387171258505_rk, -7.965430464362003e-17_rk,   &
        5.474814451120086e-16_rk, -5.4923353139448087e-17_rk, -4.515684959259734e-16_rk, 1.8213672050459193_rk,   &
        1.2942536530671354e-18_rk, -8.254711882678679e-17_rk, -0.4880338717125853_rk, 1.649664019969225e-16_rk,   &
        -5.599600890781127e-16_rk, 4.45588984268911e-16_rk, 4.0514727885669234e-16_rk, -1.8213672050459182_rk   &
        /),(/4,8/))
        test_dbr2_vol_face3_dx(:,:,3,3) = reshape((/ &
        -1.1102230246251565e-16_rk, 3.391260738665864e-18_rk, -1.211546850983593e-16_rk, -2.2622756330847157e-17_rk,   &
        -2.4213507323573815e-16_rk, 3.518611245019579_rk, -1.6493142052951656e-16_rk, -4.409873300894384e-17_rk,   &
        0.9428090415820626_rk, 2.15550360084764e-16_rk, 6.461584342262385e-17_rk, -1.0090020787097368e-16_rk,   &
        1.0398039371429228e-16_rk, 2.5774568594985596e-16_rk, -3.203555358740202e-17_rk, -4.2255402022804705e-17_rk,   &
        2.5755816607247666e-17_rk, 2.0245620306951735e-16_rk, -1.1686250176292056e-18_rk, -8.468272551694206e-17_rk,   &
        2.8415064220292546e-17_rk, -4.062949043786391e-16_rk, -1.1355213252535914e-16_rk, 0.942809041582064_rk,   &
        -2.602794718219276e-16_rk, 1.5085188618192072e-17_rk, 0.25262492130867437_rk, 7.13693930661337e-17_rk,   &
        5.496906655833001e-17_rk, 4.3363173704099797e-16_rk, 9.214644292119402e-17_rk, -5.512565324010659e-17_rk   &
        /),(/4,8/))
        test_dbr2_vol_face3_dx(:,:,4,1) = reshape((/ &
        -3.518611245019579_rk, 8.758893265454673e-17_rk, 2.740711973629032e-17_rk, -1.9183401678951457e-16_rk,   &
        -9.428755063059332e-17_rk, 1.5511747317318545e-18_rk, 1.6241575906451513e-16_rk, 9.525765783271574e-17_rk,   &
        2.1886986898323264e-16_rk, -9.516726437302048e-17_rk, 4.431703895494805e-17_rk, 8.804976540108146e-17_rk,   &
        -7.364933594428129e-17_rk, -0.9428090415820626_rk, -1.6820569146431296e-16_rk, -3.5499476889647143e-17_rk,   &
        3.129951918462842e-16_rk, 2.4743757654482727e-17_rk, -0.9428090415820631_rk, 3.457781139657757e-17_rk,   &
        -5.128595076527495e-16_rk, 4.329168183009608e-17_rk, 1.651275628553757e-16_rk, -1.6878652414250259e-16_rk,   &
        -3.0458558809443627e-16_rk, -4.1951135341134186e-17_rk, -4.210770140599844e-17_rk, -8.801667909849699e-17_rk,   &
        -2.4902699208994628e-17_rk, 1.0463087882827591e-16_rk, 1.72423791512324e-16_rk, -0.25262492130867464_rk   &
        /),(/4,8/))
        test_dbr2_vol_face3_dx(:,:,4,2) = reshape((/ &
        1.8213672050459186_rk, -1.1080088461017716e-16_rk, -3.993388697633984e-17_rk, 4.575960283248043e-16_rk,   &
        3.199047533281932e-16_rk, 0.48803387171258494_rk, 7.158400811037837e-16_rk, -3.9150975949876755e-17_rk,   &
        -1.821367205045917_rk, 4.61077255421743e-16_rk, -1.227467554654598e-16_rk, 1.5969441080399385e-16_rk,   &
        2.7460881715396213e-16_rk, -0.48803387171258483_rk, 1.0777167140511852e-16_rk, 3.32295633836136e-17_rk,   &
        -2.3262620022152944e-16_rk, 5.859658729580691e-16_rk, 1.8213672050459193_rk, -1.8302785404906304e-17_rk,   &
        5.648964293018085e-16_rk, 1.3809313834097046e-16_rk, -4.862556317241931e-16_rk, 0.48803387171258505_rk,   &
        8.033207955265518e-16_rk, -2.197424982024372e-16_rk, -1.8213672050459186_rk, 3.9240853922473276e-16_rk,   &
        -4.685577711415783e-16_rk, 1.6575726156666445e-16_rk, -3.003493014524995e-16_rk, -0.48803387171258494_rk   &
        /),(/4,8/))
        test_dbr2_vol_face3_dx(:,:,4,3) = reshape((/ &
        6.094413448457095_rk, -1.0287794130183199e-16_rk, -1.9793945680868864e-16_rk, 8.613878992017983e-16_rk,   &
        4.914544545591171e-16_rk, 2.575802203437515_rk, 7.05370605900422e-16_rk, -1.3927011185072682e-16_rk,   &
        -2.5758022034375143_rk, 5.036977843895172e-16_rk, 4.294800425771806e-16_rk, 1.8375852104271656e-16_rk,   &
        8.382286355606567e-16_rk, -1.6329931618554516_rk, -1.41086846492692e-16_rk, 2.482558686613807e-16_rk,   &
        -3.392360620545931e-16_rk, 8.001795414138661e-16_rk, 1.6329931618554527_rk, 3.9831872996613584e-17_rk,   &
        1.297804102597236e-15_rk, 5.0953917049854796e-17_rk, -5.818721808083939e-16_rk, 0.6901841202733887_rk,   &
        5.15690676737127e-16_rk, 1.8279988775732495e-17_rk, -0.6901841202733894_rk, 1.929784209526175e-16_rk,   &
        -3.101285609696744e-16_rk, 1.4812994392193673e-16_rk, 3.8748339225093266e-17_rk, -0.4375591989647142_rk   &
        /),(/4,8/))
        test_dbr2_vol_face3_dx(:,:,5,1) = reshape((/ &
        2.5758022034375156_rk, -4.909380536345864e-16_rk, -5.984727641108192e-16_rk, 9.531857482010315e-16_rk,   &
        2.8697485537084484e-17_rk, 1.6329931618554523_rk, 7.882342212857512e-16_rk, 9.278713067102063e-18_rk,   &
        -0.4375591989647143_rk, 6.469110196956726e-16_rk, -3.203458009364048e-16_rk, 8.588333436857395e-18_rk,   &
        7.332958655403577e-16_rk, -0.18493427765603976_rk, 9.788996130576368e-16_rk, -3.0851573163304446e-17_rk,   &
        -5.070801796801244e-16_rk, 1.2739855736702945e-15_rk, 9.613024693476676_rk, -4.036711185578263e-16_rk,   &
        9.949407412163066e-16_rk, -5.088532235923321e-16_rk, -1.9467037784062063e-15_rk, 6.094413448457097_rk,   &
        6.752486703730904e-16_rk, -2.6105462444301487e-16_rk, -1.6329931618554523_rk, 8.506291679664535e-16_rk,   &
        -6.857308337395212e-16_rk, 5.15382295586694e-16_rk, -4.709470790830527e-16_rk, -0.6901841202733885_rk   &
        /),(/4,8/))
        test_dbr2_vol_face3_dx(:,:,5,2) = reshape((/ &
        -6.797434948471087_rk, 3.378469772311543e-16_rk, 5.586829621555272e-16_rk, -7.996900169488785e-16_rk,   &
        -2.572965933470528e-16_rk, -1.8213672050459186_rk, -4.067245736436225e-16_rk, 1.7947541954471336e-16_rk,   &
        0.4880338717125849_rk, -3.807073170296623e-16_rk, -3.4020587694403715e-17_rk, 9.936848618725102e-17_rk,   &
        -8.085345228876326e-16_rk, 0.1307682818044213_rk, -6.016185277753164e-16_rk, -1.3810567597785056e-16_rk,   &
        5.683651187618669e-16_rk, -9.510554034534098e-16_rk, -6.79743494847109_rk, 1.4375306085640545e-16_rk,   &
        -1.2516820920432946e-15_rk, 2.4083029823310407e-16_rk, 1.1895305350476359e-15_rk, -1.8213672050459189_rk,   &
        -5.252102650954918e-16_rk, 1.5142991915481903e-17_rk, 0.48803387171258517_rk, -4.1728904220963893e-16_rk,   &
        2.822856754523757e-16_rk, -1.6440367917887347e-16_rk, 2.1885682679308348e-16_rk, 0.13076828180442135_rk   &
        /),(/4,8/))
        test_dbr2_vol_face3_dx(:,:,5,3) = reshape((/ &
        1.1102230246251565e-16_rk, -4.6921036645263476e-17_rk, 2.2752726051537297e-17_rk, 2.283366871838687e-16_rk,   &
        -2.0184648196135254e-16_rk, 0.9428090415820636_rk, -2.5635709126279554e-16_rk, 8.393535698485284e-17_rk,   &
        0.25262492130867453_rk, 5.531290950099541e-17_rk, 1.902949524850461e-16_rk, 1.898334832279784e-17_rk,   &
        1.1337783556437883e-16_rk, 7.5321221437691e-17_rk, 2.7892173337351494e-18_rk, 1.0599153170300153e-17_rk,   &
        -2.6538646931568987e-17_rk, -1.2425497732744172e-16_rk, 1.1686250176292056e-18_rk, -1.692354813131939e-16_rk,   &
        2.3657436946438417e-16_rk, -3.558987034934248e-16_rk, -3.237839973840332e-16_rk, 3.51861124501958_rk,   &
        -3.833017087609528e-16_rk, 1.3135474540326465e-16_rk, 0.9428090415820636_rk, -1.3461033067614603e-17_rk,   &
        9.089628989192752e-17_rk, 9.196328051215569e-17_rk, 1.2964581686184465e-16_rk, 5.512565324010659e-17_rk   &
        /),(/4,8/))
        test_dbr2_vol_face3_dx(:,:,6,1) = reshape((/ &
        -0.9428090415820636_rk, 2.10298037463843e-16_rk, 3.635698041612416e-16_rk, 3.5993395938766466e-17_rk,   &
        8.385382897321551e-17_rk, -4.456403845817945e-16_rk, -8.620643441494235e-17_rk, 1.4444977190806873e-16_rk,   &
        1.1419703840431433e-16_rk, -1.0357686812486838e-16_rk, 2.0925938216690384e-17_rk, 9.594122924928375e-17_rk,   &
        6.601734557941011e-18_rk, -0.2526249213086743_rk, -3.8157536757868293e-16_rk, -1.3567859431743936e-16_rk,   &
        1.5068518164793287e-16_rk, -3.644607588413744e-16_rk, -3.5186112450195792_rk, 1.0746853787106311e-17_rk,   &
        1.491445489168325e-17_rk, 8.816437971530323e-17_rk, 3.5669039926580406e-16_rk, 1.6878652414250259e-16_rk,   &
        -6.587897636871103e-17_rk, -5.710779877808185e-18_rk, 4.210770140599844e-17_rk, -9.040237084280823e-17_rk,   &
        -1.7144276162776217e-16_rk, 9.419715717089796e-17_rk, 2.688137430808794e-16_rk, -0.9428090415820629_rk   &
        /),(/4,8/))
        test_dbr2_vol_face3_dx(:,:,6,2) = reshape((/ &
        -1.8213672050459182_rk, 1.723612840643491e-16_rk, 1.7909527202443745e-16_rk, -7.485194593062283e-16_rk,   &
        3.079799834750315e-16_rk, -6.797434948471088_rk, -1.2004815405511854e-16_rk, -1.718651795601091e-17_rk,   &
        0.13076828180442163_rk, -8.441357648186438e-16_rk, -2.377515493024869e-16_rk, -4.384647704395157e-17_rk,   &
        -5.819997728932596e-16_rk, 0.48803387171258417_rk, -6.641110602545895e-17_rk, 1.1539133077456092e-17_rk,   &
        2.3373328948322156e-16_rk, -6.965591069967126e-16_rk, -1.8213672050459189_rk, 3.773973572375413e-16_rk,   &
        -9.396480803042439e-16_rk, 9.398113990657831e-16_rk, 1.1047423179578177e-15_rk, -6.79743494847109_rk,   &
        1.0684043854184564e-16_rk, 1.2645157436272035e-17_rk, 0.1307682818044217_rk, -4.743033273094222e-16_rk,   &
        2.622730057692383e-16_rk, -9.090608637060593e-16_rk, -1.331232036205039e-17_rk, 0.48803387171258483_rk   &
        /),(/4,8/))
        test_dbr2_vol_face3_dx(:,:,6,3) = reshape((/ &
        -1.6329931618554525_rk, 3.2756105281600683e-16_rk, 2.1215023389804014e-16_rk, -1.2175158313236669e-15_rk,   &
        8.929516745105251e-17_rk, -2.575802203437516_rk, -4.456706956080134e-16_rk, -2.376638419600236e-16_rk,   &
        0.18493427765603992_rk, -5.986470610717996e-16_rk, 1.0912491023466831e-16_rk, -1.2351291100893902e-16_rk,   &
        -8.532754356626778e-16_rk, 0.4375591989647142_rk, -6.001134628126889e-16_rk, 1.559310143104437e-16_rk,   &
        3.829336449637606e-16_rk, -7.852698375014784e-16_rk, -6.094413448457097_rk, 5.621597460839139e-16_rk,   &
        -1.2464295655723737e-15_rk, 7.765875473704537e-16_rk, 1.913797376524435e-15_rk, -9.613024693476676_rk,   &
        -2.2606798524342686e-16_rk, 1.3541065891755844e-16_rk, 0.6901841202733894_rk, -7.467657640560306e-16_rk,   &
        7.662773054753559e-16_rk, -7.015427332697477e-16_rk, 7.24875191403287e-17_rk, 1.6329931618554518_rk   &
        /),(/4,8/))
        test_dbr2_vol_face3_dx(:,:,7,1) = reshape((/ &
        -0.6901841202733883_rk, 7.034197870690033e-17_rk, -1.2866684421166409e-16_rk, -1.0251725400785642e-15_rk,   &
        -1.9640514348351555e-16_rk, -1.6329931618554514_rk, -6.158213524558666e-16_rk, -2.981782568832394e-16_rk,   &
        0.43755919896471396_rk, -4.3975728344593565e-16_rk, 2.78493924503024e-16_rk, -2.0047079193542488e-16_rk,   &
        -7.464993346562398e-16_rk, 0.6901841202733884_rk, -2.1574887790027075e-16_rk, 3.022087617981832e-16_rk,   &
        2.0570981638425878e-16_rk, -5.450640559875457e-16_rk, -2.5758022034375165_rk, 3.8217741098361356e-16_rk,   &
        -1.0247696509996733e-15_rk, 3.325244641617257e-16_rk, 1.2333229798745979e-15_rk, -6.094413448457097_rk,   &
        -5.434907176356684e-16_rk, 2.724761841986312e-16_rk, 1.6329931618554523_rk, -6.69824426280837e-16_rk,   &
        1.0286163569950456e-15_rk, -7.0377660992849e-16_rk, -6.668040707870608e-17_rk, 2.5758022034375143_rk   &
        /),(/4,8/))
        test_dbr2_vol_face3_dx(:,:,7,2) = reshape((/ &
        -0.48803387171258517_rk, -8.342881596450131e-17_rk, 5.758093804724099e-18_rk, -5.792980973731073e-16_rk,   &
        -2.4254108267316335e-16_rk, -1.8213672050459182_rk, -5.145008341423429e-16_rk, -1.5952207859629997e-16_rk,   &
        0.48803387171258455_rk, -9.964066940907246e-17_rk, -1.2628809086013294e-16_rk, -1.6083407380181108e-16_rk,   &
        -7.137148956824852e-16_rk, 1.8213672050459175_rk, 1.758893022591316e-16_rk, 1.039766739040786e-16_rk,   &
        -8.737795403987727e-17_rk, -4.706230130061909e-16_rk, -0.48803387171258505_rk, 7.965430464362003e-17_rk,   &
        -5.474814451120086e-16_rk, 5.4923353139448087e-17_rk, 4.515684959259734e-16_rk, -1.8213672050459193_rk,   &
        -1.2942536530671354e-18_rk, 8.254711882678679e-17_rk, 0.4880338717125853_rk, -1.649664019969225e-16_rk,   &
        5.599600890781127e-16_rk, -4.45588984268911e-16_rk, -4.0514727885669243e-16_rk, 1.8213672050459186_rk   &
        /),(/4,8/))
        test_dbr2_vol_face3_dx(:,:,7,3) = reshape((/ &
        -3.3306690738754696e-16_rk, -4.692103664526346e-17_rk, 2.2752726051537334e-17_rk, 2.283366871838687e-16_rk,   &
        -2.0184648196135247e-16_rk, 0.9428090415820636_rk, -2.563570912627954e-16_rk, 8.393535698485284e-17_rk,   &
        0.2526249213086743_rk, 5.531290950099531e-17_rk, 1.9029495248504603e-16_rk, 1.8983348322797853e-17_rk,   &
        1.1337783556437878e-16_rk, 7.5321221437691e-17_rk, 2.7892173337351494e-18_rk, 1.0599153170300104e-17_rk,   &
        -2.6538646931568962e-17_rk, -1.2425497732744165e-16_rk, 1.1686250176292056e-18_rk, -1.6923548131319396e-16_rk,   &
        2.3657436946438397e-16_rk, -3.558987034934248e-16_rk, -3.237839973840332e-16_rk, 3.51861124501958_rk,   &
        -3.833017087609525e-16_rk, 1.3135474540326455e-16_rk, 0.9428090415820634_rk, -1.346103306761459e-17_rk,   &
        9.089628989192741e-17_rk, 9.196328051215559e-17_rk, 1.2964581686184457e-16_rk, -3.88963556609956e-16_rk   &
        /),(/4,8/))
        test_dbr2_vol_face3_dx(:,:,8,1) = reshape((/ &
        -0.9428090415820631_rk, 2.1029803746384307e-16_rk, 3.635698041612416e-16_rk, 3.599339593876649e-17_rk,   &
        8.385382897321554e-17_rk, -4.456403845817945e-16_rk, -8.62064344149423e-17_rk, 1.4444977190806868e-16_rk,   &
        1.1419703840431433e-16_rk, -1.0357686812486843e-16_rk, 2.0925938216690384e-17_rk, 9.594122924928372e-17_rk,   &
        6.601734557940937e-18_rk, -0.2526249213086743_rk, -3.8157536757868293e-16_rk, -1.3567859431743938e-16_rk,   &
        1.5068518164793287e-16_rk, -3.644607588413744e-16_rk, -3.5186112450195797_rk, 1.0746853787106385e-17_rk,   &
        1.49144548916833e-17_rk, 8.816437971530323e-17_rk, 3.5669039926580426e-16_rk, -2.7530268570756003e-16_rk,   &
        -6.587897636871103e-17_rk, -5.71077987780816e-18_rk, 4.210770140599844e-17_rk, -9.040237084280823e-17_rk,   &
        -1.714427616277622e-16_rk, 9.419715717089808e-17_rk, 2.688137430808794e-16_rk, -0.9428090415820634_rk   &
        /),(/4,8/))
        test_dbr2_vol_face3_dx(:,:,8,2) = reshape((/ &
        -1.8213672050459186_rk, 1.1080088461017716e-16_rk, 3.993388697633984e-17_rk, -4.575960283248043e-16_rk,   &
        -3.199047533281931e-16_rk, -0.48803387171258494_rk, -7.158400811037837e-16_rk, 3.9150975949876755e-17_rk,   &
        1.821367205045917_rk, -4.61077255421743e-16_rk, 1.227467554654598e-16_rk, -1.5969441080399385e-16_rk,   &
        -2.7460881715396213e-16_rk, 0.4880338717125846_rk, -1.0777167140511852e-16_rk, -3.32295633836136e-17_rk,   &
        2.3262620022152944e-16_rk, -5.859658729580691e-16_rk, -1.8213672050459193_rk, 1.8302785404906304e-17_rk,   &
        -5.648964293018085e-16_rk, -1.3809313834097046e-16_rk, 4.862556317241931e-16_rk, -0.48803387171258505_rk,   &
        -8.033207955265518e-16_rk, 2.197424982024372e-16_rk, 1.8213672050459186_rk, -3.9240853922473276e-16_rk,   &
        4.685577711415783e-16_rk, -1.6575726156666445e-16_rk, 3.003493014524996e-16_rk, 0.4880338717125847_rk   &
        /),(/4,8/))
        test_dbr2_vol_face3_dx(:,:,8,3) = reshape((/ &
        1.6329931618554525_rk, -2.3371897952547987e-16_rk, -2.576556860011148e-16_rk, 7.608424569559293e-16_rk,   &
        3.143977964716526e-16_rk, 0.6901841202733883_rk, 9.583848781336045e-16_rk, 6.9793127990318e-17_rk,   &
        -0.6901841202733888_rk, 4.880212420698089e-16_rk, -4.897148152047605e-16_rk, 8.554621436334333e-17_rk,   &
        6.265197645339201e-16_rk, -0.4375591989647144_rk, 5.945350281452185e-16_rk, -1.7712932065104398e-16_rk,   &
        -3.298563511006227e-16_rk, 1.0337797921563618e-15_rk, 6.094413448457097_rk, -2.23688783457526e-16_rk,   &
        7.732808266436058e-16_rk, -6.479014038360419e-17_rk, -1.266229381756369e-15_rk, 2.5758022034375165_rk,   &
        9.926714027653321e-16_rk, -3.981201497240876e-16_rk, -2.575802203437516_rk, 7.736878301912597e-16_rk,   &
        -9.480698852592109e-16_rk, 5.176161722454364e-16_rk, -3.317791528640179e-16_rk, -1.6329931618554518_rk   &
        /),(/4,8/))

        
        
        



        
        do inode_diff = 1,self%elem%nterms_c 
            do idir =1,3
                @assertEqual(transpose(test_dbr2_vol_face3_dx(:,:,inode_diff,idir)),self%faces(ETA_MIN)%dbr2_v_dx(:,:,inode_diff,idir),tol)
            end do
        end do
        
        
        !
        ! dbr2_vol_face4_dx
        ! 
        test_dbr2_vol_face4_dx(:,:,1,1) = reshape((/ &
        -2.575802203437516_rk, -1.066363963481321e-16_rk, 2.843408458046662e-16_rk, 7.586342447252637e-17_rk,   &
        2.311477498824827e-16_rk, -1.6329931618554512_rk, 1.4447842548662415e-16_rk, -8.783145945507732e-17_rk,   &
        6.0944134484570895_rk, -1.278497398399344e-16_rk, -2.196216290055263e-16_rk, 1.6931732758009763e-16_rk,   &
        -3.029658652678879e-16_rk, 2.5758022034375134_rk, -8.660639676989461e-17_rk, -1.745802546281916e-16_rk,   &
        5.0894124156238e-16_rk, -1.9380288477231496e-16_rk, -0.6901841202733889_rk, 5.333532377291919e-18_rk,   &
        -7.706687477185488e-17_rk, 3.3953708375705845e-16_rk, 8.344618891502935e-18_rk, -0.4375591989647143_rk,   &
        -4.2011426630582996e-16_rk, 3.486491775664144e-16_rk, 1.6329931618554516_rk, -4.214849723734375e-16_rk,   &
        -9.727647352465907e-17_rk, -3.6216427281193465e-16_rk, -3.7262632979260164e-16_rk, 0.6901841202733889_rk   &
        /),(/4,8/))
        test_dbr2_vol_face4_dx(:,:,1,2) = reshape((/ &
        -1.8213672050459186_rk, 3.5154805579021044e-19_rk, 2.4283285191331554e-16_rk, -1.3473470772616698e-16_rk,   &
        -4.7959669301645604e-18_rk, -0.4880338717125847_rk, -7.548665808466865e-17_rk, 1.098404374604562e-16_rk,   &
        1.8213672050459178_rk, -1.4064571246130256e-16_rk, -2.8938542882997293e-16_rk, 6.104614745880502e-17_rk,   &
        -3.103790318429901e-16_rk, 0.4880338717125854_rk, 4.009536127199223e-17_rk, -1.08477676885462e-16_rk,   &
        3.1600822508818696e-16_rk, -4.698348980641637e-17_rk, -1.8213672050459186_rk, -1.0477962102978653e-16_rk,   &
        -1.5934806666376737e-16_rk, 2.255394345617264e-16_rk, 6.248888768973013e-17_rk, -0.4880338717125853_rk,   &
        -2.476179609314385e-16_rk, 2.1504515264247558e-16_rk, 1.821367205045918_rk, -3.9560029162832005e-16_rk,   &
        1.5870877960957165e-18_rk, -9.953164020774184e-17_rk, -1.9464348673395562e-16_rk, 0.48803387171258517_rk   &
        /),(/4,8/))
        test_dbr2_vol_face4_dx(:,:,1,3) = reshape((/ &
        0.0_rk, 1.748504802414786e-17_rk, 2.547371354572224e-17_rk, -7.549678139918367e-18_rk,   &
        2.1379093259990955e-17_rk, -0.942809041582063_rk, 1.1311108790932176e-16_rk, -2.7452127797948227e-16_rk,   &
        -3.518611245019577_rk, -2.0261276913438174e-16_rk, -1.2590865594613214e-16_rk, -6.090701783020047e-17_rk,   &
        2.0977989756019738e-16_rk, -1.8282799010158894e-17_rk, -7.115108712012956e-17_rk, 6.080775892244705e-17_rk,   &
        -9.470643162648562e-17_rk, -2.4019422232096094e-17_rk, 8.70527857695406e-17_rk, 2.7085440413770174e-17_rk,   &
        1.4136926780948384e-17_rk, 5.300225580991109e-17_rk, 3.770232448018637e-17_rk, -0.25262492130867487_rk,   &
        1.5130495594897976e-16_rk, -8.933419247775635e-17_rk, -0.9428090415820634_rk, -2.7438148804493503e-17_rk,   &
        -1.745314946638725e-17_rk, -7.638005837608167e-17_rk, -1.0724136647700152e-16_rk, 2.454869576067682e-16_rk   &
        /),(/4,8/))
        test_dbr2_vol_face4_dx(:,:,2,1) = reshape((/ &
        0.9428090415820634_rk, 2.4669907346079587e-17_rk, -6.0304019659470446e-18_rk, 2.224625330275194e-16_rk,   &
        1.0123312813119961e-16_rk, 1.6552139474100855e-16_rk, -1.2961067332487874e-16_rk, 8.841782919827349e-18_rk,   &
        -2.0896050110266653e-16_rk, -8.768700381747625e-17_rk, 3.4725512013383786e-17_rk, 1.347105443496982e-16_rk,   &
        -1.2073461635764318e-16_rk, 3.518611245019576_rk, 1.521450934304119e-16_rk, -3.867243168230883e-17_rk,   &
        5.055925690848886e-17_rk, 1.0081013266654487e-17_rk, 0.25262492130867475_rk, -1.2206305241934176e-16_rk,   &
        -1.6376105653277285e-17_rk, 7.840417628161157e-17_rk, -2.3674391544606896e-17_rk, 2.466828485647699e-17_rk,   &
        2.34681960258659e-17_rk, 3.2229337478861737e-16_rk, -1.8102724550422994e-16_rk, 5.145226882300309e-17_rk,   &
        1.2001146868008038e-16_rk, -1.5193889791167097e-16_rk, -3.051422017904943e-17_rk, 0.942809041582062_rk   &
        /),(/4,8/))
        test_dbr2_vol_face4_dx(:,:,2,2) = reshape((/ &
        -0.4880338717125847_rk, 1.5292543396216212e-17_rk, 1.9323897423563332e-16_rk, 1.6539837978955783e-16_rk,   &
        4.688042642676772e-16_rk, -1.8213672050459175_rk, 5.86059619894805e-17_rk, -3.435052200217508e-16_rk,   &
        0.4880338717125847_rk, -2.532066318972317e-16_rk, -3.159796256237012e-16_rk, 2.1942352388277212e-16_rk,   &
        -1.0653277221513609e-16_rk, 1.8213672050459184_rk, 4.490218611419851e-17_rk, 3.326090747581406e-17_rk,   &
        3.996960718156673e-16_rk, -7.866480794849941e-17_rk, -0.48803387171258505_rk, -1.5075357804183738e-16_rk,   &
        -3.9248270014313756e-16_rk, 4.476508666838463e-16_rk, 1.6141101398157893e-16_rk, -1.8213672050459189_rk,   &
        -1.950132264231039e-16_rk, 1.1504560145629656e-16_rk, 0.48803387171258505_rk, -4.4024574152634023e-16_rk,   &
        8.280049559328798e-17_rk, -2.905290660994295e-16_rk, -4.2209648187380762e-16_rk, 1.8213672050459178_rk   &
        /),(/4,8/))
        test_dbr2_vol_face4_dx(:,:,2,3) = reshape((/ &
        1.632993161855453_rk, 6.448144097790464e-17_rk, -3.0378415738444136e-16_rk, -2.9077627936012755e-16_rk,   &
        -3.5375997127367323e-16_rk, 2.5758022034375143_rk, -1.279788400710671e-16_rk, 3.5351095451473224e-16_rk,   &
        -2.5758022034375143_rk, 4.181495127917924e-16_rk, 3.108047729382747e-16_rk, -2.4312085409959543e-16_rk,   &
        2.1392058406533376e-16_rk, -6.094413448457091_rk, 5.612390459612157e-18_rk, 1.5244492738805343e-16_rk,   &
        -4.647940668443832e-16_rk, 2.0774129373775662e-16_rk, 0.4375591989647142_rk, 8.964407962827971e-17_rk,   &
        7.930605364418365e-17_rk, -4.709435158485812e-16_rk, -2.237255182708231e-17_rk, 0.6901841202733894_rk,   &
        2.453411143309845e-16_rk, -5.816083598772757e-16_rk, -0.6901841202733887_rk, 3.974708523549279e-16_rk,   &
        -5.281845689034065e-18_rk, 5.904832290996873e-16_rk, 5.103819164486526e-16_rk, -1.6329931618554516_rk   &
        /),(/4,8/))
        test_dbr2_vol_face4_dx(:,:,3,1) = reshape((/ &
        0.6901841202733889_rk, 5.729658165597293e-17_rk, -2.7228004187277206e-16_rk, -5.207884905275653e-16_rk,   &
        -4.336140061448819e-16_rk, 1.6329931618554512_rk, 1.1474292116313338e-16_rk, 7.014789361542262e-17_rk,   &
        -6.0944134484570895_rk, 3.0322374747488685e-16_rk, 1.501706049787588e-16_rk, -4.3873841627949417e-16_rk,   &
        5.444350979831743e-16_rk, -9.613024693476664_rk, -2.1768379009092926e-16_rk, 2.5192511799280927e-16_rk,   &
        -6.100597553793578e-16_rk, 1.7364085823900602e-16_rk, 0.18493427765603943_rk, 2.387925724613917e-16_rk,   &
        1.0981908607840941e-16_rk, -4.963454363202816e-16_rk, 3.900416419771088e-17_rk, 0.43755919896471407_rk,   &
        3.731778742540981e-16_rk, -9.932359271436491e-16_rk, -1.6329931618554516_rk, 3.1858043472743146e-16_rk,   &
        -1.4274646383550162e-16_rk, 6.660420686352765e-16_rk, 4.336547701507005e-16_rk, -2.5758022034375134_rk   &
        /),(/4,8/))
        test_dbr2_vol_face4_dx(:,:,3,2) = reshape((/ &
        -0.13076828180442124_rk, -2.0439443560208818e-17_rk, 3.3607501959048454e-16_rk, 7.174660114544447e-16_rk,   &
        2.438971243488034e-16_rk, -0.4880338717125845_rk, -1.7343579958991636e-16_rk, 1.33051128365621e-16_rk,   &
        1.8213672050459173_rk, -2.0939211376744292e-16_rk, -1.3552786184270975e-16_rk, 4.820115297000365e-16_rk,   &
        -6.387823970506252e-16_rk, 6.797434948471082_rk, 1.2259507417897298e-16_rk, -1.4732954987387017e-16_rk,   &
        4.217482932676945e-16_rk, -1.3569454005392588e-16_rk, -0.13076828180442124_rk, -3.0404047366777276e-16_rk,   &
        -3.2053995733980866e-16_rk, 3.410907246481491e-16_rk, 3.2356341326670836e-19_rk, -0.4880338717125854_rk,   &
        -2.982600492170031e-16_rk, 7.318482582484607e-16_rk, 1.821367205045918_rk, -3.5668908990518814e-16_rk,   &
        3.612728171702173e-16_rk, -5.826189150772699e-16_rk, -3.9433340779581413e-16_rk, 6.797434948471085_rk   &
        /),(/4,8/))
        test_dbr2_vol_face4_dx(:,:,3,3) = reshape((/ &
        3.3306690738754696e-16_rk, 1.748504802414786e-17_rk, 2.547371354572225e-17_rk, -7.549678139918269e-18_rk,   &
        2.1379093259990906e-17_rk, -0.942809041582063_rk, 1.1311108790932173e-16_rk, -2.7452127797948227e-16_rk,   &
        -3.5186112450195752_rk, -2.026127691343817e-16_rk, -1.259086559461321e-16_rk, -6.090701783020042e-17_rk,   &
        2.0977989756019728e-16_rk, -1.8282799010158894e-17_rk, -7.115108712012951e-17_rk, 6.080775892244706e-17_rk,   &
        -9.470643162648572e-17_rk, -2.4019422232096044e-17_rk, 8.70527857695406e-17_rk, 2.7085440413770125e-17_rk,   &
        1.4136926780948433e-17_rk, 5.300225580991109e-17_rk, 3.770232448018632e-17_rk, -0.25262492130867475_rk,   &
        1.513049559489797e-16_rk, -8.93341924777562e-17_rk, -0.9428090415820634_rk, -2.7438148804493478e-17_rk,   &
        -1.7453149466387227e-17_rk, -7.638005837608168e-17_rk, -1.0724136647700147e-16_rk, 2.454869576067682e-16_rk   &
        /),(/4,8/))
        test_dbr2_vol_face4_dx(:,:,4,1) = reshape((/ &
        0.9428090415820638_rk, 2.46699073460796e-17_rk, -6.030401965947075e-18_rk, 2.224625330275196e-16_rk,   &
        1.0123312813119963e-16_rk, 1.6552139474100855e-16_rk, -1.296106733248788e-16_rk, 8.841782919827349e-18_rk,   &
        2.351287087473961e-16_rk, -8.768700381747618e-17_rk, 3.4725512013383786e-17_rk, 1.347105443496983e-16_rk,   &
        -1.2073461635764315e-16_rk, 3.518611245019576_rk, 1.5214509343041195e-16_rk, -3.8672431682308794e-17_rk,   &
        5.055925690848897e-17_rk, 1.0081013266654438e-17_rk, 0.25262492130867487_rk, -1.2206305241934183e-16_rk,   &
        -1.6376105653277236e-17_rk, 7.84041762816115e-17_rk, -2.367439154460692e-17_rk, 1.3569058731899265e-16_rk,   &
        2.3468196025865894e-17_rk, 3.2229337478861737e-16_rk, -1.8102724550422994e-16_rk, 5.1452268823003013e-17_rk,   &
        1.2001146868008036e-16_rk, -1.5193889791167097e-16_rk, -3.051422017904948e-17_rk, 0.9428090415820625_rk   &
        /),(/4,8/))
        test_dbr2_vol_face4_dx(:,:,4,2) = reshape((/ &
        -0.48803387171258517_rk, 6.227541838067032e-17_rk, 3.272939813991419e-16_rk, 2.3277284233350086e-16_rk,   &
        2.676830757088976e-16_rk, -0.13076828180442113_rk, -1.0525671019542696e-16_rk, 3.143789352878491e-16_rk,   &
        6.797434948471084_rk, 9.002456043681149e-18_rk, -1.170270541343868e-16_rk, 2.7766478535761987e-16_rk,   &
        -4.167862629482761e-16_rk, 1.821367205045918_rk, 2.2346104023827164e-16_rk, -1.1082886925270067e-16_rk,   &
        4.626877387667606e-16_rk, -9.582625063074993e-17_rk, -0.48803387171258505_rk, -1.2649512660970443e-16_rk,   &
        -1.4007106682833546e-16_rk, 1.3149431975884951e-16_rk, 1.6307746661164341e-16_rk, -0.13076828180442154_rk,   &
        -5.9843365901213165e-16_rk, 5.816219199197846e-16_rk, 6.7974349484710865_rk, -3.308030283975557e-16_rk,   &
        1.8206224712600911e-16_rk, -2.3065101636187924e-16_rk, 2.248672324614325e-16_rk, 1.8213672050459178_rk   &
        /),(/4,8/))
        test_dbr2_vol_face4_dx(:,:,4,3) = reshape((/ &
        -1.632993161855453_rk, -9.945153702620037e-17_rk, 2.528367302929969e-16_rk, 3.0587563563996425e-16_rk,   &
        3.1100178475369135e-16_rk, -0.6901841202733883_rk, -9.82433357475764e-17_rk, 1.955316014442323e-16_rk,   &
        9.613024693476667_rk, -1.2923974523028943e-17_rk, -5.898746104601049e-17_rk, 3.649348897599963e-16_rk,   &
        -6.334803791857282e-16_rk, 6.094413448457091_rk, 1.366897837806469e-16_rk, -2.7406044523294755e-16_rk,   &
        6.542069300973546e-16_rk, -1.5970244927356446e-16_rk, -0.4375591989647143_rk, -1.4381496045582e-16_rk,   &
        -1.0757990720608052e-16_rk, 3.6493900422875904e-16_rk, -5.303209713329038e-17_rk, -0.1849342776560396_rk,   &
        -5.479510262289438e-16_rk, 7.602767448327884e-16_rk, 2.575802203437515_rk, -3.4259455474594097e-16_rk,   &
        4.018814462180854e-17_rk, -4.3772311234752406e-16_rk, -2.958991834946496e-16_rk, 1.6329931618554516_rk   &
        /),(/4,8/))
        test_dbr2_vol_face4_dx(:,:,5,1) = reshape((/ &
        -0.6901841202733889_rk, 1.6198239215171193e-16_rk, 4.2714904952130774e-16_rk, 1.5142495775303078e-17_rk,   &
        2.828449209956639e-16_rk, -0.4375591989647138_rk, -2.8421974153203405e-16_rk, 2.225739023625361e-16_rk,   &
        1.6329931618554507_rk, -2.437317629525841e-16_rk, -4.958131287549912e-16_rk, 2.685094763992088e-16_rk,   &
        -5.060188095287495e-16_rk, 0.690184120273388_rk, 3.330712576439269e-16_rk, -3.367917901321053e-17_rk,   &
        5.477593166271136e-16_rk, 3.974385502656584e-18_rk, -2.575802203437516_rk, -3.495587326322208e-16_rk,   &
        -5.248577022139461e-16_rk, 3.889413320752716e-16_rk, 3.0947601862130955e-16_rk, -1.6329931618554523_rk,   &
        -4.911220855331823e-16_rk, 4.480889224206179e-16_rk, 6.094413448457092_rk, -6.831921391648172e-16_rk,   &
        2.868071960710573e-16_rk, -1.4712469318284846e-16_rk, -4.2103268681969473e-17_rk, 2.5758022034375143_rk   &
        /),(/4,8/))
        test_dbr2_vol_face4_dx(:,:,5,2) = reshape((/ &
        1.8213672050459186_rk, -3.5154805579021044e-19_rk, -2.4283285191331554e-16_rk, 1.3473470772616707e-16_rk,   &
        4.7959669301645604e-18_rk, 0.4880338717125847_rk, 7.548665808466868e-17_rk, -1.0984043746045622e-16_rk,   &
        -1.8213672050459178_rk, 1.4064571246130256e-16_rk, 2.8938542882997293e-16_rk, -6.104614745880502e-17_rk,   &
        3.103790318429901e-16_rk, -0.4880338717125845_rk, -4.009536127199223e-17_rk, 1.0847767688546202e-16_rk,   &
        -3.1600822508818696e-16_rk, 4.698348980641637e-17_rk, 1.8213672050459186_rk, 1.0477962102978653e-16_rk,   &
        1.5934806666376737e-16_rk, -2.255394345617264e-16_rk, -6.248888768973013e-17_rk, 0.4880338717125853_rk,   &
        2.476179609314385e-16_rk, -2.1504515264247548e-16_rk, -1.821367205045918_rk, 3.9560029162832005e-16_rk,   &
        -1.5870877960956672e-18_rk, 9.953164020774184e-17_rk, 1.9464348673395567e-16_rk, -0.4880338717125843_rk   &
        /),(/4,8/))
        test_dbr2_vol_face4_dx(:,:,5,3) = reshape((/ &
        0.0_rk, -5.07069575252952e-17_rk, -1.2026491816305044e-16_rk, -4.009126120370283e-17_rk,   &
        1.2083506301022045e-16_rk, -0.25262492130867453_rk, 2.757318775974536e-18_rk, -1.9067306947511965e-16_rk,   &
        -0.9428090415820625_rk, 1.7202944962622477e-17_rk, -1.4772056488463472e-17_rk, 1.97242268964767e-17_rk,   &
        9.602449624003638e-18_rk, 1.8282799010158894e-17_rk, -5.510908947190209e-17_rk, 4.1079099301941295e-17_rk,   &
        5.016459676712313e-17_rk, 3.615439472765968e-17_rk, 2.3969516692975053e-17_rk, -4.423875592251585e-17_rk,   &
        -1.9261890434821735e-16_rk, 1.705541824372771e-16_rk, -3.8880684435431136e-17_rk, -0.9428090415820639_rk,   &
        1.339563676039324e-16_rk, -2.4058508624883034e-16_rk, -3.518611245019579_rk, -4.994953580032407e-17_rk,   &
        -5.2735508154854074e-17_rk, 3.40398833624345e-17_rk, -3.5023106311108314e-16_rk, -2.454869576067682e-16_rk   &
        /),(/4,8/))
        test_dbr2_vol_face4_dx(:,:,6,1) = reshape((/ &
        0.2526249213086747_rk, -3.937135850534516e-17_rk, 7.196257102300638e-17_rk, 3.8013437443714363e-16_rk,   &
        7.461944314640369e-17_rk, 5.652321018402275e-17_rk, 6.035017115511739e-17_rk, 7.570654015239562e-18_rk,   &
        -2.351287087473961e-16_rk, 3.9075957271732625e-17_rk, 7.40682169401735e-17_rk, 1.6295693207786342e-16_rk,   &
        -1.1148163014515777e-16_rk, 0.9428090415820627_rk, -9.38089869879425e-17_rk, 1.1200008830406956e-17_rk,   &
        2.4210262344368595e-17_rk, -7.280919846284895e-17_rk, 0.9428090415820638_rk, -1.883564770599157e-17_rk,   &
        -9.760377331603227e-17_rk, 3.302924513351889e-18_rk, -2.028313080594102e-17_rk, -3.5773519224402395e-16_rk,   &
        -5.927756006603645e-17_rk, 4.314160572364208e-17_rk, -2.630619643458327e-16_rk, -2.3937894220458818e-17_rk,   &
        1.3432474965639037e-16_rk, -1.8965539005350188e-16_rk, -1.1068787713839694e-16_rk, 3.5186112450195752_rk   &
        /),(/4,8/))
        test_dbr2_vol_face4_dx(:,:,6,2) = reshape((/ &
        0.4880338717125847_rk, -1.5292543396216218e-17_rk, -1.9323897423563332e-16_rk, -1.6539837978955773e-16_rk,   &
        -4.688042642676772e-16_rk, 1.8213672050459175_rk, -5.860596198948052e-17_rk, 3.4350522002175087e-16_rk,   &
        -0.4880338717125847_rk, 2.532066318972317e-16_rk, 3.159796256237012e-16_rk, -2.1942352388277212e-16_rk,   &
        1.0653277221513609e-16_rk, -1.8213672050459175_rk, -4.490218611419851e-17_rk, -3.3260907475814086e-17_rk,   &
        -3.996960718156673e-16_rk, 7.866480794849941e-17_rk, 0.48803387171258505_rk, 1.5075357804183738e-16_rk,   &
        3.9248270014313756e-16_rk, -4.476508666838463e-16_rk, -1.6141101398157893e-16_rk, 1.8213672050459189_rk,   &
        1.950132264231039e-16_rk, -1.1504560145629646e-16_rk, -0.48803387171258505_rk, 4.4024574152634023e-16_rk,   &
        -8.280049559328793e-17_rk, 2.905290660994295e-16_rk, 4.2209648187380762e-16_rk, -1.8213672050459169_rk   &
        /),(/4,8/))
        test_dbr2_vol_face4_dx(:,:,6,3) = reshape((/ &
        0.437559198964714_rk, -7.190407612107161e-17_rk, -3.7884670238126375e-16_rk, -3.5518560900874407e-16_rk,   &
        -4.782994271522881e-16_rk, 0.6901841202733883_rk, 2.2111225160094208e-16_rk, -3.947148690265603e-17_rk,   &
        -0.6901841202733889_rk, 1.87452860718229e-16_rk, 4.365169683032813e-16_rk, -4.511906353735489e-16_rk,   &
        6.078979900499036e-16_rk, -1.6329931618554518_rk, -1.841531811840824e-16_rk, -1.8599929119137708e-17_rk,   &
        -6.221341757386052e-16_rk, 3.2680418232532724e-17_rk, 1.6329931618554525_rk, 4.126331362607283e-16_rk,   &
        8.150803798781957e-16_rk, -5.627984390259005e-16_rk, -2.503122033799375e-16_rk, 2.575802203437517_rk,   &
        4.1644327799528644e-16_rk, -2.506454418954299e-16_rk, -2.575802203437515_rk, 7.570795691856002e-16_rk,   &
        -3.683964375725938e-16_rk, 3.0274019987391595e-16_rk, 5.030222089314496e-16_rk, -6.094413448457092_rk   &
        /),(/4,8/))
        test_dbr2_vol_face4_dx(:,:,7,1) = reshape((/ &
        0.18493427765603943_rk, -8.323967514102161e-17_rk, -5.710741915673204e-16_rk, -7.754112446495904e-16_rk,   &
        -4.3208380728847116e-16_rk, 0.4375591989647139_rk, 1.6351939922179922e-16_rk, -2.3771521039301526e-16_rk,   &
        -1.6329931618554507_rk, 1.6557984840911878e-16_rk, 3.476766948746443e-16_rk, -5.944233405549356e-16_rk,   &
        7.28982069819065e-16_rk, -2.575802203437514_rk, -1.4545328366804194e-16_rk, 1.1279161352396594e-17_rk,   &
        -5.961798413158507e-16_rk, 1.4164401142304136e-16_rk, 0.6901841202733889_rk, 3.8723002804420406e-16_rk,   &
        7.200652488460105e-16_rk, -3.9554718110197533e-16_rk, -2.689097570094275e-16_rk, 1.6329931618554527_rk,   &
        6.096772056652552e-16_rk, -5.34372133867902e-16_rk, -6.094413448457092_rk, 7.310679276057348e-16_rk,   &
        -5.554566953838382e-16_rk, 5.264354732898522e-16_rk, 2.634790229587634e-16_rk, -9.613024693476667_rk   &
        /),(/4,8/))
        test_dbr2_vol_face4_dx(:,:,7,2) = reshape((/ &
        0.13076828180442124_rk, 2.0439443560208824e-17_rk, -3.3607501959048454e-16_rk, -7.174660114544451e-16_rk,   &
        -2.438971243488034e-16_rk, 0.4880338717125845_rk, 1.7343579958991638e-16_rk, -1.3305112836562102e-16_rk,   &
        -1.8213672050459173_rk, 2.0939211376744292e-16_rk, 1.3552786184270975e-16_rk, -4.820115297000365e-16_rk,   &
        6.387823970506252e-16_rk, -6.797434948471085_rk, -1.2259507417897298e-16_rk, 1.4732954987387022e-16_rk,   &
        -4.217482932676945e-16_rk, 1.3569454005392588e-16_rk, 0.13076828180442124_rk, 3.0404047366777276e-16_rk,   &
        3.2053995733980866e-16_rk, -3.410907246481491e-16_rk, -3.2356341326670836e-19_rk, 0.4880338717125854_rk,   &
        2.982600492170031e-16_rk, -7.31848258248461e-16_rk, -1.821367205045918_rk, 3.5668908990518814e-16_rk,   &
        -3.6127281717021743e-16_rk, 5.826189150772699e-16_rk, 3.9433340779581423e-16_rk, -6.797434948471087_rk   &
        /),(/4,8/))
        test_dbr2_vol_face4_dx(:,:,7,3) = reshape((/ &
        1.1102230246251565e-16_rk, -5.070695752529515e-17_rk, -1.2026491816305025e-16_rk, -4.009126120370273e-17_rk,   &
        1.208350630102203e-16_rk, -0.25262492130867453_rk, 2.757318775974573e-18_rk, -1.9067306947511965e-16_rk,   &
        -0.9428090415820625_rk, 1.7202944962622427e-17_rk, -1.477205648846352e-17_rk, 1.9724226896476763e-17_rk,   &
        9.602449624003551e-18_rk, 1.8282799010158894e-17_rk, -5.510908947190209e-17_rk, 4.107909930194129e-17_rk,   &
        5.0164596767123033e-17_rk, 3.615439472765968e-17_rk, 2.3969516692975053e-17_rk, -4.42387559225159e-17_rk,   &
        -1.926189043482173e-16_rk, 1.705541824372771e-16_rk, -3.8880684435431087e-17_rk, -0.9428090415820636_rk,   &
        1.3395636760393225e-16_rk, -2.405850862488301e-16_rk, -3.518611245019577_rk, -4.9949535800324096e-17_rk,   &
        -5.2735508154854e-17_rk, 3.4039883362434415e-17_rk, -3.50231063111083e-16_rk, 6.42691462093357e-16_rk   &
        /),(/4,8/))
        test_dbr2_vol_face4_dx(:,:,8,1) = reshape((/ &
        0.2526249213086748_rk, -3.937135850534517e-17_rk, 7.19625710230063e-17_rk, 3.8013437443714383e-16_rk,   &
        7.461944314640366e-17_rk, 5.652321018402275e-17_rk, 6.035017115511743e-17_rk, 7.570654015239611e-18_rk,   &
        2.0896050110266653e-16_rk, 3.90759572717327e-17_rk, 7.40682169401735e-17_rk, 1.6295693207786342e-16_rk,   &
        -1.114816301451578e-16_rk, 0.9428090415820627_rk, -9.38089869879425e-17_rk, 1.1200008830406969e-17_rk,   &
        2.421026234436868e-17_rk, -7.2809198462849e-17_rk, 0.9428090415820637_rk, -1.8835647705991695e-17_rk,   &
        -9.760377331603222e-17_rk, 3.302924513351778e-18_rk, -2.0283130805941094e-17_rk, -2.466828485647699e-17_rk,   &
        -5.927756006603644e-17_rk, 4.314160572364208e-17_rk, -2.630619643458327e-16_rk, -2.3937894220458744e-17_rk,   &
        1.3432474965639045e-16_rk, -1.8965539005350188e-16_rk, -1.1068787713839699e-16_rk, 3.518611245019577_rk   &
        /),(/4,8/))
        test_dbr2_vol_face4_dx(:,:,8,2) = reshape((/ &
        0.48803387171258517_rk, -6.227541838067032e-17_rk, -3.272939813991419e-16_rk, -2.3277284233350076e-16_rk,   &
        -2.676830757088976e-16_rk, 0.13076828180442113_rk, 1.0525671019542694e-16_rk, -3.143789352878491e-16_rk,   &
        -6.797434948471084_rk, -9.002456043681149e-18_rk, 1.170270541343868e-16_rk, -2.7766478535761987e-16_rk,   &
        4.167862629482761e-16_rk, -1.821367205045917_rk, -2.2346104023827164e-16_rk, 1.1082886925270063e-16_rk,   &
        -4.626877387667606e-16_rk, 9.582625063074993e-17_rk, 0.48803387171258505_rk, 1.2649512660970443e-16_rk,   &
        1.4007106682833546e-16_rk, -1.3149431975884951e-16_rk, -1.6307746661164341e-16_rk, 0.13076828180442154_rk,   &
        5.9843365901213165e-16_rk, -5.816219199197845e-16_rk, -6.7974349484710865_rk, 3.308030283975557e-16_rk,   &
        -1.8206224712600907e-16_rk, 2.3065101636187924e-16_rk, -2.2486723246143254e-16_rk, -1.8213672050459169_rk   &
        /),(/4,8/))
        test_dbr2_vol_face4_dx(:,:,8,3) = reshape((/ &
        -0.4375591989647139_rk, 1.7331799117166196e-16_rk, 6.193765387073645e-16_rk, 4.3536813141614964e-16_rk,   &
        2.366293011318472e-16_rk, -0.18493427765603931_rk, -2.266268891528912e-16_rk, 4.2081762585289534e-16_rk,   &
        2.5758022034375134_rk, -2.218587506434739e-16_rk, -4.069728553263544e-16_rk, 4.1174218158059545e-16_rk,   &
        -6.27102889297911e-16_rk, 1.6329931618554518_rk, 2.9437136012788657e-16_rk, -6.355826948474487e-17_rk,   &
        5.218049822043591e-16_rk, -1.0498920768785206e-16_rk, -1.6329931618554525_rk, -3.2415562441569657e-16_rk,   &
        -4.2984257118176105e-16_rk, 2.2169007415134644e-16_rk, 3.280735722507996e-16_rk, -0.6901841202733894_rk,   &
        -6.843560132031511e-16_rk, 7.318156143930903e-16_rk, 9.613024693476671_rk, -6.57180497584952e-16_rk,   &
        4.738674538823017e-16_rk, -3.7081996659878487e-16_rk, 1.9743991729071666e-16_rk, 6.094413448457092_rk   &
        /),(/4,8/))
        
        
        



        
        do inode_diff = 1,self%elem%nterms_c 
            do idir =1,3
                @assertEqual(transpose(test_dbr2_vol_face4_dx(:,:,inode_diff,idir)),self%faces(ETA_MAX)%dbr2_v_dx(:,:,inode_diff,idir),tol)
            end do
        end do
        
       
        
        !
        ! dbr2_vol_face5_dx
        ! 
        test_dbr2_vol_face5_dx(:,:,1,1) = reshape((/ &
        9.613024693476676_rk, 1.8095719328171811e-16_rk, 2.7833704018289325e-16_rk, 2.1702855399765025e-16_rk,   &
        4.288320182290862e-16_rk, 6.094413448457094_rk, 4.680122183668924e-16_rk, 2.2583756887015957e-16_rk,   &
        2.7082844430406e-16_rk, 5.566947379858415e-16_rk, 6.0944134484570895_rk, 1.6942750917029043e-16_rk,   &
        4.2272831718902726e-16_rk, 2.1598934746642024e-16_rk, 1.460142448118878e-16_rk, 2.575802203437514_rk,   &
        -0.6901841202733894_rk, 1.0621998403349742e-15_rk, 2.2673026252940734e-16_rk, 1.582606719187105e-17_rk,   &
        1.0404922595387862e-15_rk, -0.4375591989647145_rk, -1.6106278389302365e-16_rk, 9.809888010997531e-17_rk,   &
        7.119409931348932e-16_rk, -2.266652776690621e-16_rk, -0.4375591989647137_rk, 3.654231883402626e-16_rk,   &
        -1.9612034667707596e-16_rk, 1.2859600986112558e-15_rk, 2.2278896332933515e-16_rk, -0.1849342776560392_rk   &
        /),(/4,8/))
        test_dbr2_vol_face5_dx(:,:,1,2) = reshape((/ &
        6.79743494847109_rk, 2.3528780354319235e-16_rk, 2.590800237217266e-16_rk, 2.127893869368117e-17_rk,   &
        2.702841206519118e-16_rk, 1.8213672050459182_rk, 3.150557264817447e-16_rk, 5.552243556846423e-19_rk,   &
        4.5623473859136915e-17_rk, 1.3667608820576792e-16_rk, 1.8213672050459182_rk, 1.1555923862970126e-16_rk,   &
        4.534530069586992e-16_rk, -1.4650611656800321e-16_rk, -2.132042379989646e-16_rk, 0.4880338717125856_rk,   &
        -1.8213672050459186_rk, 8.130827670477739e-16_rk, 9.779455084999785e-17_rk, 1.3353616607454003e-16_rk,   &
        8.292398808512228e-16_rk, -0.48803387171258517_rk, -1.7813941396831802e-16_rk, 6.617883026107883e-17_rk,   &
        6.352533139529663e-16_rk, -3.528067790269006e-16_rk, -0.48803387171258494_rk, 9.231933343808862e-17_rk,   &
        -1.3472720926380257e-16_rk, 5.384597325320932e-16_rk, 9.517682925741555e-17_rk, -0.13076828180442135_rk   &
        /),(/4,8/))
        test_dbr2_vol_face5_dx(:,:,1,3) = reshape((/ &
        7.771561172376096e-16_rk, -8.441154513785602e-17_rk, -1.4468905372939418e-16_rk, 1.5215158338882295e-17_rk,   &
        -2.6873624426176267e-17_rk, 3.518611245019579_rk, -1.552704760035783e-16_rk, 1.9970893748642473e-16_rk,   &
        -6.737197445377454e-17_rk, -1.5360144197841938e-16_rk, -3.5186112450195774_rk, -2.263060793199286e-16_rk,   &
        2.7394139819469737e-17_rk, 2.559447002253136e-16_rk, -2.919788601698986e-16_rk, -1.1746802312608045e-18_rk,   &
        -6.093877834533889e-17_rk, 3.3861217328478387e-16_rk, -2.6233192505074676e-17_rk, -5.919902120488018e-19_rk,   &
        4.969489857253029e-17_rk, -0.2526249213086752_rk, -1.5220358833234665e-16_rk, 8.905414665061218e-17_rk,   &
        4.9610358560713335e-18_rk, 1.7581299501660857e-16_rk, 0.25262492130867487_rk, -1.133459370066182e-16_rk,   &
        -7.05469864808175e-17_rk, 4.705456107280101e-16_rk, -3.020821451826412e-18_rk, 3.7189210704882866e-17_rk   &
        /),(/4,8/))
        test_dbr2_vol_face5_dx(:,:,2,1) = reshape((/ &
        -3.5186112450195792_rk, -2.2502932994648777e-16_rk, -1.2777058731794475e-16_rk, -1.3865746401862309e-17_rk,   &
        -2.193185500686796e-16_rk, -6.623628145567518e-16_rk, -1.69923167198525e-17_rk, 1.7620646741315044e-16_rk,   &
        -1.6769879249837294e-16_rk, 3.349190213540946e-17_rk, -3.3038019394077035e-16_rk, -7.81826253564022e-17_rk,   &
        1.0864840382639882e-16_rk, 9.309470475843764e-17_rk, 2.5049212080977032e-17_rk, 3.518611245019576_rk,   &
        0.25262492130867475_rk, 2.723044728566094e-18_rk, 2.728720320848206e-17_rk, 1.5429387884304543e-16_rk,   &
        -1.3443493124658314e-16_rk, -6.192972338016042e-17_rk, 4.715145301853083e-17_rk, 4.716680842499926e-17_rk,   &
        -9.755295611733168e-17_rk, 6.304131732592302e-17_rk, 3.0962942498321086e-18_rk, 3.6486958664438487e-16_rk,   &
        3.058688274262878e-17_rk, -1.1770492945775878e-16_rk, 4.739073483985629e-17_rk, -0.2526249213086745_rk   &
        /),(/4,8/))
        test_dbr2_vol_face5_dx(:,:,2,2) = reshape((/ &
        1.8213672050459189_rk, -1.800415018124397e-16_rk, -2.2301623946889036e-17_rk, 3.2660571747124284e-17_rk,   &
        9.290086271145808e-17_rk, 6.797434948471087_rk, 2.0621334908164993e-16_rk, 3.2269251258166857e-16_rk,   &
        -2.560971515335977e-16_rk, 1.7969392802828886e-16_rk, 0.48803387171258494_rk, -1.2394132284544767e-16_rk,   &
        2.941899591253786e-16_rk, 3.7069180400089054e-16_rk, -1.510401433664258e-16_rk, 1.8213672050459178_rk,   &
        -0.4880338717125852_rk, 9.003671388919638e-16_rk, 1.7174091223641454e-16_rk, 5.710159847703059e-17_rk,   &
        9.553920227703779e-16_rk, -1.8213672050459193_rk, -4.661911317686964e-16_rk, 2.704524785879665e-16_rk,   &
        3.683418412775764e-16_rk, -9.8776713823802e-17_rk, -0.13076828180442127_rk, 2.457135785405161e-16_rk,   &
        -2.2969515830575983e-16_rk, 1.0851937497225268e-15_rk, 1.815149713136031e-16_rk, -0.4880338717125847_rk   &
        /),(/4,8/))
        test_dbr2_vol_face5_dx(:,:,2,3) = reshape((/ &
        -6.094413448457097_rk, 1.2848368180262576e-16_rk, -5.877399135554322e-18_rk, -2.183779659346703e-16_rk,   &
        -1.8263984373423028e-16_rk, -9.613024693476673_rk, -2.9574942564346184e-16_rk, -6.017529737697348e-16_rk,   &
        -3.5757677351912467e-17_rk, -4.3658519814283165e-16_rk, -2.575802203437514_rk, 1.3506119550604032e-16_rk,   &
        -5.587708608348958e-16_rk, -5.650287524501715e-16_rk, 1.2091540327703378e-16_rk, -6.094413448457092_rk,   &
        0.43755919896471457_rk, -1.4035350583483245e-15_rk, -2.2778427323281475e-16_rk, -1.6952795582286768e-16_rk,   &
        -9.557522268647333e-16_rk, 0.6901841202733899_rk, 2.6611491920683946e-16_rk, -2.3431983518558683e-16_rk,   &
        -6.19349072873633e-16_rk, -1.2189034673469316e-17_rk, 0.18493427765603904_rk, -6.169468379780299e-16_rk,   &
        2.3608045041526466e-16_rk, -1.638800779881507e-15_rk, -2.671588767173651e-16_rk, 0.43755919896471385_rk   &
        /),(/4,8/))
        test_dbr2_vol_face5_dx(:,:,3,1) = reshape((/ &
        -2.5758022034375165_rk, 2.691014666112576e-16_rk, -2.2795865547003708e-17_rk, -1.8929706119392565e-16_rk,   &
        9.805081908273047e-18_rk, -6.094413448457094_rk, -4.3402758492718756e-16_rk, -5.782505036964605e-16_rk,   &
        6.456914069268594e-17_rk, -6.236785422566605e-16_rk, -6.0944134484570895_rk, -1.306225845748612e-17_rk,   &
        -6.400251248418249e-16_rk, -4.021787569832956e-16_rk, -1.9611266897384188e-16_rk, -9.613024693476664_rk,   &
        0.18493427765603976_rk, -1.067645929792107e-15_rk, -2.8130466894637154e-16_rk, -3.244138248779619e-16_rk,   &
        -7.7162239704562e-16_rk, 0.4375591989647144_rk, 6.675987785596198e-17_rk, -1.9243249695997383e-16_rk,   &
        -5.168350809002299e-16_rk, 1.00582643017216e-16_rk, 0.4375591989647137_rk, -1.0951623616290325e-15_rk,   &
        1.349465811918184e-16_rk, -1.0505502396957382e-15_rk, -3.1757043300904777e-16_rk, 0.6901841202733883_rk   &
        /),(/4,8/))
        test_dbr2_vol_face5_dx(:,:,3,2) = reshape((/ &
        0.48803387171258505_rk, -1.4662018494384962e-16_rk, 2.2147483372553177e-17_rk, -1.3824727891530666e-17_rk,   &
        2.9795127384518665e-17_rk, 1.8213672050459186_rk, 3.3336769007385415e-16_rk, 3.147486749769974e-16_rk,   &
        -2.551726375696788e-16_rk, 1.6544975998100314e-16_rk, 1.8213672050459173_rk, -2.221431056964162e-17_rk,   &
        7.025455022941777e-16_rk, 2.997220459841625e-16_rk, 2.5419842313915316e-16_rk, 6.797434948471082_rk,   &
        -0.13076828180442146_rk, 4.748957144948335e-16_rk, 1.7260609746560953e-16_rk, 1.9607123004015161e-16_rk,   &
        5.563338995940411e-16_rk, -0.48803387171258505_rk, -3.884560416996797e-17_rk, 2.1928315058924085e-16_rk,   &
        4.868559674528831e-16_rk, -7.851296192096415e-17_rk, -0.48803387171258483_rk, 8.043109070436345e-16_rk,   &
        -3.067643150929227e-16_rk, 3.5997610422930133e-16_rk, 2.83681459844409e-16_rk, -1.821367205045917_rk   &
        /),(/4,8/))
        test_dbr2_vol_face5_dx(:,:,3,3) = reshape((/ &
        -1.1102230246251565e-16_rk, -8.441154513785598e-17_rk, -1.4468905372939413e-16_rk, 1.521515833888222e-17_rk,   &
        -2.6873624426176328e-17_rk, 3.518611245019579_rk, -1.5527047600357821e-16_rk, 1.9970893748642473e-16_rk,   &
        -6.737197445377459e-17_rk, -1.5360144197841943e-16_rk, -3.5186112450195757_rk, -2.2630607931992843e-16_rk,   &
        2.7394139819469632e-17_rk, 2.559447002253136e-16_rk, -2.919788601698986e-16_rk, -1.1746802312608045e-18_rk,   &
        -6.093877834533889e-17_rk, 3.3861217328478377e-16_rk, -2.6233192505074676e-17_rk, -5.919902120488141e-19_rk,   &
        4.9694898572530214e-17_rk, -0.2526249213086752_rk, -1.522035883323467e-16_rk, 8.905414665061218e-17_rk,   &
        4.9610358560714074e-18_rk, 1.7581299501660843e-16_rk, 0.25262492130867475_rk, -1.1334593700661806e-16_rk,   &
        -7.054698648081753e-17_rk, 4.705456107280099e-16_rk, -3.0208214518264243e-18_rk, 3.7189210704882866e-17_rk   &
        /),(/4,8/))
        test_dbr2_vol_face5_dx(:,:,4,1) = reshape((/ &
        -3.51861124501958_rk, -2.2502932994648787e-16_rk, -1.277705873179448e-16_rk, -1.3865746401862321e-17_rk,   &
        -2.1931855006867963e-16_rk, 2.2581560514337334e-16_rk, -1.699231671985239e-17_rk, 1.762064674131505e-16_rk,   &
        -1.67698792498373e-16_rk, 3.349190213540956e-17_rk, 1.1370901590929226e-16_rk, -7.818262535640212e-17_rk,   &
        1.0864840382639872e-16_rk, 9.309470475843774e-17_rk, 2.504921208097708e-17_rk, 3.518611245019576_rk,   &
        0.25262492130867475_rk, 2.7230447285663405e-18_rk, 2.7287203208482114e-17_rk, 1.5429387884304543e-16_rk,   &
        -1.3443493124658314e-16_rk, 4.9092579082355245e-17_rk, 4.7151453018530873e-17_rk, 4.7166808424999253e-17_rk,   &
        -9.755295611733168e-17_rk, 6.304131732592307e-17_rk, 3.0962942498321086e-18_rk, 3.6486958664438487e-16_rk,   &
        3.058688274262878e-17_rk, -1.1770492945775868e-16_rk, 4.739073483985629e-17_rk, -0.2526249213086745_rk   &
        /),(/4,8/))
        test_dbr2_vol_face5_dx(:,:,4,2) = reshape((/ &
        1.8213672050459193_rk, -6.181943021715099e-17_rk, 2.256975494077017e-16_rk, 3.2468818262147774e-17_rk,   &
        3.5618368661492726e-17_rk, 0.48803387171258517_rk, 5.754157864948198e-16_rk, -3.606411373493267e-17_rk,   &
        2.4926064438825367e-17_rk, 6.964398347053025e-16_rk, 6.797434948471084_rk, 5.160896016632771e-16_rk,   &
        2.5409857212502566e-16_rk, -3.3511539614600496e-17_rk, 3.49060252348543e-16_rk, 1.8213672050459182_rk,   &
        -0.4880338717125852_rk, 5.531221110912092e-16_rk, 2.386132103409567e-16_rk, 4.42932870202678e-17_rk,   &
        4.0106342148426307e-16_rk, -0.13076828180442146_rk, -2.4669943044609367e-17_rk, -1.0047786999574404e-16_rk,   &
        8.006408358304825e-16_rk, -6.482659165315858e-16_rk, -1.8213672050459182_rk, 5.603064332183391e-16_rk,   &
        -1.3326627739951933e-16_rk, 2.5409443311233804e-16_rk, -7.624248463043193e-19_rk, -0.48803387171258494_rk   &
        /),(/4,8/))
        test_dbr2_vol_face5_dx(:,:,4,3) = reshape((/ &
        6.094413448457097_rk, 4.033940847308624e-17_rk, 2.9525550659434263e-16_rk, 1.8794764925690578e-16_rk,   &
        2.363870925865829e-16_rk, 2.575802203437515_rk, 6.062903776506184e-16_rk, 2.0233509879688535e-16_rk,   &
        1.7050162625946156e-16_rk, 7.437880820996704e-16_rk, 9.613024693476667_rk, 3.1755096313381673e-16_rk,   &
        5.039825811959563e-16_rk, 5.3139351999544354e-17_rk, 4.630423170627635e-16_rk, 6.094413448457092_rk,   &
        -0.43755919896471446_rk, 7.263107117787571e-16_rk, 2.8025065824296414e-16_rk, 1.707119362469653e-16_rk,   &
        8.563624297196729e-16_rk, -0.1849342776560396_rk, 3.829225745785388e-17_rk, 5.621154188436245e-17_rk,   &
        6.094270011614903e-16_rk, -3.3943695535974774e-16_rk, -0.6901841202733886_rk, 8.43638711991266e-16_rk,   &
        -9.498647745362963e-17_rk, 6.97709558425487e-16_rk, 2.732005196210179e-16_rk, -0.43755919896471385_rk   &
        /),(/4,8/))
        test_dbr2_vol_face5_dx(:,:,5,1) = reshape((/ &
        2.5758022034375165_rk, -1.9231495592181274e-17_rk, 2.318800812633698e-16_rk, -1.4088215697404116e-16_rk,   &
        4.4284270907629927e-17_rk, 1.6329931618554518_rk, 5.30239125066e-16_rk, -2.237547855102112e-17_rk,   &
        -3.697697521088737e-16_rk, 2.561145644622649e-16_rk, 1.632993161855451_rk, 2.7128864054006203e-16_rk,   &
        6.062496136447997e-16_rk, -1.847578330576854e-16_rk, -3.075092078728907e-16_rk, 0.6901841202733885_rk,   &
        -2.5758022034375165_rk, 1.1154449412006823e-15_rk, 2.017363003711598e-16_rk, 2.4471960105082266e-16_rk,   &
        1.0913888694315302e-15_rk, -1.6329931618554523_rk, -4.3795558595517273e-16_rk, 1.1568231755231905e-16_rk,   &
        1.013038437072558e-15_rk, -8.005177638876783e-16_rk, -1.6329931618554518_rk, 3.350782811638734e-16_rk,   &
        -2.5106519238087967e-16_rk, 4.225567139729611e-16_rk, 3.962275075393378e-17_rk, -0.6901841202733885_rk   &
        /),(/4,8/))
        test_dbr2_vol_face5_dx(:,:,5,2) = reshape((/ &
        -6.79743494847109_rk, -2.3528780354319235e-16_rk, -2.590800237217266e-16_rk, -2.127893869368117e-17_rk,   &
        -2.702841206519118e-16_rk, -1.8213672050459182_rk, -3.150557264817447e-16_rk, -5.552243556846423e-19_rk,   &
        -4.562347385913694e-17_rk, -1.3667608820576792e-16_rk, -1.8213672050459182_rk, -1.1555923862970126e-16_rk,   &
        -4.534530069586994e-16_rk, 1.4650611656800331e-16_rk, 2.132042379989646e-16_rk, -0.4880338717125847_rk,   &
        1.8213672050459186_rk, -8.130827670477739e-16_rk, -9.779455084999785e-17_rk, -1.3353616607454005e-16_rk,   &
        -8.292398808512228e-16_rk, 0.48803387171258517_rk, 1.7813941396831802e-16_rk, -6.617883026107883e-17_rk,   &
        -6.352533139529663e-16_rk, 3.528067790269006e-16_rk, 0.48803387171258494_rk, -9.231933343808853e-17_rk,   &
        1.3472720926380257e-16_rk, -5.384597325320932e-16_rk, -9.517682925741555e-17_rk, 0.13076828180442113_rk   &
        /),(/4,8/))
        test_dbr2_vol_face5_dx(:,:,5,3) = reshape((/ &
        1.1102230246251565e-16_rk, 8.159166269058049e-19_rk, -3.0672843478295086e-17_rk, -1.507956814933919e-17_rk,   &
        6.737846441218488e-17_rk, 0.9428090415820636_rk, -1.0579507112187608e-16_rk, 5.397030577765219e-17_rk,   &
        -1.3134144723117752e-16_rk, -2.117930927832878e-16_rk, -0.9428090415820622_rk, -2.26264127569286e-16_rk,   &
        9.547517956541067e-19_rk, 2.987022502347627e-17_rk, -6.16455209142317e-17_rk, 1.1746802312608045e-18_rk,   &
        6.093877834533889e-17_rk, -9.307285939355907e-17_rk, -2.1052662958175387e-17_rk, 9.648834098675142e-18_rk,   &
        3.422746144025359e-16_rk, -0.9428090415820641_rk, -1.599990382520008e-16_rk, 1.7323321818081942e-16_rk,   &
        -3.106425864045577e-16_rk, 2.1273454640685496e-16_rk, 0.9428090415820639_rk, -1.0910480384890454e-16_rk,   &
        2.3614708897849007e-18_rk, 1.1713035188655965e-16_rk, 1.3191040433352375e-16_rk, 7.383309175763279e-17_rk   &
        /),(/4,8/))
        test_dbr2_vol_face5_dx(:,:,6,1) = reshape((/ &
        -0.9428090415820631_rk, -4.502039850201343e-17_rk, -3.9766018646710983e-17_rk, -1.0956294285052504e-17_rk,   &
        4.9267152128579934e-17_rk, -2.2581560514337334e-16_rk, 2.9940830352674206e-17_rk, 4.596185212558036e-17_rk,   &
        -4.4996177647487015e-17_rk, -1.3145843703504709e-17_rk, -5.577982257593549e-16_rk, -1.923798555059168e-17_rk,   &
        6.748658876799638e-17_rk, 2.2243625493861174e-16_rk, 3.0545437915442405e-16_rk, 0.9428090415820627_rk,   &
        0.9428090415820637_rk, -2.418574028982419e-16_rk, 2.5612548714470406e-17_rk, -1.1007491105102698e-16_rk,   &
        -5.853873872673887e-17_rk, -2.7113718400738655e-16_rk, 5.1344144467191585e-17_rk, 6.109429470800152e-17_rk,   &
        -7.379813902966957e-18_rk, 1.3091370078722712e-16_rk, -3.0962942498321086e-18_rk, 1.385844831997776e-16_rk,   &
        -1.5223548689010726e-16_rk, -8.502054445924711e-18_rk, 8.59021677332718e-17_rk, -0.9428090415820627_rk   &
        /),(/4,8/))
        test_dbr2_vol_face5_dx(:,:,6,2) = reshape((/ &
        -1.8213672050459189_rk, 1.800415018124397e-16_rk, 2.2301623946889036e-17_rk, -3.2660571747124284e-17_rk,   &
        -9.290086271145808e-17_rk, -6.797434948471087_rk, -2.0621334908164993e-16_rk, -3.2269251258166857e-16_rk,   &
        2.560971515335977e-16_rk, -1.7969392802828886e-16_rk, -0.48803387171258494_rk, 1.2394132284544767e-16_rk,   &
        -2.941899591253785e-16_rk, -3.7069180400089054e-16_rk, 1.5104014336642586e-16_rk, -1.8213672050459178_rk,   &
        0.4880338717125852_rk, -9.003671388919638e-16_rk, -1.7174091223641454e-16_rk, -5.710159847703059e-17_rk,   &
        -9.553920227703779e-16_rk, 1.8213672050459193_rk, 4.661911317686964e-16_rk, -2.704524785879665e-16_rk,   &
        -3.683418412775764e-16_rk, 9.8776713823802e-17_rk, 0.13076828180442127_rk, -2.45713578540516e-16_rk,   &
        2.2969515830575983e-16_rk, -1.0851937497225268e-15_rk, -1.815149713136031e-16_rk, 0.4880338717125845_rk   &
        /),(/4,8/))
        test_dbr2_vol_face5_dx(:,:,6,3) = reshape((/ &
        -1.6329931618554525_rk, 6.343597746728893e-17_rk, -1.614412191383637e-16_rk, 1.6691801940843293e-16_rk,   &
        -1.6092988744839472e-16_rk, -2.575802203437516_rk, -4.543848842967982e-16_rk, -7.755667935221146e-17_rk,   &
        5.461073769875383e-16_rk, -3.117562797547239e-17_rk, -0.6901841202733892_rk, -2.5786527420184445e-17_rk,   &
        -6.746909542084501e-16_rk, -6.75486469044027e-17_rk, 6.370034963269819e-17_rk, -1.6329931618554516_rk,   &
        1.6329931618554527_rk, -7.805146789088816e-16_rk, -2.062961861274548e-16_rk, -1.4429352409847083e-16_rk,   &
        -1.375124745107327e-15_rk, 2.575802203437517_rk, 5.466104797399818e-16_rk, -3.5000983044114e-16_rk,   &
        -6.950160367650338e-16_rk, 4.568695166935964e-16_rk, 0.6901841202733886_rk, -3.6455796051474675e-16_rk,   &
        4.009392083812021e-16_rk, -5.311850114135963e-16_rk, -2.5743532282072935e-16_rk, 1.6329931618554516_rk   &
        /),(/4,8/))
        test_dbr2_vol_face5_dx(:,:,7,1) = reshape((/ &
        -0.6901841202733894_rk, 1.0927229259620815e-16_rk, -1.5234804396994774e-16_rk, 1.6279474554414626e-16_rk,   &
        -1.4281857516478975e-16_rk, -1.6329931618554518_rk, -5.901207857713486e-16_rk, -6.954822570013963e-17_rk,   &
        4.597621074038476e-16_rk, -2.2982287705525544e-16_rk, -1.6329931618554505_rk, -2.3281266943887874e-16_rk,   &
        -7.412227911807924e-16_rk, -2.601146768195381e-16_rk, -3.033995504359575e-16_rk, -2.575802203437514_rk,   &
        0.6901841202733889_rk, -6.317301354041986e-16_rk, -2.5296139780010065e-16_rk, -2.4569778948768704e-17_rk,   &
        -9.743113919780525e-16_rk, 1.6329931618554523_rk, 3.3526729702078945e-16_rk, -2.3787090696832204e-16_rk,   &
        -9.982788092666242e-16_rk, 5.386903623132239e-16_rk, 1.6329931618554518_rk, -6.122472475634287e-16_rk,   &
        5.555361661610941e-16_rk, -4.055526050811117e-16_rk, -2.114270862204774e-16_rk, 2.575802203437514_rk   &
        /),(/4,8/))
        test_dbr2_vol_face5_dx(:,:,7,2) = reshape((/ &
        -0.48803387171258505_rk, 1.4662018494384962e-16_rk, -2.2147483372553177e-17_rk, 1.3824727891530666e-17_rk,   &
        -2.9795127384518665e-17_rk, -1.8213672050459186_rk, -3.3336769007385415e-16_rk, -3.147486749769974e-16_rk,   &
        2.551726375696789e-16_rk, -1.6544975998100314e-16_rk, -1.8213672050459173_rk, 2.221431056964162e-17_rk,   &
        -7.025455022941777e-16_rk, -2.997220459841626e-16_rk, -2.541984231391532e-16_rk, -6.797434948471086_rk,   &
        0.13076828180442146_rk, -4.748957144948335e-16_rk, -1.7260609746560953e-16_rk, -1.9607123004015166e-16_rk,   &
        -5.563338995940411e-16_rk, 0.48803387171258505_rk, 3.884560416996797e-17_rk, -2.1928315058924085e-16_rk,   &
        -4.868559674528831e-16_rk, 7.851296192096415e-17_rk, 0.48803387171258483_rk, -8.043109070436348e-16_rk,   &
        3.067643150929227e-16_rk, -3.5997610422930133e-16_rk, -2.83681459844409e-16_rk, 1.821367205045918_rk   &
        /),(/4,8/))
        test_dbr2_vol_face5_dx(:,:,7,3) = reshape((/ &
        1.1102230246251565e-16_rk, 8.159166269058542e-19_rk, -3.067284347829506e-17_rk, -1.5079568149339216e-17_rk,   &
        6.737846441218486e-17_rk, 0.9428090415820636_rk, -1.0579507112187599e-16_rk, 5.397030577765219e-17_rk,   &
        -1.3134144723117757e-16_rk, -2.1179309278328776e-16_rk, -0.9428090415820622_rk, -2.26264127569286e-16_rk,   &
        9.547517956540174e-19_rk, 2.987022502347629e-17_rk, -6.16455209142316e-17_rk, 1.1746802312608045e-18_rk,   &
        6.093877834533889e-17_rk, -9.307285939355897e-17_rk, -2.1052662958175393e-17_rk, 9.648834098675105e-18_rk,   &
        3.4227461440253553e-16_rk, -0.9428090415820637_rk, -1.5999903825200075e-16_rk, 1.7323321818081942e-16_rk,   &
        -3.1064258640455736e-16_rk, 2.1273454640685471e-16_rk, 0.9428090415820631_rk, -1.0910480384890447e-16_rk,   &
        2.361470889784728e-18_rk, 1.171303518865596e-16_rk, 1.319104043335237e-16_rk, 7.383309175763279e-17_rk   &
        /),(/4,8/))
        test_dbr2_vol_face5_dx(:,:,8,1) = reshape((/ &
        -0.942809041582064_rk, -4.502039850201343e-17_rk, -3.976601864671103e-17_rk, -1.0956294285052565e-17_rk,   &
        4.9267152128579947e-17_rk, -2.2581560514337334e-16_rk, 2.994083035267429e-17_rk, 4.596185212558038e-17_rk,   &
        -4.4996177647486965e-17_rk, -1.3145843703504709e-17_rk, -1.1370901590929226e-16_rk, -1.923798555059165e-17_rk,   &
        6.748658876799628e-17_rk, 2.2243625493861174e-16_rk, 3.054543791544241e-16_rk, 0.9428090415820627_rk,   &
        0.9428090415820637_rk, -2.4185740289824176e-16_rk, 2.561254871447045e-17_rk, -1.1007491105102698e-16_rk,   &
        -5.853873872673889e-17_rk, 6.192972338016042e-17_rk, 5.134414446719164e-17_rk, 6.109429470800147e-17_rk,   &
        -7.379813902966963e-18_rk, 1.3091370078722717e-16_rk, -3.0962942498321086e-18_rk, 1.385844831997776e-16_rk,   &
        -1.5223548689010726e-16_rk, -8.502054445924613e-18_rk, 8.590216773327184e-17_rk, -0.9428090415820631_rk   &
        /),(/4,8/))
        test_dbr2_vol_face5_dx(:,:,8,2) = reshape((/ &
        -1.8213672050459193_rk, 6.181943021715099e-17_rk, -2.256975494077017e-16_rk, -3.2468818262147774e-17_rk,   &
        -3.5618368661492726e-17_rk, -0.48803387171258517_rk, -5.754157864948198e-16_rk, 3.606411373493267e-17_rk,   &
        -2.492606443882539e-17_rk, -6.964398347053025e-16_rk, -6.797434948471084_rk, -5.160896016632771e-16_rk,   &
        -2.5409857212502556e-16_rk, 3.3511539614600496e-17_rk, -3.49060252348543e-16_rk, -1.8213672050459173_rk,   &
        0.4880338717125852_rk, -5.531221110912092e-16_rk, -2.386132103409567e-16_rk, -4.4293287020267775e-17_rk,   &
        -4.0106342148426307e-16_rk, 0.13076828180442146_rk, 2.4669943044609367e-17_rk, 1.0047786999574404e-16_rk,   &
        -8.006408358304825e-16_rk, 6.482659165315858e-16_rk, 1.8213672050459182_rk, -5.60306433218339e-16_rk,   &
        1.3326627739951933e-16_rk, -2.5409443311233804e-16_rk, 7.624248463043193e-19_rk, 0.4880338717125847_rk   &
        /),(/4,8/))
        test_dbr2_vol_face5_dx(:,:,8,3) = reshape((/ &
        1.632993161855453_rk, -6.50678107211006e-17_rk, 2.227869060949538e-16_rk, -1.367588831097545e-16_rk,   &
        2.6172958624024977e-17_rk, 0.6901841202733883_rk, 6.659750265405502e-16_rk, -3.03839322030929e-17_rk,   &
        -2.834244825251832e-16_rk, 4.54761813542048e-16_rk, 2.575802203437513_rk, 4.783147825587565e-16_rk,   &
        6.72781450617142e-16_rk, 7.808196857450115e-18_rk, 5.959069219576511e-17_rk, 1.6329931618554516_rk,   &
        -1.6329931618554527_rk, 9.666603976959997e-16_rk, 2.4840151204380556e-16_rk, 1.2499585590112054e-16_rk,   &
        6.905755163022556e-16_rk, -0.690184120273389_rk, -2.2661240323598036e-16_rk, 3.543394079501176e-18_rk,   &
        1.3163012095741487e-15_rk, -8.823386095073061e-16_rk, -2.5758022034375156_rk, 5.827675682125556e-16_rk,   &
        -4.056621501607718e-16_rk, 2.969243076404767e-16_rk, -6.385485846318098e-18_rk, -1.6329931618554516_rk   &
        /),(/4,8/))
        
        
        


        
        do inode_diff = 1,self%elem%nterms_c 
            do idir =1,3
                @assertEqual(transpose(test_dbr2_vol_face5_dx(:,:,inode_diff,idir)),self%faces(ZETA_MIN)%dbr2_v_dx(:,:,inode_diff,idir),tol)
            end do
        end do
        
       
        
        !
        ! dbr2_vol_face6_dx
        ! 
        test_dbr2_vol_face6_dx(:,:,1,1) = reshape((/ &
        -2.5758022034375165_rk, -6.240682412894068e-17_rk, 2.0538955778558727e-16_rk, 1.6804976190998148e-16_rk,   &
        2.944010308987838e-17_rk, -1.632993161855452_rk, 1.3411974188247332e-16_rk, -1.5266355158932403e-16_rk,   &
        5.0433083401295106e-17_rk, -3.3261216387650716e-16_rk, -1.6329931618554507_rk, -4.133595289174963e-16_rk,   &
        -2.861168164408127e-16_rk, 2.312139224876515e-16_rk, 1.3480980325745167e-16_rk, -0.6901841202733884_rk,   &
        2.5758022034375165_rk, -2.167650513217983e-16_rk, -3.593162423209982e-16_rk, 3.8207134386218343e-16_rk,   &
        -1.502154834533401e-16_rk, 1.6329931618554527_rk, 4.962719042671447e-16_rk, -3.132203060059652e-16_rk,   &
        -2.8970659499498526e-16_rk, 5.248104482497172e-16_rk, 1.6329931618554516_rk, 2.585616778324496e-16_rk,   &
        -2.002811395679761e-16_rk, -2.3702839399724204e-16_rk, 2.0389751446632275e-16_rk, 0.6901841202733889_rk   &
        /),(/4,8/))
        test_dbr2_vol_face6_dx(:,:,1,2) = reshape((/ &
        -1.8213672050459189_rk, -7.384360100352609e-17_rk, 6.506211273126944e-17_rk, -1.2166445613766212e-16_rk,   &
        1.0658050761703842e-17_rk, -0.48803387171258505_rk, -2.5606994645408462e-17_rk, 2.030290951404272e-16_rk,   &
        4.8532349869909286e-17_rk, -4.5290896999715326e-17_rk, -0.4880338717125845_rk, 1.3894623601419905e-16_rk,   &
        1.9502178978834466e-16_rk, 2.967763366257601e-16_rk, 2.6227927458767836e-16_rk, -0.13076828180442168_rk,   &
        6.79743494847109_rk, -4.01967449268023e-16_rk, -6.554468792090385e-16_rk, 2.345454147961328e-16_rk,   &
        -2.564635317730689e-16_rk, 1.8213672050459189_rk, 2.8199911012778724e-16_rk, -4.928834998517138e-16_rk,   &
        -7.890081205573388e-16_rk, 4.836533571372542e-16_rk, 1.821367205045918_rk, 2.455128557516157e-17_rk,   &
        -2.7822291908206743e-16_rk, -2.9051652846254916e-16_rk, 1.8659795364927022e-16_rk, 0.48803387171258517_rk   &
        /),(/4,8/))
        test_dbr2_vol_face6_dx(:,:,1,3) = reshape((/ &
        -2.498001805406602e-16_rk, -1.2428125541634939e-16_rk, 9.815499952226236e-17_rk, 2.1963405768805602e-17_rk,   &
        1.4413663977834017e-16_rk, -0.9428090415820632_rk, 8.968128039962683e-17_rk, -9.25148249736521e-17_rk,   &
        1.7351326400796367e-16_rk, 1.8411004168861617e-16_rk, 0.9428090415820628_rk, 2.725810635752375e-16_rk,   &
        -5.393278675103874e-17_rk, -1.4534072658820154e-16_rk, 3.231116669051708e-17_rk, 2.910498755264882e-17_rk,   &
        4.361367940788262e-18_rk, -5.3207263583828255e-17_rk, 8.806955353157889e-17_rk, -8.447122778461452e-18_rk,   &
        -1.1355213252535917e-16_rk, 0.942809041582064_rk, 1.1091061580843018e-16_rk, -1.163324844110363e-16_rk,   &
        3.729436616673344e-17_rk, 8.524218066069754e-18_rk, -0.9428090415820634_rk, 1.1734011063977221e-16_rk,   &
        -1.1399714390737941e-18_rk, -4.4422787821111785e-17_rk, -1.1937958395177039e-16_rk, 2.236801179028269e-16_rk   &
        /),(/4,8/))
        test_dbr2_vol_face6_dx(:,:,2,1) = reshape((/ &
        0.9428090415820634_rk, -1.0953460752723617e-16_rk, -5.758398693108488e-17_rk, 1.777508339312056e-16_rk,   &
        2.477247488409142e-16_rk, 3.7549395479644e-16_rk, 7.397339075644909e-17_rk, -2.676087867814604e-16_rk,   &
        1.5113746720167607e-16_rk, 8.596073566636159e-20_rk, 1.0826630947398711e-16_rk, -9.856295783571524e-17_rk,   &
        -3.4352476743180213e-16_rk, 2.542732907105071e-17_rk, 1.5395739534834793e-16_rk, -0.9428090415820626_rk,   &
        -0.9428090415820636_rk, 6.120685178784191e-17_rk, 8.776528684990831e-17_rk, -1.6905912711783223e-16_rk,   &
        -1.6631930625894885e-17_rk, 2.0037335541063302e-16_rk, -8.011634980223666e-17_rk, 1.2408511309049035e-16_rk,   &
        2.8765397121368225e-17_rk, -1.6908778069638775e-16_rk, -4.995396852435307e-17_rk, -1.3321992175428253e-16_rk,   &
        1.645654139667061e-16_rk, 5.5187372504334194e-17_rk, -9.533712860997172e-17_rk, 0.942809041582062_rk   &
        /),(/4,8/))
        test_dbr2_vol_face6_dx(:,:,2,2) = reshape((/ &
        -0.488033871712585_rk, -3.8517910572459787e-16_rk, 2.39569068397076e-16_rk, 2.4620488506787546e-16_rk,   &
        3.1483721799816927e-16_rk, -1.8213672050459182_rk, -1.46761458399208e-17_rk, -2.2161598658207314e-16_rk,   &
        4.266750052232731e-16_rk, 2.401710838506043e-16_rk, -0.1307682818044212_rk, 5.545350222137236e-17_rk,   &
        -2.1649080224216406e-16_rk, 1.12590583803291e-16_rk, 3.301776173951054e-16_rk, -0.4880338717125847_rk,   &
        1.8213672050459189_rk, -3.031188690726169e-16_rk, -2.73409825421421e-16_rk, 8.946720627537367e-17_rk,   &
        -7.087225861737425e-16_rk, 6.79743494847109_rk, 7.451033796815396e-16_rk, -4.685268771302918e-16_rk,   &
        -2.1219699975140007e-16_rk, 5.277486218541053e-16_rk, 0.48803387171258505_rk, 1.2051102585904026e-16_rk,   &
        -2.0507335660173544e-17_rk, -2.651977788665678e-16_rk, -2.346481751790234e-16_rk, 1.8213672050459178_rk   &
        /),(/4,8/))
        test_dbr2_vol_face6_dx(:,:,2,3) = reshape((/ &
        1.6329931618554525_rk, 2.962226870725263e-16_rk, -2.4596057037676475e-16_rk, -3.6776400160999273e-16_rk,   &
        -4.213014917091327e-16_rk, 2.5758022034375148_rk, -2.9777441303854927e-16_rk, 5.127871633444367e-16_rk,   &
        -3.750838146109348e-16_rk, 1.484161614522248e-16_rk, 0.6901841202733879_rk, 2.3934142317797423e-16_rk,   &
        6.835743706236537e-16_rk, -1.1130052497050073e-16_rk, -3.210783652963167e-16_rk, 1.6329931618554514_rk,   &
        -1.6329931618554527_rk, 2.0876546311778463e-16_rk, 1.8348140193951107e-16_rk, -2.045650939658897e-16_rk,   &
        2.803995466045941e-16_rk, -2.5758022034375165_rk, -5.270661702733381e-16_rk, 3.054676773265112e-16_rk,   &
        2.236468317068835e-16_rk, -3.642468856193992e-16_rk, -0.6901841202733887_rk, -2.426818667179392e-16_rk,   &
        3.685569704034371e-17_rk, 2.2626380931401963e-16_rk, 1.0819198095419287e-17_rk, -1.6329931618554516_rk   &
        /),(/4,8/))
        test_dbr2_vol_face6_dx(:,:,3,1) = reshape((/ &
        0.6901841202733889_rk, 2.81476039183413e-16_rk, -9.022158392341755e-17_rk, -5.235514297723928e-16_rk,   &
        -5.248896007717068e-16_rk, 1.6329931618554516_rk, -2.8206652339537157e-16_rk, 6.87881125152245e-16_rk,   &
        -3.5270801780464726e-16_rk, 3.324402424051745e-16_rk, 1.6329931618554507_rk, 6.10485444588927e-16_rk,   &
        9.731663513044169e-16_rk, -2.820685806297529e-16_rk, -4.427245939541475e-16_rk, 2.5758022034375134_rk,   &
        -0.6901841202733894_rk, 9.435134774611451e-17_rk, 1.8378566862118164e-16_rk, -4.39530896265189e-17_rk,   &
        1.8347934470512995e-16_rk, -1.6329931618554527_rk, -3.3603920466267147e-16_rk, 6.505007982498446e-17_rk,   &
        2.321758007522487e-16_rk, -1.866348868569419e-16_rk, -1.6329931618554516_rk, 7.878165676115464e-18_rk,   &
        -1.2884968836543617e-16_rk, 1.2665364898857363e-16_rk, -1.3223257246379322e-17_rk, -2.5758022034375134_rk   &
        /),(/4,8/))
        test_dbr2_vol_face6_dx(:,:,3,2) = reshape((/ &
        -0.13076828180442118_rk, -1.2863116994304465e-16_rk, 3.204019991918959e-17_rk, 7.155296701493596e-16_rk,   &
        5.187273593551041e-16_rk, -0.48803387171258483_rk, 4.727112003388117e-17_rk, -5.259914963971166e-16_rk,   &
        4.2897940649266794e-16_rk, -1.051848438238229e-16_rk, -0.4880338717125844_rk, 2.617721592582271e-18_rk,   &
        -8.349866666629914e-16_rk, 2.1263983545607692e-16_rk, 3.8714175194736798e-16_rk, -1.8213672050459164_rk,   &
        0.48803387171258505_rk, -1.4039295051676368e-16_rk, -2.1823539006227252e-16_rk, -1.602143167958387e-16_rk,   &
        -3.900185043029292e-16_rk, 1.8213672050459193_rk, 1.3430944883288597e-16_rk, -2.823483636367767e-16_rk,   &
        -4.2138527247790045e-16_rk, 1.088582744866519e-16_rk, 1.821367205045918_rk, -4.673884437763992e-16_rk,   &
        2.594898356093646e-16_rk, -3.0546379262141545e-16_rk, -3.3885421547871906e-16_rk, 6.797434948471085_rk   &
        /),(/4,8/))
        test_dbr2_vol_face6_dx(:,:,3,3) = reshape((/ &
        8.326672684688674e-17_rk, -1.2428125541634944e-16_rk, 9.815499952226234e-17_rk, 2.1963405768805578e-17_rk,   &
        1.4413663977834017e-16_rk, -0.9428090415820628_rk, 8.968128039962675e-17_rk, -9.25148249736521e-17_rk,   &
        1.7351326400796347e-16_rk, 1.8411004168861597e-16_rk, 0.9428090415820626_rk, 2.7258106357523747e-16_rk,   &
        -5.393278675103869e-17_rk, -1.453407265882015e-16_rk, 3.2311166690517094e-17_rk, 2.910498755264882e-17_rk,   &
        4.361367940788262e-18_rk, -5.3207263583828206e-17_rk, 8.806955353157889e-17_rk, -8.447122778461465e-18_rk,   &
        -1.1355213252535902e-16_rk, 0.942809041582064_rk, 1.1091061580843018e-16_rk, -1.1633248441103616e-16_rk,   &
        3.7294366166733415e-17_rk, 8.524218066069754e-18_rk, -0.9428090415820634_rk, 1.1734011063977207e-16_rk,   &
        -1.139971439073751e-18_rk, -4.4422787821111785e-17_rk, -1.1937958395177039e-16_rk, 2.236801179028269e-16_rk   &
        /),(/4,8/))
        test_dbr2_vol_face6_dx(:,:,4,1) = reshape((/ &
        0.9428090415820638_rk, -1.0953460752723615e-16_rk, -5.758398693108482e-17_rk, 1.777508339312057e-16_rk,   &
        2.4772474884091424e-16_rk, 4.242704740889303e-17_rk, 7.397339075644919e-17_rk, -2.676087867814604e-16_rk,   &
        1.5113746720167607e-16_rk, 8.596073566628763e-20_rk, 1.0826630947398711e-16_rk, -9.856295783571529e-17_rk,   &
        -3.43524767431802e-16_rk, 2.542732907105071e-17_rk, 1.5395739534834793e-16_rk, -0.9428090415820626_rk,   &
        -0.9428090415820631_rk, 6.120685178784196e-17_rk, 8.776528684990831e-17_rk, -1.6905912711783228e-16_rk,   &
        -1.6631930625894885e-17_rk, -2.437158544394296e-16_rk, -8.01163498022366e-17_rk, 1.2408511309049037e-16_rk,   &
        2.876539712136835e-17_rk, -1.6908778069638756e-16_rk, -4.995396852435307e-17_rk, -1.3321992175428248e-16_rk,   &
        1.6456541396670615e-16_rk, 5.518737250433422e-17_rk, -9.533712860997172e-17_rk, 0.9428090415820625_rk   &
        /),(/4,8/))
        test_dbr2_vol_face6_dx(:,:,4,2) = reshape((/ &
        -0.4880338717125849_rk, 5.145712296723873e-17_rk, 3.856653730774415e-17_rk, 1.7114225623256323e-16_rk,   &
        1.9699865337283351e-16_rk, -0.1307682818044211_rk, -2.0137976924084473e-16_rk, -1.3269728576303004e-16_rk,   &
        -1.3060512415877032e-16_rk, -5.920077874596671e-16_rk, -1.8213672050459166_rk, -4.525427103564993e-16_rk,   &
        -1.6759039240794497e-16_rk, 3.329825033790626e-16_rk, 1.2055781695688404e-16_rk, -0.48803387171258494_rk,   &
        1.8213672050459193_rk, -2.8826059801583656e-16_rk, -3.037175250764682e-16_rk, 1.5260719506327674e-16_rk,   &
        -1.308728830280385e-16_rk, 0.48803387171258505_rk, 3.555368892704906e-16_rk, -1.6216778483140545e-16_rk,   &
        -5.138628855030123e-16_rk, 6.614656835015801e-16_rk, 6.7974349484710865_rk, -1.9291541082236656e-16_rk,   &
        -6.012622258848757e-17_rk, -1.878637725788998e-16_rk, 4.520234191866165e-16_rk, 1.8213672050459178_rk   &
        /),(/4,8/))
        test_dbr2_vol_face6_dx(:,:,4,3) = reshape((/ &
        -1.6329931618554525_rk, -4.766017623982745e-17_rk, 4.9650571332240055e-17_rk, 3.2383719007238155e-16_rk,   &
        1.3302821215245236e-16_rk, -0.6901841202733888_rk, 1.184118522392957e-16_rk, -3.277575133971325e-16_rk,   &
        2.8057286595007585e-17_rk, -5.16636244829457e-16_rk, -2.5758022034375134_rk, -7.845035503284492e-16_rk,   &
        -5.757087971215764e-16_rk, 4.019819781469038e-16_rk, 2.564560319152825e-16_rk, -1.6329931618554514_rk,   &
        1.6329931618554527_rk, -1.0235093595012816e-16_rk, -3.596205090026688e-16_rk, 2.2145933952281261e-16_rk,   &
        -5.3295281553875985e-17_rk, 0.6901841202733887_rk, 3.0524493865647793e-16_rk, -7.280270850443866e-17_rk,   &
        -2.9823556404035046e-16_rk, 3.471984494872597e-16_rk, 2.575802203437515_rk, 8.001645438394893e-18_rk,   &
        -3.457575416219617e-17_rk, -1.3741823367179607e-16_rk, 2.2793996980812153e-16_rk, 1.6329931618554516_rk   &
        /),(/4,8/))
        test_dbr2_vol_face6_dx(:,:,5,1) = reshape((/ &
        -0.6901841202733894_rk, -2.7800087494346216e-16_rk, 8.329373731892733e-17_rk, -4.5000292116249566e-17_rk,   &
        3.4755527234674586e-16_rk, -0.4375591989647143_rk, -3.231081036706993e-16_rk, 1.8925273395363524e-16_rk,   &
        2.275550446043712e-16_rk, 1.977504409517724e-17_rk, -0.4375591989647134_rk, 3.2907470852112515e-16_rk,   &
        2.9033285925444214e-16_rk, 5.035589492207687e-16_rk, 5.548271861451758e-16_rk, -0.18493427765603976_rk,   &
        9.613024693476676_rk, -7.698711984982911e-16_rk, -9.757162868168264e-16_rk, 1.207984134731644e-16_rk,   &
        -8.061623711603176e-16_rk, 6.094413448457097_rk, 6.808052596756818e-16_rk, -8.297906964855192e-16_rk,   &
        -1.339521258330631e-15_rk, 1.0000801885021204e-15_rk, 6.094413448457092_rk, -2.750385483935706e-16_rk,   &
        -2.5020202178974463e-16_rk, -4.941869159700325e-16_rk, 2.1369935139539073e-16_rk, 2.5758022034375143_rk   &
        /),(/4,8/))
        test_dbr2_vol_face6_dx(:,:,5,2) = reshape((/ &
        1.8213672050459189_rk, 7.384360100352609e-17_rk, -6.506211273126944e-17_rk, 1.2166445613766221e-16_rk,   &
        -1.0658050761703842e-17_rk, 0.48803387171258505_rk, 2.5606994645408462e-17_rk, -2.0302909514042726e-16_rk,   &
        -4.8532349869909237e-17_rk, 4.5290896999715326e-17_rk, 0.4880338717125845_rk, -1.389462360141991e-16_rk,   &
        -1.9502178978834476e-16_rk, -2.967763366257601e-16_rk, -2.6227927458767836e-16_rk, 0.13076828180442146_rk,   &
        -6.79743494847109_rk, 4.01967449268023e-16_rk, 6.554468792090385e-16_rk, -2.345454147961328e-16_rk,   &
        2.564635317730689e-16_rk, -1.8213672050459189_rk, -2.8199911012778724e-16_rk, 4.928834998517138e-16_rk,   &
        7.890081205573388e-16_rk, -4.836533571372542e-16_rk, -1.821367205045918_rk, -2.455128557516162e-17_rk,   &
        2.7822291908206743e-16_rk, 2.9051652846254916e-16_rk, -1.8659795364927022e-16_rk, -0.4880338717125843_rk   &
        /),(/4,8/))
        test_dbr2_vol_face6_dx(:,:,5,3) = reshape((/ &
        -8.326672684688674e-17_rk, -1.8446718280336838e-16_rk, 4.397525324666405e-17_rk, 3.111388809433246e-17_rk,   &
        -6.081219164647616e-17_rk, -0.25262492130867475_rk, 4.233811777926591e-17_rk, 2.9639808650208895e-17_rk,   &
        2.205432944985961e-16_rk, 4.0432928137504415e-16_rk, 0.25262492130867453_rk, 8.662650315565838e-17_rk,   &
        1.9354975354461176e-17_rk, -1.0499894262546736e-17_rk, 1.1591241567032009e-16_rk, 8.191731490986683e-17_rk,   &
        -4.361367940788262e-18_rk, 4.270087936287109e-17_rk, -6.663877358332985e-17_rk, -3.6199591457507366e-17_rk,   &
        -2.9504931107560174e-16_rk, 3.51861124501958_rk, 1.6455449128426665e-16_rk, -1.0029610723166169e-16_rk,   &
        1.7601562730087795e-16_rk, -1.030764591173388e-16_rk, -3.518611245019579_rk, 1.0428584814078671e-16_rk,   &
        2.915475504914767e-17_rk, -1.0260612441221358e-17_rk, -3.66170556872352e-16_rk, -2.236801179028269e-16_rk   &
        /),(/4,8/))
        test_dbr2_vol_face6_dx(:,:,6,1) = reshape((/ &
        0.25262492130867503_rk, 7.079394600537711e-17_rk, 3.423396845391221e-17_rk, 4.1423480993589425e-16_rk,   &
        1.1153450457823955e-16_rk, 1.7961755751613826e-16_rk, -2.2440781666632667e-17_rk, -2.47886617119365e-16_rk,   &
        1.1787922641873907e-16_rk, -4.243737668701921e-17_rk, 2.7559929885285436e-18_rk, 2.1641408191019755e-18_rk,   &
        -3.8480119680442613e-16_rk, -8.49208195934436e-17_rk, -6.566629089155972e-17_rk, -0.2526249213086743_rk,   &
        -3.5186112450195792_rk, 1.2375425006464569e-16_rk, 2.2138992193843847e-16_rk, -1.1007815603023212e-16_rk,   &
        -7.780569611115237e-17_rk, 2.437158544394296e-16_rk, -2.4316011210532337e-17_rk, 2.478570940512518e-17_rk,   &
        2.311832116747147e-16_rk, -9.593236380122568e-17_rk, 4.995396852435307e-17_rk, -2.1463399680528103e-16_rk,   &
        2.1565492120610392e-16_rk, -6.575668435125513e-17_rk, -2.7621366336961003e-16_rk, 3.5186112450195752_rk   &
        /),(/4,8/))
        test_dbr2_vol_face6_dx(:,:,6,2) = reshape((/ &
        0.488033871712585_rk, 3.8517910572459787e-16_rk, -2.39569068397076e-16_rk, -2.4620488506787536e-16_rk,   &
        -3.1483721799816927e-16_rk, 1.8213672050459182_rk, 1.467614583992081e-17_rk, 2.2161598658207314e-16_rk,   &
        -4.266750052232731e-16_rk, -2.401710838506043e-16_rk, 0.1307682818044212_rk, -5.545350222137236e-17_rk,   &
        2.1649080224216397e-16_rk, -1.12590583803291e-16_rk, -3.301776173951054e-16_rk, 0.4880338717125845_rk,   &
        -1.8213672050459189_rk, 3.031188690726169e-16_rk, 2.73409825421421e-16_rk, -8.94672062753737e-17_rk,   &
        7.087225861737425e-16_rk, -6.79743494847109_rk, -7.451033796815396e-16_rk, 4.685268771302918e-16_rk,   &
        2.1219699975140007e-16_rk, -5.277486218541053e-16_rk, -0.48803387171258505_rk, -1.205110258590403e-16_rk,   &
        2.0507335660173593e-17_rk, 2.651977788665678e-16_rk, 2.346481751790234e-16_rk, -1.8213672050459169_rk   &
        /),(/4,8/))
        test_dbr2_vol_face6_dx(:,:,6,3) = reshape((/ &
        0.4375591989647143_rk, 3.9167411174145345e-16_rk, -1.615029590195036e-16_rk, -4.0034840591397733e-16_rk,   &
        -3.982775852785094e-16_rk, 0.6901841202733888_rk, 3.03210767558066e-16_rk, 2.89940745155209e-17_rk,   &
        -5.659775655217063e-16_rk, -3.8166694878320203e-16_rk, 0.18493427765603904_rk, -4.178653524958855e-16_rk,   &
        7.511336219552304e-17_rk, -4.0813823536477834e-16_rk, -6.050733109239361e-16_rk, 0.4375591989647141_rk,   &
        -6.094413448457097_rk, 6.034160690707743e-16_rk, 8.209651384617178e-16_rk, 2.547933401457514e-17_rk,   &
        1.1790173783470718e-15_rk, -9.613024693476676_rk, -8.210437397494163e-16_rk, 9.053010943120558e-16_rk,   &
        9.323224193550387e-16_rk, -8.010713655835562e-16_rk, -2.575802203437515_rk, 3.85386697058065e-16_rk,   &
        5.392345534493033e-18_rk, 5.702042127625089e-16_rk, 4.2868486884657137e-16_rk, -6.094413448457092_rk   &
        /),(/4,8/))
        test_dbr2_vol_face6_dx(:,:,7,1) = reshape((/ &
        0.18493427765603931_rk, 1.364129829327079e-16_rk, -1.517616742267518e-16_rk, -7.834693277555392e-16_rk,   &
        -5.706242815032249e-16_rk, 0.43755919896471396_rk, 3.6798966700396456e-16_rk, 3.0652050028509473e-16_rk,   &
        -4.633134974418494e-16_rk, 6.509970927886124e-17_rk, 0.4375591989647135_rk, -3.33402990159329e-16_rk,   &
        4.792695343544104e-16_rk, -3.337173100338814e-16_rk, -4.2349460436205643e-16_rk, 0.6901841202733884_rk,   &
        -2.5758022034375165_rk, 5.223626983689996e-16_rk, 5.329364429399495e-16_rk, 9.935789858729991e-17_rk,   &
        9.617737633826223e-16_rk, -6.094413448457097_rk, -6.32173237254617e-16_rk, 7.802192776752689e-16_rk,   &
        8.771548349812018e-16_rk, -8.082154608996693e-16_rk, -6.094413448457092_rk, 7.043065420041327e-16_rk,   &
        -1.811078206224632e-16_rk, 6.257002846725428e-16_rk, 3.387279753438294e-16_rk, -9.613024693476667_rk   &
        /),(/4,8/))
        test_dbr2_vol_face6_dx(:,:,7,2) = reshape((/ &
        0.13076828180442118_rk, 1.2863116994304465e-16_rk, -3.204019991918959e-17_rk, -7.155296701493598e-16_rk,   &
        -5.187273593551041e-16_rk, 0.48803387171258483_rk, -4.7271120033881185e-17_rk, 5.259914963971168e-16_rk,   &
        -4.2897940649266814e-16_rk, 1.051848438238229e-16_rk, 0.4880338717125844_rk, -2.617721592582271e-18_rk,   &
        8.349866666629918e-16_rk, -2.1263983545607692e-16_rk, -3.8714175194736798e-16_rk, 1.821367205045917_rk,   &
        -0.48803387171258505_rk, 1.4039295051676368e-16_rk, 2.1823539006227252e-16_rk, 1.6021431679583875e-16_rk,   &
        3.900185043029292e-16_rk, -1.8213672050459193_rk, -1.3430944883288597e-16_rk, 2.823483636367767e-16_rk,   &
        4.2138527247790045e-16_rk, -1.088582744866519e-16_rk, -1.821367205045918_rk, 4.673884437763994e-16_rk,   &
        -2.594898356093646e-16_rk, 3.0546379262141545e-16_rk, 3.3885421547871916e-16_rk, -6.797434948471087_rk   &
        /),(/4,8/))
        test_dbr2_vol_face6_dx(:,:,7,3) = reshape((/ &
        2.7755575615628914e-17_rk, -1.8446718280336842e-16_rk, 4.3975253246664026e-17_rk, 3.111388809433248e-17_rk,   &
        -6.081219164647606e-17_rk, -0.25262492130867475_rk, 4.233811777926593e-17_rk, 2.9639808650208895e-17_rk,   &
        2.205432944985959e-16_rk, 4.0432928137504396e-16_rk, 0.2526249213086743_rk, 8.662650315565853e-17_rk,   &
        1.9354975354461127e-17_rk, -1.0499894262546761e-17_rk, 1.1591241567032009e-16_rk, 8.191731490986683e-17_rk,   &
        -4.361367940788262e-18_rk, 4.270087936287104e-17_rk, -6.663877358332985e-17_rk, -3.6199591457507354e-17_rk,   &
        -2.950493110756015e-16_rk, 3.51861124501958_rk, 1.6455449128426665e-16_rk, -1.0029610723166164e-16_rk,   &
        1.760156273008778e-16_rk, -1.030764591173388e-16_rk, -3.518611245019577_rk, 1.0428584814078655e-16_rk,   &
        2.9154755049147696e-17_rk, -1.0260612441221358e-17_rk, -3.66170556872352e-16_rk, 6.644983017972983e-16_rk   &
        /),(/4,8/))
        test_dbr2_vol_face6_dx(:,:,8,1) = reshape((/ &
        0.25262492130867503_rk, 7.079394600537718e-17_rk, 3.4233968453912255e-17_rk, 4.1423480993589435e-16_rk,   &
        1.115345045782396e-16_rk, 6.859525505362262e-17_rk, -2.244078166663257e-17_rk, -2.47886617119365e-16_rk,   &
        1.1787922641873917e-16_rk, -4.243737668701923e-17_rk, 2.7559929885285436e-18_rk, 2.164140819101926e-18_rk,   &
        -3.848011968044263e-16_rk, -8.49208195934436e-17_rk, -6.566629089155972e-17_rk, -0.2526249213086743_rk,   &
        -3.5186112450195797_rk, 1.2375425006464573e-16_rk, 2.2138992193843847e-16_rk, -1.1007815603023217e-16_rk,   &
        -7.780569611115237e-17_rk, -2.0037335541063302e-16_rk, -2.43160112105324e-17_rk, 2.4785709405125156e-17_rk,   &
        2.311832116747148e-16_rk, -9.593236380122568e-17_rk, 4.995396852435307e-17_rk, -2.1463399680528103e-16_rk,   &
        2.1565492120610397e-16_rk, -6.575668435125515e-17_rk, -2.762136633696101e-16_rk, 3.518611245019577_rk   &
        /),(/4,8/))
        test_dbr2_vol_face6_dx(:,:,8,2) = reshape((/ &
        0.4880338717125849_rk, -5.145712296723873e-17_rk, -3.856653730774415e-17_rk, -1.7114225623256314e-16_rk,   &
        -1.9699865337283351e-16_rk, 0.1307682818044211_rk, 2.0137976924084473e-16_rk, 1.3269728576302999e-16_rk,   &
        1.3060512415877037e-16_rk, 5.920077874596671e-16_rk, 1.8213672050459166_rk, 4.525427103564993e-16_rk,   &
        1.6759039240794487e-16_rk, -3.329825033790626e-16_rk, -1.2055781695688404e-16_rk, 0.4880338717125847_rk,   &
        -1.8213672050459193_rk, 2.8826059801583656e-16_rk, 3.037175250764682e-16_rk, -1.5260719506327674e-16_rk,   &
        1.308728830280385e-16_rk, -0.48803387171258505_rk, -3.555368892704906e-16_rk, 1.6216778483140545e-16_rk,   &
        5.138628855030123e-16_rk, -6.614656835015801e-16_rk, -6.7974349484710865_rk, 1.9291541082236652e-16_rk,   &
        6.012622258848762e-17_rk, 1.878637725788998e-16_rk, -4.520234191866165e-16_rk, -1.8213672050459169_rk   &
        /),(/4,8/))
        test_dbr2_vol_face6_dx(:,:,8,3) = reshape((/ &
        -0.4375591989647143_rk, -2.2739746134716635e-17_rk, 7.355245252617552e-17_rk, 3.381206297253123e-16_rk,   &
        5.199019685714615e-16_rk, -0.18493427765603937_rk, -3.878870031165978e-16_rk, -8.827369181593869e-17_rk,   &
        1.2489097652451434e-16_rk, -4.2699161396688613e-16_rk, -0.6901841202733879_rk, 2.446123461845686e-16_rk,   &
        -1.1382331290444538e-16_rk, 4.291380238898719e-16_rk, 3.73248479583296e-16_rk, -0.4375591989647141_rk,   &
        6.094413448457097_rk, -6.888178277965165e-16_rk, -6.876875912950581e-16_rk, 4.69198489004396e-17_rk,   &
        -5.889187561958685e-16_rk, 2.5758022034375165_rk, 4.919347571808829e-16_rk, -7.047088798487325e-16_rk,   &
        -1.2843536739567943e-15_rk, 1.0072242838182338e-15_rk, 9.613024693476671_rk, -5.939583933396384e-16_rk,   &
        -6.370185563278839e-17_rk, -5.496829878800663e-16_rk, 3.0365624489813254e-16_rk, 6.094413448457092_rk   &
        /),(/4,8/))
        
        
        



        
        do inode_diff = 1,self%elem%nterms_c 
            do idir =1,3
                @assertEqual(transpose(test_dbr2_vol_face6_dx(:,:,inode_diff,idir)),self%faces(ZETA_MAX)%dbr2_v_dx(:,:,inode_diff,idir),tol)
            end do
        end do


    end subroutine testElement_dbr2_vol_dx
    !*******************************************************************************************





    !> Test cartesian dbr2_face_dx 
    !!
    !!
    !------------------------------------------------------------------------------------------
    @Test
    subroutine testElement_dbr2_face_dx(self)
        class(test_element_linearC_dx),    intent(inout)   :: self
        
        real(rk), dimension(self%faces(XI_MIN)%basis_s%nnodes_face(),  self%faces(XI_MIN)%basis_s%nnodes_face(),  self%elem%nterms_c,3) :: test_dbr2_face_face1_dx
        real(rk), dimension(self%faces(XI_MAX)%basis_s%nnodes_face(),  self%faces(XI_MAX)%basis_s%nnodes_face(),  self%elem%nterms_c,3) :: test_dbr2_face_face2_dx
        real(rk), dimension(self%faces(ETA_MIN)%basis_s%nnodes_face(), self%faces(ETA_MIN)%basis_s%nnodes_face(), self%elem%nterms_c,3) :: test_dbr2_face_face3_dx
        real(rk), dimension(self%faces(ETA_MAX)%basis_s%nnodes_face(), self%faces(ETA_MAX)%basis_s%nnodes_face(), self%elem%nterms_c,3) :: test_dbr2_face_face4_dx
        real(rk), dimension(self%faces(ZETA_MIN)%basis_s%nnodes_face(),self%faces(ZETA_MIN)%basis_s%nnodes_face(),self%elem%nterms_c,3) :: test_dbr2_face_face5_dx
        real(rk), dimension(self%faces(ZETA_MAX)%basis_s%nnodes_face(),self%faces(ZETA_MAX)%basis_s%nnodes_face(),self%elem%nterms_c,3) :: test_dbr2_face_face6_dx
        
        real(rk)        :: tol = 1.e-13_rk
        integer(ik)     :: inode_diff, idir, inode
        

        !
        ! dbr2_face_face1_dx
        ! 
        test_dbr2_face_face1_dx(:,:,1,1) = reshape((/ &
        13.729352919941622_rk, -1.320468640126241e-16_rk, -5.740025623250701e-16_rk, 5.229889626284568e-16_rk,   &
        -5.892017287469513e-16_rk, 8.577748513066586_rk, 5.149004869648379e-16_rk, -2.252266600171709e-16_rk,   &
        -1.950134615405867e-15_rk, 5.309291864409784e-16_rk, 3.678769027500235_rk, 2.3965930628699803e-16_rk,   &
        1.446705635905788e-15_rk, -8.881143742454593e-16_rk, -3.919476676101876e-16_rk, 2.2984007869534553_rk   &
        /),(/4,4/))
        test_dbr2_face_face1_dx(:,:,1,2) = reshape((/ &
        9.464101615137757_rk, -2.1007181433010134e-16_rk, -3.0325006417894473e-16_rk, 3.3757417918737044e-16_rk,   &
        -2.7754612788817193e-16_rk, 2.5358983848622443_rk, 4.2743681524761524e-16_rk, -1.1012347859431943e-16_rk,   &
        -1.8475688309315717e-15_rk, 1.989235219439148e-16_rk, 9.464101615137757_rk, -3.0163454165941157e-16_rk,   &
        9.285438343881863e-16_rk, -3.9390540427481823e-16_rk, -9.276113718809886e-16_rk, 2.5358983848622456_rk   &
        /),(/4,4/))
        test_dbr2_face_face1_dx(:,:,1,3) = reshape((/ &
        0.3450920601366958_rk, -1.444013301990159e-16_rk, -3.678271622149824e-17_rk, -5.798339805174614e-17_rk,   &
        3.17382428221911e-18_rk, -4.8065123467383355_rk, -5.3646250965484326e-17_rk, -1.2371261656926958e-16_rk,   &
        -1.4356119271758378e-16_rk, -3.479115439719408e-16_rk, 0.09246713882801944_rk, -1.2769879424392307e-16_rk,   &
        8.575209162681793e-17_rk, 6.88743892211873e-17_rk, -4.6936392051731887e-17_rk, -1.2879011017187578_rk   &
        /),(/4,4/))
        test_dbr2_face_face1_dx(:,:,2,1) = reshape((/ &
        -4.806512346738337_rk, 2.27481194295968e-16_rk, 9.729950663436159e-17_rk, -3.080672422927975e-16_rk,   &
        3.702199804282354e-17_rk, 0.3450920601366935_rk, 6.447020004019891e-17_rk, -4.1481437146541305e-17_rk,   &
        7.060978680467471e-16_rk, -1.477837254896237e-16_rk, -1.287901101718758_rk, 1.9525155561708818e-16_rk,   &
        -6.26707041411721e-16_rk, -1.2135201516904217e-16_rk, 1.7129964143776882e-17_rk, 0.09246713882801977_rk   &
        /),(/4,4/))
        test_dbr2_face_face1_dx(:,:,2,2) = reshape((/ &
        3.1547005383792524_rk, -1.5807491401282121e-16_rk, -1.8764403445139999e-16_rk, 4.2746271422661744e-17_rk,   &
        -2.694481497091649e-16_rk, 0.8452994616207479_rk, 6.852008694921913e-16_rk, -3.5295280631690964e-16_rk,   &
        -1.0153294012426523e-15_rk, -2.5544773016026336e-16_rk, 3.1547005383792524_rk, -1.6050547121402855e-16_rk,   &
        2.582006211308129e-16_rk, -6.607905720325233e-16_rk, -6.328804057616443e-16_rk, 0.8452994616207488_rk   &
        /),(/4,4/))
        test_dbr2_face_face1_dx(:,:,2,3) = reshape((/ &
        -9.267932633339981_rk, 4.8966999915671886e-17_rk, 5.134857719122067e-16_rk, -1.5693832228391312e-16_rk,   &
        5.490059064219087e-16_rk, -4.116328226464947_rk, -5.257244360395526e-16_rk, 3.904207137329817e-16_rk,   &
        1.3875979400767032e-15_rk, -3.523391697941397e-17_rk, -2.483335064609496_rk, -3.0721206766016326e-16_rk,   &
        -9.05750686120885e-16_rk, 9.405920001933143e-16_rk, 4.217540955181425e-16_rk, -1.1029668240627186_rk   &
        /),(/4,4/))
        test_dbr2_face_face1_dx(:,:,3,1) = reshape((/ &
        -4.1163282264649474_rk, -3.22915524579312e-16_rk, 3.7940354905634675e-16_rk, 9.314552195713822e-17_rk,   &
        5.151577326613042e-16_rk, -9.267932633339973_rk, -6.438408870452357e-16_rk, 3.0818953431025357e-16_rk,   &
        5.379388793123721e-16_rk, -2.3536173546173106e-16_rk, -1.1029668240627184_rk, -6.301624175211745e-16_rk,   &
        -1.9329155308234594e-16_rk, 1.1308184045835438e-15_rk, 3.576877393226337e-16_rk, -2.483335064609496_rk   &
        /),(/4,4/))
        test_dbr2_face_face1_dx(:,:,3,2) = reshape((/ &
        0.8452994616207494_rk, 3.3990365573052587e-16_rk, -1.3836929583443128e-16_rk, -4.620791250126947e-17_rk,   &
        -3.3451821098371304e-16_rk, 3.15470053837925_rk, 5.065421643539907e-16_rk, -1.9228311617951394e-16_rk,   &
        -1.6144969179509598e-16_rk, -1.494444922050893e-16_rk, 0.8452994616207488_rk, 3.236387423696707e-16_rk,   &
        -2.0338125801817996e-16_rk, -6.069926645291738e-16_rk, -4.007300650618308e-16_rk, 3.1547005383792515_rk   &
        /),(/4,4/))
        test_dbr2_face_face1_dx(:,:,3,3) = reshape((/ &
        0.345092060136694_rk, -1.4440133019901585e-16_rk, -3.678271622149809e-17_rk, -5.798339805174609e-17_rk,   &
        3.173824282219135e-18_rk, -4.806512346738334_rk, -5.364625096548423e-17_rk, -1.2371261656926958e-16_rk,   &
        -1.4356119271758353e-16_rk, -3.4791154397194063e-16_rk, 0.09246713882801944_rk, -1.2769879424392307e-16_rk,   &
        8.575209162681793e-17_rk, 6.887438922118711e-17_rk, -4.6936392051731887e-17_rk, -1.287901101718757_rk   &
        /),(/4,4/))
        test_dbr2_face_face1_dx(:,:,4,1) = reshape((/ &
        -4.806512346738336_rk, 2.2748119429596805e-16_rk, 9.729950663436167e-17_rk, -3.0806724229279755e-16_rk,   &
        3.702199804282354e-17_rk, 0.34509206013669486_rk, 6.447020004019891e-17_rk, -4.1481437146541366e-17_rk,   &
        7.060978680467473e-16_rk, -1.4778372548962363e-16_rk, -1.2879011017187585_rk, 1.9525155561708825e-16_rk,   &
        -6.267070414117211e-16_rk, -1.2135201516904224e-16_rk, 1.7129964143776882e-17_rk, 0.09246713882801977_rk   &
        /),(/4,4/))
        test_dbr2_face_face1_dx(:,:,4,2) = reshape((/ &
        2.5358983848622465_rk, 2.627580434781574e-16_rk, 4.2869517985711195e-17_rk, -2.9260578069804586e-16_rk,   &
        -2.6654005326140315e-16_rk, 9.46410161513775_rk, 3.963729595647038e-16_rk, -4.000956406132258e-16_rk,   &
        -6.135023252681604e-16_rk, 5.896125486222995e-16_rk, 2.5358983848622465_rk, 6.513390114657252e-16_rk,   &
        7.716273898285025e-16_rk, -1.0679729783055522e-15_rk, -6.804682055683898e-16_rk, 9.464101615137752_rk   &
        /),(/4,4/))
        test_dbr2_face_face1_dx(:,:,4,3) = reshape((/ &
        8.57774851306659_rk, 2.3983566048235986e-16_rk, -4.399203394692103e-16_rk, 2.7290511838740533e-16_rk,   &
        -5.55353554986347e-16_rk, 13.729352919941615_rk, 6.330169379705214e-16_rk, -1.4299548059444257e-16_rk,   &
        -1.1004755546415358e-15_rk, 7.310570049232953e-16_rk, 2.298400786953457_rk, 5.626096561480094e-16_rk,   &
        7.342465028672492e-16_rk, -1.0783407786356889e-15_rk, -3.278813114146788e-16_rk, 3.678769027500234_rk   &
        /),(/4,4/))
        test_dbr2_face_face1_dx(:,:,5,1) = reshape((/ &
        3.6787690275002354_rk, -9.10173941645595e-17_rk, 4.2771166436802776e-17_rk, -2.222643334672791e-16_rk,   &
        -1.8230866245311925e-16_rk, 2.298400786953456_rk, 8.543746430959325e-16_rk, -4.629971203329155e-16_rk,   &
        -1.814480241942953e-15_rk, -1.3318634664394744e-17_rk, 13.729352919941626_rk, -3.1916324123615564e-16_rk,   &
        5.946520179490881e-16_rk, -8.913724202842298e-16_rk, -1.8485706242488225e-15_rk, 8.577748513066586_rk   &
        /),(/4,4/))
        test_dbr2_face_face1_dx(:,:,5,2) = reshape((/ &
        -9.464101615137757_rk, 2.1007181433010136e-16_rk, 3.0325006417894473e-16_rk, -3.375741791873705e-16_rk,   &
        2.7754612788817193e-16_rk, -2.5358983848622443_rk, -4.2743681524761524e-16_rk, 1.1012347859431943e-16_rk,   &
        1.8475688309315717e-15_rk, -1.989235219439148e-16_rk, -9.464101615137757_rk, 3.0163454165941166e-16_rk,   &
        -9.285438343881863e-16_rk, 3.9390540427481823e-16_rk, 9.276113718809886e-16_rk, -2.5358983848622456_rk   &
        /),(/4,4/))
        test_dbr2_face_face1_dx(:,:,5,3) = reshape((/ &
        0.09246713882801982_rk, -1.5317250778964524e-16_rk, -1.26214979862184e-16_rk, 2.951131081911229e-16_rk,   &
        -5.2301590007759696e-18_rk, -1.287901101718757_rk, 2.5787842467114805e-16_rk, 1.570476343845485e-16_rk,   &
        -1.4057345756834176e-16_rk, -2.496363096666037e-16_rk, 0.3450920601366944_rk, -4.463619447278157e-16_rk,   &
        -4.487996414156513e-16_rk, 2.190470514343274e-16_rk, 8.058604799682948e-17_rk, -4.806512346738337_rk   &
        /),(/4,4/))
        test_dbr2_face_face1_dx(:,:,6,1) = reshape((/ &
        -1.2879011017187576_rk, 1.614101900701605e-16_rk, 1.928880274929215e-17_rk, 3.6692322761802805e-17_rk,   &
        -7.730734433800413e-17_rk, 0.09246713882801944_rk, -8.534271258951619e-18_rk, -1.6614199729778814e-17_rk,   &
        4.861684091250787e-16_rk, -9.854965966362826e-17_rk, -4.806512346738338_rk, 2.4688342361465805e-16_rk,   &
        -1.7368486722402984e-16_rk, -2.932343154127523e-17_rk, 3.5543138078847963e-16_rk, 0.3450920601366945_rk   &
        /),(/4,4/))
        test_dbr2_face_face1_dx(:,:,6,2) = reshape((/ &
        -3.1547005383792524_rk, 1.5807491401282124e-16_rk, 1.8764403445139999e-16_rk, -4.2746271422661744e-17_rk,   &
        2.694481497091649e-16_rk, -0.8452994616207479_rk, -6.852008694921913e-16_rk, 3.5295280631690964e-16_rk,   &
        1.0153294012426523e-15_rk, 2.5544773016026336e-16_rk, -3.1547005383792524_rk, 1.6050547121402855e-16_rk,   &
        -2.582006211308129e-16_rk, 6.607905720325233e-16_rk, 6.328804057616443e-16_rk, -0.8452994616207488_rk   &
        /),(/4,4/))
        test_dbr2_face_face1_dx(:,:,6,3) = reshape((/ &
        -2.4833350646094976_rk, 8.277971188404419e-17_rk, 6.415501067608907e-17_rk, -1.0954109748564652e-16_rk,   &
        2.6484616579189945e-16_rk, -1.1029668240627184_rk, -1.103718796508129e-15_rk, 3.2256368567814604e-16_rk,   &
        1.468885290386217e-15_rk, 3.615046039946267e-16_rk, -9.267932633339981_rk, 5.186417623493131e-16_rk,   &
        2.7832490690592843e-17_rk, 7.016488003911778e-16_rk, 1.4125531954635134e-15_rk, -4.1163282264649474_rk   &
        /),(/4,4/))
        test_dbr2_face_face1_dx(:,:,7,1) = reshape((/ &
        -1.1029668240627193_rk, -2.318029859757615e-16_rk, -8.134877193538713e-17_rk, 1.488796879436735e-16_rk,   &
        3.3692335112912753e-16_rk, -2.483335064609496_rk, -8.373061005780292e-16_rk, 4.962255197924734e-16_rk,   &
        8.421434236927958e-16_rk, 2.1041795399165122e-16_rk, -4.116328226464948_rk, -1.7460360599316056e-16_rk,   &
        -2.4728228350102833e-16_rk, 9.500192833667804e-16_rk, 1.1377078626718633e-15_rk, -9.267932633339978_rk   &
        /),(/4,4/))
        test_dbr2_face_face1_dx(:,:,7,2) = reshape((/ &
        -0.8452994616207494_rk, -3.3990365573052597e-16_rk, 1.3836929583443128e-16_rk, 4.620791250126952e-17_rk,   &
        3.3451821098371304e-16_rk, -3.15470053837925_rk, -5.065421643539907e-16_rk, 1.9228311617951394e-16_rk,   &
        1.6144969179509598e-16_rk, 1.494444922050893e-16_rk, -0.8452994616207488_rk, -3.236387423696708e-16_rk,   &
        2.0338125801817996e-16_rk, 6.069926645291738e-16_rk, 4.007300650618308e-16_rk, -3.1547005383792515_rk   &
        /),(/4,4/))
        test_dbr2_face_face1_dx(:,:,7,3) = reshape((/ &
        0.09246713882801982_rk, -1.531725077896452e-16_rk, -1.2621497986218395e-16_rk, 2.951131081911229e-16_rk,   &
        -5.230159000775994e-18_rk, -1.287901101718757_rk, 2.5787842467114795e-16_rk, 1.570476343845484e-16_rk,   &
        -1.405734575683416e-16_rk, -2.496363096666037e-16_rk, 0.3450920601366944_rk, -4.463619447278155e-16_rk,   &
        -4.487996414156509e-16_rk, 2.190470514343272e-16_rk, 8.058604799682948e-17_rk, -4.806512346738335_rk   &
        /),(/4,4/))
        test_dbr2_face_face1_dx(:,:,8,1) = reshape((/ &
        -1.287901101718758_rk, 1.6141019007016056e-16_rk, 1.9288802749292225e-17_rk, 3.669232276180278e-17_rk,   &
        -7.730734433800413e-17_rk, 0.09246713882801988_rk, -8.534271258951619e-18_rk, -1.661419972977885e-17_rk,   &
        4.861684091250789e-16_rk, -9.854965966362819e-17_rk, -4.806512346738337_rk, 2.4688342361465815e-16_rk,   &
        -1.7368486722402994e-16_rk, -2.932343154127517e-17_rk, 3.5543138078847963e-16_rk, 0.3450920601366945_rk   &
        /),(/4,4/))
        test_dbr2_face_face1_dx(:,:,8,2) = reshape((/ &
        -2.5358983848622465_rk, -2.6275804347815736e-16_rk, -4.2869517985711195e-17_rk, 2.9260578069804586e-16_rk,   &
        2.6654005326140315e-16_rk, -9.46410161513775_rk, -3.963729595647038e-16_rk, 4.000956406132258e-16_rk,   &
        6.135023252681604e-16_rk, -5.896125486222995e-16_rk, -2.5358983848622465_rk, -6.513390114657252e-16_rk,   &
        -7.716273898285025e-16_rk, 1.0679729783055522e-15_rk, 6.804682055683898e-16_rk, -9.464101615137752_rk   &
        /),(/4,4/))
        test_dbr2_face_face1_dx(:,:,8,3) = reshape((/ &
        2.298400786953457_rk, 2.2356530369524626e-16_rk, 1.8827494904827888e-16_rk, -4.806851188965994e-16_rk,   &
        -2.543858477903475e-16_rk, 3.678769027500233_rk, 5.87961947165833e-16_rk, -6.36658954447243e-16_rk,   &
        -1.1877383752495334e-15_rk, 1.3776801533858063e-16_rk, 8.577748513066592_rk, 3.7408212710631824e-16_rk,   &
        8.697667921407093e-16_rk, -1.1397429032598323e-15_rk, -1.5737252914571723e-15_rk, 13.729352919941618_rk   &
        /),(/4,4/))
        
        
        


        
        do inode_diff = 1,self%elem%nterms_c 
            do idir =1,3
                @assertEqual(transpose(test_dbr2_face_face1_dx(:,:,inode_diff,idir)),self%faces(XI_MIN)%dbr2_f_dx(:,:,inode_diff,idir),tol)
            end do
        end do

        
        
        !
        ! dbr2_face_face2_dx
        ! 
        test_dbr2_face_face2_dx(:,:,1,1) = reshape((/ &
        9.267932633339978_rk, -1.0450826855555328e-16_rk, -2.292426790152035e-16_rk, 2.777338090331387e-16_rk,   &
        -4.1414766145540406e-16_rk, 4.116328226464945_rk, 4.602740756043493e-16_rk, 1.127822821178584e-16_rk,   &
        -1.0566302711155617e-15_rk, -4.301931370618612e-17_rk, 2.483335064609496_rk, -7.423808117712477e-17_rk,   &
        8.9048708607295e-16_rk, -4.930581854686645e-16_rk, -4.39184211874827e-16_rk, 1.1029668240627182_rk   &
        /),(/4,4/))
        test_dbr2_face_face2_dx(:,:,1,2) = reshape((/ &
        3.1547005383792515_rk, -2.48844937306503e-16_rk, -2.3760765181823037e-16_rk, 1.3059549589065324e-16_rk,   &
        -2.0011456513317723e-16_rk, 0.8452994616207483_rk, 4.2388892569463627e-16_rk, 9.48960826703531e-17_rk,   &
        -9.639625010214233e-16_rk, -1.0710237867358761e-16_rk, 3.1547005383792524_rk, -2.368874289761682e-16_rk,   &
        1.4191489084060945e-16_rk, -1.8155364912711978e-16_rk, -4.650468796772778e-16_rk, 0.8452994616207485_rk   &
        /),(/4,4/))
        test_dbr2_face_face2_dx(:,:,1,3) = reshape((/ &
        4.806512346738336_rk, -1.900638143250048e-17_rk, 2.0724207247505083e-16_rk, 3.364728045544997e-17_rk,   &
        5.023076937229199e-17_rk, -0.34509206013669386_rk, -2.570294217416577e-17_rk, 1.1137793851337543e-16_rk,   &
        -5.952049831344333e-16_rk, 8.833748893145974e-17_rk, 1.2879011017187585_rk, -2.288415289154274e-16_rk,   &
        4.393235982778663e-16_rk, -1.0030259719007203e-16_rk, -1.8113085373216587e-16_rk, -0.09246713882802002_rk   &
        /),(/4,4/))
        test_dbr2_face_face2_dx(:,:,2,1) = reshape((/ &
        -0.3450920601366954_rk, 2.0022707739007032e-16_rk, 6.660006681189252e-17_rk, -5.243457172863e-18_rk,   &
        8.016835474576096e-17_rk, 4.806512346738334_rk, 1.871066422859159e-16_rk, -5.864686308255028e-17_rk,   &
        5.624551473175263e-16_rk, 2.5055473018046814e-16_rk, -0.09246713882801927_rk, 1.3776445210410905e-16_rk,   &
        -1.301804999167826e-16_rk, -4.518564758940008e-16_rk, 1.0813675388116341e-16_rk, 1.2879011017187567_rk   &
        /),(/4,4/))
        test_dbr2_face_face2_dx(:,:,2,2) = reshape((/ &
        9.464101615137752_rk, -2.6681055675838603e-16_rk, 3.3889182838935955e-16_rk, 9.076895839080551e-17_rk,   &
        -2.783576383791208e-16_rk, 2.535898384862245_rk, 3.5506606892329025e-16_rk, 3.2880309874624115e-17_rk,   &
        -8.545552709975272e-16_rk, 7.756964150172512e-17_rk, 9.464101615137757_rk, -5.139067672320929e-16_rk,   &
        5.102738588486676e-16_rk, -5.961668706533774e-16_rk, -1.1585552223858965e-15_rk, 2.5358983848622456_rk   &
        /),(/4,4/))
        test_dbr2_face_face2_dx(:,:,2,3) = reshape((/ &
        -13.729352919941618_rk, -7.67124274020166e-17_rk, -4.459946027173979e-17_rk, -3.061376323157257e-16_rk,   &
        2.8374853733735107e-16_rk, -8.577748513066588_rk, -6.216777757160998e-16_rk, -1.655133575486835e-16_rk,   &
        1.0893801069324686e-15_rk, -2.9587290540574176e-16_rk, -3.678769027500235_rk, 1.6531515798844298e-16_rk,   &
        -1.1996301844340336e-15_rk, 1.0452172585527376e-15_rk, 5.121783117258293e-16_rk, -2.2984007869534553_rk   &
        /),(/4,4/))
        test_dbr2_face_face2_dx(:,:,3,1) = reshape((/ &
        -8.577748513066588_rk, -2.9594588622458745e-16_rk, 9.604254539141851e-17_rk, -2.672468946874127e-16_rk,   &
        2.5381095196388205e-16_rk, -13.729352919941611_rk, -8.344873601761813e-16_rk, 4.511444047242238e-18_rk,   &
        -6.828002351949074e-17_rk, -4.580901466547502e-16_rk, -2.2984007869534575_rk, -2.0129082303109342e-16_rk,   &
        -6.301260862393849e-16_rk, 1.3967711372566662e-15_rk, 2.2291070411250015e-16_rk, -3.6787690275002327_rk   &
        /),(/4,4/))
        test_dbr2_face_face2_dx(:,:,3,2) = reshape((/ &
        2.5358983848622465_rk, 6.298814276036798e-17_rk, 3.071001308032038e-17_rk, 2.998134983740975e-16_rk,   &
        -1.9793005097715481e-16_rk, 9.464101615137748_rk, 5.586240835017173e-16_rk, -2.178364360866764e-16_rk,   &
        4.489858073573654e-16_rk, 3.3859395507181545e-16_rk, 2.5358983848622465_rk, 1.1001965330855267e-16_rk,   &
        1.8177109270781904e-16_rk, -9.923185771067913e-16_rk, -2.1458244557960224e-16_rk, 9.46410161513775_rk   &
        /),(/4,4/))
        test_dbr2_face_face2_dx(:,:,3,3) = reshape((/ &
        4.806512346738335_rk, -1.9006381432500355e-17_rk, 2.0724207247505078e-16_rk, 3.3647280455449896e-17_rk,   &
        5.0230769372292015e-17_rk, -0.34509206013669386_rk, -2.5702942174165795e-17_rk, 1.1137793851337533e-16_rk,   &
        -5.952049831344331e-16_rk, 8.833748893145976e-17_rk, 1.2879011017187585_rk, -2.288415289154273e-16_rk,   &
        4.393235982778662e-16_rk, -1.0030259719007203e-16_rk, -1.8113085373216567e-16_rk, -0.09246713882801957_rk   &
        /),(/4,4/))
        test_dbr2_face_face2_dx(:,:,4,1) = reshape((/ &
        -0.3450920601366941_rk, 2.002270773900704e-16_rk, 6.66000668118925e-17_rk, -5.2434571728629754e-18_rk,   &
        8.016835474576104e-17_rk, 4.806512346738334_rk, 1.87106642285916e-16_rk, -5.864686308255033e-17_rk,   &
        5.624551473175263e-16_rk, 2.5055473018046814e-16_rk, -0.09246713882801927_rk, 1.3776445210410915e-16_rk,   &
        -1.3018049991678256e-16_rk, -4.518564758940008e-16_rk, 1.0813675388116341e-16_rk, 1.2879011017187572_rk   &
        /),(/4,4/))
        test_dbr2_face_face2_dx(:,:,4,2) = reshape((/ &
        0.8452994616207496_rk, 1.8627729960476652e-16_rk, -7.305901025222442e-17_rk, -1.3561288067315633e-16_rk,   &
        -1.3232066243347936e-16_rk, 3.15470053837925_rk, 5.553746820882449e-16_rk, -2.9240943811946787e-16_rk,   &
        2.812642198430924e-16_rk, -3.8100306054145386e-17_rk, 0.8452994616207488_rk, 3.2575261979801373e-16_rk,   &
        -4.234059854771144e-17_rk, -2.465890068597905e-16_rk, -2.539135375394034e-16_rk, 3.154700538379252_rk   &
        /),(/4,4/))
        test_dbr2_face_face2_dx(:,:,4,3) = reshape((/ &
        4.1163282264649474_rk, 1.1472519026701746e-16_rk, -3.6988468467836184e-16_rk, 2.3884307140482583e-16_rk,   &
        -3.8421007608193513e-16_rk, 9.267932633339974_rk, 6.730836600644314e-16_rk, -5.724251947806724e-17_rk,   &
        1.0102985933639776e-16_rk, 1.191979275428223e-16_rk, 1.1029668240627177_rk, 2.923678998424117e-16_rk,   &
        3.209829878783012e-16_rk, -8.446120641725934e-16_rk, -1.4991660426149775e-16_rk, 2.483335064609494_rk   &
        /),(/4,4/))
        test_dbr2_face_face2_dx(:,:,5,1) = reshape((/ &
        2.4833350646094954_rk, -3.043572289555501e-16_rk, 8.118690365693633e-17_rk, -1.2475332910059e-16_rk,   &
        -1.5925048197508763e-16_rk, 1.1029668240627173_rk, 7.829742209615957e-16_rk, -1.6209376148672855e-16_rk,   &
        -7.119965613128887e-16_rk, -8.053728803251024e-17_rk, 9.26793263333998_rk, -3.938164071956764e-16_rk,   &
        -3.5891034124192664e-16_rk, -3.596158432996151e-16_rk, -1.2172576308614012e-15_rk, 4.116328226464946_rk   &
        /),(/4,4/))
        test_dbr2_face_face2_dx(:,:,5,2) = reshape((/ &
        -3.1547005383792515_rk, 2.48844937306503e-16_rk, 2.3760765181823047e-16_rk, -1.3059549589065321e-16_rk,   &
        2.0011456513317723e-16_rk, -0.8452994616207474_rk, -4.2388892569463627e-16_rk, -9.489608267035315e-17_rk,   &
        9.639625010214233e-16_rk, 1.0710237867358764e-16_rk, -3.1547005383792524_rk, 2.368874289761682e-16_rk,   &
        -1.4191489084060945e-16_rk, 1.8155364912711978e-16_rk, 4.650468796772778e-16_rk, -0.8452994616207479_rk   &
        /),(/4,4/))
        test_dbr2_face_face2_dx(:,:,5,3) = reshape((/ &
        1.2879011017187576_rk, -3.0137511427516124e-16_rk, 8.405115904389838e-17_rk, 1.2642885308415914e-16_rk,   &
        -1.5349450536743192e-16_rk, -0.09246713882801955_rk, -1.1593663652484654e-16_rk, 1.1863664814371026e-16_rk,   &
        -2.0794068104282088e-16_rk, -6.546484635211416e-18_rk, 4.806512346738339_rk, -3.64887317540501e-16_rk,   &
        -4.856616807116211e-17_rk, -1.4688628085108052e-16_rk, -4.585474161668134e-16_rk, -0.3450920601366947_rk   &
        /),(/4,4/))
        test_dbr2_face_face2_dx(:,:,6,1) = reshape((/ &
        -0.09246713882801977_rk, 2.027220812350165e-17_rk, 1.2312917355001241e-16_rk, 1.2489865422774853e-16_rk,   &
        -7.862366997243964e-17_rk, 1.2879011017187574_rk, -9.183449853628936e-17_rk, -1.6248842162809444e-16_rk,   &
        4.366501830031765e-16_rk, 6.460016976088911e-17_rk, -0.3450920601366928_rk, 1.0753589822105655e-16_rk,   &
        1.583630905294262e-16_rk, -1.214409026286474e-16_rk, 6.896834591535399e-17_rk, 4.806512346738334_rk   &
        /),(/4,4/))
        test_dbr2_face_face2_dx(:,:,6,2) = reshape((/ &
        -9.464101615137752_rk, 2.6681055675838603e-16_rk, -3.3889182838935955e-16_rk, -9.076895839080546e-17_rk,   &
        2.783576383791208e-16_rk, -2.5358983848622443_rk, -3.5506606892329025e-16_rk, -3.2880309874624115e-17_rk,   &
        8.545552709975272e-16_rk, -7.756964150172512e-17_rk, -9.464101615137757_rk, 5.139067672320929e-16_rk,   &
        -5.102738588486676e-16_rk, 5.961668706533774e-16_rk, 1.1585552223858965e-15_rk, -2.5358983848622447_rk   &
        /),(/4,4/))
        test_dbr2_face_face2_dx(:,:,6,3) = reshape((/ &
        -3.678769027500234_rk, 5.854601351072098e-16_rk, -2.8836723625084733e-16_rk, -1.2657417821131767e-16_rk,   &
        3.913686573149592e-16_rk, -2.2984007869534553_rk, -5.752030859004601e-16_rk, 2.059455349711128e-16_rk,   &
        4.832870593525331e-16_rk, 2.248360290683253e-17_rk, -13.729352919941626_rk, 6.511678265151209e-16_rk,   &
        2.4911341878366256e-16_rk, 6.279430267793433e-16_rk, 1.6068367011128606e-15_rk, -8.577748513066588_rk   &
        /),(/4,4/))
        test_dbr2_face_face2_dx(:,:,7,1) = reshape((/ &
        -2.2984007869534575_rk, 2.638128127085468e-16_rk, -3.274452507569612e-16_rk, -1.2504397935490705e-16_rk,   &
        3.1649782191996686e-16_rk, -3.6787690275002314_rk, -5.993052238890173e-16_rk, 4.870706047429174e-16_rk,   &
        -1.6130380469346414e-16_rk, -4.8663051489267975e-17_rk, -8.577748513066593_rk, 1.787446107535632e-16_rk,   &
        4.2184160183073926e-17_rk, 6.024976485569099e-16_rk, 1.0793209390306933e-15_rk, -13.729352919941615_rk   &
        /),(/4,4/))
        test_dbr2_face_face2_dx(:,:,7,2) = reshape((/ &
        -2.5358983848622465_rk, -6.298814276036798e-17_rk, -3.071001308032038e-17_rk, -2.998134983740976e-16_rk,   &
        1.9793005097715481e-16_rk, -9.464101615137752_rk, -5.586240835017173e-16_rk, 2.1783643608667644e-16_rk,   &
        -4.489858073573654e-16_rk, -3.3859395507181555e-16_rk, -2.5358983848622465_rk, -1.1001965330855267e-16_rk,   &
        -1.8177109270781904e-16_rk, 9.923185771067913e-16_rk, 2.1458244557960224e-16_rk, -9.464101615137752_rk   &
        /),(/4,4/))
        test_dbr2_face_face2_dx(:,:,7,3) = reshape((/ &
        1.2879011017187576_rk, -3.0137511427516114e-16_rk, 8.405115904389843e-17_rk, 1.2642885308415912e-16_rk,   &
        -1.5349450536743187e-16_rk, -0.09246713882801955_rk, -1.1593663652484652e-16_rk, 1.1863664814371016e-16_rk,   &
        -2.0794068104282078e-16_rk, -6.546484635211422e-18_rk, 4.806512346738337_rk, -3.648873175405009e-16_rk,   &
        -4.8566168071162233e-17_rk, -1.4688628085108052e-16_rk, -4.585474161668132e-16_rk, -0.34509206013669336_rk   &
        /),(/4,4/))
        test_dbr2_face_face2_dx(:,:,8,1) = reshape((/ &
        -0.09246713882801932_rk, 2.0272208123501686e-17_rk, 1.2312917355001246e-16_rk, 1.2489865422774853e-16_rk,   &
        -7.862366997243953e-17_rk, 1.287901101718757_rk, -9.183449853628926e-17_rk, -1.6248842162809442e-16_rk,   &
        4.366501830031765e-16_rk, 6.460016976088911e-17_rk, -0.3450920601366946_rk, 1.0753589822105665e-16_rk,   &
        1.5836309052942645e-16_rk, -1.214409026286474e-16_rk, 6.896834591535399e-17_rk, 4.806512346738335_rk   &
        /),(/4,4/))
        test_dbr2_face_face2_dx(:,:,8,2) = reshape((/ &
        -0.8452994616207496_rk, -1.8627729960476652e-16_rk, 7.305901025222442e-17_rk, 1.3561288067315636e-16_rk,   &
        1.3232066243347936e-16_rk, -3.1547005383792492_rk, -5.553746820882449e-16_rk, 2.9240943811946787e-16_rk,   &
        -2.812642198430924e-16_rk, 3.810030605414541e-17_rk, -0.8452994616207488_rk, -3.2575261979801373e-16_rk,   &
        4.234059854771144e-17_rk, 2.465890068597905e-16_rk, 2.539135375394034e-16_rk, -3.154700538379251_rk   &
        /),(/4,4/))
        test_dbr2_face_face2_dx(:,:,8,3) = reshape((/ &
        1.1029668240627186_rk, 1.729009344311271e-17_rk, 1.2026491816305047e-16_rk, -1.262835279570006e-16_rk,   &
        -8.437964658009539e-17_rk, 2.483335064609494_rk, 8.070763589501531e-16_rk, -4.432188312585332e-16_rk,   &
        -6.740569726689139e-17_rk, -9.390633636409687e-18_rk, 4.116328226464948_rk, 7.860680856588109e-17_rk,   &
        -1.519810826413382e-16_rk, -3.3417046507718213e-16_rk, -6.897418687792339e-16_rk, 9.267932633339974_rk   &
        /),(/4,4/))
        
        
        

        
        
        
        
        do inode_diff = 1,self%elem%nterms_c 
            do idir =1,3
                @assertEqual(transpose(test_dbr2_face_face2_dx(:,:,inode_diff,idir)),self%faces(XI_MAX)%dbr2_f_dx(:,:,inode_diff,idir),tol)
            end do
        end do

        
        
        !
        ! dbr2_face_face3_dx
        ! 
        test_dbr2_face_face3_dx(:,:,1,1) = reshape((/ &
        13.729352919941618_rk, -5.873660754640463e-16_rk, -1.229932651052031e-16_rk, 9.95011028290238e-16_rk,   &
        4.490182656169216e-16_rk, 8.577748513066592_rk, 5.745892503235325e-16_rk, -3.6688602684668054e-16_rk,   &
        -5.310168861557596e-16_rk, 1.9631886449258283e-16_rk, 3.6787690275002336_rk, -3.8802053607175954e-16_rk,   &
        1.7976439400536743e-15_rk, -8.197403940318017e-16_rk, -1.1148340323476933e-15_rk, 2.298400786953457_rk   &
        /),(/4,4/))
        test_dbr2_face_face3_dx(:,:,1,2) = reshape((/ &
        9.464101615137753_rk, -2.2124120771840933e-16_rk, -3.457155890145443e-16_rk, 4.617837109830004e-16_rk,   &
        2.795234415535747e-16_rk, 2.535898384862245_rk, 9.75169507320372e-16_rk, -5.468710310342875e-16_rk,   &
        -8.952574015576977e-16_rk, 1.6775584097523642e-16_rk, 9.464101615137757_rk, -4.604986355171363e-16_rk,   &
        1.1799236042625774e-15_rk, -4.24295828213511e-16_rk, -1.2320073678761912e-15_rk, 2.5358983848622456_rk   &
        /),(/4,4/))
        test_dbr2_face_face3_dx(:,:,1,3) = reshape((/ &
        -0.3450920601366927_rk, -1.5312406608059239e-16_rk, 2.3566267188795433e-17_rk, -1.225856250470165e-16_rk,   &
        -1.9307292888107542e-16_rk, 4.806512346738337_rk, -9.93874216554128e-17_rk, -1.416977553456806e-16_rk,   &
        -2.3782515900418266e-17_rk, 2.581496050502341e-16_rk, -0.0924671388280201_rk, 8.33929962266807e-17_rk,   &
        -6.263779173649892e-17_rk, -4.821007034387881e-16_rk, -6.871252094273629e-17_rk, 1.2879011017187578_rk   &
        /),(/4,4/))
        test_dbr2_face_face3_dx(:,:,2,1) = reshape((/ &
        -4.8065123467383355_rk, 4.660552902588728e-17_rk, -5.3844768780991086e-17_rk, -2.24568497199953e-16_rk,   &
        -2.877817359972087e-16_rk, 0.34509206013669314_rk, -3.3554511506106946e-17_rk, 7.018303715238848e-17_rk,   &
        8.623714522787913e-17_rk, 2.5912382672111837e-17_rk, -1.2879011017187576_rk, 5.15535849651378e-17_rk,   &
        -8.020568281921468e-16_rk, 3.7852082331373976e-17_rk, 1.4881762980726733e-16_rk, 0.09246713882801966_rk   &
        /),(/4,4/))
        test_dbr2_face_face3_dx(:,:,2,2) = reshape((/ &
        2.5358983848622447_rk, -6.507837871100404e-16_rk, -5.965999133488895e-17_rk, -5.5166486815869904e-17_rk,   &
        -2.1015408853283325e-16_rk, 9.464101615137753_rk, 2.2301926943647076e-16_rk, -9.254611111859298e-16_rk,   &
        -4.762333997960673e-16_rk, 3.1058102841804607e-16_rk, 2.5358983848622465_rk, -3.707866158405023e-16_rk,   &
        4.853892168510737e-16_rk, -1.4241164721231722e-15_rk, -1.4421372812970917e-15_rk, 9.464101615137753_rk   &
        /),(/4,4/))
        test_dbr2_face_face3_dx(:,:,2,3) = reshape((/ &
        -8.577748513066593_rk, 6.938846125187514e-16_rk, 1.5327176669739877e-16_rk, -6.478569060432687e-16_rk,   &
        3.1836399261362415e-17_rk, -13.72935291994162_rk, -4.416473171620129e-16_rk, 4.3840074503997247e-16_rk,   &
        4.68562256828299e-16_rk, -4.803808522149288e-16_rk, -2.298400786953457_rk, 2.53073954879941e-16_rk,   &
        -9.329493201250284e-16_rk, 1.2639890151392156e-15_rk, 1.0347289234831626e-15_rk, -3.678769027500233_rk   &
        /),(/4,4/))
        test_dbr2_face_face3_dx(:,:,3,1) = reshape((/ &
        -4.1163282264649474_rk, 4.941550174122719e-16_rk, 2.3068280266718514e-16_rk, -5.45874033890332e-16_rk,   &
        1.2654520637749578e-16_rk, -9.267932633339978_rk, -5.074802273113187e-16_rk, 2.265199525419035e-16_rk,   &
        3.585425957000014e-16_rk, -2.4814362983680663e-16_rk, -1.1029668240627188_rk, 2.8491336614148396e-16_rk,   &
        -1.935302836693803e-16_rk, 7.440362293690539e-16_rk, 8.171987727331589e-16_rk, -2.4833350646094963_rk   &
        /),(/4,4/))
        test_dbr2_face_face3_dx(:,:,3,2) = reshape((/ &
        0.8452994616207483_rk, -1.3397732205437832e-16_rk, -2.703446790305604e-16_rk, 2.931547362352905e-16_rk,   &
        -4.994145146183313e-17_rk, 3.1547005383792515_rk, 3.275712037954788e-16_rk, 1.9718155815270307e-17_rk,   &
        -3.016955501189742e-16_rk, 3.4540943767162494e-17_rk, 0.8452994616207494_rk, -2.2079255327620621e-16_rk,   &
        -3.265751529420525e-16_rk, -3.9319145025119577e-16_rk, -5.79731754890581e-16_rk, 3.1547005383792515_rk   &
        /),(/4,4/))
        test_dbr2_face_face3_dx(:,:,3,3) = reshape((/ &
        -0.345092060136694_rk, -1.5312406608059234e-16_rk, 2.3566267188795433e-17_rk, -1.2258562504701654e-16_rk,   &
        -1.9307292888107542e-16_rk, 4.8065123467383355_rk, -9.938742165541285e-17_rk, -1.4169775534568055e-16_rk,   &
        -2.3782515900418365e-17_rk, 2.581496050502341e-16_rk, -0.09246713882801921_rk, 8.339299622668073e-17_rk,   &
        -6.263779173649922e-17_rk, -4.821007034387881e-16_rk, -6.871252094273639e-17_rk, 1.2879011017187574_rk   &
        /),(/4,4/))
        test_dbr2_face_face3_dx(:,:,4,1) = reshape((/ &
        -4.806512346738337_rk, 4.660552902588719e-17_rk, -5.384476878099099e-17_rk, -2.24568497199953e-16_rk,   &
        -2.8778173599720873e-16_rk, 0.34509206013669447_rk, -3.3554511506106946e-17_rk, 7.01830371523885e-17_rk,   &
        8.62371452278792e-17_rk, 2.5912382672111948e-17_rk, -1.2879011017187576_rk, 5.15535849651378e-17_rk,   &
        -8.02056828192147e-16_rk, 3.785208233137388e-17_rk, 1.4881762980726718e-16_rk, 0.09246713882801966_rk   &
        /),(/4,4/))
        test_dbr2_face_face3_dx(:,:,4,2) = reshape((/ &
        3.1547005383792515_rk, -2.2092038893285734e-16_rk, -2.408302982331041e-16_rk, 3.4512656127881026e-16_rk,   &
        1.9844581795631202e-16_rk, 0.8452994616207481_rk, 7.197846300855582e-16_rk, -1.3789097702486632e-16_rk,   &
        -5.566216945625542e-16_rk, -2.26320710005582e-17_rk, 3.1547005383792524_rk, -3.854393661315014e-16_rk,   &
        1.9594048501473755e-16_rk, -4.861843360323196e-17_rk, -7.488093840804942e-16_rk, 0.8452994616207485_rk   &
        /),(/4,4/))
        test_dbr2_face_face3_dx(:,:,4,3) = reshape((/ &
        9.26793263333998_rk, -3.876364803575668e-16_rk, -2.0040430107498956e-16_rk, 8.930281561373017e-16_rk,   &
        3.543094585007884e-16_rk, 4.1163282264649474_rk, 6.404221604728386e-16_rk, -1.5500523434861134e-16_rk,   &
        -4.2099722502746226e-16_rk, -3.591835788553942e-17_rk, 2.483335064609498_rk, -4.198599473333025e-16_rk,   &
        1.0582249035980265e-15_rk, -2.9978760826163966e-16_rk, -8.9730388159769e-16_rk, 1.102966824062719_rk   &
        /),(/4,4/))
        test_dbr2_face_face3_dx(:,:,5,1) = reshape((/ &
        3.6787690275002336_rk, -3.4190417511569615e-16_rk, -5.784011310372056e-16_rk, -1.3691750640900016e-16_rk,   &
        -6.199142109127827e-17_rk, 2.298400786953456_rk, 1.4711717232227744e-15_rk, -1.1584098744736961e-15_rk,   &
        -1.4654071141460853e-15_rk, 2.4453438140740285e-16_rk, 13.729352919941622_rk, -7.979553996927392e-16_rk,   &
        3.5279287607173123e-16_rk, -8.216853594153418e-16_rk, -2.176720740552939e-15_rk, 8.577748513066592_rk   &
        /),(/4,4/))
        test_dbr2_face_face3_dx(:,:,5,2) = reshape((/ &
        -9.464101615137753_rk, 2.2124120771840933e-16_rk, 3.457155890145443e-16_rk, -4.617837109830004e-16_rk,   &
        -2.7952344155357475e-16_rk, -2.535898384862245_rk, -9.75169507320372e-16_rk, 5.468710310342875e-16_rk,   &
        8.952574015576977e-16_rk, -1.6775584097523642e-16_rk, -9.464101615137757_rk, 4.604986355171363e-16_rk,   &
        -1.1799236042625774e-15_rk, 4.24295828213511e-16_rk, 1.2320073678761912e-15_rk, -2.5358983848622456_rk   &
        /),(/4,4/))
        test_dbr2_face_face3_dx(:,:,5,3) = reshape((/ &
        -0.09246713882801938_rk, -1.5083525775438685e-16_rk, 1.0454048536858046e-16_rk, -1.6046430372256456e-16_rk,   &
        -9.58508357895884e-17_rk, 1.2879011017187572_rk, -2.518787335181378e-16_rk, -4.151984271796063e-16_rk,   &
        8.062562425782442e-17_rk, -2.2532362871151845e-17_rk, -0.3450920601366951_rk, -7.303193713288214e-17_rk,   &
        2.6730895282381906e-16_rk, -4.905232871074567e-16_rk, -4.2154433676492975e-16_rk, 4.806512346738338_rk   &
        /),(/4,4/))
        test_dbr2_face_face3_dx(:,:,6,1) = reshape((/ &
        -1.2879011017187572_rk, 1.5099356279836624e-17_rk, 1.0714005033486685e-16_rk, 1.0532980565131217e-16_rk,   &
        5.481487598311345e-17_rk, 0.09246713882801938_rk, -4.243666404012492e-16_rk, 3.3045601901590586e-16_rk,   &
        3.3347446497808447e-16_rk, -1.201095398430099e-16_rk, -4.806512346738336_rk, 1.1794421127908415e-16_rk,   &
        -2.6319865887635285e-16_rk, -1.5857965749631626e-17_rk, 3.124108793374696e-16_rk, 0.3450920601366942_rk   &
        /),(/4,4/))
        test_dbr2_face_face3_dx(:,:,6,2) = reshape((/ &
        -2.5358983848622447_rk, 6.507837871100404e-16_rk, 5.965999133488895e-17_rk, 5.5166486815869904e-17_rk,   &
        2.1015408853283325e-16_rk, -9.464101615137753_rk, -2.2301926943647076e-16_rk, 9.254611111859298e-16_rk,   &
        4.762333997960673e-16_rk, -3.1058102841804607e-16_rk, -2.5358983848622465_rk, 3.707866158405023e-16_rk,   &
        -4.853892168510737e-16_rk, 1.4241164721231722e-15_rk, 1.4421372812970917e-15_rk, -9.464101615137753_rk   &
        /),(/4,4/))
        test_dbr2_face_face3_dx(:,:,6,3) = reshape((/ &
        -2.298400786953457_rk, 4.7764007659024645e-16_rk, 3.667205953337583e-16_rk, 1.920520044802524e-16_rk,   &
        1.0302738089775314e-16_rk, -3.6787690275002327_rk, -7.949263493033873e-16_rk, 1.2431522826373966e-15_rk,   &
        1.0513070249101766e-15_rk, -1.0189247869324108e-16_rk, -8.57774851306659_rk, 7.530431255465372e-16_rk,   &
        -3.5690317001919724e-16_rk, 1.3280666122724305e-15_rk, 2.2858541979803992e-15_rk, -13.729352919941622_rk   &
        /),(/4,4/))
        test_dbr2_face_face3_dx(:,:,7,1) = reshape((/ &
        -1.102966824062719_rk, 3.117054625560229e-16_rk, 3.641210303674718e-16_rk, -7.374210489362433e-17_rk,   &
        -4.763833087494863e-17_rk, -2.483335064609495_rk, -6.22438442420276e-16_rk, 4.974978364418845e-16_rk,   &
        7.984581841899165e-16_rk, -4.3153017213830915e-18_rk, -4.116328226464949_rk, 5.620669771345709e-16_rk,   &
        1.7360444168097472e-16_rk, 8.534012909146051e-16_rk, 1.551898981878e-15_rk, -9.267932633339978_rk   &
        /),(/4,4/))
        test_dbr2_face_face3_dx(:,:,7,2) = reshape((/ &
        -0.8452994616207483_rk, 1.3397732205437832e-16_rk, 2.703446790305604e-16_rk, -2.931547362352905e-16_rk,   &
        4.994145146183318e-17_rk, -3.1547005383792515_rk, -3.275712037954788e-16_rk, -1.9718155815270307e-17_rk,   &
        3.016955501189742e-16_rk, -3.4540943767162494e-17_rk, -0.8452994616207494_rk, 2.2079255327620621e-16_rk,   &
        3.265751529420525e-16_rk, 3.9319145025119577e-16_rk, 5.79731754890581e-16_rk, -3.1547005383792515_rk   &
        /),(/4,4/))
        test_dbr2_face_face3_dx(:,:,7,3) = reshape((/ &
        -0.09246713882801982_rk, -1.508352577543868e-16_rk, 1.0454048536858046e-16_rk, -1.6046430372256456e-16_rk,   &
        -9.58508357895884e-17_rk, 1.2879011017187572_rk, -2.518787335181378e-16_rk, -4.1519842717960617e-16_rk,   &
        8.062562425782432e-17_rk, -2.2532362871151795e-17_rk, -0.3450920601366942_rk, -7.303193713288216e-17_rk,   &
        2.6730895282381896e-16_rk, -4.905232871074567e-16_rk, -4.2154433676492965e-16_rk, 4.806512346738336_rk   &
        /),(/4,4/))
        test_dbr2_face_face3_dx(:,:,8,1) = reshape((/ &
        -1.287901101718758_rk, 1.5099356279836618e-17_rk, 1.0714005033486695e-16_rk, 1.0532980565131227e-16_rk,   &
        5.4814875983113423e-17_rk, 0.09246713882801982_rk, -4.243666404012492e-16_rk, 3.304560190159058e-16_rk,   &
        3.334744649780844e-16_rk, -1.2010953984300985e-16_rk, -4.806512346738336_rk, 1.1794421127908415e-16_rk,   &
        -2.6319865887635305e-16_rk, -1.5857965749631527e-17_rk, 3.1241087933746977e-16_rk, 0.3450920601366942_rk   &
        /),(/4,4/))
        test_dbr2_face_face3_dx(:,:,8,2) = reshape((/ &
        -3.1547005383792515_rk, 2.2092038893285734e-16_rk, 2.408302982331041e-16_rk, -3.4512656127881026e-16_rk,   &
        -1.9844581795631202e-16_rk, -0.8452994616207481_rk, -7.197846300855582e-16_rk, 1.3789097702486632e-16_rk,   &
        5.566216945625542e-16_rk, 2.26320710005582e-17_rk, -3.1547005383792524_rk, 3.854393661315014e-16_rk,   &
        -1.9594048501473755e-16_rk, 4.861843360323196e-17_rk, 7.488093840804942e-16_rk, -0.8452994616207485_rk   &
        /),(/4,4/))
        test_dbr2_face_face3_dx(:,:,8,3) = reshape((/ &
        2.4833350646094967_rk, -1.7596956108147274e-16_rk, -5.758015660709192e-16_rk, 1.2887660296487667e-16_rk,   &
        8.867429068142366e-17_rk, 1.1029668240627186_rk, 1.298683816339663e-15_rk, -4.127554282781842e-16_rk,   &
        -1.2125582734258253e-15_rk, 1.4695720443554474e-16_rk, 9.267932633339981_rk, -6.069792512807729e-16_rk,   &
        -1.7771473562844078e-16_rk, -3.470200380575168e-16_rk, -1.44276552445054e-15_rk, 4.116328226464948_rk   &
        /),(/4,4/))
        
        
        

        
        
        
        
        do inode_diff = 1,self%elem%nterms_c 
            do idir =1,3
                @assertEqual(transpose(test_dbr2_face_face3_dx(:,:,inode_diff,idir)),self%faces(ETA_MIN)%dbr2_f_dx(:,:,inode_diff,idir),tol)
            end do
        end do

        
        
        !
        ! dbr2_face_face4_dx
        ! 
        test_dbr2_face_face4_dx(:,:,1,1) = reshape((/ &
        9.267932633339974_rk, 1.919654925102951e-16_rk, 3.065228757747424e-16_rk, 6.744796894551473e-16_rk,   &
        -1.1891226124682516e-16_rk, 4.116328226464946_rk, 3.5811073478728857e-16_rk, 2.5784652611338746e-16_rk,   &
        -1.1866178736856906e-15_rk, -1.8860462432929947e-16_rk, 2.483335064609495_rk, 1.7392830309096145e-17_rk,   &
        -7.150704049005803e-17_rk, 9.920576524646464e-17_rk, 2.906713999835212e-16_rk, 1.102966824062718_rk   &
        /),(/4,4/))
        test_dbr2_face_face4_dx(:,:,1,2) = reshape((/ &
        3.154700538379251_rk, -1.3193211628901055e-16_rk, -3.4931499118565364e-18_rk, 4.0183854870849576e-16_rk,   &
        -2.8857162379222317e-16_rk, 0.8452994616207485_rk, 5.01505358294205e-16_rk, 1.2237824542023606e-16_rk,   &
        -6.888897471606638e-16_rk, -1.1248278424588477e-16_rk, 3.154700538379252_rk, -5.910001314455449e-17_rk,   &
        -2.9738708018557693e-17_rk, 1.6640791258392327e-16_rk, 7.667708645196886e-17_rk, 0.8452994616207485_rk   &
        /),(/4,4/))
        test_dbr2_face_face4_dx(:,:,1,3) = reshape((/ &
        -4.8065123467383355_rk, -1.5209016176294886e-16_rk, -4.131060794345263e-16_rk, 7.466139489704618e-17_rk,   &
        -9.985830759482957e-17_rk, 0.345092060136694_rk, -1.5516353939259063e-16_rk, -1.6180928293555551e-16_rk,   &
        5.994664556569357e-17_rk, -2.6276561021881624e-16_rk, -1.2879011017187576_rk, -6.822952457605655e-17_rk,   &
        -2.29618738770896e-16_rk, -6.72283883057309e-18_rk, 4.202744641542589e-18_rk, 0.09246713882802005_rk   &
        /),(/4,4/))
        test_dbr2_face_face4_dx(:,:,2,1) = reshape((/ &
        -0.34509206013669436_rk, 4.689250184119041e-16_rk, 1.9920496524442363e-16_rk, -1.353610294636818e-16_rk,   &
        7.180600495814201e-17_rk, 4.806512346738334_rk, 1.4006655860240166e-16_rk, 8.038515469167504e-17_rk,   &
        3.3621761609241444e-16_rk, 4.834247067764578e-16_rk, -0.09246713882801968_rk, -1.2914952232307773e-16_rk,   &
        1.1290932511460977e-16_rk, -5.425359658400146e-17_rk, -2.022677384468925e-16_rk, 1.287901101718757_rk   &
        /),(/4,4/))
        test_dbr2_face_face4_dx(:,:,2,2) = reshape((/ &
        0.8452994616207485_rk, 2.9047998045478516e-16_rk, 7.109988822017965e-17_rk, 1.4937721492708688e-16_rk,   &
        1.261886899269194e-16_rk, 3.154700538379251_rk, 2.325781794797613e-16_rk, -2.5171492662047968e-17_rk,   &
        -3.030171735926027e-16_rk, -3.084073721740651e-16_rk, 0.8452994616207479_rk, -4.93737212346905e-16_rk,   &
        -3.354747280040253e-17_rk, -1.8362364482638212e-16_rk, -1.4777300040050935e-16_rk, 3.1547005383792524_rk   &
        /),(/4,4/))
        test_dbr2_face_face4_dx(:,:,2,3) = reshape((/ &
        -4.116328226464947_rk, -5.088003491592506e-16_rk, -9.262176158463992e-17_rk, -6.137800548885117e-16_rk,   &
        1.4696456388351268e-16_rk, -9.267932633339976_rk, -3.4301375399709967e-16_rk, -1.7642239786950706e-16_rk,   &
        7.904536120275826e-16_rk, -3.205447222834214e-17_rk, -1.1029668240627184_rk, 1.7998621659003806e-16_rk,   &
        1.8821645414634416e-16_rk, -3.822932983189012e-17_rk, -9.260640617817125e-17_rk, -2.4833350646094967_rk   &
        /),(/4,4/))
        test_dbr2_face_face4_dx(:,:,3,1) = reshape((/ &
        -8.577748513066588_rk, -1.129815529334103e-15_rk, -7.049328062635896e-16_rk, -4.0375763052778375e-16_rk,   &
        -2.4699748669458955e-17_rk, -13.729352919941613_rk, -6.382438519920918e-16_rk, -4.1861683549673754e-16_rk,   &
        5.141826415008618e-16_rk, -7.782447892236158e-16_rk, -2.2984007869534544_rk, 2.4090621433705934e-16_rk,   &
        -1.543116097391615e-16_rk, 9.301427921538271e-18_rk, 1.1386407691026383e-16_rk, -3.6787690275002323_rk   &
        /),(/4,4/))
        test_dbr2_face_face4_dx(:,:,3,2) = reshape((/ &
        2.5358983848622447_rk, 7.6818058093357555e-16_rk, 4.991593698425305e-16_rk, -3.219591372807638e-16_rk,   &
        5.175438146282067e-17_rk, 9.464101615137748_rk, 4.144035617477887e-16_rk, 6.175936811029545e-16_rk,   &
        -9.2611552759155e-17_rk, 7.251838421131759e-16_rk, 2.5358983848622443_rk, -8.674314745542553e-16_rk,   &
        9.991973627129636e-17_rk, -3.351719361107828e-17_rk, -3.3568692352692996e-16_rk, 9.464101615137752_rk   &
        /),(/4,4/))
        test_dbr2_face_face4_dx(:,:,3,3) = reshape((/ &
        -4.806512346738334_rk, -1.520901617629487e-16_rk, -4.131060794345263e-16_rk, 7.466139489704604e-17_rk,   &
        -9.985830759482946e-17_rk, 0.345092060136694_rk, -1.5516353939259063e-16_rk, -1.6180928293555551e-16_rk,   &
        5.994664556569361e-17_rk, -2.6276561021881624e-16_rk, -1.2879011017187567_rk, -6.822952457605652e-17_rk,   &
        -2.296187387708958e-16_rk, -6.722838830573065e-18_rk, 4.2027446415426874e-18_rk, 0.0924671388280196_rk   &
        /),(/4,4/))
        test_dbr2_face_face4_dx(:,:,4,1) = reshape((/ &
        -0.345092060136693_rk, 4.689250184119041e-16_rk, 1.9920496524442368e-16_rk, -1.3536102946368165e-16_rk,   &
        7.180600495814211e-17_rk, 4.806512346738334_rk, 1.4006655860240171e-16_rk, 8.038515469167504e-17_rk,   &
        3.362176160924144e-16_rk, 4.834247067764578e-16_rk, -0.09246713882801968_rk, -1.2914952232307773e-16_rk,   &
        1.129093251146098e-16_rk, -5.425359658400146e-17_rk, -2.022677384468925e-16_rk, 1.287901101718757_rk   &
        /),(/4,4/))
        test_dbr2_face_face4_dx(:,:,4,2) = reshape((/ &
        9.464101615137752_rk, 4.82748714531532e-16_rk, 8.20632854592413e-16_rk, 3.3352871428859237e-16_rk,   &
        2.288585725410507e-16_rk, 2.5358983848622447_rk, 7.596968012378149e-16_rk, 6.063290257941205e-16_rk,   &
        -7.384573199206613e-16_rk, 4.510099121206118e-16_rk, 9.464101615137752_rk, -2.459594568446529e-16_rk,   &
        5.330713784165174e-16_rk, -7.897661328789645e-18_rk, 2.554556787035419e-16_rk, 2.5358983848622447_rk   &
        /),(/4,4/))
        test_dbr2_face_face4_dx(:,:,4,3) = reshape((/ &
        13.729352919941615_rk, 8.129806726851481e-16_rk, 9.188339204536925e-16_rk, 4.644572650944195e-16_rk,   &
        5.2752051306146344e-17_rk, 8.577748513066586_rk, 6.533408327822809e-16_rk, 5.000409637406181e-16_rk,   &
        -9.103469031589697e-16_rk, 5.575856926659746e-16_rk, 3.6787690275002323_rk, -4.352716743792501e-17_rk,   &
        2.7102102339544763e-16_rk, 5.1675007493036276e-17_rk, 8.420091689508603e-17_rk, 2.298400786953456_rk   &
        /),(/4,4/))
        test_dbr2_face_face4_dx(:,:,5,1) = reshape((/ &
        2.4833350646094945_rk, 1.682095729540508e-16_rk, 3.190873336933712e-16_rk, 2.3527189323632664e-16_rk,   &
        -3.813331590334186e-17_rk, 1.1029668240627182_rk, 1.0527693121823033e-15_rk, 3.2616288091466774e-16_rk,   &
        -5.240530265247462e-16_rk, 1.3036516832591116e-16_rk, 9.267932633339976_rk, -6.240174012410055e-16_rk,   &
        3.8266689730870377e-16_rk, 7.045472918893461e-19_rk, -1.0609047235548839e-16_rk, 4.116328226464947_rk   &
        /),(/4,4/))
        test_dbr2_face_face4_dx(:,:,5,2) = reshape((/ &
        -3.154700538379251_rk, 1.3193211628901074e-16_rk, 3.4931499118565364e-18_rk, -4.0183854870849576e-16_rk,   &
        2.8857162379222317e-16_rk, -0.8452994616207476_rk, -5.01505358294205e-16_rk, -1.2237824542023606e-16_rk,   &
        6.888897471606638e-16_rk, 1.1248278424588482e-16_rk, -3.154700538379252_rk, 5.91000131445544e-17_rk,   &
        2.9738708018557693e-17_rk, -1.6640791258392327e-16_rk, -7.667708645196886e-17_rk, -0.8452994616207481_rk   &
        /),(/4,4/))
        test_dbr2_face_face4_dx(:,:,5,3) = reshape((/ &
        -1.287901101718757_rk, 1.613563608712793e-17_rk, -1.168937638101483e-16_rk, -2.0487616886123704e-16_rk,   &
        2.725973737475045e-17_rk, 0.09246713882801935_rk, -2.175656125422359e-16_rk, -2.847290159876219e-16_rk,   &
        2.479560347037393e-16_rk, -2.7422350125622215e-16_rk, -4.806512346738336_rk, -1.0697580656676833e-16_rk,   &
        -1.7104129327271975e-16_rk, -1.175341957312499e-16_rk, -2.8932847800491174e-16_rk, 0.3450920601366947_rk   &
        /),(/4,4/))
        test_dbr2_face_face4_dx(:,:,6,1) = reshape((/ &
        -0.09246713882801949_rk, 1.6755077362630034e-16_rk, 1.562240400544085e-16_rk, -3.764412225064551e-16_rk,   &
        1.6884082117182807e-16_rk, 1.2879011017187574_rk, -2.016568295939037e-16_rk, 2.697850380278256e-16_rk,   &
        8.541473864256287e-17_rk, 1.0889504509569199e-16_rk, -0.3450920601366946_rk, -4.4242713548615387e-16_rk,   &
        -2.1226959919155692e-17_rk, -8.71148017359249e-17_rk, -8.93176493264641e-17_rk, 4.806512346738334_rk   &
        /),(/4,4/))
        test_dbr2_face_face4_dx(:,:,6,2) = reshape((/ &
        -0.8452994616207485_rk, -2.9047998045478516e-16_rk, -7.109988822017965e-17_rk, -1.4937721492708692e-16_rk,   &
        -1.261886899269194e-16_rk, -3.1547005383792492_rk, -2.325781794797613e-16_rk, 2.5171492662047968e-17_rk,   &
        3.030171735926027e-16_rk, 3.0840737217406515e-16_rk, -0.8452994616207479_rk, 4.937372123469049e-16_rk,   &
        3.354747280040253e-17_rk, 1.8362364482638212e-16_rk, 1.477730004005093e-16_rk, -3.1547005383792515_rk   &
        /),(/4,4/))
        test_dbr2_face_face4_dx(:,:,6,3) = reshape((/ &
        -1.102966824062718_rk, -3.518959826674793e-16_rk, -3.584176099376315e-16_rk, 3.460454981313654e-16_rk,   &
        -1.5796724264323674e-16_rk, -2.483335064609495_rk, -6.335468700461636e-16_rk, -3.1121890295487165e-16_rk,   &
        1.90682253178444e-16_rk, 3.496328783461892e-17_rk, -4.116328226464947_rk, 1.173420343293928e-15_rk,   &
        -1.903986441168284e-16_rk, 2.0394445017528544e-16_rk, 4.847365996868642e-16_rk, -9.26793263333998_rk   &
        /),(/4,4/))
        test_dbr2_face_face4_dx(:,:,7,1) = reshape((/ &
        -2.2984007869534557_rk, -5.033111202066515e-16_rk, -6.315354138021881e-16_rk, 5.176105517765835e-16_rk,   &
        -2.995483264403143e-16_rk, -3.678769027500233_rk, -6.494556529944957e-16_rk, -8.65732956970319e-16_rk,   &
        3.5322354923962047e-16_rk, -3.4815525851729524e-16_rk, -8.577748513066584_rk, 1.5088716722133133e-15_rk,   &
        -3.4021297747039224e-16_rk, 1.7352505617996035e-16_rk, 2.8472577100841654e-16_rk, -13.729352919941617_rk   &
        /),(/4,4/))
        test_dbr2_face_face4_dx(:,:,7,2) = reshape((/ &
        -2.5358983848622447_rk, -7.681805809335757e-16_rk, -4.991593698425305e-16_rk, 3.219591372807639e-16_rk,   &
        -5.175438146282067e-17_rk, -9.464101615137752_rk, -4.144035617477887e-16_rk, -6.175936811029545e-16_rk,   &
        9.2611552759155e-17_rk, -7.251838421131761e-16_rk, -2.5358983848622443_rk, 8.674314745542556e-16_rk,   &
        -9.991973627129636e-17_rk, 3.351719361107828e-17_rk, 3.3568692352693e-16_rk, -9.464101615137753_rk   &
        /),(/4,4/))
        test_dbr2_face_face4_dx(:,:,7,3) = reshape((/ &
        -1.287901101718757_rk, 1.613563608712798e-17_rk, -1.168937638101483e-16_rk, -2.0487616886123697e-16_rk,   &
        2.7259737374750492e-17_rk, 0.09246713882801935_rk, -2.175656125422359e-16_rk, -2.847290159876217e-16_rk,   &
        2.4795603470373926e-16_rk, -2.7422350125622215e-16_rk, -4.806512346738334_rk, -1.0697580656676856e-16_rk,   &
        -1.7104129327271956e-16_rk, -1.1753419573124987e-16_rk, -2.8932847800491164e-16_rk, 0.34509206013669513_rk   &
        /),(/4,4/))
        test_dbr2_face_face4_dx(:,:,8,1) = reshape((/ &
        -0.09246713882801905_rk, 1.6755077362630044e-16_rk, 1.5622404005440844e-16_rk, -3.764412225064551e-16_rk,   &
        1.6884082117182807e-16_rk, 1.287901101718757_rk, -2.0165682959390376e-16_rk, 2.697850380278256e-16_rk,   &
        8.541473864256289e-17_rk, 1.0889504509569199e-16_rk, -0.3450920601366946_rk, -4.4242713548615387e-16_rk,   &
        -2.1226959919155754e-17_rk, -8.711480173592481e-17_rk, -8.93176493264641e-17_rk, 4.806512346738335_rk   &
        /),(/4,4/))
        test_dbr2_face_face4_dx(:,:,8,2) = reshape((/ &
        -9.464101615137752_rk, -4.82748714531532e-16_rk, -8.20632854592413e-16_rk, -3.3352871428859237e-16_rk,   &
        -2.288585725410507e-16_rk, -2.535898384862244_rk, -7.596968012378149e-16_rk, -6.063290257941205e-16_rk,   &
        7.384573199206613e-16_rk, -4.510099121206118e-16_rk, -9.464101615137752_rk, 2.459594568446528e-16_rk,   &
        -5.330713784165174e-16_rk, 7.897661328789645e-18_rk, -2.5545567870354196e-16_rk, -2.535898384862244_rk   &
        /),(/4,4/))
        test_dbr2_face_face4_dx(:,:,8,3) = reshape((/ &
        3.6787690275002323_rk, 3.1962471049322334e-16_rk, 5.92205137557928e-16_rk, 6.37068395911086e-17_rk,   &
        1.034477678937358e-16_rk, 2.298400786953456_rk, 1.0686780951306354e-15_rk, 8.806769349301152e-16_rk,   &
        -6.865943225859227e-16_rk, 5.134837146778254e-16_rk, 13.729352919941617_rk, -9.594687301603912e-16_rk,   &
        5.324812306622678e-16_rk, 3.112394128721432e-17_rk, 9.392035632295917e-17_rk, 8.577748513066588_rk   &
        /),(/4,4/))
        
        
        

        
        
        
        
        do inode_diff = 1,self%elem%nterms_c 
            do idir =1,3
                @assertEqual(transpose(test_dbr2_face_face4_dx(:,:,inode_diff,idir)),self%faces(ETA_MAX)%dbr2_f_dx(:,:,inode_diff,idir),tol)
            end do
        end do

        
        
        !
        ! dbr2_face_face5_dx
        ! 
        test_dbr2_face_face5_dx(:,:,1,1) = reshape((/ &
        13.384260859804929_rk, 5.208372504918843e-16_rk, 4.423290643232242e-16_rk, 7.161647136517571e-16_rk,   &
        3.67684849088003e-16_rk, 8.485281374238566_rk, 7.980186455739692e-16_rk, 8.892239531268628e-16_rk,   &
        -8.548581906969038e-16_rk, 1.4229573940527785e-15_rk, 8.485281374238566_rk, -1.4917920364604873e-16_rk,   &
        1.597483586503064e-15_rk, 1.0045650362051887e-15_rk, 6.168422768566892e-17_rk, 3.586301888672212_rk   &
        /),(/4,4/))
        test_dbr2_face_face5_dx(:,:,1,2) = reshape((/ &
        9.95213548685034_rk, 2.416771270878927e-16_rk, 4.5468883203887224e-17_rk, 4.165408347250534e-16_rk,   &
        2.2941252311058032e-17_rk, 2.666666666666666_rk, 1.311085182420959e-16_rk, 3.6534274252079377e-16_rk,   &
        -8.036529223050591e-16_rk, 5.155297882139909e-16_rk, 2.6666666666666665_rk, -2.5851103208523715e-16_rk,   &
        1.1964015368515784e-15_rk, 5.517731177970197e-16_rk, 1.8352485871513093e-17_rk, 0.7145311798163279_rk   &
        /),(/4,4/))
        test_dbr2_face_face5_dx(:,:,1,3) = reshape((/ &
        1.5543122344752192e-15_rk, -9.22545672770054e-17_rk, -3.834352417161144e-16_rk, -2.679328415936285e-17_rk,   &
        -1.8370619784392575e-16_rk, 4.898979485566354_rk, -3.1436114693459655e-16_rk, 2.409280597019381e-16_rk,   &
        -1.9110391319549263e-17_rk, 2.0503803713968767e-16_rk, -4.898979485566355_rk, -2.8653395845759014e-16_rk,   &
        -2.4999582627100284e-17_rk, 2.206986728186365e-16_rk, -1.660350606868007e-16_rk, 5.3342853773371316e-18_rk   &
        /),(/4,4/))
        test_dbr2_face_face5_dx(:,:,2,1) = reshape((/ &
        -4.898979485566356_rk, -1.0764521032169175e-16_rk, 1.26279964722529e-16_rk, -7.159094399134303e-17_rk,   &
        -1.1042556220736899e-16_rk, -1.2082847030275873e-15_rk, 1.6448064097586353e-16_rk, 4.227844366013143e-16_rk,   &
        2.213402924845619e-16_rk, -5.795561396274829e-17_rk, -3.5004549119053365e-16_rk, -1.03898865702655e-16_rk,   &
        -3.1546241160223267e-16_rk, -6.56142859480353e-17_rk, 7.993734756135904e-19_rk, 4.898979485566353_rk   &
        /),(/4,4/))
        test_dbr2_face_face5_dx(:,:,2,2) = reshape((/ &
        2.6666666666666674_rk, -5.4819363112632966e-18_rk, -4.044354987810528e-17_rk, 3.4206600398155097e-16_rk,   &
        -3.766328025854843e-16_rk, 9.952135486850338_rk, 2.3226027006297235e-16_rk, 7.061470665854026e-16_rk,   &
        -3.645502032262132e-16_rk, 1.1814525929678738e-15_rk, 0.7145311798163272_rk, -9.262470521799753e-17_rk,   &
        2.242508349051371e-16_rk, 8.781824926896841e-16_rk, -1.1763595322831752e-16_rk, 2.666666666666666_rk   &
        /),(/4,4/))
        test_dbr2_face_face5_dx(:,:,2,3) = reshape((/ &
        -8.485281374238571_rk, -3.209374728931872e-16_rk, -1.851737873296391e-16_rk, -6.177804855010513e-16_rk,   &
        -7.355308903670833e-17_rk, -13.38426085980492_rk, -6.481381396152367e-16_rk, -1.5529364494301152e-15_rk,   &
        6.5262828953189115e-16_rk, -1.570039817229718e-15_rk, -3.586301888672213_rk, 5.396120278062939e-16_rk,   &
        -1.2570215922737312e-15_rk, -1.1596494230757899e-15_rk, 1.0355145952551815e-16_rk, -8.485281374238568_rk   &
        /),(/4,4/))
        test_dbr2_face_face5_dx(:,:,3,1) = reshape((/ &
        -3.586301888672214_rk, -3.055468298485007e-16_rk, -6.948889937682824e-16_rk, -5.729828256690711e-16_rk,   &
        -1.4683372467326509e-16_rk, -8.485281374238566_rk, -1.1269799275256966e-15_rk, -1.7347928263294916e-15_rk,   &
        4.1217760572777996e-16_rk, -1.3070461661272821e-15_rk, -8.485281374238566_rk, 3.569769350513586e-16_rk,   &
        -9.665587632985983e-16_rk, -8.733364643091182e-16_rk, -6.32829746368961e-17_rk, -13.384260859804918_rk   &
        /),(/4,4/))
        test_dbr2_face_face5_dx(:,:,3,2) = reshape((/ &
        0.7145311798163285_rk, 2.2481019827350934e-16_rk, 3.5728606618420087e-16_rk, 2.7801403886660924e-16_rk,   &
        -2.954527480874269e-17_rk, 2.6666666666666656_rk, 5.849655183509069e-16_rk, 1.260600144078492e-15_rk,   &
        -2.967066000599086e-16_rk, 3.4848040280001176e-16_rk, 2.666666666666666_rk, -1.8729937003601206e-16_rk,   &
        6.013056575330432e-16_rk, 4.39778280628817e-16_rk, 1.883830637487825e-16_rk, 9.952135486850334_rk   &
        /),(/4,4/))
        test_dbr2_face_face5_dx(:,:,3,3) = reshape((/ &
        -2.220446049250313e-16_rk, -9.225456727700545e-17_rk, -3.834352417161143e-16_rk, -2.6793284159362875e-17_rk,   &
        -1.837061978439257e-16_rk, 4.898979485566354_rk, -3.143611469345965e-16_rk, 2.409280597019381e-16_rk,   &
        -1.911039131954924e-17_rk, 2.0503803713968767e-16_rk, -4.898979485566353_rk, -2.8653395845759e-16_rk,   &
        -2.4999582627100382e-17_rk, 2.2069867281863636e-16_rk, -1.6603506068680068e-16_rk, 5.3342853773371316e-18_rk   &
        /),(/4,4/))
        test_dbr2_face_face5_dx(:,:,4,1) = reshape((/ &
        -4.898979485566356_rk, -1.0764521032169185e-16_rk, 1.2627996472252916e-16_rk, -7.159094399134302e-17_rk,   &
        -1.1042556220736897e-16_rk, 1.239829265226006e-16_rk, 1.6448064097586378e-16_rk, 4.227844366013145e-16_rk,   &
        2.213402924845618e-16_rk, -5.795561396274804e-17_rk, 9.822221383596543e-16_rk, -1.0389886570265488e-16_rk,   &
        -3.1546241160223296e-16_rk, -6.561428594803525e-17_rk, 7.99373475613615e-19_rk, 4.898979485566353_rk   &
        /),(/4,4/))
        test_dbr2_face_face5_dx(:,:,4,2) = reshape((/ &
        2.6666666666666674_rk, 1.5994442812081799e-16_rk, 4.678016151137142e-16_rk, 3.630190847151646e-16_rk,   &
        2.3228948434942027e-16_rk, 0.7145311798163272_rk, 8.296593210069785e-16_rk, 5.436563331626926e-16_rk,   &
        -4.937795790921952e-16_rk, 8.566078104842116e-16_rk, 9.952135486850334_rk, 4.345691423613375e-16_rk,   &
        4.0509696356812326e-16_rk, 1.7017431062047768e-16_rk, 2.1258218644619153e-16_rk, 2.666666666666666_rk   &
        /),(/4,4/))
        test_dbr2_face_face5_dx(:,:,4,3) = reshape((/ &
        8.485281374238571_rk, 5.05446607447198e-16_rk, 9.520442707618677e-16_rk, 6.713670538197771e-16_rk,   &
        4.409654847245598e-16_rk, 3.5863018886722124_rk, 1.2768604334844297e-15_rk, 1.071080330026239e-15_rk,   &
        -6.144075068927926e-16_rk, 1.1599637429503427e-15_rk, 13.38426085980492_rk, 3.345588910888627e-17_rk,   &
        1.3070207575279317e-15_rk, 7.182520774385172e-16_rk, 2.2851866184808324e-16_rk, 8.485281374238568_rk   &
        /),(/4,4/))
        test_dbr2_face_face5_dx(:,:,5,1) = reshape((/ &
        4.461420286601642_rk, -6.983270425131278e-17_rk, -7.583856710746701e-17_rk, 3.7148343162958897e-16_rk,   &
        -4.3730715807557034e-16_rk, 2.8284271247461894_rk, 1.3828734298705023e-16_rk, 5.111931673725048e-16_rk,   &
        -8.886094810394025e-16_rk, 7.472381559955374e-16_rk, 2.82842712474619_rk, 2.538062634111286e-17_rk,   &
        5.394997889817194e-16_rk, 5.170601950599108e-16_rk, 3.1407232093563634e-17_rk, 1.1954339628907376_rk   &
        /),(/4,4/))
        test_dbr2_face_face5_dx(:,:,5,2) = reshape((/ &
        -9.95213548685034_rk, -2.416771270878927e-16_rk, -4.5468883203887126e-17_rk, -4.165408347250534e-16_rk,   &
        -2.2941252311058032e-17_rk, -2.666666666666666_rk, -1.311085182420959e-16_rk, -3.6534274252079377e-16_rk,   &
        8.036529223050591e-16_rk, -5.155297882139909e-16_rk, -2.6666666666666665_rk, 2.585110320852372e-16_rk,   &
        -1.1964015368515784e-15_rk, -5.517731177970197e-16_rk, -1.8352485871513093e-17_rk, -0.714531179816327_rk   &
        /),(/4,4/))
        test_dbr2_face_face5_dx(:,:,5,3) = reshape((/ &
        2.220446049250313e-16_rk, -2.471953679995625e-17_rk, 2.4051639045123063e-17_rk, 1.1977218685875464e-17_rk,   &
        -2.4686688046336583e-16_rk, 1.632993161855452_rk, -1.0806377306231783e-16_rk, -1.260297602187642e-16_rk,   &
        1.104893593228902e-16_rk, 2.4661911387578997e-17_rk, -1.6329931618554514_rk, -8.62483861655849e-17_rk,   &
        -1.0287794130183208e-16_rk, 2.7993871385805935e-16_rk, -6.746442514785123e-17_rk, -5.3342853773371316e-18_rk   &
        /),(/4,4/))
        test_dbr2_face_face5_dx(:,:,6,1) = reshape((/ &
        -1.632993161855452_rk, 9.571849057925062e-17_rk, 9.420807985333738e-17_rk, -2.6362292736207328e-17_rk,   &
        7.331198296002619e-17_rk, -1.239829265226006e-16_rk, 1.564447214900603e-16_rk, 2.1025814294758176e-16_rk,   &
        1.37124889672565e-16_rk, -6.016613925652164e-17_rk, -9.404371865952899e-17_rk, 1.5425311483722676e-16_rk,   &
        -1.0533392012007476e-16_rk, -1.3578022871483994e-17_rk, 1.194304011504709e-16_rk, 1.6329931618554514_rk   &
        /),(/4,4/))
        test_dbr2_face_face5_dx(:,:,6,2) = reshape((/ &
        -2.6666666666666674_rk, 5.4819363112632966e-18_rk, 4.044354987810528e-17_rk, -3.4206600398155097e-16_rk,   &
        3.766328025854843e-16_rk, -9.952135486850338_rk, -2.3226027006297235e-16_rk, -7.061470665854026e-16_rk,   &
        3.645502032262132e-16_rk, -1.1814525929678738e-15_rk, -0.7145311798163272_rk, 9.262470521799748e-17_rk,   &
        -2.242508349051371e-16_rk, -8.781824926896841e-16_rk, 1.1763595322831755e-16_rk, -2.666666666666665_rk   &
        /),(/4,4/))
        test_dbr2_face_face5_dx(:,:,6,3) = reshape((/ &
        -2.8284271247461907_rk, -1.166249527981564e-18_rk, -4.2421151790993435e-17_rk, -3.570983575792572e-16_rk,   &
        6.108620555789101e-16_rk, -4.461420286601642_rk, -1.8666829141479274e-16_rk, -5.954215501013224e-16_rk,   &
        6.409952320439471e-16_rk, -7.117339281265948e-16_rk, -1.1954339628907378_rk, -9.338535501275481e-17_rk,   &
        -3.312879275598129e-16_rk, -7.834208860464862e-16_rk, -8.337320809618338e-17_rk, -2.8284271247461894_rk   &
        /),(/4,4/))
        test_dbr2_face_face5_dx(:,:,7,1) = reshape((/ &
        -1.1954339628907387_rk, -1.216042769071884e-16_rk, -1.125775925992078e-16_rk, -3.1875884615717433e-16_rk,   &
        2.9068319215551794e-16_rk, -2.8284271247461903_rk, -4.511767859671706e-16_rk, -9.317094532676686e-16_rk,   &
        6.143597016942723e-16_rk, -6.269058774824943e-16_rk, -2.82842712474619_rk, -3.338868560155664e-16_rk,   &
        -3.2883194874156994e-16_rk, -4.899041493169427e-16_rk, -2.702680343945055e-16_rk, -4.461420286601641_rk   &
        /),(/4,4/))
        test_dbr2_face_face5_dx(:,:,7,2) = reshape((/ &
        -0.7145311798163285_rk, -2.2481019827350934e-16_rk, -3.5728606618420097e-16_rk, -2.7801403886660924e-16_rk,   &
        2.954527480874269e-17_rk, -2.6666666666666656_rk, -5.849655183509069e-16_rk, -1.260600144078492e-15_rk,   &
        2.967066000599086e-16_rk, -3.4848040280001176e-16_rk, -2.666666666666666_rk, 1.872993700360121e-16_rk,   &
        -6.013056575330432e-16_rk, -4.39778280628817e-16_rk, -1.8838306374878255e-16_rk, -9.952135486850336_rk   &
        /),(/4,4/))
        test_dbr2_face_face5_dx(:,:,7,3) = reshape((/ &
        2.220446049250313e-16_rk, -2.4719536799956298e-17_rk, 2.4051639045123038e-17_rk, 1.1977218685875489e-17_rk,   &
        -2.4686688046336593e-16_rk, 1.632993161855452_rk, -1.0806377306231787e-16_rk, -1.2602976021876416e-16_rk,   &
        1.1048935932289018e-16_rk, 2.4661911387578997e-17_rk, -1.632993161855451_rk, -8.624838616558475e-17_rk,   &
        -1.0287794130183198e-16_rk, 2.799387138580593e-16_rk, -6.746442514785115e-17_rk, -5.3342853773371316e-18_rk   &
        /),(/4,4/))
        test_dbr2_face_face5_dx(:,:,8,1) = reshape((/ &
        -1.632993161855452_rk, 9.571849057925057e-17_rk, 9.42080798533374e-17_rk, -2.6362292736207334e-17_rk,   &
        7.331198296002621e-17_rk, 3.20106283327462e-16_rk, 1.5644472149006026e-16_rk, 2.1025814294758196e-16_rk,   &
        1.371248896725649e-16_rk, -6.016613925652149e-17_rk, 3.5004549119053365e-16_rk, 1.5425311483722678e-16_rk,   &
        -1.0533392012007488e-16_rk, -1.3578022871484044e-17_rk, 1.1943040115047093e-16_rk, 1.6329931618554514_rk   &
        /),(/4,4/))
        test_dbr2_face_face5_dx(:,:,8,2) = reshape((/ &
        -2.6666666666666674_rk, -1.5994442812081799e-16_rk, -4.678016151137142e-16_rk, -3.630190847151646e-16_rk,   &
        -2.3228948434942027e-16_rk, -0.7145311798163272_rk, -8.296593210069785e-16_rk, -5.436563331626926e-16_rk,   &
        4.937795790921952e-16_rk, -8.566078104842116e-16_rk, -9.952135486850334_rk, -4.3456914236133757e-16_rk,   &
        -4.0509696356812326e-16_rk, -1.7017431062047768e-16_rk, -2.1258218644619153e-16_rk, -2.666666666666665_rk   &
        /),(/4,4/))
        test_dbr2_face_face5_dx(:,:,8,3) = reshape((/ &
        2.8284271247461907_rk, 5.0605323127894086e-17_rk, -5.682126299252592e-18_rk, 3.3314392020750627e-16_rk,   &
        -1.171282946521783e-16_rk, 1.1954339628907376_rk, 4.0279583753942837e-16_rk, 8.47481070538851e-16_rk,   &
        -8.619739506897275e-16_rk, 6.624101053514369e-16_rk, 4.4614202866016415_rk, 2.6588212734392447e-16_rk,   &
        5.370438101634769e-16_rk, 2.235434583303675e-16_rk, 2.1830205839188574e-16_rk, 2.8284271247461894_rk   &
        /),(/4,4/))
        
        
        

        
        
        
        
        do inode_diff = 1,self%elem%nterms_c 
            do idir =1,3
                @assertEqual(transpose(test_dbr2_face_face5_dx(:,:,inode_diff,idir)),self%faces(ZETA_MIN)%dbr2_f_dx(:,:,inode_diff,idir),tol)
            end do
        end do

        
        
        !
        ! dbr2_face_face6_dx
        ! 
        test_dbr2_face_face6_dx(:,:,1,1) = reshape((/ &
        4.461420286601642_rk, -5.684459730224785e-16_rk, -1.6028794952720261e-16_rk, -1.1109345996220221e-16_rk,   &
        -9.335087752687833e-16_rk, 2.8284271247461907_rk, -3.810141734558122e-18_rk, -1.0040011711871064e-16_rk,   &
        -1.2820696166098845e-15_rk, 9.279214751532554e-16_rk, 2.8284271247461907_rk, -4.702428500464297e-16_rk,   &
        3.2455352953626735e-16_rk, -3.798032784322744e-16_rk, 1.9291905656112512e-16_rk, 1.195433962890738_rk   &
        /),(/4,4/))
        test_dbr2_face_face6_dx(:,:,1,2) = reshape((/ &
        9.952135486850343_rk, -5.598882227065085e-16_rk, -9.342124850099103e-16_rk, -3.819702265905288e-16_rk,   &
        -1.3819968413468855e-15_rk, 2.666666666666667_rk, 1.1241259759911965e-17_rk, -2.833903054262188e-16_rk,   &
        -1.786839363245631e-15_rk, 7.387825630587664e-16_rk, 2.666666666666667_rk, -3.74514786144454e-16_rk,   &
        5.122803868005181e-16_rk, -2.217438222387242e-16_rk, 3.1542210672121583e-16_rk, 0.7145311798163274_rk   &
        /),(/4,4/))
        test_dbr2_face_face6_dx(:,:,1,3) = reshape((/ &
        4.3021142204224816e-16_rk, -1.5082639230632891e-16_rk, 1.246295310830438e-16_rk, 1.260055393642378e-16_rk,   &
        -1.131308760398192e-16_rk, 1.632993161855452_rk, -1.655730401954421e-16_rk, -7.620283469116152e-18_rk,   &
        1.0913108193781217e-16_rk, 1.4480248029879212e-16_rk, -1.6329931618554518_rk, 1.1463242131767432e-16_rk,   &
        6.58107465291609e-17_rk, -1.6894862727237321e-16_rk, 1.280849071924973e-17_rk, 6.593865901546968e-17_rk   &
        /),(/4,4/))
        test_dbr2_face_face6_dx(:,:,2,1) = reshape((/ &
        -1.632993161855453_rk, 9.513417807043579e-17_rk, 2.617148444946139e-16_rk, 6.544030724232135e-17_rk,   &
        1.8569073948846066e-16_rk, -2.0083108122058479e-16_rk, -5.950235597045093e-17_rk, -1.2527558347299834e-16_rk,   &
        4.10651521340132e-16_rk, -1.231457167013047e-16_rk, 2.3715282665292594e-16_rk, 4.238568999876114e-17_rk,   &
        -1.7149326057119634e-16_rk, -6.94401013443282e-17_rk, -3.694746691305275e-16_rk, 1.6329931618554512_rk   &
        /),(/4,4/))
        test_dbr2_face_face6_dx(:,:,2,2) = reshape((/ &
        2.666666666666667_rk, -5.531496456528186e-16_rk, 9.79577490127199e-18_rk, 1.6632289375347661e-16_rk,   &
        -1.1081801134065895e-15_rk, 9.95213548685034_rk, 1.500099596508532e-16_rk, -4.334904878230827e-16_rk,   &
        -3.5640084485576105e-16_rk, 8.998557962653599e-16_rk, 0.7145311798163274_rk, -4.418716718770032e-17_rk,   &
        -5.57012249913958e-17_rk, -1.2534905976917288e-15_rk, -2.4209980609450843e-17_rk, 2.666666666666667_rk   &
        /),(/4,4/))
        test_dbr2_face_face6_dx(:,:,2,3) = reshape((/ &
        -2.8284271247461903_rk, 6.241381872583716e-16_rk, -2.260564260504549e-16_rk, -8.035238664435694e-17_rk,   &
        8.609489118201419e-16_rk, -4.461420286601642_rk, 2.2888553790045116e-16_rk, 2.332959840608251e-16_rk,   &
        7.622870133319402e-16_rk, -9.495782387507428e-16_rk, -1.1954339628907389_rk, 3.132247387299943e-16_rk,   &
        -2.1887101549423194e-16_rk, 6.181920070489758e-16_rk, 1.637471218501528e-16_rk, -2.8284271247461894_rk   &
        /),(/4,4/))
        test_dbr2_face_face6_dx(:,:,3,1) = reshape((/ &
        -1.1954339628907378_rk, 3.781776168816067e-16_rk, -3.6314173946202497e-16_rk, -1.9787154522440486e-17_rk,   &
        5.62127296291862e-16_rk, -2.8284271247461907_rk, 1.2281485367546e-16_rk, 3.5095128406470726e-16_rk,   &
        4.607665739296203e-16_rk, -6.816300417506459e-16_rk, -2.8284271247461907_rk, 3.854714700489074e-16_rk,   &
        1.8432991606125366e-17_rk, 5.18683481120931e-16_rk, 5.460302816999298e-16_rk, -4.461420286601642_rk   &
        /),(/4,4/))
        test_dbr2_face_face6_dx(:,:,3,2) = reshape((/ &
        0.714531179816327_rk, -9.351955481455428e-17_rk, 9.867227371607298e-17_rk, 1.303038913915492e-16_rk,   &
        -6.105107249737425e-16_rk, 2.666666666666667_rk, -2.0070924686538936e-16_rk, -6.616962795411219e-16_rk,   &
        -9.152769430533614e-17_rk, 3.5941293133033796e-16_rk, 2.666666666666667_rk, -5.62693108690466e-16_rk,   &
        3.108311221914566e-17_rk, -5.272903391437853e-16_rk, -7.80529544777142e-16_rk, 9.952135486850334_rk   &
        /),(/4,4/))
        test_dbr2_face_face6_dx(:,:,3,3) = reshape((/ &
        -4.579669976578771e-16_rk, -1.5082639230632877e-16_rk, 1.246295310830437e-16_rk, 1.260055393642378e-16_rk,   &
        -1.1313087603981924e-16_rk, 1.632993161855452_rk, -1.6557304019544206e-16_rk, -7.6202834691163e-18_rk,   &
        1.0913108193781227e-16_rk, 1.4480248029879207e-16_rk, -1.6329931618554518_rk, 1.1463242131767427e-16_rk,   &
        6.581074652916087e-17_rk, -1.6894862727237312e-16_rk, 1.2808490719249692e-17_rk, 5.100278688655323e-16_rk   &
        /),(/4,4/))
        test_dbr2_face_face6_dx(:,:,4,1) = reshape((/ &
        -1.632993161855453_rk, 9.513417807043604e-17_rk, 2.617148444946139e-16_rk, 6.544030724232135e-17_rk,   &
        1.8569073948846066e-16_rk, 2.432581286294778e-16_rk, -5.950235597045092e-17_rk, -1.252755834729983e-16_rk,   &
        4.10651521340132e-16_rk, -1.2314571670130466e-16_rk, 2.3715282665292594e-16_rk, 4.2385689998761177e-17_rk,   &
        -1.714932605711964e-16_rk, -6.944010134432822e-17_rk, -3.694746691305276e-16_rk, 1.6329931618554512_rk   &
        /),(/4,4/))
        test_dbr2_face_face6_dx(:,:,4,2) = reshape((/ &
        2.666666666666667_rk, -1.206016986859647e-16_rk, -7.005590104415715e-16_rk, -1.1543767179149035e-16_rk,   &
        -2.1628528147638274e-16_rk, 0.7145311798163274_rk, 2.656936744875286e-16_rk, -1.1352640576016567e-16_rk,   &
        -1.1186509997769184e-15_rk, 6.806461917725618e-16_rk, 9.95213548685034_rk, -3.7980619861466534e-16_rk,   &
        -2.445596981809802e-16_rk, -2.5283320327630995e-16_rk, 8.535138998878153e-17_rk, 2.666666666666667_rk   &
        /),(/4,4/))
        test_dbr2_face_face6_dx(:,:,4,3) = reshape((/ &
        2.8284271247461903_rk, -3.224854026457139e-16_rk, -2.3202636115632514e-17_rk, -1.7165869208411867e-16_rk,   &
        -6.346871597405035e-16_rk, 1.1954339628907389_rk, 1.0226054249043298e-16_rk, -2.1805541712259272e-16_rk,   &
        -9.805491772075644e-16_rk, 6.599732781531586e-16_rk, 4.4614202866016415_rk, -5.424895813653428e-16_rk,   &
        8.724952243591017e-17_rk, -2.8029475250422947e-16_rk, -1.8936410328865221e-16_rk, 2.8284271247461894_rk   &
        /),(/4,4/))
        test_dbr2_face_face6_dx(:,:,5,1) = reshape((/ &
        13.38426085980493_rk, -6.9976968935754e-16_rk, -1.6493313849569902e-15_rk, -3.9311272939334476e-16_rk,   &
        -1.9574683630894283e-15_rk, 8.485281374238571_rk, 3.136545424083258e-16_rk, -6.871736511364169e-16_rk,   &
        -2.2879220066156865e-15_rk, 1.2344585185896421e-15_rk, 8.485281374238571_rk, -3.5920962396527727e-16_rk,   &
        1.8760380631424048e-16_rk, -9.989216166773735e-16_rk, 2.9638866981973963e-16_rk, 3.5863018886722133_rk   &
        /),(/4,4/))
        test_dbr2_face_face6_dx(:,:,5,2) = reshape((/ &
        -9.952135486850343_rk, 5.598882227065085e-16_rk, 9.342124850099103e-16_rk, 3.819702265905288e-16_rk,   &
        1.3819968413468855e-15_rk, -2.666666666666667_rk, -1.124125975991194e-17_rk, 2.833903054262189e-16_rk,   &
        1.786839363245631e-15_rk, -7.387825630587664e-16_rk, -2.666666666666667_rk, 3.74514786144454e-16_rk,   &
        -5.122803868005181e-16_rk, 2.217438222387242e-16_rk, -3.1542210672121583e-16_rk, -0.7145311798163265_rk   &
        /),(/4,4/))
        test_dbr2_face_face6_dx(:,:,5,3) = reshape((/ &
        4.579669976578771e-16_rk, -1.5503119418225284e-16_rk, 3.776671546811954e-16_rk, 7.322926720356502e-17_rk,   &
        -5.175340077232663e-16_rk, 4.8989794855663575_rk, 8.377230096157819e-17_rk, -2.1862848869370133e-16_rk,   &
        4.2986117156743465e-16_rk, 1.020211753928653e-17_rk, -4.8989794855663575_rk, 1.2268607169959377e-16_rk,   &
        6.773236054773218e-17_rk, -5.386230019632315e-16_rk, -9.028007882535236e-17_rk, -6.593865901546968e-17_rk   &
        /),(/4,4/))
        test_dbr2_face_face6_dx(:,:,6,1) = reshape((/ &
        -4.8989794855663575_rk, 2.346382695289017e-16_rk, 4.6864497258476e-16_rk, 2.9679219540916355e-16_rk,   &
        3.598323249902627e-16_rk, 2.0083108122058479e-16_rk, -9.03692845402237e-17_rk, -1.422271361870321e-16_rk,   &
        7.881148559922339e-16_rk, -1.4510912247011025e-16_rk, 2.0693638319713667e-16_rk, -1.7544785794335562e-16_rk,   &
        -1.687645953737773e-16_rk, -1.466139127271706e-16_rk, -4.054801754965572e-16_rk, 4.898979485566352_rk   &
        /),(/4,4/))
        test_dbr2_face_face6_dx(:,:,6,2) = reshape((/ &
        -2.666666666666667_rk, 5.531496456528186e-16_rk, -9.79577490127199e-18_rk, -1.6632289375347661e-16_rk,   &
        1.1081801134065895e-15_rk, -9.95213548685034_rk, -1.5000995965085322e-16_rk, 4.334904878230825e-16_rk,   &
        3.5640084485576105e-16_rk, -8.998557962653599e-16_rk, -0.7145311798163274_rk, 4.418716718770032e-17_rk,   &
        5.570122499139582e-17_rk, 1.2534905976917288e-15_rk, 2.4209980609450794e-17_rk, -2.666666666666666_rk   &
        /),(/4,4/))
        test_dbr2_face_face6_dx(:,:,6,3) = reshape((/ &
        -8.485281374238573_rk, 6.20162614010891e-16_rk, 8.03019257691035e-16_rk, 2.3091266780616086e-17_rk,   &
        2.1151700458224317e-15_rk, -13.384260859804929_rk, -3.0705755882968023e-16_rk, 1.0480292760171505e-15_rk,   &
        1.0699459790560182e-15_rk, -1.0995515136588185e-15_rk, -3.5863018886722156_rk, 4.1197141020903927e-16_rk,   &
        -8.657157148819524e-17_rk, 1.6841585313677756e-15_rk, 1.9937158450217e-16_rk, -8.485281374238566_rk   &
        /),(/4,4/))
        test_dbr2_face_face6_dx(:,:,7,1) = reshape((/ &
        -3.5863018886722138_rk, 2.3049315029973643e-16_rk, 7.120414397874704e-16_rk, -2.0047166142498232e-16_rk,   &
        1.2378037131089026e-15_rk, -8.485281374238571_rk, -1.3291597332787827e-16_rk, 9.71627923510481e-16_rk,   &
        7.116922946312187e-16_rk, -9.442402736494215e-16_rk, -8.485281374238571_rk, 7.101053398519885e-16_rk,   &
        1.4992538443331412e-16_rk, 1.2921494421317148e-15_rk, 5.145716811733749e-16_rk, -13.38426085980492_rk   &
        /),(/4,4/))
        test_dbr2_face_face6_dx(:,:,7,2) = reshape((/ &
        -0.714531179816327_rk, 9.351955481455428e-17_rk, -9.867227371607298e-17_rk, -1.3030389139154921e-16_rk,   &
        6.105107249737425e-16_rk, -2.666666666666667_rk, 2.007092468653894e-16_rk, 6.616962795411221e-16_rk,   &
        9.152769430533614e-17_rk, -3.5941293133033796e-16_rk, -2.666666666666667_rk, 5.62693108690466e-16_rk,   &
        -3.1083112219145634e-17_rk, 5.272903391437853e-16_rk, 7.805295447771422e-16_rk, -9.952135486850338_rk   &
        /),(/4,4/))
        test_dbr2_face_face6_dx(:,:,7,3) = reshape((/ &
        -4.3021142204224816e-16_rk, -1.550311941822528e-16_rk, 3.776671546811951e-16_rk, 7.322926720356512e-17_rk,   &
        -5.175340077232662e-16_rk, 4.898979485566356_rk, 8.377230096157813e-17_rk, -2.1862848869370138e-16_rk,   &
        4.2986117156743456e-16_rk, 1.0202117539286554e-17_rk, -4.898979485566356_rk, 1.2268607169959362e-16_rk,   &
        6.773236054773206e-17_rk, -5.386230019632313e-16_rk, -9.028007882535237e-17_rk, 1.2663289705347181e-15_rk   &
        /),(/4,4/))
        test_dbr2_face_face6_dx(:,:,8,1) = reshape((/ &
        -4.8989794855663575_rk, 2.3463826952890185e-16_rk, 4.686449725847599e-16_rk, 2.9679219540916355e-16_rk,   &
        3.598323249902627e-16_rk, -2.432581286294778e-16_rk, -9.03692845402238e-17_rk, -1.4222713618703215e-16_rk,   &
        7.881148559922339e-16_rk, -1.451091224701103e-16_rk, 2.0693638319713667e-16_rk, -1.7544785794335564e-16_rk,   &
        -1.6876459537377725e-16_rk, -1.4661391272717058e-16_rk, -4.0548017549655727e-16_rk, 4.898979485566354_rk   &
        /),(/4,4/))
        test_dbr2_face_face6_dx(:,:,8,2) = reshape((/ &
        -2.666666666666667_rk, 1.206016986859647e-16_rk, 7.005590104415715e-16_rk, 1.1543767179149035e-16_rk,   &
        2.1628528147638274e-16_rk, -0.7145311798163274_rk, -2.6569367448752865e-16_rk, 1.1352640576016557e-16_rk,   &
        1.1186509997769184e-15_rk, -6.806461917725618e-16_rk, -9.95213548685034_rk, 3.7980619861466534e-16_rk,   &
        2.4455969818098026e-16_rk, 2.5283320327630995e-16_rk, -8.53513899887816e-17_rk, -2.666666666666666_rk   &
        /),(/4,4/))
        test_dbr2_face_face6_dx(:,:,8,3) = reshape((/ &
        8.485281374238573_rk, -3.101002256463855e-16_rk, -1.5583535670534256e-15_rk, -1.6954980118774623e-16_rk,   &
        -1.080102030375899e-15_rk, 3.586301888672216_rk, 1.3951295690652393e-16_rk, -6.107722986297479e-16_rk,   &
        -1.929668322190887e-15_rk, 1.0791472785802455e-15_rk, 13.384260859804929_rk, -6.573435536082266e-16_rk,   &
        -4.8893149607269004e-17_rk, -6.069125274413127e-16_rk, -1.8811426851465308e-17_rk, 8.485281374238566_rk   &
        /),(/4,4/))
        
        
        
        do inode_diff = 1,self%elem%nterms_c 
            do idir =1,3
                @assertEqual(transpose(test_dbr2_face_face6_dx(:,:,inode_diff,idir)),self%faces(ZETA_MAX)%dbr2_f_dx(:,:,inode_diff,idir),tol)
            end do
        end do
    
    
    
    
    end subroutine testElement_dbr2_face_dx
    !*******************************************************************************************







    !>
    !!
    !!
    !------------------------------------------------------------------------------------------
    @Test
    subroutine testElement_face_dmetrics_dx_etamax(self)
        class(test_element_linearC_dx),    intent(inout)   :: self
        real(rk)    :: test_dmetric_dx_etamax(3,3,self%faces(ETA_MAX)%basis_s%nnodes_face(),self%elem%nterms_c,3)
        real(rk)    :: tol = 1.e-13_rk
        
        integer(ik)     :: inode_diff, idir, inode, irow
        
       
        test_dmetric_dx_etamax(:,:,1,1,1) = reshape((/                                                                                 &
                                        6.220084679281461248e-01_rk, -2.775557561562891351e-17_rk, -6.220084679281461248e-01_rk, &
                                        6.220084679281459028e-01_rk, -5.551115123125782702e-17_rk, -6.220084679281460138e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))

        test_dmetric_dx_etamax(:,:,1,1,2) = reshape((/                                                                                 &
                                        4.912182768655737776e-17_rk, 0.000000000000000000e+00_rk, -4.912182768655739625e-17_rk, &
                                        4.912182768655738392e-17_rk, 3.081487911019577365e-33_rk, -4.912182768655739625e-17_rk, &
                                        8.796528112548944733e-01_rk, 0.000000000000000000e+00_rk, -8.796528112548946954e-01_rk  &
                                        /),(/3,3/))

        test_dmetric_dx_etamax(:,:,1,1,3) = reshape((/                                                                                 &
                                        6.220084679281461248e-01_rk, -2.775557561562891351e-17_rk, -6.220084679281461248e-01_rk, &
                                        -6.220084679281461248e-01_rk, 0.000000000000000000e+00_rk, 6.220084679281463469e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))

        test_dmetric_dx_etamax(:,:,1,2,1) = reshape((/                                                                                 &
                                        1.666666666666666297e-01_rk, 0.000000000000000000e+00_rk, -1.666666666666666852e-01_rk, &
                                        1.666666666666666019e-01_rk, 0.000000000000000000e+00_rk, -1.666666666666666297e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))

        test_dmetric_dx_etamax(:,:,1,2,2) = reshape((/                                                                                 &
                                        1.316215405935381755e-17_rk, 0.000000000000000000e+00_rk, -1.316215405935382063e-17_rk, &
                                        1.316215405935381447e-17_rk, 0.000000000000000000e+00_rk, -1.316215405935381755e-17_rk, &
                                        2.357022603955157836e-01_rk, -5.551115123125782702e-17_rk, -2.357022603955156725e-01_rk  &
                                        /),(/3,3/))

        test_dmetric_dx_etamax(:,:,1,2,3) = reshape((/                                                                                 &
                                        1.666666666666666297e-01_rk, 0.000000000000000000e+00_rk, -1.666666666666666852e-01_rk, &
                                        -1.666666666666666297e-01_rk, 0.000000000000000000e+00_rk, 1.666666666666666574e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))

        test_dmetric_dx_etamax(:,:,1,3,1) = reshape((/                                                                                 &
                                        -9.553418012614793842e-01_rk, 2.988584907226845555e-01_rk, -6.220084679281461248e-01_rk, &
                                        -9.553418012614791621e-01_rk, 2.988584907226844445e-01_rk, -6.220084679281459028e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))

        test_dmetric_dx_etamax(:,:,1,3,2) = reshape((/                                                                                 &
                                        -7.544613580526502518e-17_rk, 2.360172898102762969e-17_rk, -4.912182768655739625e-17_rk, &
                                        -7.544613580526501286e-17_rk, 2.360172898102762045e-17_rk, -4.912182768655738392e-17_rk, &
                                        -1.351057332045926040e+00_rk, 4.226497308103741579e-01_rk, -8.796528112548946954e-01_rk  &
                                        /),(/3,3/))

        test_dmetric_dx_etamax(:,:,1,3,3) = reshape((/                                                                                 &
                                        -9.553418012614793842e-01_rk, 2.988584907226845555e-01_rk, -6.220084679281461248e-01_rk, &
                                        9.553418012614796062e-01_rk, -2.988584907226846110e-01_rk, 6.220084679281462359e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))

        test_dmetric_dx_etamax(:,:,1,4,1) = reshape((/                                                                                 &
                                        1.666666666666667407e-01_rk, 1.115355071650410368e+00_rk, 1.410683602522958990e+00_rk, &
                                        1.666666666666666574e-01_rk, 1.115355071650410146e+00_rk, 1.410683602522958768e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))

        test_dmetric_dx_etamax(:,:,1,4,2) = reshape((/                                                                                 &
                                        1.316215405935382987e-17_rk, 8.808285170366592959e-17_rk, 1.114058094324686255e-16_rk, &
                                        1.316215405935382525e-17_rk, 8.808285170366591727e-17_rk, 1.114058094324686008e-16_rk, &
                                        2.357022603955159779e-01_rk, 1.577350269189625731e+00_rk, 1.995007882905305285e+00_rk  &
                                        /),(/3,3/))

        test_dmetric_dx_etamax(:,:,1,4,3) = reshape((/                                                                                 &
                                        1.666666666666667407e-01_rk, 1.115355071650410368e+00_rk, 1.410683602522958990e+00_rk, &
                                        -1.666666666666668239e-01_rk, -1.115355071650410590e+00_rk, -1.410683602522959212e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))

        test_dmetric_dx_etamax(:,:,1,5,1) = reshape((/                                                                                 &
                                        1.666666666666666297e-01_rk, 2.775557561562891351e-17_rk, -1.666666666666666852e-01_rk, &
                                        1.666666666666665464e-01_rk, 5.551115123125782702e-17_rk, -1.666666666666665186e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))

        test_dmetric_dx_etamax(:,:,1,5,2) = reshape((/                                                                                 &
                                        1.316215405935381447e-17_rk, 0.000000000000000000e+00_rk, -1.316215405935382063e-17_rk, &
                                        1.316215405935381292e-17_rk, -3.081487911019577365e-33_rk, -1.316215405935382371e-17_rk, &
                                        2.357022603955158668e-01_rk, 1.110223024625156540e-16_rk, -2.357022603955158946e-01_rk  &
                                        /),(/3,3/))

        test_dmetric_dx_etamax(:,:,1,5,3) = reshape((/                                                                                 &
                                        1.666666666666666297e-01_rk, 2.775557561562891351e-17_rk, -1.666666666666666852e-01_rk, &
                                        -1.666666666666666019e-01_rk, 0.000000000000000000e+00_rk, 1.666666666666666574e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))

        test_dmetric_dx_etamax(:,:,1,6,1) = reshape((/                                                                                 &
                                        4.465819873852046318e-02_rk, 0.000000000000000000e+00_rk, -4.465819873852047706e-02_rk, &
                                        4.465819873852042154e-02_rk, 0.000000000000000000e+00_rk, -4.465819873852047706e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))

        test_dmetric_dx_etamax(:,:,1,6,2) = reshape((/                                                                                 &
                                        3.526788550857880869e-18_rk, 0.000000000000000000e+00_rk, -3.526788550857880099e-18_rk, &
                                        3.526788550857881640e-18_rk, 0.000000000000000000e+00_rk, -3.526788550857877018e-18_rk, &
                                        6.315623032716868868e-02_rk, 0.000000000000000000e+00_rk, -6.315623032716854990e-02_rk  &
                                        /),(/3,3/))

        test_dmetric_dx_etamax(:,:,1,6,3) = reshape((/                                                                                 &
                                        4.465819873852046318e-02_rk, 0.000000000000000000e+00_rk, -4.465819873852047706e-02_rk, &
                                        -4.465819873852044930e-02_rk, 0.000000000000000000e+00_rk, 4.465819873852044930e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))

        test_dmetric_dx_etamax(:,:,1,7,1) = reshape((/                                                                                 &
                                        -2.559830641437075283e-01_rk, -2.988584907226845555e-01_rk, -1.666666666666665741e-01_rk, &
                                        -2.559830641437075283e-01_rk, -2.988584907226844445e-01_rk, -1.666666666666666297e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))

        test_dmetric_dx_etamax(:,:,1,7,2) = reshape((/                                                                                 &
                                        -2.021573116106957774e-17_rk, -2.360172898102762969e-17_rk, -1.316215405935382063e-17_rk, &
                                        -2.021573116106958083e-17_rk, -2.360172898102762045e-17_rk, -1.316215405935381138e-17_rk, &
                                        -3.620147210498532164e-01_rk, -4.226497308103742689e-01_rk, -2.357022603955158946e-01_rk  &
                                        /),(/3,3/))

        test_dmetric_dx_etamax(:,:,1,7,3) = reshape((/                                                                                 &
                                        -2.559830641437075283e-01_rk, -2.988584907226845555e-01_rk, -1.666666666666665741e-01_rk, &
                                        2.559830641437075838e-01_rk, 2.988584907226846110e-01_rk, 1.666666666666666574e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))

        test_dmetric_dx_etamax(:,:,1,8,1) = reshape((/                                                                                 &
                                        4.465819873852046318e-02_rk, -1.115355071650410368e+00_rk, 3.779915320718537086e-01_rk, &
                                        4.465819873852047706e-02_rk, -1.115355071650410146e+00_rk, 3.779915320718536531e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))

        test_dmetric_dx_etamax(:,:,1,8,2) = reshape((/                                                                                 &
                                        3.526788550857880869e-18_rk, -8.808285170366592959e-17_rk, 2.985109666956551519e-17_rk, &
                                        3.526788550857883181e-18_rk, -8.808285170366591727e-17_rk, 2.985109666956552752e-17_rk, &
                                        6.315623032716871643e-02_rk, -1.577350269189625731e+00_rk, 5.345607511182002280e-01_rk  &
                                        /),(/3,3/))

        test_dmetric_dx_etamax(:,:,1,8,3) = reshape((/                                                                                 &
                                        4.465819873852046318e-02_rk, -1.115355071650410368e+00_rk, 3.779915320718537086e-01_rk, &
                                        -4.465819873852050481e-02_rk, 1.115355071650410590e+00_rk, -3.779915320718537641e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))

        test_dmetric_dx_etamax(:,:,2,1,1) = reshape((/                                                                                 &
                                        1.666666666666666019e-01_rk, 5.551115123125782702e-17_rk, -1.666666666666666297e-01_rk, &
                                        1.666666666666666019e-01_rk, 5.551115123125782702e-17_rk, -1.666666666666666297e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))

        test_dmetric_dx_etamax(:,:,2,1,2) = reshape((/                                                                                 &
                                        2.384528009481804351e-17_rk, 6.162975822039154730e-33_rk, -2.384528009481806200e-17_rk, &
                                        2.384528009481804351e-17_rk, 6.162975822039154730e-33_rk, -2.384528009481806200e-17_rk, &
                                        2.357022603955158391e-01_rk, 0.000000000000000000e+00_rk, -2.357022603955158668e-01_rk  &
                                        /),(/3,3/))

        test_dmetric_dx_etamax(:,:,2,1,3) = reshape((/                                                                                 &
                                        1.666666666666666574e-01_rk, 5.551115123125782702e-17_rk, -1.666666666666667129e-01_rk, &
                                        -1.666666666666666574e-01_rk, -5.551115123125782702e-17_rk, 1.666666666666667129e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))

        test_dmetric_dx_etamax(:,:,2,2,1) = reshape((/                                                                                 &
                                        6.220084679281459028e-01_rk, 8.326672684688674053e-17_rk, -6.220084679281461248e-01_rk, &
                                        6.220084679281459028e-01_rk, 8.326672684688674053e-17_rk, -6.220084679281461248e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))

        test_dmetric_dx_etamax(:,:,2,2,2) = reshape((/                                                                                 &
                                        8.899179683457179257e-17_rk, 0.000000000000000000e+00_rk, -8.899179683457181722e-17_rk, &
                                        8.899179683457179257e-17_rk, 0.000000000000000000e+00_rk, -8.899179683457181722e-17_rk, &
                                        8.796528112548944733e-01_rk, 1.110223024625156540e-16_rk, -8.796528112548948064e-01_rk  &
                                        /),(/3,3/))

        test_dmetric_dx_etamax(:,:,2,2,3) = reshape((/                                                                                 &
                                        6.220084679281460138e-01_rk, 2.775557561562891351e-17_rk, -6.220084679281463469e-01_rk, &
                                        -6.220084679281460138e-01_rk, -2.775557561562891351e-17_rk, 6.220084679281463469e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))

        test_dmetric_dx_etamax(:,:,2,3,1) = reshape((/                                                                                 &
                                        -1.410683602522958324e+00_rk, 1.115355071650409924e+00_rk, -1.666666666666666297e-01_rk, &
                                        -1.410683602522958324e+00_rk, 1.115355071650409924e+00_rk, -1.666666666666666297e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))

        test_dmetric_dx_etamax(:,:,2,3,2) = reshape((/                                                                                 &
                                        -2.018288737639616287e-16_rk, 1.595757245320793663e-16_rk, -2.384528009481806200e-17_rk, &
                                        -2.018288737639616287e-16_rk, 1.595757245320793663e-16_rk, -2.384528009481806200e-17_rk, &
                                        -1.995007882905305063e+00_rk, 1.577350269189625509e+00_rk, -2.357022603955158668e-01_rk  &
                                        /),(/3,3/))

        test_dmetric_dx_etamax(:,:,2,3,3) = reshape((/                                                                                 &
                                        -1.410683602522958768e+00_rk, 1.115355071650410368e+00_rk, -1.666666666666667129e-01_rk, &
                                        1.410683602522958768e+00_rk, -1.115355071650410368e+00_rk, 1.666666666666667129e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))

        test_dmetric_dx_etamax(:,:,2,4,1) = reshape((/                                                                                 &
                                        6.220084679281459028e-01_rk, 2.988584907226845555e-01_rk, 9.553418012614793842e-01_rk, &
                                        6.220084679281459028e-01_rk, 2.988584907226845555e-01_rk, 9.553418012614793842e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))

        test_dmetric_dx_etamax(:,:,2,4,2) = reshape((/                                                                                 &
                                        8.899179683457179257e-17_rk, 4.275818651998199686e-17_rk, 1.366823570242079166e-16_rk, &
                                        8.899179683457179257e-17_rk, 4.275818651998199686e-17_rk, 1.366823570242079166e-16_rk, &
                                        8.796528112548944733e-01_rk, 4.226497308103744355e-01_rk, 1.351057332045926485e+00_rk  &
                                        /),(/3,3/))

        test_dmetric_dx_etamax(:,:,2,4,3) = reshape((/                                                                                 &
                                        6.220084679281460138e-01_rk, 2.988584907226846665e-01_rk, 9.553418012614796062e-01_rk, &
                                        -6.220084679281460138e-01_rk, -2.988584907226846665e-01_rk, -9.553418012614796062e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))

        test_dmetric_dx_etamax(:,:,2,5,1) = reshape((/                                                                                 &
                                        4.465819873852042154e-02_rk, 5.551115123125782702e-17_rk, -4.465819873852044930e-02_rk, &
                                        4.465819873852042154e-02_rk, 5.551115123125782702e-17_rk, -4.465819873852044930e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))

        test_dmetric_dx_etamax(:,:,2,5,2) = reshape((/                                                                                 &
                                        6.389323544700418445e-18_rk, 6.162975822039154730e-33_rk, -6.389323544700426148e-18_rk, &
                                        6.389323544700418445e-18_rk, 6.162975822039154730e-33_rk, -6.389323544700426148e-18_rk, &
                                        6.315623032716871643e-02_rk, 0.000000000000000000e+00_rk, -6.315623032716868868e-02_rk  &
                                        /),(/3,3/))

        test_dmetric_dx_etamax(:,:,2,5,3) = reshape((/                                                                                 &
                                        4.465819873852047706e-02_rk, 5.551115123125782702e-17_rk, -4.465819873852047706e-02_rk, &
                                        -4.465819873852047706e-02_rk, -5.551115123125782702e-17_rk, 4.465819873852047706e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))

        test_dmetric_dx_etamax(:,:,2,6,1) = reshape((/                                                                                 &
                                        1.666666666666666019e-01_rk, 2.775557561562891351e-17_rk, -1.666666666666666019e-01_rk, &
                                        1.666666666666666019e-01_rk, 2.775557561562891351e-17_rk, -1.666666666666666019e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))

        test_dmetric_dx_etamax(:,:,2,6,2) = reshape((/                                                                                 &
                                        2.384528009481805584e-17_rk, 0.000000000000000000e+00_rk, -2.384528009481806200e-17_rk, &
                                        2.384528009481805584e-17_rk, 0.000000000000000000e+00_rk, -2.384528009481806200e-17_rk, &
                                        2.357022603955157281e-01_rk, 0.000000000000000000e+00_rk, -2.357022603955158668e-01_rk  &
                                        /),(/3,3/))

        test_dmetric_dx_etamax(:,:,2,6,3) = reshape((/                                                                                 &
                                        1.666666666666666019e-01_rk, 8.326672684688674053e-17_rk, -1.666666666666667684e-01_rk, &
                                        -1.666666666666666019e-01_rk, -8.326672684688674053e-17_rk, 1.666666666666667684e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))

        test_dmetric_dx_etamax(:,:,2,7,1) = reshape((/                                                                                 &
                                        -3.779915320718537641e-01_rk, -1.115355071650410368e+00_rk, -4.465819873852044930e-02_rk, &
                                        -3.779915320718537641e-01_rk, -1.115355071650410368e+00_rk, -4.465819873852044930e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))

        test_dmetric_dx_etamax(:,:,2,7,2) = reshape((/                                                                                 &
                                        -5.407988373433651779e-17_rk, -1.595757245320794156e-16_rk, -6.389323544700426148e-18_rk, &
                                        -5.407988373433651779e-17_rk, -1.595757245320794156e-16_rk, -6.389323544700426148e-18_rk, &
                                        -5.345607511182002280e-01_rk, -1.577350269189625731e+00_rk, -6.315623032716868868e-02_rk  &
                                        /),(/3,3/))

        test_dmetric_dx_etamax(:,:,2,7,3) = reshape((/                                                                                 &
                                        -3.779915320718536531e-01_rk, -1.115355071650410812e+00_rk, -4.465819873852047706e-02_rk, &
                                        3.779915320718536531e-01_rk, 1.115355071650410812e+00_rk, 4.465819873852047706e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))

        test_dmetric_dx_etamax(:,:,2,8,1) = reshape((/                                                                                 &
                                        1.666666666666666019e-01_rk, -2.988584907226844445e-01_rk, 2.559830641437075283e-01_rk, &
                                        1.666666666666666019e-01_rk, -2.988584907226844445e-01_rk, 2.559830641437075283e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))

        test_dmetric_dx_etamax(:,:,2,8,2) = reshape((/                                                                                 &
                                        2.384528009481805584e-17_rk, -4.275818651998197221e-17_rk, 3.662392718421891121e-17_rk, &
                                        2.384528009481805584e-17_rk, -4.275818651998197221e-17_rk, 3.662392718421891121e-17_rk, &
                                        2.357022603955157281e-01_rk, -4.226497308103742134e-01_rk, 3.620147210498532164e-01_rk  &
                                        /),(/3,3/))

        test_dmetric_dx_etamax(:,:,2,8,3) = reshape((/                                                                                 &
                                        1.666666666666666019e-01_rk, -2.988584907226845555e-01_rk, 2.559830641437076948e-01_rk, &
                                        -1.666666666666666019e-01_rk, 2.988584907226845555e-01_rk, -2.559830641437076948e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))

        test_dmetric_dx_etamax(:,:,3,1,1) = reshape((/                                                                                 &
                                        1.666666666666666019e-01_rk, -2.775557561562891351e-17_rk, -1.666666666666667962e-01_rk, &
                                        1.666666666666666019e-01_rk, -2.775557561562891351e-17_rk, -1.666666666666667962e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))

        test_dmetric_dx_etamax(:,:,3,1,2) = reshape((/                                                                                 &
                                        1.316215405935382217e-17_rk, 0.000000000000000000e+00_rk, -1.316215405935381755e-17_rk, &
                                        1.316215405935382217e-17_rk, 0.000000000000000000e+00_rk, -1.316215405935381755e-17_rk, &
                                        2.357022603955158391e-01_rk, 0.000000000000000000e+00_rk, -2.357022603955158946e-01_rk  &
                                        /),(/3,3/))

        test_dmetric_dx_etamax(:,:,3,1,3) = reshape((/                                                                                 &
                                        1.666666666666666019e-01_rk, -2.775557561562891351e-17_rk, -1.666666666666667962e-01_rk, &
                                        -1.666666666666667684e-01_rk, -2.775557561562891351e-17_rk, 1.666666666666667684e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))

        test_dmetric_dx_etamax(:,:,3,2,1) = reshape((/                                                                                 &
                                        4.465819873852044930e-02_rk, 0.000000000000000000e+00_rk, -4.465819873852044930e-02_rk, &
                                        4.465819873852044930e-02_rk, 0.000000000000000000e+00_rk, -4.465819873852044930e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))

        test_dmetric_dx_etamax(:,:,3,2,2) = reshape((/                                                                                 &
                                        3.526788550857878558e-18_rk, 0.000000000000000000e+00_rk, -3.526788550857883181e-18_rk, &
                                        3.526788550857878558e-18_rk, 0.000000000000000000e+00_rk, -3.526788550857883181e-18_rk, &
                                        6.315623032716867480e-02_rk, -5.551115123125782702e-17_rk, -6.315623032716866092e-02_rk  &
                                        /),(/3,3/))

        test_dmetric_dx_etamax(:,:,3,2,3) = reshape((/                                                                                 &
                                        4.465819873852044930e-02_rk, 0.000000000000000000e+00_rk, -4.465819873852044930e-02_rk, &
                                        -4.465819873852047706e-02_rk, 0.000000000000000000e+00_rk, 4.465819873852056032e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))

        test_dmetric_dx_etamax(:,:,3,3,1) = reshape((/                                                                                 &
                                        -2.559830641437075283e-01_rk, 2.988584907226845555e-01_rk, -1.666666666666666297e-01_rk, &
                                        -2.559830641437075283e-01_rk, 2.988584907226845555e-01_rk, -1.666666666666666297e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))

        test_dmetric_dx_etamax(:,:,3,3,2) = reshape((/                                                                                 &
                                        -2.021573116106957774e-17_rk, 2.360172898102762969e-17_rk, -1.316215405935381755e-17_rk, &
                                        -2.021573116106957774e-17_rk, 2.360172898102762969e-17_rk, -1.316215405935381755e-17_rk, &
                                        -3.620147210498532719e-01_rk, 4.226497308103741579e-01_rk, -2.357022603955158946e-01_rk  &
                                        /),(/3,3/))

        test_dmetric_dx_etamax(:,:,3,3,3) = reshape((/                                                                                 &
                                        -2.559830641437075283e-01_rk, 2.988584907226845555e-01_rk, -1.666666666666666297e-01_rk, &
                                        2.559830641437076948e-01_rk, -2.988584907226845555e-01_rk, 1.666666666666666574e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))

        test_dmetric_dx_etamax(:,:,3,4,1) = reshape((/                                                                                 &
                                        4.465819873852044930e-02_rk, 1.115355071650410368e+00_rk, 3.779915320718538196e-01_rk, &
                                        4.465819873852044930e-02_rk, 1.115355071650410368e+00_rk, 3.779915320718538196e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))

        test_dmetric_dx_etamax(:,:,3,4,2) = reshape((/                                                                                 &
                                        3.526788550857878558e-18_rk, 8.808285170366592959e-17_rk, 2.985109666956551519e-17_rk, &
                                        3.526788550857878558e-18_rk, 8.808285170366592959e-17_rk, 2.985109666956551519e-17_rk, &
                                        6.315623032716867480e-02_rk, 1.577350269189625731e+00_rk, 5.345607511182004501e-01_rk  &
                                        /),(/3,3/))

        test_dmetric_dx_etamax(:,:,3,4,3) = reshape((/                                                                                 &
                                        4.465819873852044930e-02_rk, 1.115355071650410368e+00_rk, 3.779915320718538196e-01_rk, &
                                        -4.465819873852047706e-02_rk, -1.115355071650410812e+00_rk, -3.779915320718540972e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))

        test_dmetric_dx_etamax(:,:,3,5,1) = reshape((/                                                                                 &
                                        6.220084679281461248e-01_rk, 2.775557561562891351e-17_rk, -6.220084679281463469e-01_rk, &
                                        6.220084679281461248e-01_rk, 2.775557561562891351e-17_rk, -6.220084679281463469e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))

        test_dmetric_dx_etamax(:,:,3,5,2) = reshape((/                                                                                 &
                                        4.912182768655739625e-17_rk, 0.000000000000000000e+00_rk, -4.912182768655740858e-17_rk, &
                                        4.912182768655739625e-17_rk, 0.000000000000000000e+00_rk, -4.912182768655740858e-17_rk, &
                                        8.796528112548944733e-01_rk, 1.110223024625156540e-16_rk, -8.796528112548949174e-01_rk  &
                                        /),(/3,3/))

        test_dmetric_dx_etamax(:,:,3,5,3) = reshape((/                                                                                 &
                                        6.220084679281461248e-01_rk, 2.775557561562891351e-17_rk, -6.220084679281463469e-01_rk, &
                                        -6.220084679281463469e-01_rk, 2.775557561562891351e-17_rk, 6.220084679281464579e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))

        test_dmetric_dx_etamax(:,:,3,6,1) = reshape((/                                                                                 &
                                        1.666666666666666297e-01_rk, 0.000000000000000000e+00_rk, -1.666666666666666852e-01_rk, &
                                        1.666666666666666297e-01_rk, 0.000000000000000000e+00_rk, -1.666666666666666852e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))

        test_dmetric_dx_etamax(:,:,3,6,2) = reshape((/                                                                                 &
                                        1.316215405935381909e-17_rk, 0.000000000000000000e+00_rk, -1.316215405935382371e-17_rk, &
                                        1.316215405935381909e-17_rk, 0.000000000000000000e+00_rk, -1.316215405935382371e-17_rk, &
                                        2.357022603955158391e-01_rk, 0.000000000000000000e+00_rk, -2.357022603955158946e-01_rk  &
                                        /),(/3,3/))

        test_dmetric_dx_etamax(:,:,3,6,3) = reshape((/                                                                                 &
                                        1.666666666666666297e-01_rk, 0.000000000000000000e+00_rk, -1.666666666666666852e-01_rk, &
                                        -1.666666666666667129e-01_rk, 0.000000000000000000e+00_rk, 1.666666666666667684e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))

        test_dmetric_dx_etamax(:,:,3,7,1) = reshape((/                                                                                 &
                                        -9.553418012614793842e-01_rk, -2.988584907226845555e-01_rk, -6.220084679281461248e-01_rk, &
                                        -9.553418012614793842e-01_rk, -2.988584907226845555e-01_rk, -6.220084679281461248e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))

        test_dmetric_dx_etamax(:,:,3,7,2) = reshape((/                                                                                 &
                                        -7.544613580526503751e-17_rk, -2.360172898102762969e-17_rk, -4.912182768655738392e-17_rk, &
                                        -7.544613580526503751e-17_rk, -2.360172898102762969e-17_rk, -4.912182768655738392e-17_rk, &
                                        -1.351057332045926263e+00_rk, -4.226497308103742689e-01_rk, -8.796528112548944733e-01_rk  &
                                        /),(/3,3/))

        test_dmetric_dx_etamax(:,:,3,7,3) = reshape((/                                                                                 &
                                        -9.553418012614793842e-01_rk, -2.988584907226845555e-01_rk, -6.220084679281461248e-01_rk, &
                                        9.553418012614796062e-01_rk, 2.988584907226845555e-01_rk, 6.220084679281463469e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))

        test_dmetric_dx_etamax(:,:,3,8,1) = reshape((/                                                                                 &
                                        1.666666666666666297e-01_rk, -1.115355071650410368e+00_rk, 1.410683602522959212e+00_rk, &
                                        1.666666666666666297e-01_rk, -1.115355071650410368e+00_rk, 1.410683602522959212e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))

        test_dmetric_dx_etamax(:,:,3,8,2) = reshape((/                                                                                 &
                                        1.316215405935381909e-17_rk, -8.808285170366592959e-17_rk, 1.114058094324686255e-16_rk, &
                                        1.316215405935381909e-17_rk, -8.808285170366592959e-17_rk, 1.114058094324686255e-16_rk, &
                                        2.357022603955158391e-01_rk, -1.577350269189625731e+00_rk, 1.995007882905305507e+00_rk  &
                                        /),(/3,3/))

        test_dmetric_dx_etamax(:,:,3,8,3) = reshape((/                                                                                 &
                                        1.666666666666666297e-01_rk, -1.115355071650410368e+00_rk, 1.410683602522959212e+00_rk, &
                                        -1.666666666666667129e-01_rk, 1.115355071650410812e+00_rk, -1.410683602522959657e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))

        test_dmetric_dx_etamax(:,:,4,1,1) = reshape((/                                                                                 &
                                        4.465819873852047706e-02_rk, 5.551115123125782702e-17_rk, -4.465819873852046318e-02_rk, &
                                        4.465819873852036603e-02_rk, 5.551115123125782702e-17_rk, -4.465819873852044930e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))

        test_dmetric_dx_etamax(:,:,4,1,2) = reshape((/                                                                                 &
                                        6.389323544700415363e-18_rk, 6.162975822039154730e-33_rk, -6.389323544700427689e-18_rk, &
                                        6.389323544700415363e-18_rk, 6.162975822039154730e-33_rk, -6.389323544700429230e-18_rk, &
                                        6.315623032716877194e-02_rk, -5.551115123125782702e-17_rk, -6.315623032716866092e-02_rk  &
                                        /),(/3,3/))

        test_dmetric_dx_etamax(:,:,4,1,3) = reshape((/                                                                                 &
                                        4.465819873852047706e-02_rk, 5.551115123125782702e-17_rk, -4.465819873852046318e-02_rk, &
                                        -4.465819873852042154e-02_rk, -5.551115123125782702e-17_rk, 4.465819873852044930e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))

        test_dmetric_dx_etamax(:,:,4,2,1) = reshape((/                                                                                 &
                                        1.666666666666666852e-01_rk, 5.551115123125782702e-17_rk, -1.666666666666666297e-01_rk, &
                                        1.666666666666666019e-01_rk, 2.775557561562891351e-17_rk, -1.666666666666666574e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))

        test_dmetric_dx_etamax(:,:,4,2,2) = reshape((/                                                                                 &
                                        2.384528009481806816e-17_rk, 6.162975822039154730e-33_rk, -2.384528009481807124e-17_rk, &
                                        2.384528009481805584e-17_rk, 0.000000000000000000e+00_rk, -2.384528009481806816e-17_rk, &
                                        2.357022603955156725e-01_rk, -5.551115123125782702e-17_rk, -2.357022603955158946e-01_rk  &
                                        /),(/3,3/))

        test_dmetric_dx_etamax(:,:,4,2,3) = reshape((/                                                                                 &
                                        1.666666666666666852e-01_rk, 5.551115123125782702e-17_rk, -1.666666666666666297e-01_rk, &
                                        -1.666666666666666852e-01_rk, -8.326672684688674053e-17_rk, 1.666666666666666297e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))

        test_dmetric_dx_etamax(:,:,4,3,1) = reshape((/                                                                                 &
                                        -3.779915320718537641e-01_rk, 1.115355071650410368e+00_rk, -4.465819873852040767e-02_rk, &
                                        -3.779915320718537641e-01_rk, 1.115355071650410146e+00_rk, -4.465819873852044930e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))

        test_dmetric_dx_etamax(:,:,4,3,2) = reshape((/                                                                                 &
                                        -5.407988373433655477e-17_rk, 1.595757245320794402e-16_rk, -6.389323544700427689e-18_rk, &
                                        -5.407988373433651779e-17_rk, 1.595757245320793663e-16_rk, -6.389323544700419985e-18_rk, &
                                        -5.345607511182001170e-01_rk, 1.577350269189625509e+00_rk, -6.315623032716863317e-02_rk  &
                                        /),(/3,3/))

        test_dmetric_dx_etamax(:,:,4,3,3) = reshape((/                                                                                 &
                                        -3.779915320718537641e-01_rk, 1.115355071650410368e+00_rk, -4.465819873852040767e-02_rk, &
                                        3.779915320718537086e-01_rk, -1.115355071650410590e+00_rk, 4.465819873852042154e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))

        test_dmetric_dx_etamax(:,:,4,4,1) = reshape((/                                                                                 &
                                        1.666666666666666297e-01_rk, 2.988584907226845000e-01_rk, 2.559830641437075283e-01_rk, &
                                        1.666666666666666574e-01_rk, 2.988584907226844445e-01_rk, 2.559830641437076393e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))

        test_dmetric_dx_etamax(:,:,4,4,2) = reshape((/                                                                                 &
                                        2.384528009481806816e-17_rk, 4.275818651998200302e-17_rk, 3.662392718421892354e-17_rk, &
                                        2.384528009481805584e-17_rk, 4.275818651998199686e-17_rk, 3.662392718421890505e-17_rk, &
                                        2.357022603955158946e-01_rk, 4.226497308103742134e-01_rk, 3.620147210498531054e-01_rk  &
                                        /),(/3,3/))

        test_dmetric_dx_etamax(:,:,4,4,3) = reshape((/                                                                                 &
                                        1.666666666666666297e-01_rk, 2.988584907226845000e-01_rk, 2.559830641437075283e-01_rk, &
                                        -1.666666666666666852e-01_rk, -2.988584907226845555e-01_rk, -2.559830641437076393e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))

        test_dmetric_dx_etamax(:,:,4,5,1) = reshape((/                                                                                 &
                                        1.666666666666666297e-01_rk, 5.551115123125782702e-17_rk, -1.666666666666666852e-01_rk, &
                                        1.666666666666665464e-01_rk, 5.551115123125782702e-17_rk, -1.666666666666666297e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))

        test_dmetric_dx_etamax(:,:,4,5,2) = reshape((/                                                                                 &
                                        2.384528009481804351e-17_rk, 6.162975822039154730e-33_rk, -2.384528009481806508e-17_rk, &
                                        2.384528009481805584e-17_rk, 6.162975822039154730e-33_rk, -2.384528009481806200e-17_rk, &
                                        2.357022603955157836e-01_rk, 5.551115123125782702e-17_rk, -2.357022603955158668e-01_rk  &
                                        /),(/3,3/))

        test_dmetric_dx_etamax(:,:,4,5,3) = reshape((/                                                                                 &
                                        1.666666666666666297e-01_rk, 5.551115123125782702e-17_rk, -1.666666666666666852e-01_rk, &
                                        -1.666666666666665741e-01_rk, -5.551115123125782702e-17_rk, 1.666666666666667129e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))

        test_dmetric_dx_etamax(:,:,4,6,1) = reshape((/                                                                                 &
                                        6.220084679281460138e-01_rk, 5.551115123125782702e-17_rk, -6.220084679281462359e-01_rk, &
                                        6.220084679281460138e-01_rk, 8.326672684688674053e-17_rk, -6.220084679281461248e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))

        test_dmetric_dx_etamax(:,:,4,6,2) = reshape((/                                                                                 &
                                        8.899179683457182955e-17_rk, 6.162975822039154730e-33_rk, -8.899179683457182955e-17_rk, &
                                        8.899179683457179257e-17_rk, 0.000000000000000000e+00_rk, -8.899179683457182955e-17_rk, &
                                        8.796528112548944733e-01_rk, 5.551115123125782702e-17_rk, -8.796528112548946954e-01_rk  &
                                        /),(/3,3/))

        test_dmetric_dx_etamax(:,:,4,6,3) = reshape((/                                                                                 &
                                        6.220084679281460138e-01_rk, 5.551115123125782702e-17_rk, -6.220084679281462359e-01_rk, &
                                        -6.220084679281461248e-01_rk, -2.775557561562891351e-17_rk, 6.220084679281462359e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))

        test_dmetric_dx_etamax(:,:,4,7,1) = reshape((/                                                                                 &
                                        -1.410683602522958768e+00_rk, -1.115355071650410590e+00_rk, -1.666666666666665186e-01_rk, &
                                        -1.410683602522958324e+00_rk, -1.115355071650410590e+00_rk, -1.666666666666665186e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))

        test_dmetric_dx_etamax(:,:,4,7,2) = reshape((/                                                                                 &
                                        -2.018288737639617026e-16_rk, -1.595757245320794895e-16_rk, -2.384528009481806508e-17_rk, &
                                        -2.018288737639616287e-16_rk, -1.595757245320794156e-16_rk, -2.384528009481804351e-17_rk, &
                                        -1.995007882905305063e+00_rk, -1.577350269189625953e+00_rk, -2.357022603955156725e-01_rk  &
                                        /),(/3,3/))

        test_dmetric_dx_etamax(:,:,4,7,3) = reshape((/                                                                                 &
                                        -1.410683602522958768e+00_rk, -1.115355071650410590e+00_rk, -1.666666666666665186e-01_rk, &
                                        1.410683602522958768e+00_rk, 1.115355071650410812e+00_rk, 1.666666666666665464e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))

        test_dmetric_dx_etamax(:,:,4,8,1) = reshape((/                                                                                 &
                                        6.220084679281461248e-01_rk, -2.988584907226843890e-01_rk, 9.553418012614793842e-01_rk, &
                                        6.220084679281459028e-01_rk, -2.988584907226843335e-01_rk, 9.553418012614792731e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))

        test_dmetric_dx_etamax(:,:,4,8,2) = reshape((/                                                                                 &
                                        8.899179683457182955e-17_rk, -4.275818651998199070e-17_rk, 1.366823570242079412e-16_rk, &
                                        8.899179683457179257e-17_rk, -4.275818651998197221e-17_rk, 1.366823570242079166e-16_rk, &
                                        8.796528112548946954e-01_rk, -4.226497308103739914e-01_rk, 1.351057332045926263e+00_rk  &
                                        /),(/3,3/))

        test_dmetric_dx_etamax(:,:,4,8,3) = reshape((/                                                                                 &
                                        6.220084679281461248e-01_rk, -2.988584907226843890e-01_rk, 9.553418012614793842e-01_rk, &
                                        -6.220084679281461248e-01_rk, 2.988584907226844445e-01_rk, -9.553418012614794952e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))

        
        
        
        
        
        do inode = 1,self%elem%basis_s%nnodes_face()
            do inode_diff = 1,self%elem%nterms_c
                do idir = 1,3
                    @assertEqual(transpose(test_dmetric_dx_etamax(:,:,inode,inode_diff,idir)),self%faces(ETA_MAX)%dmetric_dx(:,:,inode,inode_diff,idir),tol)
                end do
            end do
        end do

    end subroutine testElement_face_dmetrics_dx_etamax
    !*******************************************************************************************







    !>
    !!
    !!
    !------------------------------------------------------------------------------------------
    @Test
    subroutine testElement_face_dmetrics_dx_zetamax(self)
        class(test_element_linearC_dx),    intent(inout)   :: self
        real(rk)    :: test_dmetric_dx_zetamax(3,3,self%faces(ZETA_MAX)%basis_s%nnodes_face(),self%elem%nterms_c,3)
        real(rk)    :: tol = 1.e-13_rk
        
        integer(ik)     :: inode_diff, idir, inode, irow
        
       
        test_dmetric_dx_zetamax(:,:,1,1,1) = reshape((/                                                                                 &
                                        1.110223024625156540e-16_rk, 8.796528112548948064e-01_rk, 0.000000000000000000e+00_rk, &
                                        1.110223024625156540e-16_rk, 8.796528112548948064e-01_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))

        test_dmetric_dx_zetamax(:,:,1,1,2) = reshape((/                                                                                 &
                                        3.851859888774471706e-34_rk, -7.554110863947321095e-18_rk, 1.925929944387235853e-34_rk, &
                                        3.851859888774471706e-34_rk, -7.554110863947321095e-18_rk, 1.925929944387235853e-34_rk, &
                                        5.551115123125782702e-17_rk, 1.244016935856292472e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))

        test_dmetric_dx_zetamax(:,:,1,1,3) = reshape((/                                                                                 &
                                        1.110223024625156540e-16_rk, 8.796528112548949174e-01_rk, 2.775557561562891351e-17_rk, &
                                        0.000000000000000000e+00_rk, -8.796528112548945844e-01_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))

        test_dmetric_dx_zetamax(:,:,1,2,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 2.357022603955158668e-01_rk, 8.326672684688674053e-17_rk, &
                                        0.000000000000000000e+00_rk, 2.357022603955158668e-01_rk, 8.326672684688674053e-17_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))

        test_dmetric_dx_zetamax(:,:,1,2,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, -2.024117905529855554e-18_rk, -5.777789833161707559e-34_rk, &
                                        0.000000000000000000e+00_rk, -2.024117905529855554e-18_rk, -5.777789833161707559e-34_rk, &
                                        0.000000000000000000e+00_rk, 3.333333333333333703e-01_rk, -5.551115123125782702e-17_rk  &
                                        /),(/3,3/))

        test_dmetric_dx_zetamax(:,:,1,2,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 2.357022603955158946e-01_rk, -2.775557561562891351e-17_rk, &
                                        0.000000000000000000e+00_rk, -2.357022603955158391e-01_rk, -5.551115123125782702e-17_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))

        test_dmetric_dx_zetamax(:,:,1,3,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 6.315623032716868868e-02_rk, -2.775557561562891351e-17_rk, &
                                        0.000000000000000000e+00_rk, 6.315623032716868868e-02_rk, -2.775557561562891351e-17_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))

        test_dmetric_dx_zetamax(:,:,1,3,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, -5.423607581721005448e-19_rk, 1.925929944387235853e-34_rk, &
                                        0.000000000000000000e+00_rk, -5.423607581721005448e-19_rk, 1.925929944387235853e-34_rk, &
                                        0.000000000000000000e+00_rk, 8.931639747704092636e-02_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))

        test_dmetric_dx_zetamax(:,:,1,3,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 6.315623032716871643e-02_rk, 2.775557561562891351e-17_rk, &
                                        0.000000000000000000e+00_rk, -6.315623032716867480e-02_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))

        test_dmetric_dx_zetamax(:,:,1,4,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 2.357022603955158668e-01_rk, -2.775557561562891351e-17_rk, &
                                        0.000000000000000000e+00_rk, 2.357022603955158668e-01_rk, -2.775557561562891351e-17_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))

        test_dmetric_dx_zetamax(:,:,1,4,2) = reshape((/                                                                                 &
                                        -3.851859888774471706e-34_rk, -2.024117905529855554e-18_rk, 1.925929944387235853e-34_rk, &
                                        -3.851859888774471706e-34_rk, -2.024117905529855554e-18_rk, 1.925929944387235853e-34_rk, &
                                        -5.551115123125782702e-17_rk, 3.333333333333333703e-01_rk, -5.551115123125782702e-17_rk  &
                                        /),(/3,3/))

        test_dmetric_dx_zetamax(:,:,1,4,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 2.357022603955158946e-01_rk, 8.326672684688674053e-17_rk, &
                                        0.000000000000000000e+00_rk, -2.357022603955158391e-01_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))

        test_dmetric_dx_zetamax(:,:,1,5,1) = reshape((/                                                                                 &
                                        1.577350269189625953e+00_rk, -8.796528112548948064e-01_rk, 1.387778780781445676e-16_rk, &
                                        1.577350269189625953e+00_rk, -8.796528112548948064e-01_rk, 1.387778780781445676e-16_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))

        test_dmetric_dx_zetamax(:,:,1,5,2) = reshape((/                                                                                 &
                                        -1.354566102930678280e-17_rk, 7.554110863947321095e-18_rk, -9.629649721936179265e-34_rk, &
                                        -1.354566102930678280e-17_rk, 7.554110863947321095e-18_rk, -9.629649721936179265e-34_rk, &
                                        2.230710143300821180e+00_rk, -1.244016935856292472e+00_rk, 3.330669073875469621e-16_rk  &
                                        /),(/3,3/))

        test_dmetric_dx_zetamax(:,:,1,5,3) = reshape((/                                                                                 &
                                        1.577350269189625953e+00_rk, -8.796528112548949174e-01_rk, 1.942890293094023946e-16_rk, &
                                        -1.577350269189625731e+00_rk, 8.796528112548945844e-01_rk, -3.330669073875469621e-16_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))

        test_dmetric_dx_zetamax(:,:,1,6,1) = reshape((/                                                                                 &
                                        -5.773502691896258421e-01_rk, -2.357022603955158668e-01_rk, -1.000000000000000000e+00_rk, &
                                        -5.773502691896258421e-01_rk, -2.357022603955158668e-01_rk, -1.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))

        test_dmetric_dx_zetamax(:,:,1,6,2) = reshape((/                                                                                 &
                                        4.958056047779149272e-18_rk, 2.024117905529855554e-18_rk, 8.587604981527633525e-18_rk, &
                                        4.958056047779149272e-18_rk, 2.024117905529855554e-18_rk, 8.587604981527633525e-18_rk, &
                                        -8.164965809277260345e-01_rk, -3.333333333333333703e-01_rk, -1.414213562373095145e+00_rk  &
                                        /),(/3,3/))

        test_dmetric_dx_zetamax(:,:,1,6,3) = reshape((/                                                                                 &
                                        -5.773502691896258421e-01_rk, -2.357022603955158946e-01_rk, -1.000000000000000444e+00_rk, &
                                        5.773502691896257311e-01_rk, 2.357022603955158391e-01_rk, 1.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))

        test_dmetric_dx_zetamax(:,:,1,7,1) = reshape((/                                                                                 &
                                        -4.226497308103744355e-01_rk, -6.315623032716868868e-02_rk, -8.326672684688674053e-17_rk, &
                                        -4.226497308103744355e-01_rk, -6.315623032716868868e-02_rk, -8.326672684688674053e-17_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))

        test_dmetric_dx_zetamax(:,:,1,7,2) = reshape((/                                                                                 &
                                        3.629548933748484253e-18_rk, 5.423607581721005448e-19_rk, 5.777789833161707559e-34_rk, &
                                        3.629548933748484253e-18_rk, 5.423607581721005448e-19_rk, 5.777789833161707559e-34_rk, &
                                        -5.977169814453690000e-01_rk, -8.931639747704092636e-02_rk, -1.110223024625156540e-16_rk  &
                                        /),(/3,3/))

        test_dmetric_dx_zetamax(:,:,1,7,3) = reshape((/                                                                                 &
                                        -4.226497308103744355e-01_rk, -6.315623032716871643e-02_rk, -2.775557561562891351e-17_rk, &
                                        4.226497308103742689e-01_rk, 6.315623032716867480e-02_rk, 1.110223024625156540e-16_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))

        test_dmetric_dx_zetamax(:,:,1,8,1) = reshape((/                                                                                 &
                                        -5.773502691896258421e-01_rk, -2.357022603955158668e-01_rk, 1.000000000000000000e+00_rk, &
                                        -5.773502691896258421e-01_rk, -2.357022603955158668e-01_rk, 1.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))

        test_dmetric_dx_zetamax(:,:,1,8,2) = reshape((/                                                                                 &
                                        4.958056047779150042e-18_rk, 2.024117905529855554e-18_rk, -8.587604981527633525e-18_rk, &
                                        4.958056047779150042e-18_rk, 2.024117905529855554e-18_rk, -8.587604981527633525e-18_rk, &
                                        -8.164965809277260345e-01_rk, -3.333333333333333703e-01_rk, 1.414213562373095145e+00_rk  &
                                        /),(/3,3/))

        test_dmetric_dx_zetamax(:,:,1,8,3) = reshape((/                                                                                 &
                                        -5.773502691896258421e-01_rk, -2.357022603955158946e-01_rk, 1.000000000000000444e+00_rk, &
                                        5.773502691896257311e-01_rk, 2.357022603955158391e-01_rk, -1.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))

        test_dmetric_dx_zetamax(:,:,2,1,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 2.357022603955158113e-01_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 2.357022603955158113e-01_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))

        test_dmetric_dx_zetamax(:,:,2,1,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 1.308410382236479049e-17_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 1.308410382236479049e-17_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 3.333333333333333703e-01_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))

        test_dmetric_dx_zetamax(:,:,2,1,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 2.357022603955158391e-01_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, -2.357022603955157836e-01_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))

        test_dmetric_dx_zetamax(:,:,2,2,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 8.796528112548946954e-01_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 8.796528112548946954e-01_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))

        test_dmetric_dx_zetamax(:,:,2,2,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 4.883054023657155659e-17_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 4.883054023657155659e-17_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 1.244016935856292472e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))

        test_dmetric_dx_zetamax(:,:,2,2,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 8.796528112548948064e-01_rk, -5.551115123125782702e-17_rk, &
                                        0.000000000000000000e+00_rk, -8.796528112548946954e-01_rk, 5.551115123125782702e-17_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))

        test_dmetric_dx_zetamax(:,:,2,3,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 2.357022603955159223e-01_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 2.357022603955159223e-01_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))

        test_dmetric_dx_zetamax(:,:,2,3,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 1.308410382236479665e-17_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 1.308410382236479665e-17_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 3.333333333333333703e-01_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))

        test_dmetric_dx_zetamax(:,:,2,3,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 2.357022603955159501e-01_rk, 5.551115123125782702e-17_rk, &
                                        0.000000000000000000e+00_rk, -2.357022603955159501e-01_rk, -5.551115123125782702e-17_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))

        test_dmetric_dx_zetamax(:,:,2,4,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 6.315623032716868868e-02_rk, -5.551115123125782702e-17_rk, &
                                        0.000000000000000000e+00_rk, 6.315623032716868868e-02_rk, -5.551115123125782702e-17_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))

        test_dmetric_dx_zetamax(:,:,2,4,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 3.505875052887613068e-18_rk, -3.081487911019577365e-33_rk, &
                                        0.000000000000000000e+00_rk, 3.505875052887613068e-18_rk, -3.081487911019577365e-33_rk, &
                                        0.000000000000000000e+00_rk, 8.931639747704092636e-02_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))

        test_dmetric_dx_zetamax(:,:,2,4,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 6.315623032716871643e-02_rk, 5.551115123125782702e-17_rk, &
                                        0.000000000000000000e+00_rk, -6.315623032716867480e-02_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))

        test_dmetric_dx_zetamax(:,:,2,5,1) = reshape((/                                                                                 &
                                        1.000000000000000222e+00_rk, -2.357022603955158113e-01_rk, 5.773502691896258421e-01_rk, &
                                        1.000000000000000222e+00_rk, -2.357022603955158113e-01_rk, 5.773502691896258421e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))

        test_dmetric_dx_zetamax(:,:,2,5,2) = reshape((/                                                                                 &
                                        5.551115123125783935e-17_rk, -1.308410382236479049e-17_rk, 3.204937810639273644e-17_rk, &
                                        5.551115123125783935e-17_rk, -1.308410382236479049e-17_rk, 3.204937810639273644e-17_rk, &
                                        1.414213562373095145e+00_rk, -3.333333333333333703e-01_rk, 8.164965809277262565e-01_rk  &
                                        /),(/3,3/))

        test_dmetric_dx_zetamax(:,:,2,5,3) = reshape((/                                                                                 &
                                        1.000000000000000222e+00_rk, -2.357022603955158391e-01_rk, 5.773502691896259531e-01_rk, &
                                        -1.000000000000000000e+00_rk, 2.357022603955157836e-01_rk, -5.773502691896259531e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))

        test_dmetric_dx_zetamax(:,:,2,6,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, -8.796528112548946954e-01_rk, -1.577350269189625731e+00_rk, &
                                        0.000000000000000000e+00_rk, -8.796528112548946954e-01_rk, -1.577350269189625731e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))

        test_dmetric_dx_zetamax(:,:,2,6,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, -4.883054023657155659e-17_rk, -8.756052933765055729e-17_rk, &
                                        0.000000000000000000e+00_rk, -4.883054023657155659e-17_rk, -8.756052933765055729e-17_rk, &
                                        0.000000000000000000e+00_rk, -1.244016935856292472e+00_rk, -2.230710143300821180e+00_rk  &
                                        /),(/3,3/))

        test_dmetric_dx_zetamax(:,:,2,6,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, -8.796528112548948064e-01_rk, -1.577350269189626175e+00_rk, &
                                        0.000000000000000000e+00_rk, 8.796528112548946954e-01_rk, 1.577350269189625731e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))

        test_dmetric_dx_zetamax(:,:,2,7,1) = reshape((/                                                                                 &
                                        -1.000000000000000222e+00_rk, -2.357022603955159223e-01_rk, 5.773502691896256200e-01_rk, &
                                        -1.000000000000000222e+00_rk, -2.357022603955159223e-01_rk, 5.773502691896256200e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))

        test_dmetric_dx_zetamax(:,:,2,7,2) = reshape((/                                                                                 &
                                        -5.551115123125783935e-17_rk, -1.308410382236479665e-17_rk, 3.204937810639272411e-17_rk, &
                                        -5.551115123125783935e-17_rk, -1.308410382236479665e-17_rk, 3.204937810639272411e-17_rk, &
                                        -1.414213562373095145e+00_rk, -3.333333333333333703e-01_rk, 8.164965809277258124e-01_rk  &
                                        /),(/3,3/))

        test_dmetric_dx_zetamax(:,:,2,7,3) = reshape((/                                                                                 &
                                        -1.000000000000000222e+00_rk, -2.357022603955159501e-01_rk, 5.773502691896258421e-01_rk, &
                                        1.000000000000000000e+00_rk, 2.357022603955159501e-01_rk, -5.773502691896255090e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))

        test_dmetric_dx_zetamax(:,:,2,8,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, -6.315623032716868868e-02_rk, 4.226497308103742689e-01_rk, &
                                        0.000000000000000000e+00_rk, -6.315623032716868868e-02_rk, 4.226497308103742689e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))

        test_dmetric_dx_zetamax(:,:,2,8,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, -3.505875052887613068e-18_rk, 2.346177312486509675e-17_rk, &
                                        0.000000000000000000e+00_rk, -3.505875052887613068e-18_rk, 2.346177312486509675e-17_rk, &
                                        0.000000000000000000e+00_rk, -8.931639747704092636e-02_rk, 5.977169814453692220e-01_rk  &
                                        /),(/3,3/))

        test_dmetric_dx_zetamax(:,:,2,8,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, -6.315623032716871643e-02_rk, 4.226497308103743800e-01_rk, &
                                        0.000000000000000000e+00_rk, 6.315623032716867480e-02_rk, -4.226497308103742689e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))

        test_dmetric_dx_zetamax(:,:,3,1,1) = reshape((/                                                                                 &
                                        -2.775557561562891351e-17_rk, 2.357022603955158668e-01_rk, 5.551115123125782702e-17_rk, &
                                        -2.775557561562891351e-17_rk, 2.357022603955158391e-01_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))

        test_dmetric_dx_zetamax(:,:,3,1,2) = reshape((/                                                                                 &
                                        -1.540743955509788682e-33_rk, 1.308410382236479357e-17_rk, 3.081487911019577365e-33_rk, &
                                        -1.540743955509788682e-33_rk, 1.308410382236479203e-17_rk, 0.000000000000000000e+00_rk, &
                                        -2.775557561562891351e-17_rk, 3.333333333333333703e-01_rk, -5.551115123125782702e-17_rk  &
                                        /),(/3,3/))

        test_dmetric_dx_zetamax(:,:,3,1,3) = reshape((/                                                                                 &
                                        -2.775557561562891351e-17_rk, 2.357022603955158391e-01_rk, 0.000000000000000000e+00_rk, &
                                        2.775557561562891351e-17_rk, -2.357022603955158668e-01_rk, -5.551115123125782702e-17_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))

        test_dmetric_dx_zetamax(:,:,3,2,1) = reshape((/                                                                                 &
                                        -2.775557561562891351e-17_rk, 6.315623032716871643e-02_rk, 5.551115123125782702e-17_rk, &
                                        0.000000000000000000e+00_rk, 6.315623032716870255e-02_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))

        test_dmetric_dx_zetamax(:,:,3,2,2) = reshape((/                                                                                 &
                                        -1.540743955509788682e-33_rk, 3.505875052887614609e-18_rk, 3.081487911019577365e-33_rk, &
                                        0.000000000000000000e+00_rk, 3.505875052887613838e-18_rk, 0.000000000000000000e+00_rk, &
                                        -2.775557561562891351e-17_rk, 8.931639747704092636e-02_rk, 5.551115123125782702e-17_rk  &
                                        /),(/3,3/))

        test_dmetric_dx_zetamax(:,:,3,2,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 6.315623032716870255e-02_rk, 0.000000000000000000e+00_rk, &
                                        2.775557561562891351e-17_rk, -6.315623032716871643e-02_rk, -5.551115123125782702e-17_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))

        test_dmetric_dx_zetamax(:,:,3,3,1) = reshape((/                                                                                 &
                                        8.326672684688674053e-17_rk, 2.357022603955159223e-01_rk, 0.000000000000000000e+00_rk, &
                                        -2.775557561562891351e-17_rk, 2.357022603955158391e-01_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))

        test_dmetric_dx_zetamax(:,:,3,3,2) = reshape((/                                                                                 &
                                        4.622231866529366047e-33_rk, 1.308410382236479665e-17_rk, 0.000000000000000000e+00_rk, &
                                        -1.540743955509788682e-33_rk, 1.308410382236479203e-17_rk, 0.000000000000000000e+00_rk, &
                                        8.326672684688674053e-17_rk, 3.333333333333333703e-01_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))

        test_dmetric_dx_zetamax(:,:,3,3,3) = reshape((/                                                                                 &
                                        -2.775557561562891351e-17_rk, 2.357022603955158391e-01_rk, 0.000000000000000000e+00_rk, &
                                        -8.326672684688674053e-17_rk, -2.357022603955159223e-01_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))

        test_dmetric_dx_zetamax(:,:,3,4,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 8.796528112548948064e-01_rk, -5.551115123125782702e-17_rk, &
                                        0.000000000000000000e+00_rk, 8.796528112548945844e-01_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))

        test_dmetric_dx_zetamax(:,:,3,4,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 4.883054023657156275e-17_rk, -3.081487911019577365e-33_rk, &
                                        0.000000000000000000e+00_rk, 4.883054023657155043e-17_rk, 0.000000000000000000e+00_rk, &
                                        -2.775557561562891351e-17_rk, 1.244016935856292472e+00_rk, 5.551115123125782702e-17_rk  &
                                        /),(/3,3/))

        test_dmetric_dx_zetamax(:,:,3,4,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 8.796528112548945844e-01_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, -8.796528112548948064e-01_rk, 5.551115123125782702e-17_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))

        test_dmetric_dx_zetamax(:,:,3,5,1) = reshape((/                                                                                 &
                                        1.000000000000000000e+00_rk, -2.357022603955158668e-01_rk, -5.773502691896258421e-01_rk, &
                                        9.999999999999997780e-01_rk, -2.357022603955158391e-01_rk, -5.773502691896258421e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))

        test_dmetric_dx_zetamax(:,:,3,5,2) = reshape((/                                                                                 &
                                        5.551115123125782702e-17_rk, -1.308410382236479357e-17_rk, -3.204937810639273644e-17_rk, &
                                        5.551115123125781470e-17_rk, -1.308410382236479203e-17_rk, -3.204937810639273644e-17_rk, &
                                        1.414213562373094923e+00_rk, -3.333333333333333703e-01_rk, -8.164965809277261455e-01_rk  &
                                        /),(/3,3/))

        test_dmetric_dx_zetamax(:,:,3,5,3) = reshape((/                                                                                 &
                                        9.999999999999997780e-01_rk, -2.357022603955158391e-01_rk, -5.773502691896258421e-01_rk, &
                                        -1.000000000000000000e+00_rk, 2.357022603955158668e-01_rk, 5.773502691896258421e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))

        test_dmetric_dx_zetamax(:,:,3,6,1) = reshape((/                                                                                 &
                                        -8.326672684688674053e-17_rk, -6.315623032716871643e-02_rk, -4.226497308103742689e-01_rk, &
                                        -2.775557561562891351e-17_rk, -6.315623032716870255e-02_rk, -4.226497308103741579e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))

        test_dmetric_dx_zetamax(:,:,3,6,2) = reshape((/                                                                                 &
                                        -4.622231866529366047e-33_rk, -3.505875052887614609e-18_rk, -2.346177312486509675e-17_rk, &
                                        -1.540743955509788682e-33_rk, -3.505875052887613838e-18_rk, -2.346177312486509059e-17_rk, &
                                        -8.326672684688674053e-17_rk, -8.931639747704092636e-02_rk, -5.977169814453690000e-01_rk  &
                                        /),(/3,3/))

        test_dmetric_dx_zetamax(:,:,3,6,3) = reshape((/                                                                                 &
                                        -2.775557561562891351e-17_rk, -6.315623032716870255e-02_rk, -4.226497308103741579e-01_rk, &
                                        8.326672684688674053e-17_rk, 6.315623032716871643e-02_rk, 4.226497308103742689e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))

        test_dmetric_dx_zetamax(:,:,3,7,1) = reshape((/                                                                                 &
                                        -1.000000000000000000e+00_rk, -2.357022603955159223e-01_rk, -5.773502691896257311e-01_rk, &
                                        -1.000000000000000000e+00_rk, -2.357022603955158391e-01_rk, -5.773502691896256200e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))

        test_dmetric_dx_zetamax(:,:,3,7,2) = reshape((/                                                                                 &
                                        -5.551115123125782702e-17_rk, -1.308410382236479665e-17_rk, -3.204937810639273027e-17_rk, &
                                        -5.551115123125782702e-17_rk, -1.308410382236479203e-17_rk, -3.204937810639272411e-17_rk, &
                                        -1.414213562373094923e+00_rk, -3.333333333333333703e-01_rk, -8.164965809277258124e-01_rk  &
                                        /),(/3,3/))

        test_dmetric_dx_zetamax(:,:,3,7,3) = reshape((/                                                                                 &
                                        -1.000000000000000000e+00_rk, -2.357022603955158391e-01_rk, -5.773502691896256200e-01_rk, &
                                        1.000000000000000000e+00_rk, 2.357022603955159223e-01_rk, 5.773502691896257311e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))

        test_dmetric_dx_zetamax(:,:,3,8,1) = reshape((/                                                                                 &
                                        1.387778780781445676e-16_rk, -8.796528112548948064e-01_rk, 1.577350269189625731e+00_rk, &
                                        1.942890293094023946e-16_rk, -8.796528112548945844e-01_rk, 1.577350269189625731e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))

        test_dmetric_dx_zetamax(:,:,3,8,2) = reshape((/                                                                                 &
                                        7.703719777548943412e-33_rk, -4.883054023657156275e-17_rk, 8.756052933765055729e-17_rk, &
                                        1.078520768856852078e-32_rk, -4.883054023657155043e-17_rk, 8.756052933765055729e-17_rk, &
                                        1.387778780781445676e-16_rk, -1.244016935856292472e+00_rk, 2.230710143300821180e+00_rk  &
                                        /),(/3,3/))

        test_dmetric_dx_zetamax(:,:,3,8,3) = reshape((/                                                                                 &
                                        1.942890293094023946e-16_rk, -8.796528112548945844e-01_rk, 1.577350269189625731e+00_rk, &
                                        -1.387778780781445676e-16_rk, 8.796528112548948064e-01_rk, -1.577350269189625731e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))

        test_dmetric_dx_zetamax(:,:,4,1,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 6.315623032716870255e-02_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 6.315623032716870255e-02_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))

        test_dmetric_dx_zetamax(:,:,4,1,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 7.554110863947330340e-18_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 7.554110863947330340e-18_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 8.931639747704081533e-02_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))

        test_dmetric_dx_zetamax(:,:,4,1,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 6.315623032716871643e-02_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, -6.315623032716871643e-02_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))

        test_dmetric_dx_zetamax(:,:,4,2,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 2.357022603955158391e-01_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 2.357022603955158391e-01_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))

        test_dmetric_dx_zetamax(:,:,4,2,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 2.819232555025944346e-17_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 2.819232555025944346e-17_rk, 0.000000000000000000e+00_rk, &
                                        -5.551115123125782702e-17_rk, 3.333333333333332593e-01_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))

        test_dmetric_dx_zetamax(:,:,4,2,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 2.357022603955158946e-01_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, -2.357022603955158946e-01_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))

        test_dmetric_dx_zetamax(:,:,4,3,1) = reshape((/                                                                                 &
                                        1.110223024625156540e-16_rk, 8.796528112548945844e-01_rk, 0.000000000000000000e+00_rk, &
                                        1.110223024625156540e-16_rk, 8.796528112548945844e-01_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))

        test_dmetric_dx_zetamax(:,:,4,3,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 1.052151913370904065e-16_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 1.052151913370904065e-16_rk, 0.000000000000000000e+00_rk, &
                                        5.551115123125782702e-17_rk, 1.244016935856292472e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))

        test_dmetric_dx_zetamax(:,:,4,3,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 8.796528112548946954e-01_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, -8.796528112548946954e-01_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))

        test_dmetric_dx_zetamax(:,:,4,4,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 2.357022603955158391e-01_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 2.357022603955158391e-01_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))

        test_dmetric_dx_zetamax(:,:,4,4,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 2.819232555025943730e-17_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 2.819232555025943730e-17_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 3.333333333333332593e-01_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))

        test_dmetric_dx_zetamax(:,:,4,4,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 2.357022603955158946e-01_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, -2.357022603955158946e-01_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))

        test_dmetric_dx_zetamax(:,:,4,5,1) = reshape((/                                                                                 &
                                        4.226497308103741024e-01_rk, -6.315623032716859153e-02_rk, 0.000000000000000000e+00_rk, &
                                        4.226497308103741024e-01_rk, -6.315623032716859153e-02_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))

        test_dmetric_dx_zetamax(:,:,4,5,2) = reshape((/                                                                                 &
                                        5.055309518347866234e-17_rk, -7.554110863947318014e-18_rk, 0.000000000000000000e+00_rk, &
                                        5.055309518347866234e-17_rk, -7.554110863947318014e-18_rk, 0.000000000000000000e+00_rk, &
                                        5.977169814453691110e-01_rk, -8.931639747704081533e-02_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))

        test_dmetric_dx_zetamax(:,:,4,5,3) = reshape((/                                                                                 &
                                        4.226497308103742689e-01_rk, -6.315623032716860541e-02_rk, 0.000000000000000000e+00_rk, &
                                        -4.226497308103742689e-01_rk, 6.315623032716860541e-02_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))

        test_dmetric_dx_zetamax(:,:,4,6,1) = reshape((/                                                                                 &
                                        5.773502691896256200e-01_rk, -2.357022603955157281e-01_rk, -1.000000000000000000e+00_rk, &
                                        5.773502691896256200e-01_rk, -2.357022603955157281e-01_rk, -1.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))

        test_dmetric_dx_zetamax(:,:,4,6,2) = reshape((/                                                                                 &
                                        6.905681226056459441e-17_rk, -2.819232555025943114e-17_rk, -1.196099074440432876e-16_rk, &
                                        6.905681226056459441e-17_rk, -2.819232555025943114e-17_rk, -1.196099074440432876e-16_rk, &
                                        8.164965809277259234e-01_rk, -3.333333333333332593e-01_rk, -1.414213562373095145e+00_rk  &
                                        /),(/3,3/))

        test_dmetric_dx_zetamax(:,:,4,6,3) = reshape((/                                                                                 &
                                        5.773502691896257311e-01_rk, -2.357022603955157836e-01_rk, -1.000000000000000222e+00_rk, &
                                        -5.773502691896257311e-01_rk, 2.357022603955157836e-01_rk, 1.000000000000000222e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))

        test_dmetric_dx_zetamax(:,:,4,7,1) = reshape((/                                                                                 &
                                        -1.577350269189625509e+00_rk, -8.796528112548948064e-01_rk, 0.000000000000000000e+00_rk, &
                                        -1.577350269189625509e+00_rk, -8.796528112548948064e-01_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))

        test_dmetric_dx_zetamax(:,:,4,7,2) = reshape((/                                                                                 &
                                        -1.886667197046078450e-16_rk, -1.052151913370904435e-16_rk, 0.000000000000000000e+00_rk, &
                                        -1.886667197046078450e-16_rk, -1.052151913370904435e-16_rk, 0.000000000000000000e+00_rk, &
                                        -2.230710143300820736e+00_rk, -1.244016935856292472e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))

        test_dmetric_dx_zetamax(:,:,4,7,3) = reshape((/                                                                                 &
                                        -1.577350269189625731e+00_rk, -8.796528112548950284e-01_rk, 0.000000000000000000e+00_rk, &
                                        1.577350269189625731e+00_rk, 8.796528112548950284e-01_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))

        test_dmetric_dx_zetamax(:,:,4,8,1) = reshape((/                                                                                 &
                                        5.773502691896256200e-01_rk, -2.357022603955157281e-01_rk, 1.000000000000000000e+00_rk, &
                                        5.773502691896256200e-01_rk, -2.357022603955157281e-01_rk, 1.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))

        test_dmetric_dx_zetamax(:,:,4,8,2) = reshape((/                                                                                 &
                                        6.905681226056459441e-17_rk, -2.819232555025942498e-17_rk, 1.196099074440432876e-16_rk, &
                                        6.905681226056459441e-17_rk, -2.819232555025942498e-17_rk, 1.196099074440432876e-16_rk, &
                                        8.164965809277258124e-01_rk, -3.333333333333331483e-01_rk, 1.414213562373095145e+00_rk  &
                                        /),(/3,3/))

        test_dmetric_dx_zetamax(:,:,4,8,3) = reshape((/                                                                                 &
                                        5.773502691896257311e-01_rk, -2.357022603955157836e-01_rk, 1.000000000000000222e+00_rk, &
                                        -5.773502691896257311e-01_rk, 2.357022603955157836e-01_rk, -1.000000000000000222e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))

        
        
        do inode = 1,self%elem%basis_s%nnodes_face()
            do inode_diff = 1,self%elem%nterms_c
                do idir = 1,3
                    @assertEqual(transpose(test_dmetric_dx_zetamax(:,:,inode,inode_diff,idir)),self%faces(ZETA_MAX)%dmetric_dx(:,:,inode,inode_diff,idir),tol)
                end do
            end do
        end do

    end subroutine testElement_face_dmetrics_dx_zetamax
    !*******************************************************************************************







    !> Test cartesian face dgrad_dx  
    !!
    !!
    !------------------------------------------------------------------------------------------
    @Test
    subroutine testElement_face_dgrad_dx_etamin(self)
        class(test_element_linearC_dx),    intent(inout)   :: self
        
        
        real(rk), dimension(self%elem%nterms_s,self%elem%basis_s%nnodes_face(),self%elem%nterms_c,3) :: test_dgrad1_dx, test_dgrad2_dx, test_dgrad3_dx
        
        real(rk)        :: tol = 1.e-13_rk
        integer(ik)     :: inode_diff, idir, inode, irow
       
       
        !
        ! dgrad1_dx
        ! 
        test_dgrad1_dx(:,:,1,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 1.410683602522959212e+00_rk, 0.000000000000000000e+00_rk,1.410683602522958990e+00_rk,-2.225142160180980433e+00_rk,-8.144585576580214425e-01_rk,-8.144585576580215536e-01_rk,1.284686425165674439e+00_rk, &
                                        0.000000000000000000e+00_rk, 9.553418012614796062e-01_rk, 0.000000000000000000e+00_rk,9.553418012614797172e-01_rk,-4.037749551350625632e-01_rk,-5.515668461264171540e-01_rk,-5.515668461264170430e-01_rk,2.331195790392574241e-01_rk, &
                                        0.000000000000000000e+00_rk, 3.779915320718539862e-01_rk, 0.000000000000000000e+00_rk,3.779915320718539862e-01_rk,-5.962250448649377699e-01_rk,2.182335127930837837e-01_rk,2.182335127930837837e-01_rk,-3.442306901503685568e-01_rk, &
                                        0.000000000000000000e+00_rk, 2.559830641437076393e-01_rk, 0.000000000000000000e+00_rk,2.559830641437075283e-01_rk,-1.081911731523527570e-01_rk,1.477918909913548129e-01_rk,1.477918909913547574e-01_rk,-6.246420294345225721e-02_rk  &
                                        /),(/8,4/))

        test_dgrad1_dx(:,:,1,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, -4.521153216574655706e-17_rk, 1.995007882905305285e+00_rk,-4.521153216574655090e-17_rk,7.131442243211573258e-17_rk,-1.151818338230803374e+00_rk,-1.995007882905305285e+00_rk,1.151818338230803374e+00_rk, &
                                        0.000000000000000000e+00_rk, 3.061811060947145186e-17_rk, 1.351057332045926263e+00_rk,3.061811060947145802e-17_rk,-1.294073620701538108e-17_rk,7.800333143473332509e-01_rk,-1.351057332045926263e+00_rk,-7.800333143473332509e-01_rk, &
                                        0.000000000000000000e+00_rk, -1.211439353238551362e-17_rk, 5.345607511182004501e-01_rk,-1.211439353238551362e-17_rk,1.910864189937736306e-17_rk,-3.086287935563014617e-01_rk,-5.345607511182004501e-01_rk,3.086287935563014617e-01_rk, &
                                        0.000000000000000000e+00_rk, 8.204098011574665193e-18_rk, 3.620147210498531054e-01_rk,8.204098011574668275e-18_rk,-3.467459816133959706e-18_rk,2.090092966487400172e-01_rk,-3.620147210498531054e-01_rk,-2.090092966487400172e-01_rk  &
                                        /),(/8,4/))

        test_dgrad1_dx(:,:,1,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, -1.410683602522959212e+00_rk, 0.000000000000000000e+00_rk,1.410683602522959434e+00_rk,-5.962250448649378809e-01_rk,-8.144585576580215536e-01_rk,8.144585576580215536e-01_rk,3.442306901503685568e-01_rk, &
                                        0.000000000000000000e+00_rk, -9.553418012614796062e-01_rk, 0.000000000000000000e+00_rk,9.553418012614797172e-01_rk,-1.506908647387896760e+00_rk,-5.515668461264171540e-01_rk,5.515668461264170430e-01_rk,8.700141132135771338e-01_rk, &
                                        0.000000000000000000e+00_rk, -3.779915320718539862e-01_rk, 0.000000000000000000e+00_rk,3.779915320718539862e-01_rk,-1.597580192787699804e-01_rk,2.182335127930837837e-01_rk,-2.182335127930837837e-01_rk,-9.223633543579928817e-02_rk, &
                                        0.000000000000000000e+00_rk, -2.559830641437076393e-01_rk, 0.000000000000000000e+00_rk,2.559830641437076948e-01_rk,-4.037749551350625077e-01_rk,1.477918909913548129e-01_rk,-1.477918909913547574e-01_rk,-2.331195790392574241e-01_rk  &
                                        /),(/8,4/))

        test_dgrad1_dx(:,:,2,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, -6.220084679281462359e-01_rk, 0.000000000000000000e+00_rk,-6.220084679281461248e-01_rk,9.811252243246879612e-01_rk,3.591167563965418363e-01_rk,3.591167563965418363e-01_rk,-5.664529123725905446e-01_rk, &
                                        0.000000000000000000e+00_rk, -1.666666666666668239e-01_rk, 0.000000000000000000e+00_rk,-1.666666666666667962e-01_rk,7.044162180172915122e-02_rk,9.622504486493768661e-02_rk,9.622504486493771436e-02_rk,-4.066948930938213413e-02_rk, &
                                        0.000000000000000000e+00_rk, -1.666666666666667407e-01_rk, 0.000000000000000000e+00_rk,-1.666666666666667407e-01_rk,2.628917115316043440e-01_rk,-9.622504486493765885e-02_rk,-9.622504486493765885e-02_rk,1.517806004204932113e-01_rk, &
                                        0.000000000000000000e+00_rk, -4.465819873852042154e-02_rk, 0.000000000000000000e+00_rk,-4.465819873852040767e-02_rk,1.887477567531184452e-02_rk,-2.578342306320858396e-02_rk,-2.578342306320856314e-02_rk,1.089735681703509276e-02_rk  &
                                        /),(/8,4/))

        test_dgrad1_dx(:,:,2,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 1.993498457400721049e-17_rk, -8.796528112548946954e-01_rk,1.993498457400721049e-17_rk,-3.144445328410131161e-17_rk,5.078677873714244617e-01_rk,8.796528112548946954e-01_rk,-5.078677873714244617e-01_rk, &
                                        0.000000000000000000e+00_rk, -5.341563017732126848e-18_rk, -2.357022603955159501e-01_rk,-5.341563017732125307e-18_rk,2.257610171551135088e-18_rk,-1.360827634879544501e-01_rk,2.357022603955159501e-01_rk,1.360827634879544501e-01_rk, &
                                        0.000000000000000000e+00_rk, 5.341563017732123767e-18_rk, -2.357022603955158946e-01_rk,5.341563017732123767e-18_rk,-8.425515863913113985e-18_rk,1.360827634879543113e-01_rk,2.357022603955158946e-01_rk,-1.360827634879543113e-01_rk, &
                                        0.000000000000000000e+00_rk, -1.431267496921271484e-18_rk, -6.315623032716863317e-02_rk,-1.431267496921272639e-18_rk,6.049248222914128867e-19_rk,-3.646326658039283908e-02_rk,6.315623032716863317e-02_rk,3.646326658039283908e-02_rk  &
                                        /),(/8,4/))

        test_dgrad1_dx(:,:,2,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 6.220084679281462359e-01_rk, 0.000000000000000000e+00_rk,-6.220084679281463469e-01_rk,2.628917115316044550e-01_rk,3.591167563965419474e-01_rk,-3.591167563965418363e-01_rk,-1.517806004204932668e-01_rk, &
                                        0.000000000000000000e+00_rk, 1.666666666666668239e-01_rk, 0.000000000000000000e+00_rk,-1.666666666666667962e-01_rk,2.628917115316043995e-01_rk,9.622504486493768661e-02_rk,-9.622504486493771436e-02_rk,-1.517806004204933501e-01_rk, &
                                        0.000000000000000000e+00_rk, 1.666666666666667407e-01_rk, 0.000000000000000000e+00_rk,-1.666666666666667407e-01_rk,7.044162180172905408e-02_rk,-9.622504486493765885e-02_rk,9.622504486493765885e-02_rk,4.066948930938207168e-02_rk, &
                                        0.000000000000000000e+00_rk, 4.465819873852042154e-02_rk, 0.000000000000000000e+00_rk,-4.465819873852047706e-02_rk,7.044162180172905408e-02_rk,-2.578342306320859090e-02_rk,2.578342306320856314e-02_rk,4.066948930938210638e-02_rk  &
                                        /),(/8,4/))

        test_dgrad1_dx(:,:,3,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, -1.666666666666666574e-01_rk, 0.000000000000000000e+00_rk,-1.666666666666666852e-01_rk,2.628917115316042885e-01_rk,9.622504486493763110e-02_rk,9.622504486493763110e-02_rk,-1.517806004204931281e-01_rk, &
                                        0.000000000000000000e+00_rk, -6.220084679281461248e-01_rk, 0.000000000000000000e+00_rk,-6.220084679281461248e-01_rk,2.628917115316043440e-01_rk,3.591167563965418363e-01_rk,3.591167563965418363e-01_rk,-1.517806004204931836e-01_rk, &
                                        0.000000000000000000e+00_rk, -4.465819873852044930e-02_rk, 0.000000000000000000e+00_rk,-4.465819873852044930e-02_rk,7.044162180172908183e-02_rk,-2.578342306320857702e-02_rk,-2.578342306320857702e-02_rk,4.066948930938210638e-02_rk, &
                                        0.000000000000000000e+00_rk, -1.666666666666666297e-01_rk, 0.000000000000000000e+00_rk,-1.666666666666666297e-01_rk,7.044162180172902632e-02_rk,-9.622504486493765885e-02_rk,-9.622504486493760334e-02_rk,4.066948930938206475e-02_rk  &
                                        /),(/8,4/))

        test_dgrad1_dx(:,:,3,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 5.341563017732122226e-18_rk, -2.357022603955156725e-01_rk,5.341563017732122226e-18_rk,-8.425515863913112445e-18_rk,1.360827634879543391e-01_rk,2.357022603955156725e-01_rk,-1.360827634879543391e-01_rk, &
                                        0.000000000000000000e+00_rk, -1.993498457400721049e-17_rk, -8.796528112548944733e-01_rk,-1.993498457400721049e-17_rk,8.425515863913112445e-18_rk,-5.078677873714245727e-01_rk,8.796528112548944733e-01_rk,5.078677873714245727e-01_rk, &
                                        0.000000000000000000e+00_rk, 1.431267496921272254e-18_rk, -6.315623032716866092e-02_rk,1.431267496921272254e-18_rk,-2.257610171551133548e-18_rk,3.646326658039286683e-02_rk,6.315623032716866092e-02_rk,-3.646326658039286683e-02_rk, &
                                        0.000000000000000000e+00_rk, -5.341563017732120685e-18_rk, -2.357022603955158946e-01_rk,-5.341563017732123767e-18_rk,2.257610171551131622e-18_rk,-1.360827634879543668e-01_rk,2.357022603955158946e-01_rk,1.360827634879543668e-01_rk  &
                                        /),(/8,4/))

        test_dgrad1_dx(:,:,3,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 1.666666666666666574e-01_rk, 0.000000000000000000e+00_rk,-1.666666666666666297e-01_rk,7.044162180172908183e-02_rk,9.622504486493765885e-02_rk,-9.622504486493763110e-02_rk,-4.066948930938207168e-02_rk, &
                                        0.000000000000000000e+00_rk, 6.220084679281461248e-01_rk, 0.000000000000000000e+00_rk,-6.220084679281461248e-01_rk,9.811252243246880722e-01_rk,3.591167563965418363e-01_rk,-3.591167563965418363e-01_rk,-5.664529123725905446e-01_rk, &
                                        0.000000000000000000e+00_rk, 4.465819873852044930e-02_rk, 0.000000000000000000e+00_rk,-4.465819873852044930e-02_rk,1.887477567531188616e-02_rk,-2.578342306320857702e-02_rk,2.578342306320857702e-02_rk,1.089735681703512399e-02_rk, &
                                        0.000000000000000000e+00_rk, 1.666666666666666297e-01_rk, 0.000000000000000000e+00_rk,-1.666666666666667684e-01_rk,2.628917115316043995e-01_rk,-9.622504486493764497e-02_rk,9.622504486493760334e-02_rk,1.517806004204932113e-01_rk  &
                                        /),(/8,4/))

        test_dgrad1_dx(:,:,4,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, -6.220084679281463469e-01_rk, 0.000000000000000000e+00_rk,-6.220084679281461248e-01_rk,9.811252243246879612e-01_rk,3.591167563965419474e-01_rk,3.591167563965419474e-01_rk,-5.664529123725906556e-01_rk, &
                                        0.000000000000000000e+00_rk, -1.666666666666666297e-01_rk, 0.000000000000000000e+00_rk,-1.666666666666666852e-01_rk,7.044162180172906795e-02_rk,9.622504486493763110e-02_rk,9.622504486493760334e-02_rk,-4.066948930938207862e-02_rk, &
                                        0.000000000000000000e+00_rk, -1.666666666666667407e-01_rk, 0.000000000000000000e+00_rk,-1.666666666666667407e-01_rk,2.628917115316043440e-01_rk,-9.622504486493768661e-02_rk,-9.622504486493768661e-02_rk,1.517806004204932113e-01_rk, &
                                        0.000000000000000000e+00_rk, -4.465819873852044930e-02_rk, 0.000000000000000000e+00_rk,-4.465819873852046318e-02_rk,1.887477567531187228e-02_rk,-2.578342306320858396e-02_rk,-2.578342306320857702e-02_rk,1.089735681703510664e-02_rk  &
                                        /),(/8,4/))

        test_dgrad1_dx(:,:,4,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 1.993498457400721665e-17_rk, -8.796528112548946954e-01_rk,1.993498457400721665e-17_rk,-3.144445328410131161e-17_rk,5.078677873714244617e-01_rk,8.796528112548946954e-01_rk,-5.078677873714244617e-01_rk, &
                                        0.000000000000000000e+00_rk, -5.341563017732120685e-18_rk, -2.357022603955158391e-01_rk,-5.341563017732122226e-18_rk,2.257610171551132007e-18_rk,-1.360827634879543391e-01_rk,2.357022603955158391e-01_rk,1.360827634879543391e-01_rk, &
                                        0.000000000000000000e+00_rk, 5.341563017732125307e-18_rk, -2.357022603955158946e-01_rk,5.341563017732125307e-18_rk,-8.425515863913113985e-18_rk,1.360827634879543113e-01_rk,2.357022603955158946e-01_rk,-1.360827634879543113e-01_rk, &
                                        0.000000000000000000e+00_rk, -1.431267496921272254e-18_rk, -6.315623032716866092e-02_rk,-1.431267496921272639e-18_rk,6.049248222914144274e-19_rk,-3.646326658039283908e-02_rk,6.315623032716866092e-02_rk,3.646326658039283908e-02_rk  &
                                        /),(/8,4/))

        test_dgrad1_dx(:,:,4,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 6.220084679281463469e-01_rk, 0.000000000000000000e+00_rk,-6.220084679281463469e-01_rk,2.628917115316043440e-01_rk,3.591167563965419474e-01_rk,-3.591167563965419474e-01_rk,-1.517806004204932113e-01_rk, &
                                        0.000000000000000000e+00_rk, 1.666666666666666297e-01_rk, 0.000000000000000000e+00_rk,-1.666666666666666852e-01_rk,2.628917115316042885e-01_rk,9.622504486493763110e-02_rk,-9.622504486493760334e-02_rk,-1.517806004204931836e-01_rk, &
                                        0.000000000000000000e+00_rk, 1.666666666666667407e-01_rk, 0.000000000000000000e+00_rk,-1.666666666666667407e-01_rk,7.044162180172905408e-02_rk,-9.622504486493768661e-02_rk,9.622504486493768661e-02_rk,4.066948930938207168e-02_rk, &
                                        0.000000000000000000e+00_rk, 4.465819873852044930e-02_rk, 0.000000000000000000e+00_rk,-4.465819873852047706e-02_rk,7.044162180172905408e-02_rk,-2.578342306320859090e-02_rk,2.578342306320857702e-02_rk,4.066948930938210638e-02_rk  &
                                        /),(/8,4/))

        test_dgrad1_dx(:,:,5,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 3.779915320718537641e-01_rk, 0.000000000000000000e+00_rk,3.779915320718537086e-01_rk,-5.962250448649375478e-01_rk,-2.182335127930839225e-01_rk,-2.182335127930838947e-01_rk,3.442306901503684458e-01_rk, &
                                        0.000000000000000000e+00_rk, 2.559830641437075838e-01_rk, 0.000000000000000000e+00_rk,2.559830641437076948e-01_rk,-1.081911731523528264e-01_rk,-1.477918909913548129e-01_rk,-1.477918909913548129e-01_rk,6.246420294345231966e-02_rk, &
                                        0.000000000000000000e+00_rk, 1.410683602522959434e+00_rk, 0.000000000000000000e+00_rk,1.410683602522959434e+00_rk,-2.225142160180980877e+00_rk,8.144585576580215536e-01_rk,8.144585576580215536e-01_rk,-1.284686425165674439e+00_rk, &
                                        0.000000000000000000e+00_rk, 9.553418012614794952e-01_rk, 0.000000000000000000e+00_rk,9.553418012614793842e-01_rk,-4.037749551350622301e-01_rk,5.515668461264170430e-01_rk,5.515668461264170430e-01_rk,-2.331195790392572298e-01_rk  &
                                        /),(/8,4/))

        test_dgrad1_dx(:,:,5,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, -1.211439353238551979e-17_rk, 5.345607511182002280e-01_rk,-1.211439353238552133e-17_rk,1.910864189937735073e-17_rk,-3.086287935563014617e-01_rk,-5.345607511182002280e-01_rk,3.086287935563014617e-01_rk, &
                                        0.000000000000000000e+00_rk, 8.204098011574668275e-18_rk, 3.620147210498532164e-01_rk,8.204098011574668275e-18_rk,-3.467459816133962017e-18_rk,2.090092966487400172e-01_rk,-3.620147210498532164e-01_rk,-2.090092966487400172e-01_rk, &
                                        0.000000000000000000e+00_rk, -4.521153216574655706e-17_rk, 1.995007882905305507e+00_rk,-4.521153216574655706e-17_rk,7.131442243211574491e-17_rk,-1.151818338230803374e+00_rk,-1.995007882905305507e+00_rk,1.151818338230803374e+00_rk, &
                                        0.000000000000000000e+00_rk, 3.061811060947145186e-17_rk, 1.351057332045926263e+00_rk,3.061811060947145186e-17_rk,-1.294073620701537030e-17_rk,7.800333143473331399e-01_rk,-1.351057332045926263e+00_rk,-7.800333143473331399e-01_rk  &
                                        /),(/8,4/))

        test_dgrad1_dx(:,:,5,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, -3.779915320718537641e-01_rk, 0.000000000000000000e+00_rk,3.779915320718539862e-01_rk,-1.597580192787700915e-01_rk,-2.182335127930837837e-01_rk,2.182335127930838947e-01_rk,9.223633543579926042e-02_rk, &
                                        0.000000000000000000e+00_rk, -2.559830641437075838e-01_rk, 0.000000000000000000e+00_rk,2.559830641437076948e-01_rk,-4.037749551350623411e-01_rk,-1.477918909913548129e-01_rk,1.477918909913548129e-01_rk,2.331195790392573963e-01_rk, &
                                        0.000000000000000000e+00_rk, -1.410683602522959434e+00_rk, 0.000000000000000000e+00_rk,1.410683602522959434e+00_rk,-5.962250448649377699e-01_rk,8.144585576580215536e-01_rk,-8.144585576580215536e-01_rk,-3.442306901503685013e-01_rk, &
                                        0.000000000000000000e+00_rk, -9.553418012614794952e-01_rk, 0.000000000000000000e+00_rk,9.553418012614796062e-01_rk,-1.506908647387896760e+00_rk,5.515668461264172651e-01_rk,-5.515668461264170430e-01_rk,-8.700141132135771338e-01_rk  &
                                        /),(/8,4/))

        test_dgrad1_dx(:,:,6,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, -1.666666666666666574e-01_rk, 0.000000000000000000e+00_rk,-1.666666666666665741e-01_rk,2.628917115316042885e-01_rk,9.622504486493763110e-02_rk,9.622504486493763110e-02_rk,-1.517806004204931281e-01_rk, &
                                        0.000000000000000000e+00_rk, -4.465819873852050481e-02_rk, 0.000000000000000000e+00_rk,-4.465819873852051869e-02_rk,1.887477567531190004e-02_rk,2.578342306320861171e-02_rk,2.578342306320860478e-02_rk,-1.089735681703511705e-02_rk, &
                                        0.000000000000000000e+00_rk, -6.220084679281463469e-01_rk, 0.000000000000000000e+00_rk,-6.220084679281463469e-01_rk,9.811252243246884053e-01_rk,-3.591167563965419474e-01_rk,-3.591167563965419474e-01_rk,5.664529123725906556e-01_rk, &
                                        0.000000000000000000e+00_rk, -1.666666666666665464e-01_rk, 0.000000000000000000e+00_rk,-1.666666666666665186e-01_rk,7.044162180172894305e-02_rk,-9.622504486493752007e-02_rk,-9.622504486493754783e-02_rk,4.066948930938202311e-02_rk  &
                                        /),(/8,4/))

        test_dgrad1_dx(:,:,6,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 5.341563017732122226e-18_rk, -2.357022603955158946e-01_rk,5.341563017732122226e-18_rk,-8.425515863913109363e-18_rk,1.360827634879543391e-01_rk,2.357022603955158946e-01_rk,-1.360827634879543391e-01_rk, &
                                        0.000000000000000000e+00_rk, -1.431267496921273795e-18_rk, -6.315623032716873031e-02_rk,-1.431267496921274180e-18_rk,6.049248222914148126e-19_rk,-3.646326658039285296e-02_rk,6.315623032716873031e-02_rk,3.646326658039285296e-02_rk, &
                                        0.000000000000000000e+00_rk, 1.993498457400721665e-17_rk, -8.796528112548946954e-01_rk,1.993498457400721665e-17_rk,-3.144445328410131777e-17_rk,5.078677873714244617e-01_rk,8.796528112548946954e-01_rk,-5.078677873714244617e-01_rk, &
                                        0.000000000000000000e+00_rk, -5.341563017732117604e-18_rk, -2.357022603955156725e-01_rk,-5.341563017732116063e-18_rk,2.257610171551126999e-18_rk,-1.360827634879542281e-01_rk,2.357022603955156725e-01_rk,1.360827634879542281e-01_rk  &
                                        /),(/8,4/))

        test_dgrad1_dx(:,:,6,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 1.666666666666666574e-01_rk, 0.000000000000000000e+00_rk,-1.666666666666667407e-01_rk,7.044162180172908183e-02_rk,9.622504486493765885e-02_rk,-9.622504486493763110e-02_rk,-4.066948930938208556e-02_rk, &
                                        0.000000000000000000e+00_rk, 4.465819873852050481e-02_rk, 0.000000000000000000e+00_rk,-4.465819873852051869e-02_rk,7.044162180172913734e-02_rk,2.578342306320861171e-02_rk,-2.578342306320860478e-02_rk,-4.066948930938214801e-02_rk, &
                                        0.000000000000000000e+00_rk, 6.220084679281463469e-01_rk, 0.000000000000000000e+00_rk,-6.220084679281463469e-01_rk,2.628917115316043995e-01_rk,-3.591167563965419474e-01_rk,3.591167563965419474e-01_rk,1.517806004204931836e-01_rk, &
                                        0.000000000000000000e+00_rk, 1.666666666666665464e-01_rk, 0.000000000000000000e+00_rk,-1.666666666666667129e-01_rk,2.628917115316041775e-01_rk,-9.622504486493764497e-02_rk,9.622504486493754783e-02_rk,1.517806004204932113e-01_rk  &
                                        /),(/8,4/))

        test_dgrad1_dx(:,:,7,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, -4.465819873852044930e-02_rk, 0.000000000000000000e+00_rk,-4.465819873852047706e-02_rk,7.044162180172908183e-02_rk,2.578342306320860478e-02_rk,2.578342306320856314e-02_rk,-4.066948930938205087e-02_rk, &
                                        0.000000000000000000e+00_rk, -1.666666666666666019e-01_rk, 0.000000000000000000e+00_rk,-1.666666666666666297e-01_rk,7.044162180172905408e-02_rk,9.622504486493760334e-02_rk,9.622504486493765885e-02_rk,-4.066948930938207168e-02_rk, &
                                        0.000000000000000000e+00_rk, -1.666666666666666297e-01_rk, 0.000000000000000000e+00_rk,-1.666666666666666297e-01_rk,2.628917115316043440e-01_rk,-9.622504486493765885e-02_rk,-9.622504486493765885e-02_rk,1.517806004204932113e-01_rk, &
                                        0.000000000000000000e+00_rk, -6.220084679281462359e-01_rk, 0.000000000000000000e+00_rk,-6.220084679281462359e-01_rk,2.628917115316041775e-01_rk,-3.591167563965419474e-01_rk,-3.591167563965419474e-01_rk,1.517806004204931281e-01_rk  &
                                        /),(/8,4/))

        test_dgrad1_dx(:,:,7,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 1.431267496921271484e-18_rk, -6.315623032716854990e-02_rk,1.431267496921273795e-18_rk,-2.257610171551135088e-18_rk,3.646326658039286683e-02_rk,6.315623032716854990e-02_rk,-3.646326658039286683e-02_rk, &
                                        0.000000000000000000e+00_rk, -5.341563017732123767e-18_rk, -2.357022603955157836e-01_rk,-5.341563017732120685e-18_rk,2.257610171551131622e-18_rk,-1.360827634879543391e-01_rk,2.357022603955157836e-01_rk,1.360827634879543391e-01_rk, &
                                        0.000000000000000000e+00_rk, 5.341563017732123767e-18_rk, -2.357022603955158946e-01_rk,5.341563017732123767e-18_rk,-8.425515863913113985e-18_rk,1.360827634879543668e-01_rk,2.357022603955158946e-01_rk,-1.360827634879543668e-01_rk, &
                                        0.000000000000000000e+00_rk, -1.993498457400721665e-17_rk, -8.796528112548946954e-01_rk,-1.993498457400721665e-17_rk,8.425515863913110904e-18_rk,-5.078677873714245727e-01_rk,8.796528112548946954e-01_rk,5.078677873714245727e-01_rk  &
                                        /),(/8,4/))

        test_dgrad1_dx(:,:,7,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 4.465819873852044930e-02_rk, 0.000000000000000000e+00_rk,-4.465819873852044930e-02_rk,1.887477567531187228e-02_rk,2.578342306320857702e-02_rk,-2.578342306320856314e-02_rk,-1.089735681703511011e-02_rk, &
                                        0.000000000000000000e+00_rk, 1.666666666666666019e-01_rk, 0.000000000000000000e+00_rk,-1.666666666666666297e-01_rk,2.628917115316041775e-01_rk,9.622504486493760334e-02_rk,-9.622504486493765885e-02_rk,-1.517806004204931281e-01_rk, &
                                        0.000000000000000000e+00_rk, 1.666666666666666297e-01_rk, 0.000000000000000000e+00_rk,-1.666666666666666297e-01_rk,7.044162180172905408e-02_rk,-9.622504486493765885e-02_rk,9.622504486493765885e-02_rk,4.066948930938208556e-02_rk, &
                                        0.000000000000000000e+00_rk, 6.220084679281462359e-01_rk, 0.000000000000000000e+00_rk,-6.220084679281463469e-01_rk,9.811252243246886273e-01_rk,-3.591167563965420029e-01_rk,3.591167563965419474e-01_rk,5.664529123725906556e-01_rk  &
                                        /),(/8,4/))

        test_dgrad1_dx(:,:,8,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, -1.666666666666666574e-01_rk, 0.000000000000000000e+00_rk,-1.666666666666666852e-01_rk,2.628917115316042885e-01_rk,9.622504486493763110e-02_rk,9.622504486493763110e-02_rk,-1.517806004204932391e-01_rk, &
                                        0.000000000000000000e+00_rk, -4.465819873852044930e-02_rk, 0.000000000000000000e+00_rk,-4.465819873852043542e-02_rk,1.887477567531187228e-02_rk,2.578342306320857008e-02_rk,2.578342306320860478e-02_rk,-1.089735681703511705e-02_rk, &
                                        0.000000000000000000e+00_rk, -6.220084679281463469e-01_rk, 0.000000000000000000e+00_rk,-6.220084679281463469e-01_rk,9.811252243246884053e-01_rk,-3.591167563965419474e-01_rk,-3.591167563965419474e-01_rk,5.664529123725906556e-01_rk, &
                                        0.000000000000000000e+00_rk, -1.666666666666667129e-01_rk, 0.000000000000000000e+00_rk,-1.666666666666666852e-01_rk,7.044162180172902632e-02_rk,-9.622504486493763110e-02_rk,-9.622504486493764497e-02_rk,4.066948930938206475e-02_rk  &
                                        /),(/8,4/))

        test_dgrad1_dx(:,:,8,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 5.341563017732122226e-18_rk, -2.357022603955158946e-01_rk,5.341563017732122226e-18_rk,-8.425515863913109363e-18_rk,1.360827634879543391e-01_rk,2.357022603955158946e-01_rk,-1.360827634879543391e-01_rk, &
                                        0.000000000000000000e+00_rk, -1.431267496921273795e-18_rk, -6.315623032716864704e-02_rk,-1.431267496921271869e-18_rk,6.049248222914148126e-19_rk,-3.646326658039285296e-02_rk,6.315623032716864704e-02_rk,3.646326658039285296e-02_rk, &
                                        0.000000000000000000e+00_rk, 1.993498457400721665e-17_rk, -8.796528112548946954e-01_rk,1.993498457400721665e-17_rk,-3.144445328410131777e-17_rk,5.078677873714244617e-01_rk,8.796528112548946954e-01_rk,-5.078677873714244617e-01_rk, &
                                        0.000000000000000000e+00_rk, -5.341563017732122996e-18_rk, -2.357022603955158668e-01_rk,-5.341563017732122226e-18_rk,2.257610171551131622e-18_rk,-1.360827634879543391e-01_rk,2.357022603955158668e-01_rk,1.360827634879543391e-01_rk  &
                                        /),(/8,4/))

        test_dgrad1_dx(:,:,8,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 1.666666666666666574e-01_rk, 0.000000000000000000e+00_rk,-1.666666666666667407e-01_rk,7.044162180172908183e-02_rk,9.622504486493768661e-02_rk,-9.622504486493763110e-02_rk,-4.066948930938208556e-02_rk, &
                                        0.000000000000000000e+00_rk, 4.465819873852044930e-02_rk, 0.000000000000000000e+00_rk,-4.465819873852043542e-02_rk,7.044162180172905408e-02_rk,2.578342306320857008e-02_rk,-2.578342306320860478e-02_rk,-4.066948930938209250e-02_rk, &
                                        0.000000000000000000e+00_rk, 6.220084679281463469e-01_rk, 0.000000000000000000e+00_rk,-6.220084679281463469e-01_rk,2.628917115316043995e-01_rk,-3.591167563965419474e-01_rk,3.591167563965419474e-01_rk,1.517806004204931836e-01_rk, &
                                        0.000000000000000000e+00_rk, 1.666666666666667129e-01_rk, 0.000000000000000000e+00_rk,-1.666666666666667129e-01_rk,2.628917115316043995e-01_rk,-9.622504486493764497e-02_rk,9.622504486493764497e-02_rk,1.517806004204932113e-01_rk  &
                                        /),(/8,4/))

        
        
        
        
        
        do inode_diff = 1,self%elem%nterms_c 
            do idir =1,3
                @assertEqual(transpose(test_dgrad1_dx(:,:,inode_diff,idir)),self%faces(ETA_MIN)%dgrad1_dx(:,:,inode_diff,idir),tol)
            end do
        end do


        !
        ! grad2
        !
        test_dgrad2_dx(:,:,1,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 1.115355071650410590e+00_rk, 0.000000000000000000e+00_rk,1.115355071650410368e+00_rk,-1.759305622509789391e+00_rk,-6.439505508593788008e-01_rk,-6.439505508593789118e-01_rk,1.015735574742848923e+00_rk, &
                                        0.000000000000000000e+00_rk, 2.988584907226845555e-01_rk, 0.000000000000000000e+00_rk,2.988584907226846110e-01_rk,-1.263124606543373774e-01_rk,-1.725460300683471504e-01_rk,-1.725460300683471782e-01_rk,7.292653316078570591e-02_rk, &
                                        0.000000000000000000e+00_rk, 1.115355071650410590e+00_rk, 0.000000000000000000e+00_rk,1.115355071650410590e+00_rk,-1.759305622509789391e+00_rk,6.439505508593789118e-01_rk,6.439505508593789118e-01_rk,-1.015735574742848923e+00_rk, &
                                        0.000000000000000000e+00_rk, 2.988584907226846110e-01_rk, 0.000000000000000000e+00_rk,2.988584907226845555e-01_rk,-1.263124606543373218e-01_rk,1.725460300683471782e-01_rk,1.725460300683471504e-01_rk,-7.292653316078565040e-02_rk  &
                                        /),(/8,4/))

        test_dgrad2_dx(:,:,1,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, -3.574643641420676764e-17_rk, 1.577350269189625731e+00_rk,-3.574643641420676148e-17_rk,5.638465110051887460e-17_rk,-9.106836025229589904e-01_rk,-1.577350269189625731e+00_rk,9.106836025229589904e-01_rk, &
                                        0.000000000000000000e+00_rk, 9.578228769477180502e-18_rk, 4.226497308103742689e-01_rk,9.578228769477178961e-18_rk,-4.048235811059714190e-18_rk,2.440169358562924440e-01_rk,-4.226497308103742689e-01_rk,-2.440169358562924440e-01_rk, &
                                        0.000000000000000000e+00_rk, -3.574643641420676764e-17_rk, 1.577350269189625731e+00_rk,-3.574643641420676764e-17_rk,5.638465110051887460e-17_rk,-9.106836025229589904e-01_rk,-1.577350269189625731e+00_rk,9.106836025229589904e-01_rk, &
                                        0.000000000000000000e+00_rk, 9.578228769477178961e-18_rk, 4.226497308103742689e-01_rk,9.578228769477180502e-18_rk,-4.048235811059711109e-18_rk,2.440169358562924440e-01_rk,-4.226497308103742689e-01_rk,-2.440169358562924440e-01_rk  &
                                        /),(/8,4/))

        test_dgrad2_dx(:,:,1,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, -1.115355071650410590e+00_rk, 0.000000000000000000e+00_rk,1.115355071650410812e+00_rk,-4.714045207910319002e-01_rk,-6.439505508593789118e-01_rk,6.439505508593789118e-01_rk,2.721655269759087892e-01_rk, &
                                        0.000000000000000000e+00_rk, -2.988584907226845555e-01_rk, 0.000000000000000000e+00_rk,2.988584907226846110e-01_rk,-4.714045207910317892e-01_rk,-1.725460300683471504e-01_rk,1.725460300683471782e-01_rk,2.721655269759086782e-01_rk, &
                                        0.000000000000000000e+00_rk, -1.115355071650410590e+00_rk, 0.000000000000000000e+00_rk,1.115355071650410590e+00_rk,-4.714045207910317892e-01_rk,6.439505508593789118e-01_rk,-6.439505508593789118e-01_rk,-2.721655269759086782e-01_rk, &
                                        0.000000000000000000e+00_rk, -2.988584907226846110e-01_rk, 0.000000000000000000e+00_rk,2.988584907226845555e-01_rk,-4.714045207910317892e-01_rk,1.725460300683471782e-01_rk,-1.725460300683471504e-01_rk,-2.721655269759087892e-01_rk  &
                                        /),(/8,4/))

        test_dgrad2_dx(:,:,2,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 2.988584907226846110e-01_rk, 0.000000000000000000e+00_rk,2.988584907226845555e-01_rk,-4.714045207910317892e-01_rk,-1.725460300683471782e-01_rk,-1.725460300683471504e-01_rk,2.721655269759086782e-01_rk, &
                                        0.000000000000000000e+00_rk, 1.115355071650410368e+00_rk, 0.000000000000000000e+00_rk,1.115355071650410590e+00_rk,-4.714045207910318447e-01_rk,-6.439505508593789118e-01_rk,-6.439505508593788008e-01_rk,2.721655269759087337e-01_rk, &
                                        0.000000000000000000e+00_rk, 2.988584907226846110e-01_rk, 0.000000000000000000e+00_rk,2.988584907226846110e-01_rk,-4.714045207910317892e-01_rk,1.725460300683471504e-01_rk,1.725460300683471504e-01_rk,-2.721655269759086782e-01_rk, &
                                        0.000000000000000000e+00_rk, 1.115355071650410590e+00_rk, 0.000000000000000000e+00_rk,1.115355071650410368e+00_rk,-4.714045207910315671e-01_rk,6.439505508593788008e-01_rk,6.439505508593789118e-01_rk,-2.721655269759085671e-01_rk  &
                                        /),(/8,4/))

        test_dgrad2_dx(:,:,2,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, -9.578228769477178961e-18_rk, 4.226497308103742689e-01_rk,-9.578228769477180502e-18_rk,1.510822172789464835e-17_rk,-2.440169358562924440e-01_rk,-4.226497308103742689e-01_rk,2.440169358562924440e-01_rk, &
                                        0.000000000000000000e+00_rk, 3.574643641420676148e-17_rk, 1.577350269189625731e+00_rk,3.574643641420676764e-17_rk,-1.510822172789465452e-17_rk,9.106836025229589904e-01_rk,-1.577350269189625731e+00_rk,-9.106836025229589904e-01_rk, &
                                        0.000000000000000000e+00_rk, -9.578228769477178961e-18_rk, 4.226497308103742689e-01_rk,-9.578228769477178961e-18_rk,1.510822172789464835e-17_rk,-2.440169358562924440e-01_rk,-4.226497308103742689e-01_rk,2.440169358562924440e-01_rk, &
                                        0.000000000000000000e+00_rk, 3.574643641420676764e-17_rk, 1.577350269189625731e+00_rk,3.574643641420676148e-17_rk,-1.510822172789464219e-17_rk,9.106836025229589904e-01_rk,-1.577350269189625731e+00_rk,-9.106836025229589904e-01_rk  &
                                        /),(/8,4/))

        test_dgrad2_dx(:,:,2,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, -2.988584907226846110e-01_rk, 0.000000000000000000e+00_rk,2.988584907226845555e-01_rk,-1.263124606543374329e-01_rk,-1.725460300683471782e-01_rk,1.725460300683471504e-01_rk,7.292653316078570591e-02_rk, &
                                        0.000000000000000000e+00_rk, -1.115355071650410368e+00_rk, 0.000000000000000000e+00_rk,1.115355071650410590e+00_rk,-1.759305622509789391e+00_rk,-6.439505508593789118e-01_rk,6.439505508593788008e-01_rk,1.015735574742848923e+00_rk, &
                                        0.000000000000000000e+00_rk, -2.988584907226846110e-01_rk, 0.000000000000000000e+00_rk,2.988584907226846110e-01_rk,-1.263124606543373218e-01_rk,1.725460300683471504e-01_rk,-1.725460300683471504e-01_rk,-7.292653316078567816e-02_rk, &
                                        0.000000000000000000e+00_rk, -1.115355071650410590e+00_rk, 0.000000000000000000e+00_rk,1.115355071650410812e+00_rk,-1.759305622509789391e+00_rk,6.439505508593789118e-01_rk,-6.439505508593789118e-01_rk,-1.015735574742849145e+00_rk  &
                                        /),(/8,4/))

        test_dgrad2_dx(:,:,3,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, -2.775557561562891351e-17_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,2.775557561562891351e-17_rk,-2.775557561562891351e-17_rk,6.938893903907228378e-18_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,-2.775557561562891351e-17_rk,0.000000000000000000e+00_rk,2.775557561562891351e-17_rk,-2.775557561562891351e-17_rk,1.387778780781445676e-17_rk  &
                                        /),(/8,4/))

        test_dgrad2_dx(:,:,3,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 1.540743955509788682e-33_rk, 0.000000000000000000e+00_rk,-1.540743955509788682e-33_rk,-7.703719777548943412e-34_rk,-2.775557561562891351e-17_rk,0.000000000000000000e+00_rk,2.775557561562891351e-17_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, -1.540743955509788682e-33_rk, 0.000000000000000000e+00_rk,1.540743955509788682e-33_rk,7.703719777548943412e-34_rk,-2.775557561562891351e-17_rk,0.000000000000000000e+00_rk,2.775557561562891351e-17_rk  &
                                        /),(/8,4/))

        test_dgrad2_dx(:,:,3,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 2.775557561562891351e-17_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,2.775557561562891351e-17_rk,2.775557561562891351e-17_rk,0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,2.775557561562891351e-17_rk,0.000000000000000000e+00_rk,-1.387778780781445676e-17_rk,2.775557561562891351e-17_rk,-2.775557561562891351e-17_rk  &
                                        /),(/8,4/))

        test_dgrad2_dx(:,:,4,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,-2.775557561562891351e-17_rk,0.000000000000000000e+00_rk,-2.775557561562891351e-17_rk,2.775557561562891351e-17_rk,0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-2.775557561562891351e-17_rk,-2.775557561562891351e-17_rk,0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk  &
                                        /),(/8,4/))

        test_dgrad2_dx(:,:,4,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 1.540743955509788682e-33_rk, 0.000000000000000000e+00_rk,-1.540743955509788682e-33_rk,0.000000000000000000e+00_rk,2.775557561562891351e-17_rk,0.000000000000000000e+00_rk,-2.775557561562891351e-17_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 1.540743955509788682e-33_rk, 0.000000000000000000e+00_rk,1.540743955509788682e-33_rk,0.000000000000000000e+00_rk,2.775557561562891351e-17_rk,0.000000000000000000e+00_rk,-2.775557561562891351e-17_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk  &
                                        /),(/8,4/))

        test_dgrad2_dx(:,:,4,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,2.775557561562891351e-17_rk,1.387778780781445676e-17_rk,1.387778780781445676e-17_rk,-2.775557561562891351e-17_rk,1.387778780781445676e-17_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-1.387778780781445676e-17_rk,-2.775557561562891351e-17_rk,2.775557561562891351e-17_rk,0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk  &
                                        /),(/8,4/))

        test_dgrad2_dx(:,:,5,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, -1.115355071650410590e+00_rk, 0.000000000000000000e+00_rk,-1.115355071650410368e+00_rk,1.759305622509789391e+00_rk,6.439505508593788008e-01_rk,6.439505508593789118e-01_rk,-1.015735574742848923e+00_rk, &
                                        0.000000000000000000e+00_rk, -2.988584907226845555e-01_rk, 0.000000000000000000e+00_rk,-2.988584907226846110e-01_rk,1.263124606543373774e-01_rk,1.725460300683471504e-01_rk,1.725460300683471782e-01_rk,-7.292653316078570591e-02_rk, &
                                        0.000000000000000000e+00_rk, -1.115355071650410590e+00_rk, 0.000000000000000000e+00_rk,-1.115355071650410590e+00_rk,1.759305622509789391e+00_rk,-6.439505508593789118e-01_rk,-6.439505508593789118e-01_rk,1.015735574742848923e+00_rk, &
                                        0.000000000000000000e+00_rk, -2.988584907226846110e-01_rk, 0.000000000000000000e+00_rk,-2.988584907226845555e-01_rk,1.263124606543373218e-01_rk,-1.725460300683471782e-01_rk,-1.725460300683471504e-01_rk,7.292653316078565040e-02_rk  &
                                        /),(/8,4/))

        test_dgrad2_dx(:,:,5,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 3.574643641420676764e-17_rk, -1.577350269189625731e+00_rk,3.574643641420676148e-17_rk,-5.638465110051887460e-17_rk,9.106836025229589904e-01_rk,1.577350269189625731e+00_rk,-9.106836025229589904e-01_rk, &
                                        0.000000000000000000e+00_rk, -9.578228769477180502e-18_rk, -4.226497308103742689e-01_rk,-9.578228769477178961e-18_rk,4.048235811059714190e-18_rk,-2.440169358562924440e-01_rk,4.226497308103742689e-01_rk,2.440169358562924440e-01_rk, &
                                        0.000000000000000000e+00_rk, 3.574643641420676764e-17_rk, -1.577350269189625731e+00_rk,3.574643641420676764e-17_rk,-5.638465110051887460e-17_rk,9.106836025229589904e-01_rk,1.577350269189625731e+00_rk,-9.106836025229589904e-01_rk, &
                                        0.000000000000000000e+00_rk, -9.578228769477178961e-18_rk, -4.226497308103742689e-01_rk,-9.578228769477180502e-18_rk,4.048235811059711109e-18_rk,-2.440169358562924440e-01_rk,4.226497308103742689e-01_rk,2.440169358562924440e-01_rk  &
                                        /),(/8,4/))

        test_dgrad2_dx(:,:,5,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 1.115355071650410590e+00_rk, 0.000000000000000000e+00_rk,-1.115355071650410812e+00_rk,4.714045207910319002e-01_rk,6.439505508593789118e-01_rk,-6.439505508593789118e-01_rk,-2.721655269759087892e-01_rk, &
                                        0.000000000000000000e+00_rk, 2.988584907226845555e-01_rk, 0.000000000000000000e+00_rk,-2.988584907226846110e-01_rk,4.714045207910317892e-01_rk,1.725460300683471504e-01_rk,-1.725460300683471782e-01_rk,-2.721655269759086782e-01_rk, &
                                        0.000000000000000000e+00_rk, 1.115355071650410590e+00_rk, 0.000000000000000000e+00_rk,-1.115355071650410590e+00_rk,4.714045207910317892e-01_rk,-6.439505508593789118e-01_rk,6.439505508593789118e-01_rk,2.721655269759086782e-01_rk, &
                                        0.000000000000000000e+00_rk, 2.988584907226846110e-01_rk, 0.000000000000000000e+00_rk,-2.988584907226845555e-01_rk,4.714045207910317892e-01_rk,-1.725460300683471782e-01_rk,1.725460300683471504e-01_rk,2.721655269759087892e-01_rk  &
                                        /),(/8,4/))

        test_dgrad2_dx(:,:,6,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, -2.988584907226846110e-01_rk, 0.000000000000000000e+00_rk,-2.988584907226845555e-01_rk,4.714045207910317892e-01_rk,1.725460300683471782e-01_rk,1.725460300683471504e-01_rk,-2.721655269759086782e-01_rk, &
                                        0.000000000000000000e+00_rk, -1.115355071650410368e+00_rk, 0.000000000000000000e+00_rk,-1.115355071650410590e+00_rk,4.714045207910318447e-01_rk,6.439505508593789118e-01_rk,6.439505508593788008e-01_rk,-2.721655269759087337e-01_rk, &
                                        0.000000000000000000e+00_rk, -2.988584907226846110e-01_rk, 0.000000000000000000e+00_rk,-2.988584907226846110e-01_rk,4.714045207910317892e-01_rk,-1.725460300683471504e-01_rk,-1.725460300683471504e-01_rk,2.721655269759086782e-01_rk, &
                                        0.000000000000000000e+00_rk, -1.115355071650410590e+00_rk, 0.000000000000000000e+00_rk,-1.115355071650410368e+00_rk,4.714045207910315671e-01_rk,-6.439505508593788008e-01_rk,-6.439505508593789118e-01_rk,2.721655269759085671e-01_rk  &
                                        /),(/8,4/))

        test_dgrad2_dx(:,:,6,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 9.578228769477178961e-18_rk, -4.226497308103742689e-01_rk,9.578228769477180502e-18_rk,-1.510822172789464835e-17_rk,2.440169358562924440e-01_rk,4.226497308103742689e-01_rk,-2.440169358562924440e-01_rk, &
                                        0.000000000000000000e+00_rk, -3.574643641420676148e-17_rk, -1.577350269189625731e+00_rk,-3.574643641420676764e-17_rk,1.510822172789465452e-17_rk,-9.106836025229589904e-01_rk,1.577350269189625731e+00_rk,9.106836025229589904e-01_rk, &
                                        0.000000000000000000e+00_rk, 9.578228769477178961e-18_rk, -4.226497308103742689e-01_rk,9.578228769477178961e-18_rk,-1.510822172789464835e-17_rk,2.440169358562924440e-01_rk,4.226497308103742689e-01_rk,-2.440169358562924440e-01_rk, &
                                        0.000000000000000000e+00_rk, -3.574643641420676764e-17_rk, -1.577350269189625731e+00_rk,-3.574643641420676148e-17_rk,1.510822172789464219e-17_rk,-9.106836025229589904e-01_rk,1.577350269189625731e+00_rk,9.106836025229589904e-01_rk  &
                                        /),(/8,4/))

        test_dgrad2_dx(:,:,6,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 2.988584907226846110e-01_rk, 0.000000000000000000e+00_rk,-2.988584907226845555e-01_rk,1.263124606543374329e-01_rk,1.725460300683471782e-01_rk,-1.725460300683471504e-01_rk,-7.292653316078570591e-02_rk, &
                                        0.000000000000000000e+00_rk, 1.115355071650410368e+00_rk, 0.000000000000000000e+00_rk,-1.115355071650410590e+00_rk,1.759305622509789391e+00_rk,6.439505508593789118e-01_rk,-6.439505508593788008e-01_rk,-1.015735574742848923e+00_rk, &
                                        0.000000000000000000e+00_rk, 2.988584907226846110e-01_rk, 0.000000000000000000e+00_rk,-2.988584907226846110e-01_rk,1.263124606543373218e-01_rk,-1.725460300683471504e-01_rk,1.725460300683471504e-01_rk,7.292653316078567816e-02_rk, &
                                        0.000000000000000000e+00_rk, 1.115355071650410590e+00_rk, 0.000000000000000000e+00_rk,-1.115355071650410812e+00_rk,1.759305622509789391e+00_rk,-6.439505508593789118e-01_rk,6.439505508593789118e-01_rk,1.015735574742849145e+00_rk  &
                                        /),(/8,4/))

        test_dgrad2_dx(:,:,7,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 2.775557561562891351e-17_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-2.775557561562891351e-17_rk,2.775557561562891351e-17_rk,-6.938893903907228378e-18_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,2.775557561562891351e-17_rk,0.000000000000000000e+00_rk,-2.775557561562891351e-17_rk,2.775557561562891351e-17_rk,-1.387778780781445676e-17_rk  &
                                        /),(/8,4/))

        test_dgrad2_dx(:,:,7,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, -1.540743955509788682e-33_rk, 0.000000000000000000e+00_rk,1.540743955509788682e-33_rk,7.703719777548943412e-34_rk,2.775557561562891351e-17_rk,0.000000000000000000e+00_rk,-2.775557561562891351e-17_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 1.540743955509788682e-33_rk, 0.000000000000000000e+00_rk,-1.540743955509788682e-33_rk,-7.703719777548943412e-34_rk,2.775557561562891351e-17_rk,0.000000000000000000e+00_rk,-2.775557561562891351e-17_rk  &
                                        /),(/8,4/))

        test_dgrad2_dx(:,:,7,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, -2.775557561562891351e-17_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-2.775557561562891351e-17_rk,-2.775557561562891351e-17_rk,0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,-2.775557561562891351e-17_rk,0.000000000000000000e+00_rk,1.387778780781445676e-17_rk,-2.775557561562891351e-17_rk,2.775557561562891351e-17_rk  &
                                        /),(/8,4/))

        test_dgrad2_dx(:,:,8,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,2.775557561562891351e-17_rk,0.000000000000000000e+00_rk,2.775557561562891351e-17_rk,-2.775557561562891351e-17_rk,0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,2.775557561562891351e-17_rk,2.775557561562891351e-17_rk,0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk  &
                                        /),(/8,4/))

        test_dgrad2_dx(:,:,8,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, -1.540743955509788682e-33_rk, 0.000000000000000000e+00_rk,1.540743955509788682e-33_rk,0.000000000000000000e+00_rk,-2.775557561562891351e-17_rk,0.000000000000000000e+00_rk,2.775557561562891351e-17_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, -1.540743955509788682e-33_rk, 0.000000000000000000e+00_rk,-1.540743955509788682e-33_rk,0.000000000000000000e+00_rk,-2.775557561562891351e-17_rk,0.000000000000000000e+00_rk,2.775557561562891351e-17_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk  &
                                        /),(/8,4/))

        test_dgrad2_dx(:,:,8,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,-2.775557561562891351e-17_rk,-1.387778780781445676e-17_rk,-1.387778780781445676e-17_rk,2.775557561562891351e-17_rk,-1.387778780781445676e-17_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,1.387778780781445676e-17_rk,2.775557561562891351e-17_rk,-2.775557561562891351e-17_rk,0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk  &
                                        /),(/8,4/))

        
        

        
        do inode_diff = 1,self%elem%nterms_c 
            do idir =1,3
                @assertEqual(transpose(test_dgrad2_dx(:,:,inode_diff,idir)),self%faces(ETA_MIN)%dgrad2_dx(:,:,inode_diff,idir),tol)
            end do
        end do


        !
        ! grad3
        !
        test_dgrad3_dx(:,:,1,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 1.666666666666667129e-01_rk, 0.000000000000000000e+00_rk,1.666666666666667962e-01_rk,-2.628917115316047326e-01_rk,-9.622504486493768661e-02_rk,-9.622504486493764497e-02_rk,1.517806004204932391e-01_rk, &
                                        0.000000000000000000e+00_rk, 6.220084679281461248e-01_rk, 0.000000000000000000e+00_rk,6.220084679281463469e-01_rk,-2.628917115316044550e-01_rk,-3.591167563965420029e-01_rk,-3.591167563965419474e-01_rk,1.517806004204932668e-01_rk, &
                                        0.000000000000000000e+00_rk, 4.465819873852047706e-02_rk, 0.000000000000000000e+00_rk,4.465819873852047706e-02_rk,-7.044162180172905408e-02_rk,2.578342306320859090e-02_rk,2.578342306320859090e-02_rk,-4.066948930938210638e-02_rk, &
                                        0.000000000000000000e+00_rk, 1.666666666666667407e-01_rk, 0.000000000000000000e+00_rk,1.666666666666667407e-01_rk,-7.044162180172908183e-02_rk,9.622504486493765885e-02_rk,9.622504486493765885e-02_rk,-4.066948930938206475e-02_rk  &
                                        /),(/8,4/))

        test_dgrad3_dx(:,:,1,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, -5.341563017732122996e-18_rk, 2.357022603955160611e-01_rk,-5.341563017732125307e-18_rk,8.425515863913121689e-18_rk,-1.360827634879543946e-01_rk,-2.357022603955160611e-01_rk,1.360827634879543946e-01_rk, &
                                        0.000000000000000000e+00_rk, 1.993498457400721665e-17_rk, 8.796528112548948064e-01_rk,1.993498457400721973e-17_rk,-8.425515863913117067e-18_rk,5.078677873714245727e-01_rk,-8.796528112548948064e-01_rk,-5.078677873714245727e-01_rk, &
                                        0.000000000000000000e+00_rk, -1.431267496921273025e-18_rk, 6.315623032716868868e-02_rk,-1.431267496921273025e-18_rk,2.257610171551133548e-18_rk,-3.646326658039283908e-02_rk,-6.315623032716868868e-02_rk,3.646326658039283908e-02_rk, &
                                        0.000000000000000000e+00_rk, 5.341563017732123767e-18_rk, 2.357022603955158391e-01_rk,5.341563017732123767e-18_rk,-2.257610171551132007e-18_rk,1.360827634879543946e-01_rk,-2.357022603955158391e-01_rk,-1.360827634879543946e-01_rk  &
                                        /),(/8,4/))

        test_dgrad3_dx(:,:,1,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, -1.666666666666667129e-01_rk, 0.000000000000000000e+00_rk,1.666666666666669072e-01_rk,-7.044162180172924836e-02_rk,-9.622504486493774212e-02_rk,9.622504486493764497e-02_rk,4.066948930938213413e-02_rk, &
                                        0.000000000000000000e+00_rk, -6.220084679281461248e-01_rk, 0.000000000000000000e+00_rk,6.220084679281463469e-01_rk,-9.811252243246882943e-01_rk,-3.591167563965420029e-01_rk,3.591167563965419474e-01_rk,5.664529123725907667e-01_rk, &
                                        0.000000000000000000e+00_rk, -4.465819873852047706e-02_rk, 0.000000000000000000e+00_rk,4.465819873852047706e-02_rk,-1.887477567531187228e-02_rk,2.578342306320859090e-02_rk,-2.578342306320859090e-02_rk,-1.089735681703511705e-02_rk, &
                                        0.000000000000000000e+00_rk, -1.666666666666667407e-01_rk, 0.000000000000000000e+00_rk,1.666666666666667129e-01_rk,-2.628917115316043440e-01_rk,9.622504486493765885e-02_rk,-9.622504486493765885e-02_rk,-1.517806004204932113e-01_rk  &
                                        /),(/8,4/))

        test_dgrad3_dx(:,:,2,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, -9.553418012614796062e-01_rk, 0.000000000000000000e+00_rk,-9.553418012614797172e-01_rk,1.506908647387897204e+00_rk,5.515668461264171540e-01_rk,5.515668461264172651e-01_rk,-8.700141132135771338e-01_rk, &
                                        0.000000000000000000e+00_rk, -1.410683602522958768e+00_rk, 0.000000000000000000e+00_rk,-1.410683602522959434e+00_rk,5.962250448649378809e-01_rk,8.144585576580215536e-01_rk,8.144585576580214425e-01_rk,-3.442306901503685568e-01_rk, &
                                        0.000000000000000000e+00_rk, -2.559830641437076948e-01_rk, 0.000000000000000000e+00_rk,-2.559830641437076948e-01_rk,4.037749551350625632e-01_rk,-1.477918909913548129e-01_rk,-1.477918909913548129e-01_rk,2.331195790392574241e-01_rk, &
                                        0.000000000000000000e+00_rk, -3.779915320718539862e-01_rk, 0.000000000000000000e+00_rk,-3.779915320718538752e-01_rk,1.597580192787700082e-01_rk,-2.182335127930838392e-01_rk,-2.182335127930837837e-01_rk,9.223633543579921878e-02_rk  &
                                        /),(/8,4/))

        test_dgrad3_dx(:,:,2,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 3.061811060947146418e-17_rk, -1.351057332045926707e+00_rk,3.061811060947145802e-17_rk,-4.829548501192754882e-17_rk,7.800333143473332509e-01_rk,1.351057332045926707e+00_rk,-7.800333143473332509e-01_rk, &
                                        0.000000000000000000e+00_rk, -4.521153216574655090e-17_rk, -1.995007882905305285e+00_rk,-4.521153216574655706e-17_rk,1.910864189937736306e-17_rk,-1.151818338230803374e+00_rk,1.995007882905305285e+00_rk,1.151818338230803374e+00_rk, &
                                        0.000000000000000000e+00_rk, 8.204098011574668275e-18_rk, -3.620147210498532164e-01_rk,8.204098011574668275e-18_rk,-1.294073620701538108e-17_rk,2.090092966487399895e-01_rk,3.620147210498532164e-01_rk,-2.090092966487399895e-01_rk, &
                                        0.000000000000000000e+00_rk, -1.211439353238551362e-17_rk, -5.345607511182004501e-01_rk,-1.211439353238551671e-17_rk,5.120145165393678056e-18_rk,-3.086287935563015172e-01_rk,5.345607511182004501e-01_rk,3.086287935563015172e-01_rk  &
                                        /),(/8,4/))

        test_dgrad3_dx(:,:,2,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 9.553418012614796062e-01_rk, 0.000000000000000000e+00_rk,-9.553418012614800503e-01_rk,4.037749551350626742e-01_rk,5.515668461264173761e-01_rk,-5.515668461264172651e-01_rk,-2.331195790392574241e-01_rk, &
                                        0.000000000000000000e+00_rk, 1.410683602522958768e+00_rk, 0.000000000000000000e+00_rk,-1.410683602522959434e+00_rk,2.225142160180980877e+00_rk,8.144585576580215536e-01_rk,-8.144585576580214425e-01_rk,-1.284686425165674439e+00_rk, &
                                        0.000000000000000000e+00_rk, 2.559830641437076948e-01_rk, 0.000000000000000000e+00_rk,-2.559830641437076948e-01_rk,1.081911731523527986e-01_rk,-1.477918909913548129e-01_rk,1.477918909913548129e-01_rk,6.246420294345233354e-02_rk, &
                                        0.000000000000000000e+00_rk, 3.779915320718539862e-01_rk, 0.000000000000000000e+00_rk,-3.779915320718539862e-01_rk,5.962250448649377699e-01_rk,-2.182335127930838670e-01_rk,2.182335127930837837e-01_rk,3.442306901503684458e-01_rk  &
                                        /),(/8,4/))

        test_dgrad3_dx(:,:,3,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 1.666666666666667129e-01_rk, 0.000000000000000000e+00_rk,1.666666666666666852e-01_rk,-2.628917115316042885e-01_rk,-9.622504486493763110e-02_rk,-9.622504486493764497e-02_rk,1.517806004204931836e-01_rk, &
                                        0.000000000000000000e+00_rk, 6.220084679281461248e-01_rk, 0.000000000000000000e+00_rk,6.220084679281462359e-01_rk,-2.628917115316043440e-01_rk,-3.591167563965418918e-01_rk,-3.591167563965418363e-01_rk,1.517806004204932113e-01_rk, &
                                        0.000000000000000000e+00_rk, 4.465819873852047706e-02_rk, 0.000000000000000000e+00_rk,4.465819873852047706e-02_rk,-7.044162180172905408e-02_rk,2.578342306320859090e-02_rk,2.578342306320859090e-02_rk,-4.066948930938210638e-02_rk, &
                                        0.000000000000000000e+00_rk, 1.666666666666667407e-01_rk, 0.000000000000000000e+00_rk,1.666666666666666297e-01_rk,-7.044162180172902632e-02_rk,9.622504486493765885e-02_rk,9.622504486493768661e-02_rk,-4.066948930938203699e-02_rk  &
                                        /),(/8,4/))

        test_dgrad3_dx(:,:,3,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, -5.341563017732122996e-18_rk, 2.357022603955158668e-01_rk,-5.341563017732122226e-18_rk,8.425515863913112445e-18_rk,-1.360827634879543391e-01_rk,-2.357022603955158668e-01_rk,1.360827634879543391e-01_rk, &
                                        0.000000000000000000e+00_rk, 1.993498457400721049e-17_rk, 8.796528112548946954e-01_rk,1.993498457400721357e-17_rk,-8.425515863913113985e-18_rk,5.078677873714244617e-01_rk,-8.796528112548946954e-01_rk,-5.078677873714244617e-01_rk, &
                                        0.000000000000000000e+00_rk, -1.431267496921273025e-18_rk, 6.315623032716868868e-02_rk,-1.431267496921273025e-18_rk,2.257610171551133548e-18_rk,-3.646326658039283908e-02_rk,-6.315623032716868868e-02_rk,3.646326658039283908e-02_rk, &
                                        0.000000000000000000e+00_rk, 5.341563017732125307e-18_rk, 2.357022603955158391e-01_rk,5.341563017732123767e-18_rk,-2.257610171551132007e-18_rk,1.360827634879542836e-01_rk,-2.357022603955158391e-01_rk,-1.360827634879542836e-01_rk  &
                                        /),(/8,4/))

        test_dgrad3_dx(:,:,3,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, -1.666666666666667129e-01_rk, 0.000000000000000000e+00_rk,1.666666666666667129e-01_rk,-7.044162180172906795e-02_rk,-9.622504486493764497e-02_rk,9.622504486493764497e-02_rk,4.066948930938207862e-02_rk, &
                                        0.000000000000000000e+00_rk, -6.220084679281461248e-01_rk, 0.000000000000000000e+00_rk,6.220084679281462359e-01_rk,-9.811252243246880722e-01_rk,-3.591167563965418918e-01_rk,3.591167563965418363e-01_rk,5.664529123725905446e-01_rk, &
                                        0.000000000000000000e+00_rk, -4.465819873852047706e-02_rk, 0.000000000000000000e+00_rk,4.465819873852047706e-02_rk,-1.887477567531187228e-02_rk,2.578342306320859090e-02_rk,-2.578342306320859090e-02_rk,-1.089735681703511705e-02_rk, &
                                        0.000000000000000000e+00_rk, -1.666666666666667407e-01_rk, 0.000000000000000000e+00_rk,1.666666666666667129e-01_rk,-2.628917115316043440e-01_rk,9.622504486493765885e-02_rk,-9.622504486493768661e-02_rk,-1.517806004204932113e-01_rk  &
                                        /),(/8,4/))

        test_dgrad3_dx(:,:,4,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 6.220084679281463469e-01_rk, 0.000000000000000000e+00_rk,6.220084679281461248e-01_rk,-9.811252243246880722e-01_rk,-3.591167563965418363e-01_rk,-3.591167563965420029e-01_rk,5.664529123725906556e-01_rk, &
                                        0.000000000000000000e+00_rk, 1.666666666666665741e-01_rk, 0.000000000000000000e+00_rk,1.666666666666666297e-01_rk,-7.044162180172908183e-02_rk,-9.622504486493760334e-02_rk,-9.622504486493760334e-02_rk,4.066948930938207168e-02_rk, &
                                        0.000000000000000000e+00_rk, 1.666666666666667684e-01_rk, 0.000000000000000000e+00_rk,1.666666666666667684e-01_rk,-2.628917115316043995e-01_rk,9.622504486493764497e-02_rk,9.622504486493764497e-02_rk,-1.517806004204932113e-01_rk, &
                                        0.000000000000000000e+00_rk, 4.465819873852044930e-02_rk, 0.000000000000000000e+00_rk,4.465819873852042154e-02_rk,-1.887477567531187228e-02_rk,2.578342306320853539e-02_rk,2.578342306320857702e-02_rk,-1.089735681703511011e-02_rk  &
                                        /),(/8,4/))

        test_dgrad3_dx(:,:,4,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, -1.993498457400721973e-17_rk, 8.796528112548948064e-01_rk,-1.993498457400721049e-17_rk,3.144445328410131161e-17_rk,-5.078677873714245727e-01_rk,-8.796528112548948064e-01_rk,5.078677873714245727e-01_rk, &
                                        0.000000000000000000e+00_rk, 5.341563017732120685e-18_rk, 2.357022603955157836e-01_rk,5.341563017732120685e-18_rk,-2.257610171551131622e-18_rk,1.360827634879543391e-01_rk,-2.357022603955157836e-01_rk,-1.360827634879543391e-01_rk, &
                                        0.000000000000000000e+00_rk, -5.341563017732122996e-18_rk, 2.357022603955158668e-01_rk,-5.341563017732122996e-18_rk,8.425515863913113985e-18_rk,-1.360827634879543113e-01_rk,-2.357022603955158668e-01_rk,1.360827634879543113e-01_rk, &
                                        0.000000000000000000e+00_rk, 1.431267496921272254e-18_rk, 6.315623032716882745e-02_rk,1.431267496921269943e-18_rk,-6.049248222914144274e-19_rk,3.646326658039283908e-02_rk,-6.315623032716882745e-02_rk,-3.646326658039283908e-02_rk  &
                                        /),(/8,4/))

        test_dgrad3_dx(:,:,4,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, -6.220084679281463469e-01_rk, 0.000000000000000000e+00_rk,6.220084679281463469e-01_rk,-2.628917115316043440e-01_rk,-3.591167563965420029e-01_rk,3.591167563965420029e-01_rk,1.517806004204931836e-01_rk, &
                                        0.000000000000000000e+00_rk, -1.666666666666665741e-01_rk, 0.000000000000000000e+00_rk,1.666666666666666297e-01_rk,-2.628917115316041775e-01_rk,-9.622504486493760334e-02_rk,9.622504486493760334e-02_rk,1.517806004204931281e-01_rk, &
                                        0.000000000000000000e+00_rk, -1.666666666666667684e-01_rk, 0.000000000000000000e+00_rk,1.666666666666667684e-01_rk,-7.044162180172906795e-02_rk,9.622504486493764497e-02_rk,-9.622504486493764497e-02_rk,-4.066948930938207168e-02_rk, &
                                        0.000000000000000000e+00_rk, -4.465819873852044930e-02_rk, 0.000000000000000000e+00_rk,4.465819873852056032e-02_rk,-7.044162180172908183e-02_rk,2.578342306320861865e-02_rk,-2.578342306320857702e-02_rk,-4.066948930938210638e-02_rk  &
                                        /),(/8,4/))

        test_dgrad3_dx(:,:,5,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 4.465819873852047706e-02_rk, 0.000000000000000000e+00_rk,4.465819873852051869e-02_rk,-7.044162180172913734e-02_rk,-2.578342306320861171e-02_rk,-2.578342306320859090e-02_rk,4.066948930938213413e-02_rk, &
                                        0.000000000000000000e+00_rk, 1.666666666666666852e-01_rk, 0.000000000000000000e+00_rk,1.666666666666667407e-01_rk,-7.044162180172908183e-02_rk,-9.622504486493765885e-02_rk,-9.622504486493760334e-02_rk,4.066948930938208556e-02_rk, &
                                        0.000000000000000000e+00_rk, 1.666666666666667129e-01_rk, 0.000000000000000000e+00_rk,1.666666666666667129e-01_rk,-2.628917115316043995e-01_rk,9.622504486493764497e-02_rk,9.622504486493764497e-02_rk,-1.517806004204932113e-01_rk, &
                                        0.000000000000000000e+00_rk, 6.220084679281463469e-01_rk, 0.000000000000000000e+00_rk,6.220084679281463469e-01_rk,-2.628917115316043995e-01_rk,3.591167563965420029e-01_rk,3.591167563965419474e-01_rk,-1.517806004204931836e-01_rk  &
                                        /),(/8,4/))

        test_dgrad3_dx(:,:,5,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, -1.431267496921273025e-18_rk, 6.315623032716874419e-02_rk,-1.431267496921274180e-18_rk,2.257610171551135859e-18_rk,-3.646326658039286683e-02_rk,-6.315623032716874419e-02_rk,3.646326658039286683e-02_rk, &
                                        0.000000000000000000e+00_rk, 5.341563017732120685e-18_rk, 2.357022603955158946e-01_rk,5.341563017732123767e-18_rk,-2.257610171551132392e-18_rk,1.360827634879543391e-01_rk,-2.357022603955158946e-01_rk,-1.360827634879543391e-01_rk, &
                                        0.000000000000000000e+00_rk, -5.341563017732122996e-18_rk, 2.357022603955158668e-01_rk,-5.341563017732122996e-18_rk,8.425515863913113985e-18_rk,-1.360827634879543391e-01_rk,-2.357022603955158668e-01_rk,1.360827634879543391e-01_rk, &
                                        0.000000000000000000e+00_rk, 1.993498457400721665e-17_rk, 8.796528112548946954e-01_rk,1.993498457400721973e-17_rk,-8.425515863913113985e-18_rk,5.078677873714245727e-01_rk,-8.796528112548946954e-01_rk,-5.078677873714245727e-01_rk  &
                                        /),(/8,4/))

        test_dgrad3_dx(:,:,5,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, -4.465819873852047706e-02_rk, 0.000000000000000000e+00_rk,4.465819873852053257e-02_rk,-1.887477567531191391e-02_rk,-2.578342306320861865e-02_rk,2.578342306320859090e-02_rk,1.089735681703511705e-02_rk, &
                                        0.000000000000000000e+00_rk, -1.666666666666666852e-01_rk, 0.000000000000000000e+00_rk,1.666666666666667407e-01_rk,-2.628917115316043995e-01_rk,-9.622504486493765885e-02_rk,9.622504486493760334e-02_rk,1.517806004204932391e-01_rk, &
                                        0.000000000000000000e+00_rk, -1.666666666666667129e-01_rk, 0.000000000000000000e+00_rk,1.666666666666667129e-01_rk,-7.044162180172906795e-02_rk,9.622504486493764497e-02_rk,-9.622504486493764497e-02_rk,-4.066948930938207862e-02_rk, &
                                        0.000000000000000000e+00_rk, -6.220084679281463469e-01_rk, 0.000000000000000000e+00_rk,6.220084679281464579e-01_rk,-9.811252243246884053e-01_rk,3.591167563965420584e-01_rk,-3.591167563965419474e-01_rk,-5.664529123725908777e-01_rk  &
                                        /),(/8,4/))

        test_dgrad3_dx(:,:,6,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, -2.559830641437076948e-01_rk, 0.000000000000000000e+00_rk,-2.559830641437076948e-01_rk,4.037749551350625632e-01_rk,1.477918909913548129e-01_rk,1.477918909913548129e-01_rk,-2.331195790392574241e-01_rk, &
                                        0.000000000000000000e+00_rk, -3.779915320718537086e-01_rk, 0.000000000000000000e+00_rk,-3.779915320718538752e-01_rk,1.597580192787700915e-01_rk,2.182335127930838392e-01_rk,2.182335127930838947e-01_rk,-9.223633543579926042e-02_rk, &
                                        0.000000000000000000e+00_rk, -9.553418012614796062e-01_rk, 0.000000000000000000e+00_rk,-9.553418012614796062e-01_rk,1.506908647387897204e+00_rk,-5.515668461264172651e-01_rk,-5.515668461264172651e-01_rk,8.700141132135771338e-01_rk, &
                                        0.000000000000000000e+00_rk, -1.410683602522959434e+00_rk, 0.000000000000000000e+00_rk,-1.410683602522959434e+00_rk,5.962250448649376589e-01_rk,-8.144585576580215536e-01_rk,-8.144585576580215536e-01_rk,3.442306901503682792e-01_rk  &
                                        /),(/8,4/))

        test_dgrad3_dx(:,:,6,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 8.204098011574668275e-18_rk, -3.620147210498533830e-01_rk,8.204098011574668275e-18_rk,-1.294073620701537954e-17_rk,2.090092966487399617e-01_rk,3.620147210498533830e-01_rk,-2.090092966487399617e-01_rk, &
                                        0.000000000000000000e+00_rk, -1.211439353238551979e-17_rk, -5.345607511182003391e-01_rk,-1.211439353238551671e-17_rk,5.120145165393678056e-18_rk,-3.086287935563015172e-01_rk,5.345607511182003391e-01_rk,3.086287935563015172e-01_rk, &
                                        0.000000000000000000e+00_rk, 3.061811060947146418e-17_rk, -1.351057332045926485e+00_rk,3.061811060947146418e-17_rk,-4.829548501192754882e-17_rk,7.800333143473332509e-01_rk,1.351057332045926485e+00_rk,-7.800333143473332509e-01_rk, &
                                        0.000000000000000000e+00_rk, -4.521153216574655706e-17_rk, -1.995007882905305507e+00_rk,-4.521153216574655706e-17_rk,1.910864189937735690e-17_rk,-1.151818338230803596e+00_rk,1.995007882905305507e+00_rk,1.151818338230803596e+00_rk  &
                                        /),(/8,4/))

        test_dgrad3_dx(:,:,6,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 2.559830641437076948e-01_rk, 0.000000000000000000e+00_rk,-2.559830641437077503e-01_rk,1.081911731523528264e-01_rk,1.477918909913548962e-01_rk,-1.477918909913548129e-01_rk,-6.246420294345231966e-02_rk, &
                                        0.000000000000000000e+00_rk, 3.779915320718537086e-01_rk, 0.000000000000000000e+00_rk,-3.779915320718538752e-01_rk,5.962250448649376589e-01_rk,2.182335127930838392e-01_rk,-2.182335127930838947e-01_rk,-3.442306901503684458e-01_rk, &
                                        0.000000000000000000e+00_rk, 9.553418012614796062e-01_rk, 0.000000000000000000e+00_rk,-9.553418012614796062e-01_rk,4.037749551350624522e-01_rk,-5.515668461264172651e-01_rk,5.515668461264172651e-01_rk,2.331195790392573408e-01_rk, &
                                        0.000000000000000000e+00_rk, 1.410683602522959434e+00_rk, 0.000000000000000000e+00_rk,-1.410683602522959657e+00_rk,2.225142160180980877e+00_rk,-8.144585576580216646e-01_rk,8.144585576580215536e-01_rk,1.284686425165674883e+00_rk  &
                                        /),(/8,4/))

        test_dgrad3_dx(:,:,7,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 4.465819873852047706e-02_rk, 0.000000000000000000e+00_rk,4.465819873852043542e-02_rk,-7.044162180172910959e-02_rk,-2.578342306320857008e-02_rk,-2.578342306320859090e-02_rk,4.066948930938207862e-02_rk, &
                                        0.000000000000000000e+00_rk, 1.666666666666666852e-01_rk, 0.000000000000000000e+00_rk,1.666666666666666297e-01_rk,-7.044162180172908183e-02_rk,-9.622504486493765885e-02_rk,-9.622504486493760334e-02_rk,4.066948930938208556e-02_rk, &
                                        0.000000000000000000e+00_rk, 1.666666666666667129e-01_rk, 0.000000000000000000e+00_rk,1.666666666666667129e-01_rk,-2.628917115316043995e-01_rk,9.622504486493764497e-02_rk,9.622504486493764497e-02_rk,-1.517806004204932113e-01_rk, &
                                        0.000000000000000000e+00_rk, 6.220084679281463469e-01_rk, 0.000000000000000000e+00_rk,6.220084679281462359e-01_rk,-2.628917115316042330e-01_rk,3.591167563965418918e-01_rk,3.591167563965419474e-01_rk,-1.517806004204931281e-01_rk  &
                                        /),(/8,4/))

        test_dgrad3_dx(:,:,7,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, -1.431267496921273025e-18_rk, 6.315623032716871643e-02_rk,-1.431267496921271869e-18_rk,2.257610171551132777e-18_rk,-3.646326658039282520e-02_rk,-6.315623032716871643e-02_rk,3.646326658039282520e-02_rk, &
                                        0.000000000000000000e+00_rk, 5.341563017732120685e-18_rk, 2.357022603955160056e-01_rk,5.341563017732123767e-18_rk,-2.257610171551132392e-18_rk,1.360827634879543946e-01_rk,-2.357022603955160056e-01_rk,-1.360827634879543946e-01_rk, &
                                        0.000000000000000000e+00_rk, -5.341563017732122996e-18_rk, 2.357022603955158668e-01_rk,-5.341563017732122996e-18_rk,8.425515863913113985e-18_rk,-1.360827634879543391e-01_rk,-2.357022603955158668e-01_rk,1.360827634879543391e-01_rk, &
                                        0.000000000000000000e+00_rk, 1.993498457400721665e-17_rk, 8.796528112548946954e-01_rk,1.993498457400721357e-17_rk,-8.425515863913110904e-18_rk,5.078677873714245727e-01_rk,-8.796528112548946954e-01_rk,-5.078677873714245727e-01_rk  &
                                        /),(/8,4/))

        test_dgrad3_dx(:,:,7,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, -4.465819873852047706e-02_rk, 0.000000000000000000e+00_rk,4.465819873852050481e-02_rk,-1.887477567531186534e-02_rk,-2.578342306320860478e-02_rk,2.578342306320859090e-02_rk,1.089735681703511705e-02_rk, &
                                        0.000000000000000000e+00_rk, -1.666666666666666852e-01_rk, 0.000000000000000000e+00_rk,1.666666666666666297e-01_rk,-2.628917115316041775e-01_rk,-9.622504486493765885e-02_rk,9.622504486493760334e-02_rk,1.517806004204932391e-01_rk, &
                                        0.000000000000000000e+00_rk, -1.666666666666667129e-01_rk, 0.000000000000000000e+00_rk,1.666666666666667129e-01_rk,-7.044162180172906795e-02_rk,9.622504486493764497e-02_rk,-9.622504486493764497e-02_rk,-4.066948930938207862e-02_rk, &
                                        0.000000000000000000e+00_rk, -6.220084679281463469e-01_rk, 0.000000000000000000e+00_rk,6.220084679281462359e-01_rk,-9.811252243246884053e-01_rk,3.591167563965419474e-01_rk,-3.591167563965419474e-01_rk,-5.664529123725906556e-01_rk  &
                                        /),(/8,4/))

        test_dgrad3_dx(:,:,8,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 1.666666666666667684e-01_rk, 0.000000000000000000e+00_rk,1.666666666666666297e-01_rk,-2.628917115316042885e-01_rk,-9.622504486493760334e-02_rk,-9.622504486493764497e-02_rk,1.517806004204932113e-01_rk, &
                                        0.000000000000000000e+00_rk, 4.465819873852042154e-02_rk, 0.000000000000000000e+00_rk,4.465819873852042154e-02_rk,-1.887477567531187228e-02_rk,-2.578342306320853539e-02_rk,-2.578342306320863253e-02_rk,1.089735681703511011e-02_rk, &
                                        0.000000000000000000e+00_rk, 6.220084679281463469e-01_rk, 0.000000000000000000e+00_rk,6.220084679281463469e-01_rk,-9.811252243246882943e-01_rk,3.591167563965420029e-01_rk,3.591167563965420029e-01_rk,-5.664529123725906556e-01_rk, &
                                        0.000000000000000000e+00_rk, 1.666666666666666297e-01_rk, 0.000000000000000000e+00_rk,1.666666666666666297e-01_rk,-7.044162180172902632e-02_rk,9.622504486493760334e-02_rk,9.622504486493765885e-02_rk,-4.066948930938206475e-02_rk  &
                                        /),(/8,4/))

        test_dgrad3_dx(:,:,8,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, -5.341563017732122996e-18_rk, 2.357022603955158391e-01_rk,-5.341563017732120685e-18_rk,8.425515863913109363e-18_rk,-1.360827634879542836e-01_rk,-2.357022603955158391e-01_rk,1.360827634879542836e-01_rk, &
                                        0.000000000000000000e+00_rk, 1.431267496921275336e-18_rk, 6.315623032716854990e-02_rk,1.431267496921269943e-18_rk,-6.049248222914144274e-19_rk,3.646326658039286683e-02_rk,-6.315623032716854990e-02_rk,-3.646326658039286683e-02_rk, &
                                        0.000000000000000000e+00_rk, -1.993498457400721973e-17_rk, 8.796528112548948064e-01_rk,-1.993498457400721973e-17_rk,3.144445328410131777e-17_rk,-5.078677873714245727e-01_rk,-8.796528112548948064e-01_rk,5.078677873714245727e-01_rk, &
                                        0.000000000000000000e+00_rk, 5.341563017732123767e-18_rk, 2.357022603955160611e-01_rk,5.341563017732120685e-18_rk,-2.257610171551132007e-18_rk,1.360827634879542836e-01_rk,-2.357022603955160611e-01_rk,-1.360827634879542836e-01_rk  &
                                        /),(/8,4/))

        test_dgrad3_dx(:,:,8,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, -1.666666666666667684e-01_rk, 0.000000000000000000e+00_rk,1.666666666666667407e-01_rk,-7.044162180172905408e-02_rk,-9.622504486493768661e-02_rk,9.622504486493764497e-02_rk,4.066948930938207168e-02_rk, &
                                        0.000000000000000000e+00_rk, -4.465819873852042154e-02_rk, 0.000000000000000000e+00_rk,4.465819873852042154e-02_rk,-7.044162180172908183e-02_rk,-2.578342306320853539e-02_rk,2.578342306320863253e-02_rk,4.066948930938205087e-02_rk, &
                                        0.000000000000000000e+00_rk, -6.220084679281463469e-01_rk, 0.000000000000000000e+00_rk,6.220084679281463469e-01_rk,-2.628917115316043995e-01_rk,3.591167563965420029e-01_rk,-3.591167563965420029e-01_rk,-1.517806004204931836e-01_rk, &
                                        0.000000000000000000e+00_rk, -1.666666666666666297e-01_rk, 0.000000000000000000e+00_rk,1.666666666666668239e-01_rk,-2.628917115316043440e-01_rk,9.622504486493765885e-02_rk,-9.622504486493765885e-02_rk,-1.517806004204932113e-01_rk  &
                                        /),(/8,4/))

        
        

        
        do inode_diff = 1,self%elem%nterms_c 
            do idir =1,3
                @assertEqual(transpose(test_dgrad3_dx(:,:,inode_diff,idir)),self%faces(ETA_MIN)%dgrad3_dx(:,:,inode_diff,idir),tol)
            end do
        end do

    end subroutine testElement_face_dgrad_dx_etamin
    !*******************************************************************************************








    !>  Test that the derivatives of the scaled normal vectors have been computed correctly. These are really
    !!  unit vectors scaled by the inverse jacobian of the face metric terms. Essentially,
    !!  an area scaling.
    !!
    !!  @author Matteo Ugolotti
    !!
    !------------------------------------------------------------------------------------------
    @Test
    subroutine testelement_face_dnormals_dx(self)
        class(test_element_linearC_dx),    intent(inout)   :: self

        real(rk), dimension(3,self%faces(XI_MAX)%basis_s%nnodes_face(),self%elem%nterms_c,3) :: test_dnorm_dx
        integer(ik) :: inode_diff, idir, irow
        real(rk)    :: tol = 1.e-13_rk
        real(rk)    :: mat(4,3)
        
        
        !
        ! xi_min
        !
        test_dnorm_dx(:,:,1,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, -1.394193839563012960e-01_rk, 1.971687836487032164e-01_rk, &
                                        0.000000000000000000e+00_rk, -3.735731134033556944e-02_rk, 1.971687836487032164e-01_rk, &
                                        0.000000000000000000e+00_rk, -1.394193839563012960e-01_rk, 5.283121635129678362e-02_rk, &
                                        0.000000000000000000e+00_rk, -3.735731134033556944e-02_rk, 5.283121635129678362e-02_rk  &
                                        /),(/3,4/))

        test_dnorm_dx(:,:,1,2) = reshape((/                                                                                 &
                                        1.394193839563012960e-01_rk, 0.000000000000000000e+00_rk, 1.394193839563012960e-01_rk, &
                                        3.735731134033556944e-02_rk, 0.000000000000000000e+00_rk, 3.735731134033556944e-02_rk, &
                                        1.394193839563012960e-01_rk, 0.000000000000000000e+00_rk, 1.394193839563012960e-01_rk, &
                                        3.735731134033556944e-02_rk, 0.000000000000000000e+00_rk, 3.735731134033556944e-02_rk  &
                                        /),(/3,4/))

        test_dnorm_dx(:,:,1,3) = reshape((/                                                                                 &
                                        -1.971687836487032164e-01_rk, -1.394193839563012960e-01_rk, 0.000000000000000000e+00_rk, &
                                        -1.971687836487032164e-01_rk, -3.735731134033556944e-02_rk, 0.000000000000000000e+00_rk, &
                                        -5.283121635129678362e-02_rk, -1.394193839563012960e-01_rk, 0.000000000000000000e+00_rk, &
                                        -5.283121635129678362e-02_rk, -3.735731134033556944e-02_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))

        test_dnorm_dx(:,:,2,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))

        test_dnorm_dx(:,:,2,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))

        test_dnorm_dx(:,:,2,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))

        test_dnorm_dx(:,:,3,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))

        test_dnorm_dx(:,:,3,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))

        test_dnorm_dx(:,:,3,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))

        test_dnorm_dx(:,:,4,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, -3.735731134033556944e-02_rk, -1.971687836487032164e-01_rk, &
                                        0.000000000000000000e+00_rk, -1.394193839563012960e-01_rk, -1.971687836487032164e-01_rk, &
                                        0.000000000000000000e+00_rk, -3.735731134033556944e-02_rk, -5.283121635129678362e-02_rk, &
                                        0.000000000000000000e+00_rk, -1.394193839563012960e-01_rk, -5.283121635129678362e-02_rk  &
                                        /),(/3,4/))

        test_dnorm_dx(:,:,4,2) = reshape((/                                                                                 &
                                        3.735731134033556944e-02_rk, 0.000000000000000000e+00_rk, 3.735731134033556944e-02_rk, &
                                        1.394193839563012960e-01_rk, 0.000000000000000000e+00_rk, 1.394193839563012960e-01_rk, &
                                        3.735731134033556944e-02_rk, 0.000000000000000000e+00_rk, 3.735731134033556944e-02_rk, &
                                        1.394193839563012960e-01_rk, 0.000000000000000000e+00_rk, 1.394193839563012960e-01_rk  &
                                        /),(/3,4/))

        test_dnorm_dx(:,:,4,3) = reshape((/                                                                                 &
                                        1.971687836487032164e-01_rk, -3.735731134033556944e-02_rk, 0.000000000000000000e+00_rk, &
                                        1.971687836487032164e-01_rk, -1.394193839563012960e-01_rk, 0.000000000000000000e+00_rk, &
                                        5.283121635129678362e-02_rk, -3.735731134033556944e-02_rk, 0.000000000000000000e+00_rk, &
                                        5.283121635129678362e-02_rk, -1.394193839563012960e-01_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))

        test_dnorm_dx(:,:,5,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 1.394193839563012960e-01_rk, 5.283121635129678362e-02_rk, &
                                        0.000000000000000000e+00_rk, 3.735731134033556944e-02_rk, 5.283121635129678362e-02_rk, &
                                        0.000000000000000000e+00_rk, 1.394193839563012960e-01_rk, 1.971687836487032164e-01_rk, &
                                        0.000000000000000000e+00_rk, 3.735731134033556944e-02_rk, 1.971687836487032164e-01_rk  &
                                        /),(/3,4/))

        test_dnorm_dx(:,:,5,2) = reshape((/                                                                                 &
                                        -1.394193839563012960e-01_rk, 0.000000000000000000e+00_rk, -1.394193839563012960e-01_rk, &
                                        -3.735731134033556944e-02_rk, 0.000000000000000000e+00_rk, -3.735731134033556944e-02_rk, &
                                        -1.394193839563012960e-01_rk, 0.000000000000000000e+00_rk, -1.394193839563012960e-01_rk, &
                                        -3.735731134033556944e-02_rk, 0.000000000000000000e+00_rk, -3.735731134033556944e-02_rk  &
                                        /),(/3,4/))

        test_dnorm_dx(:,:,5,3) = reshape((/                                                                                 &
                                        -5.283121635129678362e-02_rk, 1.394193839563012960e-01_rk, 0.000000000000000000e+00_rk, &
                                        -5.283121635129678362e-02_rk, 3.735731134033556944e-02_rk, 0.000000000000000000e+00_rk, &
                                        -1.971687836487032164e-01_rk, 1.394193839563012960e-01_rk, 0.000000000000000000e+00_rk, &
                                        -1.971687836487032164e-01_rk, 3.735731134033556944e-02_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))

        test_dnorm_dx(:,:,6,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))

        test_dnorm_dx(:,:,6,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))

        test_dnorm_dx(:,:,6,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))

        test_dnorm_dx(:,:,7,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))

        test_dnorm_dx(:,:,7,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))

        test_dnorm_dx(:,:,7,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))

        test_dnorm_dx(:,:,8,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 3.735731134033556944e-02_rk, -5.283121635129678362e-02_rk, &
                                        0.000000000000000000e+00_rk, 1.394193839563012960e-01_rk, -5.283121635129678362e-02_rk, &
                                        0.000000000000000000e+00_rk, 3.735731134033556944e-02_rk, -1.971687836487032164e-01_rk, &
                                        0.000000000000000000e+00_rk, 1.394193839563012960e-01_rk, -1.971687836487032164e-01_rk  &
                                        /),(/3,4/))

        test_dnorm_dx(:,:,8,2) = reshape((/                                                                                 &
                                        -3.735731134033556944e-02_rk, 0.000000000000000000e+00_rk, -3.735731134033556944e-02_rk, &
                                        -1.394193839563012960e-01_rk, 0.000000000000000000e+00_rk, -1.394193839563012960e-01_rk, &
                                        -3.735731134033556944e-02_rk, 0.000000000000000000e+00_rk, -3.735731134033556944e-02_rk, &
                                        -1.394193839563012960e-01_rk, 0.000000000000000000e+00_rk, -1.394193839563012960e-01_rk  &
                                        /),(/3,4/))

        test_dnorm_dx(:,:,8,3) = reshape((/                                                                                 &
                                        5.283121635129678362e-02_rk, 3.735731134033556944e-02_rk, 0.000000000000000000e+00_rk, &
                                        5.283121635129678362e-02_rk, 1.394193839563012960e-01_rk, 0.000000000000000000e+00_rk, &
                                        1.971687836487032164e-01_rk, 3.735731134033556944e-02_rk, 0.000000000000000000e+00_rk, &
                                        1.971687836487032164e-01_rk, 1.394193839563012960e-01_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))

        
        
        
        
        do inode_diff = 1,self%elem%nterms_c
            do idir = 1,3
                @assertequal(transpose(test_dnorm_dx(:,:,inode_diff,idir)),self%faces(xi_min)%dnorm_dx(:,:,inode_diff,idir),tol)
            end do
        end do
        
        !
        ! xi_max
        !
        test_dnorm_dx(:,:,1,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))

        test_dnorm_dx(:,:,1,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))

        test_dnorm_dx(:,:,1,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))

        test_dnorm_dx(:,:,2,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 1.394193839563013237e-01_rk, -1.971687836487032164e-01_rk, &
                                        0.000000000000000000e+00_rk, 3.735731134033556944e-02_rk, -1.971687836487032164e-01_rk, &
                                        0.000000000000000000e+00_rk, 1.394193839563013237e-01_rk, -5.283121635129678362e-02_rk, &
                                        0.000000000000000000e+00_rk, 3.735731134033556944e-02_rk, -5.283121635129678362e-02_rk  &
                                        /),(/3,4/))

        test_dnorm_dx(:,:,2,2) = reshape((/                                                                                 &
                                        -1.394193839563013237e-01_rk, 0.000000000000000000e+00_rk, -1.394193839563013515e-01_rk, &
                                        -3.735731134033556944e-02_rk, 0.000000000000000000e+00_rk, -3.735731134033560413e-02_rk, &
                                        -1.394193839563013237e-01_rk, 0.000000000000000000e+00_rk, -1.394193839563013237e-01_rk, &
                                        -3.735731134033556944e-02_rk, 0.000000000000000000e+00_rk, -3.735731134033558332e-02_rk  &
                                        /),(/3,4/))

        test_dnorm_dx(:,:,2,3) = reshape((/                                                                                 &
                                        1.971687836487032164e-01_rk, 1.394193839563013515e-01_rk, 0.000000000000000000e+00_rk, &
                                        1.971687836487032164e-01_rk, 3.735731134033560413e-02_rk, 0.000000000000000000e+00_rk, &
                                        5.283121635129678362e-02_rk, 1.394193839563013237e-01_rk, 0.000000000000000000e+00_rk, &
                                        5.283121635129678362e-02_rk, 3.735731134033558332e-02_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))

        test_dnorm_dx(:,:,3,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 3.735731134033557638e-02_rk, 1.971687836487032164e-01_rk, &
                                        0.000000000000000000e+00_rk, 1.394193839563012960e-01_rk, 1.971687836487032164e-01_rk, &
                                        0.000000000000000000e+00_rk, 3.735731134033557638e-02_rk, 5.283121635129678362e-02_rk, &
                                        0.000000000000000000e+00_rk, 1.394193839563012960e-01_rk, 5.283121635129678362e-02_rk  &
                                        /),(/3,4/))

        test_dnorm_dx(:,:,3,2) = reshape((/                                                                                 &
                                        -3.735731134033557638e-02_rk, 0.000000000000000000e+00_rk, -3.735731134033554168e-02_rk, &
                                        -1.394193839563012960e-01_rk, 0.000000000000000000e+00_rk, -1.394193839563013237e-01_rk, &
                                        -3.735731134033557638e-02_rk, 0.000000000000000000e+00_rk, -3.735731134033556944e-02_rk, &
                                        -1.394193839563012960e-01_rk, 0.000000000000000000e+00_rk, -1.394193839563013237e-01_rk  &
                                        /),(/3,4/))

        test_dnorm_dx(:,:,3,3) = reshape((/                                                                                 &
                                        -1.971687836487032164e-01_rk, 3.735731134033554168e-02_rk, 0.000000000000000000e+00_rk, &
                                        -1.971687836487032164e-01_rk, 1.394193839563013237e-01_rk, 0.000000000000000000e+00_rk, &
                                        -5.283121635129678362e-02_rk, 3.735731134033556944e-02_rk, 0.000000000000000000e+00_rk, &
                                        -5.283121635129678362e-02_rk, 1.394193839563013237e-01_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))

        test_dnorm_dx(:,:,4,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))

        test_dnorm_dx(:,:,4,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))

        test_dnorm_dx(:,:,4,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))

        test_dnorm_dx(:,:,5,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))

        test_dnorm_dx(:,:,5,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))

        test_dnorm_dx(:,:,5,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))

        test_dnorm_dx(:,:,6,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, -1.394193839563013237e-01_rk, -5.283121635129678362e-02_rk, &
                                        0.000000000000000000e+00_rk, -3.735731134033556944e-02_rk, -5.283121635129678362e-02_rk, &
                                        0.000000000000000000e+00_rk, -1.394193839563013237e-01_rk, -1.971687836487032164e-01_rk, &
                                        0.000000000000000000e+00_rk, -3.735731134033556944e-02_rk, -1.971687836487032164e-01_rk  &
                                        /),(/3,4/))

        test_dnorm_dx(:,:,6,2) = reshape((/                                                                                 &
                                        1.394193839563013237e-01_rk, 0.000000000000000000e+00_rk, 1.394193839563013237e-01_rk, &
                                        3.735731134033556944e-02_rk, 0.000000000000000000e+00_rk, 3.735731134033557638e-02_rk, &
                                        1.394193839563013237e-01_rk, 0.000000000000000000e+00_rk, 1.394193839563012960e-01_rk, &
                                        3.735731134033556944e-02_rk, 0.000000000000000000e+00_rk, 3.735731134033555556e-02_rk  &
                                        /),(/3,4/))

        test_dnorm_dx(:,:,6,3) = reshape((/                                                                                 &
                                        5.283121635129678362e-02_rk, -1.394193839563013237e-01_rk, 0.000000000000000000e+00_rk, &
                                        5.283121635129678362e-02_rk, -3.735731134033557638e-02_rk, 0.000000000000000000e+00_rk, &
                                        1.971687836487032164e-01_rk, -1.394193839563012960e-01_rk, 0.000000000000000000e+00_rk, &
                                        1.971687836487032164e-01_rk, -3.735731134033555556e-02_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))

        test_dnorm_dx(:,:,7,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, -3.735731134033557638e-02_rk, 5.283121635129678362e-02_rk, &
                                        0.000000000000000000e+00_rk, -1.394193839563012960e-01_rk, 5.283121635129678362e-02_rk, &
                                        0.000000000000000000e+00_rk, -3.735731134033557638e-02_rk, 1.971687836487032164e-01_rk, &
                                        0.000000000000000000e+00_rk, -1.394193839563012960e-01_rk, 1.971687836487032164e-01_rk  &
                                        /),(/3,4/))

        test_dnorm_dx(:,:,7,2) = reshape((/                                                                                 &
                                        3.735731134033557638e-02_rk, 0.000000000000000000e+00_rk, 3.735731134033556944e-02_rk, &
                                        1.394193839563012960e-01_rk, 0.000000000000000000e+00_rk, 1.394193839563013515e-01_rk, &
                                        3.735731134033557638e-02_rk, 0.000000000000000000e+00_rk, 3.735731134033559719e-02_rk, &
                                        1.394193839563012960e-01_rk, 0.000000000000000000e+00_rk, 1.394193839563013793e-01_rk  &
                                        /),(/3,4/))

        test_dnorm_dx(:,:,7,3) = reshape((/                                                                                 &
                                        -5.283121635129678362e-02_rk, -3.735731134033556944e-02_rk, 0.000000000000000000e+00_rk, &
                                        -5.283121635129678362e-02_rk, -1.394193839563013515e-01_rk, 0.000000000000000000e+00_rk, &
                                        -1.971687836487032164e-01_rk, -3.735731134033559719e-02_rk, 0.000000000000000000e+00_rk, &
                                        -1.971687836487032164e-01_rk, -1.394193839563013793e-01_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))

        test_dnorm_dx(:,:,8,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))

        test_dnorm_dx(:,:,8,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))

        test_dnorm_dx(:,:,8,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))

        
        
        


        do inode_diff = 1,self%elem%nterms_c
            do idir = 1,3
                @assertequal(transpose(test_dnorm_dx(:,:,inode_diff,idir)),self%faces(xi_max)%dnorm_dx(:,:,inode_diff,idir),tol)
            end do
        end do

        !
        ! eta_min
        !
        test_dnorm_dx(:,:,1,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, -1.394193839563012960e-01_rk, -1.971687836487032164e-01_rk, &
                                        0.000000000000000000e+00_rk, -3.735731134033556944e-02_rk, -1.971687836487032164e-01_rk, &
                                        0.000000000000000000e+00_rk, -1.394193839563012960e-01_rk, -5.283121635129678362e-02_rk, &
                                        0.000000000000000000e+00_rk, -3.735731134033556944e-02_rk, -5.283121635129678362e-02_rk  &
                                        /),(/3,4/))

        test_dnorm_dx(:,:,1,2) = reshape((/                                                                                 &
                                        1.394193839563012960e-01_rk, 0.000000000000000000e+00_rk, -1.394193839563012960e-01_rk, &
                                        3.735731134033556944e-02_rk, 0.000000000000000000e+00_rk, -3.735731134033556944e-02_rk, &
                                        1.394193839563012960e-01_rk, 0.000000000000000000e+00_rk, -1.394193839563012960e-01_rk, &
                                        3.735731134033556944e-02_rk, 0.000000000000000000e+00_rk, -3.735731134033556944e-02_rk  &
                                        /),(/3,4/))

        test_dnorm_dx(:,:,1,3) = reshape((/                                                                                 &
                                        1.971687836487032164e-01_rk, 1.394193839563012960e-01_rk, 0.000000000000000000e+00_rk, &
                                        1.971687836487032164e-01_rk, 3.735731134033556944e-02_rk, 0.000000000000000000e+00_rk, &
                                        5.283121635129678362e-02_rk, 1.394193839563012960e-01_rk, 0.000000000000000000e+00_rk, &
                                        5.283121635129678362e-02_rk, 3.735731134033556944e-02_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))

        test_dnorm_dx(:,:,2,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, -3.735731134033556944e-02_rk, 1.971687836487032164e-01_rk, &
                                        0.000000000000000000e+00_rk, -1.394193839563012960e-01_rk, 1.971687836487032164e-01_rk, &
                                        0.000000000000000000e+00_rk, -3.735731134033556944e-02_rk, 5.283121635129678362e-02_rk, &
                                        0.000000000000000000e+00_rk, -1.394193839563012960e-01_rk, 5.283121635129678362e-02_rk  &
                                        /),(/3,4/))

        test_dnorm_dx(:,:,2,2) = reshape((/                                                                                 &
                                        3.735731134033556944e-02_rk, 0.000000000000000000e+00_rk, -3.735731134033556944e-02_rk, &
                                        1.394193839563012960e-01_rk, 0.000000000000000000e+00_rk, -1.394193839563012960e-01_rk, &
                                        3.735731134033556944e-02_rk, 0.000000000000000000e+00_rk, -3.735731134033556944e-02_rk, &
                                        1.394193839563012960e-01_rk, 0.000000000000000000e+00_rk, -1.394193839563012960e-01_rk  &
                                        /),(/3,4/))

        test_dnorm_dx(:,:,2,3) = reshape((/                                                                                 &
                                        -1.971687836487032164e-01_rk, 3.735731134033556944e-02_rk, 0.000000000000000000e+00_rk, &
                                        -1.971687836487032164e-01_rk, 1.394193839563012960e-01_rk, 0.000000000000000000e+00_rk, &
                                        -5.283121635129678362e-02_rk, 3.735731134033556944e-02_rk, 0.000000000000000000e+00_rk, &
                                        -5.283121635129678362e-02_rk, 1.394193839563012960e-01_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))

        test_dnorm_dx(:,:,3,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 3.469446951953614189e-18_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 3.469446951953614189e-18_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))

        test_dnorm_dx(:,:,3,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        -3.469446951953614189e-18_rk, 0.000000000000000000e+00_rk, 3.469446951953614189e-18_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        -3.469446951953614189e-18_rk, 0.000000000000000000e+00_rk, 3.469446951953614189e-18_rk  &
                                        /),(/3,4/))

        test_dnorm_dx(:,:,3,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, -3.469446951953614189e-18_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, -3.469446951953614189e-18_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))

        test_dnorm_dx(:,:,4,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 3.469446951953614189e-18_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 3.469446951953614189e-18_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))

        test_dnorm_dx(:,:,4,2) = reshape((/                                                                                 &
                                        -3.469446951953614189e-18_rk, 0.000000000000000000e+00_rk, 3.469446951953614189e-18_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        -3.469446951953614189e-18_rk, 0.000000000000000000e+00_rk, 3.469446951953614189e-18_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))

        test_dnorm_dx(:,:,4,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, -3.469446951953614189e-18_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, -3.469446951953614189e-18_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))

        test_dnorm_dx(:,:,5,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 1.394193839563012960e-01_rk, -5.283121635129678362e-02_rk, &
                                        0.000000000000000000e+00_rk, 3.735731134033556944e-02_rk, -5.283121635129678362e-02_rk, &
                                        0.000000000000000000e+00_rk, 1.394193839563012960e-01_rk, -1.971687836487032164e-01_rk, &
                                        0.000000000000000000e+00_rk, 3.735731134033556944e-02_rk, -1.971687836487032164e-01_rk  &
                                        /),(/3,4/))

        test_dnorm_dx(:,:,5,2) = reshape((/                                                                                 &
                                        -1.394193839563012960e-01_rk, 0.000000000000000000e+00_rk, 1.394193839563012960e-01_rk, &
                                        -3.735731134033556944e-02_rk, 0.000000000000000000e+00_rk, 3.735731134033556944e-02_rk, &
                                        -1.394193839563012960e-01_rk, 0.000000000000000000e+00_rk, 1.394193839563012960e-01_rk, &
                                        -3.735731134033556944e-02_rk, 0.000000000000000000e+00_rk, 3.735731134033556944e-02_rk  &
                                        /),(/3,4/))

        test_dnorm_dx(:,:,5,3) = reshape((/                                                                                 &
                                        5.283121635129678362e-02_rk, -1.394193839563012960e-01_rk, 0.000000000000000000e+00_rk, &
                                        5.283121635129678362e-02_rk, -3.735731134033556944e-02_rk, 0.000000000000000000e+00_rk, &
                                        1.971687836487032164e-01_rk, -1.394193839563012960e-01_rk, 0.000000000000000000e+00_rk, &
                                        1.971687836487032164e-01_rk, -3.735731134033556944e-02_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))

        test_dnorm_dx(:,:,6,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 3.735731134033556944e-02_rk, 5.283121635129678362e-02_rk, &
                                        0.000000000000000000e+00_rk, 1.394193839563012960e-01_rk, 5.283121635129678362e-02_rk, &
                                        0.000000000000000000e+00_rk, 3.735731134033556944e-02_rk, 1.971687836487032164e-01_rk, &
                                        0.000000000000000000e+00_rk, 1.394193839563012960e-01_rk, 1.971687836487032164e-01_rk  &
                                        /),(/3,4/))

        test_dnorm_dx(:,:,6,2) = reshape((/                                                                                 &
                                        -3.735731134033556944e-02_rk, 0.000000000000000000e+00_rk, 3.735731134033556944e-02_rk, &
                                        -1.394193839563012960e-01_rk, 0.000000000000000000e+00_rk, 1.394193839563012960e-01_rk, &
                                        -3.735731134033556944e-02_rk, 0.000000000000000000e+00_rk, 3.735731134033556944e-02_rk, &
                                        -1.394193839563012960e-01_rk, 0.000000000000000000e+00_rk, 1.394193839563012960e-01_rk  &
                                        /),(/3,4/))

        test_dnorm_dx(:,:,6,3) = reshape((/                                                                                 &
                                        -5.283121635129678362e-02_rk, -3.735731134033556944e-02_rk, 0.000000000000000000e+00_rk, &
                                        -5.283121635129678362e-02_rk, -1.394193839563012960e-01_rk, 0.000000000000000000e+00_rk, &
                                        -1.971687836487032164e-01_rk, -3.735731134033556944e-02_rk, 0.000000000000000000e+00_rk, &
                                        -1.971687836487032164e-01_rk, -1.394193839563012960e-01_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))

        test_dnorm_dx(:,:,7,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, -3.469446951953614189e-18_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, -3.469446951953614189e-18_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))

        test_dnorm_dx(:,:,7,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        3.469446951953614189e-18_rk, 0.000000000000000000e+00_rk, -3.469446951953614189e-18_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        3.469446951953614189e-18_rk, 0.000000000000000000e+00_rk, -3.469446951953614189e-18_rk  &
                                        /),(/3,4/))

        test_dnorm_dx(:,:,7,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 3.469446951953614189e-18_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 3.469446951953614189e-18_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))

        test_dnorm_dx(:,:,8,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, -3.469446951953614189e-18_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, -3.469446951953614189e-18_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))

        test_dnorm_dx(:,:,8,2) = reshape((/                                                                                 &
                                        3.469446951953614189e-18_rk, 0.000000000000000000e+00_rk, -3.469446951953614189e-18_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        3.469446951953614189e-18_rk, 0.000000000000000000e+00_rk, -3.469446951953614189e-18_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))

        test_dnorm_dx(:,:,8,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 3.469446951953614189e-18_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 3.469446951953614189e-18_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))

        
        
        

        do inode_diff = 1,self%elem%nterms_c
            do idir = 1,3
                @assertequal(transpose(test_dnorm_dx(:,:,inode_diff,idir)),self%faces(eta_min)%dnorm_dx(:,:,inode_diff,idir),tol)
            end do
        end do

        !
        ! eta_max
        !
        test_dnorm_dx(:,:,1,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, -3.469446951953614189e-18_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, -3.469446951953614189e-18_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))

        test_dnorm_dx(:,:,1,2) = reshape((/                                                                                 &
                                        3.469446951953614189e-18_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        3.469446951953614189e-18_rk, 0.000000000000000000e+00_rk, -6.938893903907228378e-18_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))

        test_dnorm_dx(:,:,1,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 6.938893903907228378e-18_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))

        test_dnorm_dx(:,:,2,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, -3.469446951953614189e-18_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, -3.469446951953614189e-18_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))

        test_dnorm_dx(:,:,2,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        3.469446951953614189e-18_rk, 0.000000000000000000e+00_rk, -6.938893903907228378e-18_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        3.469446951953614189e-18_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))

        test_dnorm_dx(:,:,2,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 6.938893903907228378e-18_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))

        test_dnorm_dx(:,:,3,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 3.735731134033556944e-02_rk, -1.971687836487032164e-01_rk, &
                                        0.000000000000000000e+00_rk, 1.394193839563012960e-01_rk, -1.971687836487032164e-01_rk, &
                                        0.000000000000000000e+00_rk, 3.735731134033556944e-02_rk, -5.283121635129678362e-02_rk, &
                                        0.000000000000000000e+00_rk, 1.394193839563012960e-01_rk, -5.283121635129678362e-02_rk  &
                                        /),(/3,4/))

        test_dnorm_dx(:,:,3,2) = reshape((/                                                                                 &
                                        -3.735731134033556944e-02_rk, 0.000000000000000000e+00_rk, 3.735731134033555556e-02_rk, &
                                        -1.394193839563012960e-01_rk, 0.000000000000000000e+00_rk, 1.394193839563013237e-01_rk, &
                                        -3.735731134033556944e-02_rk, 0.000000000000000000e+00_rk, 3.735731134033557638e-02_rk, &
                                        -1.394193839563012960e-01_rk, 0.000000000000000000e+00_rk, 1.394193839563013237e-01_rk  &
                                        /),(/3,4/))

        test_dnorm_dx(:,:,3,3) = reshape((/                                                                                 &
                                        1.971687836487032164e-01_rk, -3.735731134033555556e-02_rk, 0.000000000000000000e+00_rk, &
                                        1.971687836487032164e-01_rk, -1.394193839563013237e-01_rk, 0.000000000000000000e+00_rk, &
                                        5.283121635129678362e-02_rk, -3.735731134033557638e-02_rk, 0.000000000000000000e+00_rk, &
                                        5.283121635129678362e-02_rk, -1.394193839563013237e-01_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))

        test_dnorm_dx(:,:,4,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 1.394193839563012960e-01_rk, 1.971687836487032164e-01_rk, &
                                        0.000000000000000000e+00_rk, 3.735731134033556944e-02_rk, 1.971687836487032164e-01_rk, &
                                        0.000000000000000000e+00_rk, 1.394193839563012960e-01_rk, 5.283121635129678362e-02_rk, &
                                        0.000000000000000000e+00_rk, 3.735731134033556944e-02_rk, 5.283121635129678362e-02_rk  &
                                        /),(/3,4/))

        test_dnorm_dx(:,:,4,2) = reshape((/                                                                                 &
                                        -1.394193839563012960e-01_rk, 0.000000000000000000e+00_rk, 1.394193839563013793e-01_rk, &
                                        -3.735731134033556944e-02_rk, 0.000000000000000000e+00_rk, 3.735731134033560413e-02_rk, &
                                        -1.394193839563012960e-01_rk, 0.000000000000000000e+00_rk, 1.394193839563013515e-01_rk, &
                                        -3.735731134033556944e-02_rk, 0.000000000000000000e+00_rk, 3.735731134033558332e-02_rk  &
                                        /),(/3,4/))

        test_dnorm_dx(:,:,4,3) = reshape((/                                                                                 &
                                        -1.971687836487032164e-01_rk, -1.394193839563013793e-01_rk, 0.000000000000000000e+00_rk, &
                                        -1.971687836487032164e-01_rk, -3.735731134033560413e-02_rk, 0.000000000000000000e+00_rk, &
                                        -5.283121635129678362e-02_rk, -1.394193839563013515e-01_rk, 0.000000000000000000e+00_rk, &
                                        -5.283121635129678362e-02_rk, -3.735731134033558332e-02_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))

        test_dnorm_dx(:,:,5,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 3.469446951953614189e-18_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 3.469446951953614189e-18_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))

        test_dnorm_dx(:,:,5,2) = reshape((/                                                                                 &
                                        -3.469446951953614189e-18_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        -3.469446951953614189e-18_rk, 0.000000000000000000e+00_rk, 6.938893903907228378e-18_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))

        test_dnorm_dx(:,:,5,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, -6.938893903907228378e-18_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))

        test_dnorm_dx(:,:,6,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 3.469446951953614189e-18_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 3.469446951953614189e-18_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))

        test_dnorm_dx(:,:,6,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        -3.469446951953614189e-18_rk, 0.000000000000000000e+00_rk, 6.938893903907228378e-18_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        -3.469446951953614189e-18_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))

        test_dnorm_dx(:,:,6,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, -6.938893903907228378e-18_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))

        test_dnorm_dx(:,:,7,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, -3.735731134033556944e-02_rk, -5.283121635129678362e-02_rk, &
                                        0.000000000000000000e+00_rk, -1.394193839563012960e-01_rk, -5.283121635129678362e-02_rk, &
                                        0.000000000000000000e+00_rk, -3.735731134033556944e-02_rk, -1.971687836487032164e-01_rk, &
                                        0.000000000000000000e+00_rk, -1.394193839563012960e-01_rk, -1.971687836487032164e-01_rk  &
                                        /),(/3,4/))

        test_dnorm_dx(:,:,7,2) = reshape((/                                                                                 &
                                        3.735731134033556944e-02_rk, 0.000000000000000000e+00_rk, -3.735731134033558332e-02_rk, &
                                        1.394193839563012960e-01_rk, 0.000000000000000000e+00_rk, -1.394193839563013515e-01_rk, &
                                        3.735731134033556944e-02_rk, 0.000000000000000000e+00_rk, -3.735731134033560413e-02_rk, &
                                        1.394193839563012960e-01_rk, 0.000000000000000000e+00_rk, -1.394193839563013793e-01_rk  &
                                        /),(/3,4/))

        test_dnorm_dx(:,:,7,3) = reshape((/                                                                                 &
                                        5.283121635129678362e-02_rk, 3.735731134033558332e-02_rk, 0.000000000000000000e+00_rk, &
                                        5.283121635129678362e-02_rk, 1.394193839563013515e-01_rk, 0.000000000000000000e+00_rk, &
                                        1.971687836487032164e-01_rk, 3.735731134033560413e-02_rk, 0.000000000000000000e+00_rk, &
                                        1.971687836487032164e-01_rk, 1.394193839563013793e-01_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))

        test_dnorm_dx(:,:,8,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, -1.394193839563012960e-01_rk, 5.283121635129678362e-02_rk, &
                                        0.000000000000000000e+00_rk, -3.735731134033556944e-02_rk, 5.283121635129678362e-02_rk, &
                                        0.000000000000000000e+00_rk, -1.394193839563012960e-01_rk, 1.971687836487032164e-01_rk, &
                                        0.000000000000000000e+00_rk, -3.735731134033556944e-02_rk, 1.971687836487032164e-01_rk  &
                                        /),(/3,4/))

        test_dnorm_dx(:,:,8,2) = reshape((/                                                                                 &
                                        1.394193839563012960e-01_rk, 0.000000000000000000e+00_rk, -1.394193839563013237e-01_rk, &
                                        3.735731134033556944e-02_rk, 0.000000000000000000e+00_rk, -3.735731134033557638e-02_rk, &
                                        1.394193839563012960e-01_rk, 0.000000000000000000e+00_rk, -1.394193839563013237e-01_rk, &
                                        3.735731134033556944e-02_rk, 0.000000000000000000e+00_rk, -3.735731134033555556e-02_rk  &
                                        /),(/3,4/))

        test_dnorm_dx(:,:,8,3) = reshape((/                                                                                 &
                                        -5.283121635129678362e-02_rk, 1.394193839563013237e-01_rk, 0.000000000000000000e+00_rk, &
                                        -5.283121635129678362e-02_rk, 3.735731134033557638e-02_rk, 0.000000000000000000e+00_rk, &
                                        -1.971687836487032164e-01_rk, 1.394193839563013237e-01_rk, 0.000000000000000000e+00_rk, &
                                        -1.971687836487032164e-01_rk, 3.735731134033555556e-02_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))

        
        
        
        
        do inode_diff = 1,self%elem%nterms_c
            do idir = 1,3
                @assertequal(transpose(test_dnorm_dx(:,:,inode_diff,idir)),self%faces(eta_max)%dnorm_dx(:,:,inode_diff,idir),tol)
            end do
        end do

        !
        ! zeta_min
        !
        test_dnorm_dx(:,:,1,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 2.788387679126025920e-01_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 1.767766952966368654e-01_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 1.767766952966368654e-01_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 7.471462268067113888e-02_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))

        test_dnorm_dx(:,:,1,2) = reshape((/                                                                                 &
                                        -2.788387679126025920e-01_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        -1.767766952966368654e-01_rk, 0.000000000000000000e+00_rk, -1.020620726159657543e-01_rk, &
                                        -1.767766952966368654e-01_rk, 0.000000000000000000e+00_rk, 1.020620726159657959e-01_rk, &
                                        -7.471462268067113888e-02_rk, 0.000000000000000000e+00_rk, 1.040834085586084257e-17_rk  &
                                        /),(/3,4/))

        test_dnorm_dx(:,:,1,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 1.020620726159657543e-01_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, -1.020620726159657959e-01_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, -1.040834085586084257e-17_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))

        test_dnorm_dx(:,:,2,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, -1.020620726159657266e-01_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 1.734723475976807094e-17_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 1.020620726159657127e-01_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))

        test_dnorm_dx(:,:,2,2) = reshape((/                                                                                 &
                                        1.020620726159657266e-01_rk, 0.000000000000000000e+00_rk, 1.767766952966368932e-01_rk, &
                                        -1.734723475976807094e-17_rk, 0.000000000000000000e+00_rk, 2.788387679126026475e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 7.471462268067113888e-02_rk, &
                                        -1.020620726159657127e-01_rk, 0.000000000000000000e+00_rk, 1.767766952966369209e-01_rk  &
                                        /),(/3,4/))

        test_dnorm_dx(:,:,2,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, -1.767766952966368932e-01_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, -2.788387679126026475e-01_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, -7.471462268067113888e-02_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, -1.767766952966369209e-01_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))

        test_dnorm_dx(:,:,3,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, -7.471462268067113888e-02_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, -1.767766952966368654e-01_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, -1.767766952966368654e-01_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, -2.788387679126025920e-01_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))

        test_dnorm_dx(:,:,3,2) = reshape((/                                                                                 &
                                        7.471462268067113888e-02_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        1.767766952966368654e-01_rk, 0.000000000000000000e+00_rk, -1.020620726159657404e-01_rk, &
                                        1.767766952966368654e-01_rk, 0.000000000000000000e+00_rk, 1.020620726159657404e-01_rk, &
                                        2.788387679126025920e-01_rk, 0.000000000000000000e+00_rk, -1.734723475976807094e-17_rk  &
                                        /),(/3,4/))

        test_dnorm_dx(:,:,3,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 1.020620726159657404e-01_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, -1.020620726159657404e-01_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 1.734723475976807094e-17_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))

        test_dnorm_dx(:,:,4,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, -1.020620726159657404e-01_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, -1.040834085586084257e-17_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 1.020620726159657266e-01_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))

        test_dnorm_dx(:,:,4,2) = reshape((/                                                                                 &
                                        1.020620726159657404e-01_rk, 0.000000000000000000e+00_rk, -1.767766952966368932e-01_rk, &
                                        1.040834085586084257e-17_rk, 0.000000000000000000e+00_rk, -7.471462268067115275e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -2.788387679126027030e-01_rk, &
                                        -1.020620726159657266e-01_rk, 0.000000000000000000e+00_rk, -1.767766952966369209e-01_rk  &
                                        /),(/3,4/))

        test_dnorm_dx(:,:,4,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 1.767766952966368932e-01_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 7.471462268067115275e-02_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 2.788387679126027030e-01_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 1.767766952966369209e-01_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))

        test_dnorm_dx(:,:,5,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, -6.938893903907228378e-18_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 1.040834085586084257e-17_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 6.938893903907228378e-18_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))

        test_dnorm_dx(:,:,5,2) = reshape((/                                                                                 &
                                        6.938893903907228378e-18_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        -1.040834085586084257e-17_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        -6.938893903907228378e-18_rk, 0.000000000000000000e+00_rk, 3.469446951953614189e-18_rk  &
                                        /),(/3,4/))

        test_dnorm_dx(:,:,5,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, -3.469446951953614189e-18_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))

        test_dnorm_dx(:,:,6,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, -3.469446951953614189e-18_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 6.938893903907228378e-18_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))

        test_dnorm_dx(:,:,6,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        3.469446951953614189e-18_rk, 0.000000000000000000e+00_rk, -6.938893903907228378e-18_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        -6.938893903907228378e-18_rk, 0.000000000000000000e+00_rk, 3.469446951953614189e-18_rk  &
                                        /),(/3,4/))

        test_dnorm_dx(:,:,6,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 6.938893903907228378e-18_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, -3.469446951953614189e-18_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))

        test_dnorm_dx(:,:,7,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, -3.469446951953614189e-18_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, -6.938893903907228378e-18_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))

        test_dnorm_dx(:,:,7,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        3.469446951953614189e-18_rk, 0.000000000000000000e+00_rk, -6.938893903907228378e-18_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        6.938893903907228378e-18_rk, 0.000000000000000000e+00_rk, 3.469446951953614189e-18_rk  &
                                        /),(/3,4/))

        test_dnorm_dx(:,:,7,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 6.938893903907228378e-18_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, -3.469446951953614189e-18_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))

        test_dnorm_dx(:,:,8,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 6.938893903907228378e-18_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, -3.469446951953614189e-18_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))

        test_dnorm_dx(:,:,8,2) = reshape((/                                                                                 &
                                        -6.938893903907228378e-18_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        3.469446951953614189e-18_rk, 0.000000000000000000e+00_rk, -6.938893903907228378e-18_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -1.387778780781445676e-17_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -1.040834085586084257e-17_rk  &
                                        /),(/3,4/))

        test_dnorm_dx(:,:,8,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 6.938893903907228378e-18_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 1.387778780781445676e-17_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 1.040834085586084257e-17_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))


        
        
        
        do inode_diff = 1,self%elem%nterms_c
            do idir = 1,3
                @assertequal(transpose(test_dnorm_dx(:,:,inode_diff,idir)),self%faces(zeta_min)%dnorm_dx(:,:,inode_diff,idir),tol)
            end do
        end do


        !
        ! zeta_max
        !
        test_dnorm_dx(:,:,1,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 6.938893903907228378e-18_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 3.469446951953614189e-18_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))

        test_dnorm_dx(:,:,1,2) = reshape((/                                                                                 &
                                        -6.938893903907228378e-18_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        -3.469446951953614189e-18_rk, 0.000000000000000000e+00_rk, -6.938893903907228378e-18_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))

        test_dnorm_dx(:,:,1,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 6.938893903907228378e-18_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))

        test_dnorm_dx(:,:,2,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 3.469446951953614189e-18_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 6.938893903907228378e-18_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))

        test_dnorm_dx(:,:,2,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 6.938893903907228378e-18_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        -3.469446951953614189e-18_rk, 0.000000000000000000e+00_rk, 6.938893903907228378e-18_rk, &
                                        -6.938893903907228378e-18_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))

        test_dnorm_dx(:,:,2,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, -6.938893903907228378e-18_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, -6.938893903907228378e-18_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))

        test_dnorm_dx(:,:,3,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, -1.040834085586084257e-17_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, -6.938893903907228378e-18_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))

        test_dnorm_dx(:,:,3,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        1.040834085586084257e-17_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        6.938893903907228378e-18_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))

        test_dnorm_dx(:,:,3,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))

        test_dnorm_dx(:,:,4,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, -6.938893903907228378e-18_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 3.469446951953614189e-18_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))

        test_dnorm_dx(:,:,4,2) = reshape((/                                                                                 &
                                        6.938893903907228378e-18_rk, 0.000000000000000000e+00_rk, 6.938893903907228378e-18_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        -3.469446951953614189e-18_rk, 0.000000000000000000e+00_rk, 6.938893903907228378e-18_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))

        test_dnorm_dx(:,:,4,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, -6.938893903907228378e-18_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, -6.938893903907228378e-18_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))

        test_dnorm_dx(:,:,5,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, -2.788387679126025920e-01_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, -1.767766952966368654e-01_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, -1.767766952966368654e-01_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, -7.471462268067113888e-02_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))

        test_dnorm_dx(:,:,5,2) = reshape((/                                                                                 &
                                        2.788387679126025920e-01_rk, 0.000000000000000000e+00_rk, 4.163336342344337027e-17_rk, &
                                        1.767766952966368654e-01_rk, 0.000000000000000000e+00_rk, 1.020620726159657682e-01_rk, &
                                        1.767766952966368654e-01_rk, 0.000000000000000000e+00_rk, -1.020620726159657682e-01_rk, &
                                        7.471462268067113888e-02_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))

        test_dnorm_dx(:,:,5,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, -4.163336342344337027e-17_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, -1.020620726159657682e-01_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 1.020620726159657682e-01_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))

        test_dnorm_dx(:,:,6,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 1.020620726159657266e-01_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 1.040834085586084257e-17_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, -1.020620726159657404e-01_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))

        test_dnorm_dx(:,:,6,2) = reshape((/                                                                                 &
                                        -1.020620726159657266e-01_rk, 0.000000000000000000e+00_rk, -1.767766952966368654e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -2.788387679126025920e-01_rk, &
                                        -1.040834085586084257e-17_rk, 0.000000000000000000e+00_rk, -7.471462268067112500e-02_rk, &
                                        1.020620726159657404e-01_rk, 0.000000000000000000e+00_rk, -1.767766952966368932e-01_rk  &
                                        /),(/3,4/))

        test_dnorm_dx(:,:,6,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 1.767766952966368654e-01_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 2.788387679126025920e-01_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 7.471462268067112500e-02_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 1.767766952966368932e-01_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))

        test_dnorm_dx(:,:,7,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 7.471462268067113888e-02_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 1.767766952966368654e-01_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 1.767766952966368654e-01_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 2.788387679126025920e-01_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))

        test_dnorm_dx(:,:,7,2) = reshape((/                                                                                 &
                                        -7.471462268067113888e-02_rk, 0.000000000000000000e+00_rk, -1.387778780781445676e-17_rk, &
                                        -1.767766952966368654e-01_rk, 0.000000000000000000e+00_rk, 1.020620726159657127e-01_rk, &
                                        -1.767766952966368654e-01_rk, 0.000000000000000000e+00_rk, -1.020620726159657266e-01_rk, &
                                        -2.788387679126025920e-01_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))

        test_dnorm_dx(:,:,7,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 1.387778780781445676e-17_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, -1.020620726159657127e-01_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 1.020620726159657266e-01_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))

        test_dnorm_dx(:,:,8,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 1.020620726159657404e-01_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, -1.734723475976807094e-17_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, -1.020620726159657266e-01_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))

        test_dnorm_dx(:,:,8,2) = reshape((/                                                                                 &
                                        -1.020620726159657404e-01_rk, 0.000000000000000000e+00_rk, 1.767766952966368654e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 7.471462268067113888e-02_rk, &
                                        1.734723475976807094e-17_rk, 0.000000000000000000e+00_rk, 2.788387679126026475e-01_rk, &
                                        1.020620726159657266e-01_rk, 0.000000000000000000e+00_rk, 1.767766952966368932e-01_rk  &
                                        /),(/3,4/))

        test_dnorm_dx(:,:,8,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, -1.767766952966368654e-01_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, -7.471462268067113888e-02_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, -2.788387679126026475e-01_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, -1.767766952966368932e-01_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))

        
        
        

        do inode_diff = 1,self%elem%nterms_c
            do idir = 1,3
                @assertequal(transpose(test_dnorm_dx(:,:,inode_diff,idir)),self%faces(zeta_max)%dnorm_dx(:,:,inode_diff,idir),tol)
            end do
        end do



    end subroutine testelement_face_dnormals_dx
    !*******************************************************************************************





!    !>  Test dmetric_dx_point 
!    !!  Here we test the routine taking as probing point the interpolation nodes.
!    !!  The dmetric_dx at interpolation nodes has already been tested above, so they are right.
!    !!
!    !!  @author Matteo Ugolotti
!    !!
!    !------------------------------------------------------------------------------------------
!    @Test
!    subroutine testelement_dmetric_dx_point(self)
!        class(test_element_linearC_dx),    intent(inout)   :: self
!
!        integer(ik) :: inode_diff, idir, irow
!        real(rk)    :: tol, point_coords(3)
!        real(rk), allocatable   :: point_dmetric_dx(:,:,:,:)
!        
!        tol = 1.e-13_rk
!       
!        ! Local coordinates of the point
!        point_coords = [-1._rk/sqrt(3._rk),1._rk/sqrt(3._rk),-1._rk/sqrt(3._rk)]
!
!        ! Being TESTED
!        point_dmetric_dx = self%elem%dmetric_dx_point(point_coords, coordinate_frame='Undeformed', coordinate_scaling=.true.)
!
!
!        ! Test
!        @assertequal(point_dmetric_dx,self%elem%dmetric_dx(:,:,3,:,:),tol)
!
!
!    end subroutine testelement_dmetric_dx_point
!    !*******************************************************************************************







!    !>  Test djinv_dx_point 
!    !!  Here we test the routine taking as probing point the interpolation nodes.
!    !!  The djinv_dx at interpolation nodes has already been tested above, so they are right.
!    !!
!    !!  @author Matteo Ugolotti
!    !!
!    !------------------------------------------------------------------------------------------
!    @Test
!    subroutine testelement_djinv_dx_point(self)
!        class(test_element_linearC_dx),    intent(inout)   :: self
!
!        integer(ik) :: inode_diff, idir, irow
!        real(rk)    :: tol, point_coords(3)
!        real(rk), allocatable   :: point_djinv_dx(:,:)
!        
!        tol = 1.e-13_rk
!       
!        ! Local coordinates of the point
!        point_coords = [1._rk/sqrt(3._rk),1._rk/sqrt(3._rk),-1._rk/sqrt(3._rk)]
!
!        ! Being TESTED
!        point_djinv_dx = self%elem%djinv_dx_point(point_coords, coordinate_frame='Undeformed', coordinate_scaling=.true.)
!
!
!        ! Test
!        @assertequal(point_djinv_dx,self%elem%djinv_dx(4,:,:),tol)
!
!
!    end subroutine testelement_djinv_dx_point
!    !*******************************************************************************************








!    !>  Test h_index
!    !!
!    !!  Fortran search the minimum x, y and z coordinate among all the support nodes.
!    !!  If multiple minimum are found, fortran returns the location of the first minimum starting 
!    !!  from the first minimum found (ie. first location in connectivity vector).
!    !!
!    !!  In this case, for instance for x direction, there exists 4 minima. However, the one stored
!    !!  for dX differentiation (needed for artificial viscosity) will be node 1, since it comes first
!    !!
!    !!
!    !!  @author Matteo Ugolotti
!    !!
!    !------------------------------------------------------------------------------------------
!    @Test
!    subroutine testelement_h_index(self)
!        class(test_element_linearC_dx),    intent(inout)   :: self
!
!        integer(ik) :: x_min, x_max, y_min, y_max, z_min, z_max
!        
!        x_min = 1
!        x_max = 4
!        y_min = 1
!        y_max = 5
!        z_min = 3
!        z_max = 2
!
!
!        ! Test
!        @assertequal(x_min,self%elem%h_index(1,1))
!        @assertequal(x_max,self%elem%h_index(1,2))
!        @assertequal(y_min,self%elem%h_index(2,1))
!        @assertequal(y_max,self%elem%h_index(2,2))
!        @assertequal(z_min,self%elem%h_index(3,1))
!        @assertequal(z_max,self%elem%h_index(3,2))
!
!
!    end subroutine testelement_h_index
!    !*******************************************************************************************




!
!####################################################
!#
!#   PYTHON SCRIPT FOR TESTING ELEMENT DX INITIALIZATION
!#
!#       This requires PyTORCH. For installation refer to
!#       https://pytorch.org/get-started/locally/
!#
!####################################################
!
!
!from __future__ import division
!
!import torch
!import torch.autograd as autograd
!import torch.nn as nn
!import torch.nn.functional as F
!import torch.optim as optim
!import numpy as np
!import sys
!import os
!import time
!
!
!#
!# TORCH INSTALLATION: refer to https://pytorch.org/get-started/locally/
!#
!def update_progress(job_title, progress):
!    length = 20 # modify this to change the length
!    block = int(round(length*progress))
!    msg = "\r{0}: [{1}] {2}%".format(job_title, "#"*block + "-"*(length-block), round(progress*100, 2))
!    if progress >= 1: msg += " DONE\r\n"
!    sys.stdout.write(msg)
!    sys.stdout.flush()
!
!def cls():
!    os.system('cls' if os.name=='nt' else 'clear')
!
!
!cls()
!
!
!################################################################################################################
!
!# Initialize torch tensor for coordiantes 
!coords_data_A = [[0., 0., 0.],
!                 [5., 0., 0.],
!                 [5., 1., 0.],
!                 [0., 1., 0.],
!                 [0., 0., 1.],
!                 [5., 0., 1.],
!                 [5., 1., 1.],
!                 [0., 1., 1.]]
!
!sqrt_two     = np.sqrt(2.)
!inv_sqrt_two = 1./sqrt_two
!coords_data_B = [[0., 0., 0.],
!                 [inv_sqrt_two,inv_sqrt_two, 0.],
!                 [0., sqrt_two, 0.],
!                 [-inv_sqrt_two,inv_sqrt_two, 0.],
!                 [0., 0., 1.],
!                 [inv_sqrt_two,inv_sqrt_two, 1.],
!                 [0., sqrt_two, 1.],
!                 [-inv_sqrt_two,inv_sqrt_two, 1.]]
!
!coords_data_C = [[0., 0., 0.],
!                 [inv_sqrt_two, 0., inv_sqrt_two],
!                 [sqrt_two, 0., 0.],
!                 [inv_sqrt_two, 0., -inv_sqrt_two],
!                 [0., 1., 0.],
!                 [inv_sqrt_two, 1., inv_sqrt_two],
!                 [sqrt_two, 1., 0. ],
!                 [inv_sqrt_two, 1., -inv_sqrt_two]]
!
!coords_data_D  = [[ 1.0, 0.0,       0.0],
!                  [ 2.0, 0.0,       0.0],
!                  [ 2.0, np.pi/2.0, 0.0],
!                  [ 1.0, np.pi/2.0, 0.0],
!                  [ 1.0, 0.0,       1.0],
!                  [ 2.0, 0.0,       1.0],
!                  [ 2.0, np.pi/2.0, 1.0],
!                  [ 1.0, np.pi/2.0, 1.0]]
!
!#coords_data = coords_data_A
!#coord_sys  = 'CARTESIAN'
!
!#coords_data = coords_data_B
!#coord_sys  = 'CARTESIAN'
!
!coords_data = coords_data_C
!coord_sys  = 'CARTESIAN'
!
!#coords_data = coords_data_D
!#coord_sys  = 'CYLINDRICAL'
!
!
!coords = torch.tensor(coords_data,requires_grad=True,dtype=torch.float64)
!
!
!nnodes_r   = coords.size(0)
!nnodes_elem  = 8 
!nnodes_face  = 4 
!nterms_s   = 8
!ndirs      = 3
!
!
!
!# Define matrix of polynomial basis terms at support nodes
!val_r_data = [[ 1.0,-1.0,-1.0,-1.0, 1.0, 1.0, 1.0,-1.0],
!              [ 1.0,-1.0,-1.0, 1.0,-1.0,-1.0, 1.0, 1.0],
!              [ 1.0, 1.0,-1.0, 1.0, 1.0,-1.0,-1.0,-1.0],
!              [ 1.0, 1.0,-1.0,-1.0,-1.0, 1.0,-1.0, 1.0],
!              [ 1.0,-1.0, 1.0,-1.0, 1.0,-1.0,-1.0, 1.0],
!              [ 1.0,-1.0, 1.0, 1.0,-1.0, 1.0,-1.0,-1.0],
!              [ 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0],
!              [ 1.0, 1.0, 1.0,-1.0,-1.0,-1.0, 1.0,-1.0]]
!
!val_r = torch.tensor(val_r_data,requires_grad=False,dtype=torch.float64)
!
!
!# Define matrices at interpolation nodes (quadrature, level = 1)
!val_i_data = [[ 1.0,-np.sqrt(1.0/3.0),-np.sqrt(1.0/3.0),-np.sqrt(1.0/3.0), 1.0/3.0, 1.0/3.0, 1.0/3.0,-1.0/3.0*np.sqrt(1.0/3.0)],
!              [ 1.0,-np.sqrt(1.0/3.0),-np.sqrt(1.0/3.0), np.sqrt(1.0/3.0),-1.0/3.0,-1.0/3.0, 1.0/3.0, 1.0/3.0*np.sqrt(1.0/3.0)],
!              [ 1.0, np.sqrt(1.0/3.0),-np.sqrt(1.0/3.0),-np.sqrt(1.0/3.0),-1.0/3.0, 1.0/3.0,-1.0/3.0, 1.0/3.0*np.sqrt(1.0/3.0)],
!              [ 1.0, np.sqrt(1.0/3.0),-np.sqrt(1.0/3.0), np.sqrt(1.0/3.0), 1.0/3.0,-1.0/3.0,-1.0/3.0,-1.0/3.0*np.sqrt(1.0/3.0)],
!              [ 1.0,-np.sqrt(1.0/3.0), np.sqrt(1.0/3.0),-np.sqrt(1.0/3.0), 1.0/3.0,-1.0/3.0,-1.0/3.0, 1.0/3.0*np.sqrt(1.0/3.0)],
!              [ 1.0,-np.sqrt(1.0/3.0), np.sqrt(1.0/3.0), np.sqrt(1.0/3.0),-1.0/3.0, 1.0/3.0,-1.0/3.0,-1.0/3.0*np.sqrt(1.0/3.0)],
!              [ 1.0, np.sqrt(1.0/3.0), np.sqrt(1.0/3.0),-np.sqrt(1.0/3.0),-1.0/3.0,-1.0/3.0, 1.0/3.0,-1.0/3.0*np.sqrt(1.0/3.0)],
!              [ 1.0, np.sqrt(1.0/3.0), np.sqrt(1.0/3.0), np.sqrt(1.0/3.0), 1.0/3.0, 1.0/3.0, 1.0/3.0, 1.0/3.0*np.sqrt(1.0/3.0)]]
!val_i = torch.tensor(val_i_data,requires_grad=False,dtype=torch.float64)
!
!
!ddxi_i_data  = [[ 0.0,0.0,0.0,1.0,-np.sqrt(1.0/3.0),-np.sqrt(1.0/3.0),0.0, 1.0/3.0],
!                [ 0.0,0.0,0.0,1.0,-np.sqrt(1.0/3.0),-np.sqrt(1.0/3.0),0.0, 1.0/3.0],
!                [ 0.0,0.0,0.0,1.0, np.sqrt(1.0/3.0),-np.sqrt(1.0/3.0),0.0,-1.0/3.0],
!                [ 0.0,0.0,0.0,1.0, np.sqrt(1.0/3.0),-np.sqrt(1.0/3.0),0.0,-1.0/3.0],
!                [ 0.0,0.0,0.0,1.0,-np.sqrt(1.0/3.0), np.sqrt(1.0/3.0),0.0,-1.0/3.0],
!                [ 0.0,0.0,0.0,1.0,-np.sqrt(1.0/3.0), np.sqrt(1.0/3.0),0.0,-1.0/3.0],
!                [ 0.0,0.0,0.0,1.0, np.sqrt(1.0/3.0), np.sqrt(1.0/3.0),0.0, 1.0/3.0],
!                [ 0.0,0.0,0.0,1.0, np.sqrt(1.0/3.0), np.sqrt(1.0/3.0),0.0, 1.0/3.0]]
!ddxi_i = torch.tensor(ddxi_i_data,requires_grad=False,dtype=torch.float64)
!
!ddeta_i_data = [[ 0.0,1.0,0.0,0.0,-np.sqrt(1.0/3.0),0.0,-np.sqrt(1.0/3.0), 1.0/3.0],
!                [ 0.0,1.0,0.0,0.0, np.sqrt(1.0/3.0),0.0,-np.sqrt(1.0/3.0),-1.0/3.0],
!                [ 0.0,1.0,0.0,0.0,-np.sqrt(1.0/3.0),0.0,-np.sqrt(1.0/3.0), 1.0/3.0],
!                [ 0.0,1.0,0.0,0.0, np.sqrt(1.0/3.0),0.0,-np.sqrt(1.0/3.0),-1.0/3.0],
!                [ 0.0,1.0,0.0,0.0,-np.sqrt(1.0/3.0),0.0, np.sqrt(1.0/3.0),-1.0/3.0],
!                [ 0.0,1.0,0.0,0.0, np.sqrt(1.0/3.0),0.0, np.sqrt(1.0/3.0), 1.0/3.0],
!                [ 0.0,1.0,0.0,0.0,-np.sqrt(1.0/3.0),0.0, np.sqrt(1.0/3.0),-1.0/3.0],
!                [ 0.0,1.0,0.0,0.0, np.sqrt(1.0/3.0),0.0, np.sqrt(1.0/3.0), 1.0/3.0]]
!ddeta_i = torch.tensor(ddeta_i_data,requires_grad=False,dtype=torch.float64)
!
!ddzeta_i_data= [[ 0.0,0.0,1.0,0.0,0.0,-np.sqrt(1.0/3.0),-np.sqrt(1.0/3.0), 1.0/3.0],
!                [ 0.0,0.0,1.0,0.0,0.0, np.sqrt(1.0/3.0),-np.sqrt(1.0/3.0),-1.0/3.0],
!                [ 0.0,0.0,1.0,0.0,0.0,-np.sqrt(1.0/3.0), np.sqrt(1.0/3.0),-1.0/3.0],
!                [ 0.0,0.0,1.0,0.0,0.0, np.sqrt(1.0/3.0), np.sqrt(1.0/3.0), 1.0/3.0],
!                [ 0.0,0.0,1.0,0.0,0.0,-np.sqrt(1.0/3.0),-np.sqrt(1.0/3.0), 1.0/3.0],
!                [ 0.0,0.0,1.0,0.0,0.0, np.sqrt(1.0/3.0),-np.sqrt(1.0/3.0),-1.0/3.0],
!                [ 0.0,0.0,1.0,0.0,0.0,-np.sqrt(1.0/3.0), np.sqrt(1.0/3.0),-1.0/3.0],
!                [ 0.0,0.0,1.0,0.0,0.0, np.sqrt(1.0/3.0), np.sqrt(1.0/3.0), 1.0/3.0]]
!ddzeta_i = torch.tensor(ddzeta_i_data,requires_grad=False,dtype=torch.float64)
!
!# Define element interpolation nodes weights for linear element
!weights_e_data = [1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0] 
!weights_e = torch.tensor(weights_e_data,requires_grad=False,dtype=torch.float64)
!
!
!# Define val_f for each face
!# Face 1, XI_MIN
!val_1_data   = [[ 1.0,-np.sqrt(1.0/3.0),-np.sqrt(1.0/3.0),-1.0, np.sqrt(1.0/3.0), np.sqrt(1.0/3.0), 1.0/3.0,-1.0/3.0],
!                [ 1.0, np.sqrt(1.0/3.0),-np.sqrt(1.0/3.0),-1.0,-np.sqrt(1.0/3.0), np.sqrt(1.0/3.0),-1.0/3.0, 1.0/3.0],
!                [ 1.0,-np.sqrt(1.0/3.0), np.sqrt(1.0/3.0),-1.0, np.sqrt(1.0/3.0),-np.sqrt(1.0/3.0),-1.0/3.0, 1.0/3.0],
!                [ 1.0, np.sqrt(1.0/3.0), np.sqrt(1.0/3.0),-1.0,-np.sqrt(1.0/3.0),-np.sqrt(1.0/3.0), 1.0/3.0,-1.0/3.0],
!                ]
!val_1 = torch.tensor(val_1_data,requires_grad=False,dtype=torch.float64)
!
!# Face 2, XI_MAX
!val_2_data   = [[ 1.0,-np.sqrt(1.0/3.0),-np.sqrt(1.0/3.0),1.0,-np.sqrt(1.0/3.0),-np.sqrt(1.0/3.0), 1.0/3.0, 1.0/3.0],
!                [ 1.0, np.sqrt(1.0/3.0),-np.sqrt(1.0/3.0),1.0, np.sqrt(1.0/3.0),-np.sqrt(1.0/3.0),-1.0/3.0,-1.0/3.0],
!                [ 1.0,-np.sqrt(1.0/3.0), np.sqrt(1.0/3.0),1.0,-np.sqrt(1.0/3.0), np.sqrt(1.0/3.0),-1.0/3.0,-1.0/3.0],
!                [ 1.0, np.sqrt(1.0/3.0), np.sqrt(1.0/3.0),1.0, np.sqrt(1.0/3.0), np.sqrt(1.0/3.0), 1.0/3.0, 1.0/3.0],
!                ] 
!val_2 = torch.tensor(val_2_data,requires_grad=False,dtype=torch.float64)
!
!# Face 3, ETA_MIN
!val_3_data   = [[ 1.0,-1.0,-np.sqrt(1.0/3.0),-np.sqrt(1.0/3.0), np.sqrt(1.0/3.0), 1.0/3.0, np.sqrt(1.0/3.0),-1.0/3.0],
!                [ 1.0,-1.0,-np.sqrt(1.0/3.0), np.sqrt(1.0/3.0),-np.sqrt(1.0/3.0),-1.0/3.0, np.sqrt(1.0/3.0), 1.0/3.0],
!                [ 1.0,-1.0, np.sqrt(1.0/3.0),-np.sqrt(1.0/3.0), np.sqrt(1.0/3.0),-1.0/3.0,-np.sqrt(1.0/3.0), 1.0/3.0],
!                [ 1.0,-1.0, np.sqrt(1.0/3.0), np.sqrt(1.0/3.0),-np.sqrt(1.0/3.0), 1.0/3.0,-np.sqrt(1.0/3.0),-1.0/3.0],
!                ] 
!val_3 = torch.tensor(val_3_data,requires_grad=False,dtype=torch.float64)
!
!# Face 4, ETA_MAX
!val_4_data   = [[ 1.0,1.0,-np.sqrt(1.0/3.0),-np.sqrt(1.0/3.0),-np.sqrt(1.0/3.0), 1.0/3.0,-np.sqrt(1.0/3.0), 1.0/3.0],
!                [ 1.0,1.0,-np.sqrt(1.0/3.0), np.sqrt(1.0/3.0), np.sqrt(1.0/3.0),-1.0/3.0,-np.sqrt(1.0/3.0),-1.0/3.0],
!                [ 1.0,1.0, np.sqrt(1.0/3.0),-np.sqrt(1.0/3.0),-np.sqrt(1.0/3.0),-1.0/3.0, np.sqrt(1.0/3.0),-1.0/3.0],
!                [ 1.0,1.0, np.sqrt(1.0/3.0), np.sqrt(1.0/3.0), np.sqrt(1.0/3.0), 1.0/3.0, np.sqrt(1.0/3.0), 1.0/3.0],
!                ]
!val_4 = torch.tensor(val_4_data,requires_grad=False,dtype=torch.float64)
!
!# Face 5, ZETA_MIN
!val_5_data   = [[ 1.0,-np.sqrt(1.0/3.0),-1.0,-np.sqrt(1.0/3.0), 1.0/3.0, np.sqrt(1.0/3.0), np.sqrt(1.0/3.0),-1.0/3.0],
!                [ 1.0,-np.sqrt(1.0/3.0),-1.0, np.sqrt(1.0/3.0),-1.0/3.0,-np.sqrt(1.0/3.0), np.sqrt(1.0/3.0), 1.0/3.0],
!                [ 1.0, np.sqrt(1.0/3.0),-1.0,-np.sqrt(1.0/3.0),-1.0/3.0, np.sqrt(1.0/3.0),-np.sqrt(1.0/3.0), 1.0/3.0],
!                [ 1.0, np.sqrt(1.0/3.0),-1.0, np.sqrt(1.0/3.0), 1.0/3.0,-np.sqrt(1.0/3.0),-np.sqrt(1.0/3.0),-1.0/3.0],
!                ]
!val_5 = torch.tensor(val_5_data,requires_grad=False,dtype=torch.float64)
!
!# Face 6, ZETA_MAX
!val_6_data   = [[ 1.0,-np.sqrt(1.0/3.0),1.0,-np.sqrt(1.0/3.0), 1.0/3.0,-np.sqrt(1.0/3.0),-np.sqrt(1.0/3.0), 1.0/3.0],
!                [ 1.0,-np.sqrt(1.0/3.0),1.0, np.sqrt(1.0/3.0),-1.0/3.0, np.sqrt(1.0/3.0),-np.sqrt(1.0/3.0),-1.0/3.0],
!                [ 1.0, np.sqrt(1.0/3.0),1.0,-np.sqrt(1.0/3.0),-1.0/3.0,-np.sqrt(1.0/3.0), np.sqrt(1.0/3.0),-1.0/3.0],
!                [ 1.0, np.sqrt(1.0/3.0),1.0, np.sqrt(1.0/3.0), 1.0/3.0, np.sqrt(1.0/3.0), np.sqrt(1.0/3.0), 1.0/3.0],
!                ]
!val_6 = torch.tensor(val_6_data,requires_grad=False,dtype=torch.float64)
!
!
!
!
!
!#--------------------------------------------------------------------
!
!# Matrix modes_to_nodes
!val_r_inv = torch.inverse(val_r)
!
!
!# Computes coordiantes modes
!coords_modes = torch.mm(val_r_inv,coords)
!
!
!# Initialized coordiantes
!interp_coords = torch.mm(val_i,coords_modes)
!
!
!# Initialized jacobian
!jacobian     = torch.empty(3,3,nnodes_elem, dtype=torch.float64) 
!jacobian_tmp = torch.empty(3,3,nnodes_elem, dtype=torch.float64) 
!for inode in range(0,nnodes_elem):
!    jacobian_tmp[0,0,inode] = torch.dot(ddxi_i[inode,:]   , coords_modes[:,0])
!    jacobian_tmp[0,1,inode] = torch.dot(ddeta_i[inode,:]  , coords_modes[:,0])
!    jacobian_tmp[0,2,inode] = torch.dot(ddzeta_i[inode,:] , coords_modes[:,0])
!    jacobian_tmp[1,0,inode] = torch.dot(ddxi_i[inode,:]   , coords_modes[:,1])
!    jacobian_tmp[1,1,inode] = torch.dot(ddeta_i[inode,:]  , coords_modes[:,1])
!    jacobian_tmp[1,2,inode] = torch.dot(ddzeta_i[inode,:] , coords_modes[:,1])
!    jacobian_tmp[2,0,inode] = torch.dot(ddxi_i[inode,:]   , coords_modes[:,2])
!    jacobian_tmp[2,1,inode] = torch.dot(ddeta_i[inode,:]  , coords_modes[:,2])
!    jacobian_tmp[2,2,inode] = torch.dot(ddzeta_i[inode,:] , coords_modes[:,2])
!    update_progress("Computing Jacobian                 ", inode/(nnodes_elem-1))
!if coord_sys == 'CYLINDRICAL':
!    jacobian = jacobian_tmp.clone()
!    scaling_factor = torch.mv(val_i,coords_modes[:,0])
!    for inode in range(0,nnodes_elem):
!        jacobian[1,0,inode] = jacobian_tmp[1,0,inode] * scaling_factor[inode]
!        jacobian[1,1,inode] = jacobian_tmp[1,1,inode] * scaling_factor[inode]
!        jacobian[1,2,inode] = jacobian_tmp[1,2,inode] * scaling_factor[inode]
!else:
!    jacobian = jacobian_tmp.clone()
!
!
!# Matrics and Determinant
!metrics = torch.empty(3,3,nnodes_elem, dtype=torch.float64) 
!jinv    = torch.empty(nnodes_elem, dtype=torch.float64) 
!for inode in range(0,nnodes_elem):
!    ijacobian = torch.empty(3,3, dtype=torch.float64)
!    imetric   = torch.empty(3,3, dtype=torch.float64)
!    for irow in range(0,3):
!        for icol in range(0,3):
!            ijacobian[irow,icol] = jacobian[irow,icol,inode]
!    # Compute jacobian for the ith node
!    update_progress("Computing Jinv and Metric          ", inode/(nnodes_elem-1))
!    jinv[inode] = torch.det(ijacobian) 
!    imetric     = torch.inverse(ijacobian)
!    for irow in range(0,3):
!        for icol in range(0,3):
!            metrics[irow,icol,inode] = imetric[irow,icol]
!
! 
!# Compute inverse Mass matrix
!invmass = torch.empty(nterms_s,nterms_s,nnodes_elem, dtype=torch.float64)
!mass    = torch.empty(nterms_s,nterms_s,nnodes_elem, dtype=torch.float64)
!val_tmp = torch.empty(nterms_s,nnodes_elem, dtype=torch.float64)
!i = 1
!for iterm in range(0,nterms_s):
!    for inode in range(0,nnodes_elem):
!        val_tmp[inode,iterm] = val_i[inode,iterm] * weights_e[inode] * jinv[inode]
!        update_progress("Computing invmass                  ", i/(nterms_s*nnodes_elem))
!        i += 1
!mass    = torch.mm(torch.t(val_tmp),val_i)
!invmass = torch.inverse(mass)
!
!
!# Compute BR2_VOL for each face
!br2_vol_face1 = torch.mm(val_i,torch.mm(invmass,torch.t(val_1)))
!br2_vol_face2 = torch.mm(val_i,torch.mm(invmass,torch.t(val_2)))
!br2_vol_face3 = torch.mm(val_i,torch.mm(invmass,torch.t(val_3)))
!br2_vol_face4 = torch.mm(val_i,torch.mm(invmass,torch.t(val_4)))
!br2_vol_face5 = torch.mm(val_i,torch.mm(invmass,torch.t(val_5)))
!br2_vol_face6 = torch.mm(val_i,torch.mm(invmass,torch.t(val_6)))
!update_progress("Computing br2_vol                  ", 1)
!
!
!# Compute BR2_FACE for each face
!br2_face_face1 = torch.mm(val_1,torch.mm(invmass,torch.t(val_1)))
!br2_face_face2 = torch.mm(val_2,torch.mm(invmass,torch.t(val_2)))
!br2_face_face3 = torch.mm(val_3,torch.mm(invmass,torch.t(val_3)))
!br2_face_face4 = torch.mm(val_4,torch.mm(invmass,torch.t(val_4)))
!br2_face_face5 = torch.mm(val_5,torch.mm(invmass,torch.t(val_5)))
!br2_face_face6 = torch.mm(val_6,torch.mm(invmass,torch.t(val_6)))
!update_progress("Computing br2_face                 ", 1)
!
!
!# Grad1, Grad2, and Grad3
!grad1 = torch.empty(nnodes_elem,nterms_s, dtype=torch.float64)
!grad2 = torch.empty(nnodes_elem,nterms_s, dtype=torch.float64)
!grad3 = torch.empty(nnodes_elem,nterms_s, dtype=torch.float64)
!i = 1
!for iterm in range(0,nterms_s):
!    for inode in range(0,nnodes_elem):
!        grad1[inode,iterm] = metrics[0,0,inode] * ddxi_i[inode,iterm] + metrics[1,0,inode] * ddeta_i[inode,iterm] + metrics[2,0,inode] * ddzeta_i[inode,iterm] 
!        grad2[inode,iterm] = metrics[0,1,inode] * ddxi_i[inode,iterm] + metrics[1,1,inode] * ddeta_i[inode,iterm] + metrics[2,1,inode] * ddzeta_i[inode,iterm] 
!        grad3[inode,iterm] = metrics[0,2,inode] * ddxi_i[inode,iterm] + metrics[1,2,inode] * ddeta_i[inode,iterm] + metrics[2,2,inode] * ddzeta_i[inode,iterm] 
!        update_progress("Computing grad1, grad2, grad3      ", i/(nnodes_elem*nterms_s))
!        i += 1
!
!
!
!
!
!
!
!#WRITE_____________________
!
!#
!# Metrics
!#
!f = open("metrics.txt","w")
!i = 1
!for inode in range (0,nnodes_elem):
!    f.write("Metric interpolation node %d \n" % (inode+1))
!    array = np.zeros([3, 3])
!    for irow in range(0,3):
!        for icol in range(0,3):
!            array[irow,icol] = metrics[irow,icol,inode].item() 
!            update_progress("Writing metrics to file            ", i/(nnodes_elem*9))
!            i += 1
!    np.savetxt(f,array)
!f.close()
!
!#
!# jinv
!#
!f = open("jinv.txt","w")
!array = np.zeros([1])
!i = 1
!for inode in range (0,nnodes_elem):
!    f.write("Jinv interpolation node %d \n" % (inode+1))
!    array[0] = jinv[inode].item()
!    np.savetxt(f,array)
!    update_progress("Writing jinv to file               ", i/(nnodes_elem))
!    i += 1
!f.close()
!
!#
!# Grad1
!#
!f = open("grad1.txt","w")
!f.write("Grad1 \n")
!array = np.zeros([nnodes_elem,nterms_s])
!i = 1
!for inode in range (0,nnodes_elem):
!    for iterm in range(0,nterms_s):
!        array[inode,iterm] = grad1[inode,iterm].item()
!        update_progress("Writing grad1 to file              ", i/(nnodes_elem*nterms_s))
!        i += 1
!np.savetxt(f,array)
!f.close()
!
!#
!# Grad2
!#
!f = open("grad2.txt","w")
!f.write("Grad2 \n")
!array = np.zeros([nnodes_elem,nterms_s])
!i = 1
!for inode in range (0,nnodes_elem):
!    for iterm in range(0,nterms_s):
!        array[inode,iterm] = grad2[inode,iterm].item()
!        update_progress("Writing grad2 to file              ", i/(nnodes_elem*nterms_s))
!        i += 1
!np.savetxt(f,array)
!f.close()
!
!#
!# Grad3
!#
!f = open("grad3.txt","w")
!f.write("Grad3 \n")
!array = np.zeros([nnodes_elem,nterms_s])
!i = 1
!for inode in range (0,nnodes_elem):
!    for iterm in range(0,nterms_s):
!        array[inode,iterm] = grad3[inode,iterm].item()
!        update_progress("Writing grad3 to file              ", i/(nnodes_elem*nterms_s))
!        i += 1
!np.savetxt(f,array)
!f.close()
!
!#
!# dmetric_dx
!#
!f = open("dmetric_dx.txt","w")
!i = 1
!for inode in range (0,nnodes_elem):
!    for inode_diff in range(0,nnodes_r):
!        for idir in range(0,ndirs):
!            array = np.zeros([3,3])
!#            f.write("dmetric_dx interpolation node %s, diff_node %s, diff_dir %s \n" % (inode+1,inode_diff+1,idir+1))
!            f.write("test_dmetric_dx(:,:,"+str(inode+1)+","+str(inode_diff+1)+","+str(idir+1)+") = reshape((/ &\n")
!            for irow in range(0,3):
!                row = ''
!                for icol in range(0,3):
!                    data = metrics[irow,icol,inode]
!                    data.backward(retain_graph=True)
!                    ddata = coords.grad
!                    ddata_np = ddata.numpy()
!                    array[irow,icol] = ddata_np[inode_diff,idir]
!                    update_progress("Writing dmetric_dx to file         ", i/(nnodes_elem*nnodes_r*ndirs*3*3))
!                    # This avoid to accumulate derivatives
!                    dummy = coords.grad.data.zero_()
!                    row = row + str(array[irow,icol])+'_rk'
!                    if ((icol == 2) and (irow == 2)):
!                        row = row + '   &\n'
!                    elif ((icol == 2) and (irow != 2)):
!                        row = row + "," +  "   &\n"
!                    else:
!                        row = row + ', '
!                    i += 1
!                f.write(row)
!            f.write("/),(/3,3/))\n")
!f.close()
!
!#
!# interp_coords_dx
!#
!f = open("dinterp_xcoords_dx.txt","w")
!i = 1
!f.write("test_dcoords_dx = reshape((/ &\n")
!array = np.zeros([nnodes_elem,nnodes_r*ndirs])
!for inode in range (0,nnodes_elem):
!    data = interp_coords[inode,0]
!    data.backward(retain_graph=True)
!    ddata = coords.grad
!    ddata_np = ddata.numpy()
!
!    row = ''
!    for idir in range(0,ndirs):
!        for inode_diff in range(0,nnodes_r):
!
!            if idir == 0:
!                index = inode_diff
!            elif idir == 1:
!                index = nnodes_r + inode_diff
!            elif idir == 2:
!                index = 2*nnodes_r + inode_diff
!            array[inode,index] = ddata_np[inode_diff,idir]
!            update_progress("Writing interp_xcoords_dx to file  ", i/(nnodes_elem*nnodes_r*3))
!
!            row = row + str(array[inode,index])+'_rk'
!            if ((index == ndirs*nnodes_r-1) and (inode == nnodes_r-1)):
!                row = row + '   &\n'
!            elif ((index == ndirs*nnodes_r-1) and (inode != nnodes_r-1)):
!                row = row + "," +  "   &\n"
!            else:
!                row = row + ', '
!            i += 1
!
!    # This avoid to accumulate derivatives
!    dummy = coords.grad.data.zero_()
!    f.write(row)
!f.write("/),(/24,8/))\n")
!f.close()
!
!
!f = open("dinterp_ycoords_dx.txt","w")
!i = 1
!f.write("test_dcoords_dx = reshape((/ &\n")
!array = np.zeros([nnodes_elem,nnodes_r*ndirs])
!for inode in range (0,nnodes_elem):
!    data = interp_coords[inode,1]
!    data.backward(retain_graph=True)
!    ddata = coords.grad
!    ddata_np = ddata.numpy()
!
!    row = ''
!    for idir in range(0,ndirs):
!        for inode_diff in range(0,nnodes_r):
!
!            if idir == 0:
!                index = inode_diff
!            elif idir == 1:
!                index = nnodes_r + inode_diff
!            elif idir == 2:
!                index = 2*nnodes_r + inode_diff
!            array[inode,index] = ddata_np[inode_diff,idir]
!            update_progress("Writing interp_ycoords_dx to file  ", i/(nnodes_elem*nnodes_r*3))
!
!            row = row + str(array[inode,index])+'_rk'
!            if ((index == ndirs*nnodes_r-1) and (inode == nnodes_r-1)):
!                row = row + '   &\n'
!            elif ((index == ndirs*nnodes_r-1) and (inode != nnodes_r-1)):
!                row = row + "," +  "   &\n"
!            else:
!                row = row + ', '
!            i += 1
!
!    # This avoid to accumulate derivatives
!    dummy = coords.grad.data.zero_()
!    f.write(row)
!f.write("/),(/24,8/))\n")
!f.close()
!
!
!
!f = open("dinterp_zcoords_dx.txt","w")
!i = 1
!f.write("test_dcoords_dx = reshape((/ &\n")
!array = np.zeros([nnodes_elem,nnodes_r*ndirs])
!for inode in range (0,nnodes_elem):
!    data = interp_coords[inode,2]
!    data.backward(retain_graph=True)
!    ddata = coords.grad
!    ddata_np = ddata.numpy()
!
!    row = ''
!    for idir in range(0,ndirs):
!        for inode_diff in range(0,nnodes_r):
!
!            if idir == 0:
!                index = inode_diff
!            elif idir == 1:
!                index = nnodes_r + inode_diff
!            elif idir == 2:
!                index = 2*nnodes_r + inode_diff
!            array[inode,index] = ddata_np[inode_diff,idir]
!            update_progress("Writing interp_zcoords_dx to file  ", i/(nnodes_elem*nnodes_r*3))
!
!            row = row + str(array[inode,index])+'_rk'
!            if ((index == ndirs*nnodes_r-1) and (inode == nnodes_r-1)):
!                row = row + '   &\n'
!            elif ((index == ndirs*nnodes_r-1) and (inode != nnodes_r-1)):
!                row = row + "," +  "   &\n"
!            else:
!                row = row + ', '
!            i += 1
!
!    # This avoid to accumulate derivatives
!    dummy = coords.grad.data.zero_()
!    f.write(row)
!f.write("/),(/24,8/))\n")
!f.close()
!
!
!
!#
!# djinv_dx
!#
!f = open("djinv_dx.txt","w")
!i = 1
!for inode in range (0,nnodes_elem):
!
!    f.write("test_djinv_dx("+str(inode+1)+",:,:) = reshape((/ &\n")
!    array = np.zeros([nnodes_r,ndirs])
!#    f.write("djinv_dx interpolation node %s, row=inode_diff, col=dir \n" % (inode+1))
!    for inode_diff in range(0,nnodes_r):
!        row = ''
!        for idir in range(0,ndirs):
!                data = jinv[inode]
!                data.backward(retain_graph=True)
!                ddata = coords.grad
!                ddata_np = ddata.numpy()
!                array[inode_diff,idir] = ddata_np[inode_diff,idir]
!                update_progress("Writing djinv_dx to file           ", i/(nnodes_elem*nnodes_r*ndirs))
!                dummy = coords.grad.data.zero_()
!                i += 1
!
!                row = row + str(array[inode_diff,idir])+'_rk'
!                if ((idir == ndirs-1) and (inode_diff == nnodes_r-1)):
!                    row = row + '   &\n'
!                elif ((idir == ndirs-1) and (inode_diff != nnodes_r-1)):
!                    row = row + "," +  "   &\n"
!                else:
!                    row = row + ', '
!
!        f.write(row)
!    f.write("/),(/3,8/))\n")
!f.close()
!
!#
!# dmass_dx
!# 
!f = open("dmass_dx.txt","w")
!i = 1
!for inode_diff in range(0,nnodes_r):
!    for idir in range(0,ndirs):
!
!        f.write("test_dmass_dx(:,:,"+str(inode_diff+1)+","+str(idir+1)+") = reshape((/ &\n")
!        array = np.zeros([nterms_s,nterms_s])
!        for irow in range(0,nterms_s):
!            row = ''
!            for icol in range(0,nterms_s):
!                data = mass[irow,icol]
!                data.backward(retain_graph=True)
!                ddata = coords.grad
!                ddata_np = ddata.numpy()
!                array[irow,icol] = ddata_np[inode_diff,idir]
!                update_progress("Writing dmass_dx to file          ", i/(nnodes_elem*nnodes_r*ndirs*nterms_s))
!                dummy = coords.grad.data.zero_()
!
!                row = row + str(array[irow,icol])+'_rk'
!                if ((icol == nterms_s-1) and (irow == nterms_s-1)):
!                    row = row + '   &\n'
!                elif ((icol == nterms_s-1) and (irow != nterms_s-1)):
!                    row = row + "," +  "   &\n"
!                else:
!                    row = row + ', '
!                i += 1
!            f.write(row)
!        f.write("/),(/8,8/))\n")
!f.close()
!
!#
!# dinvmass_dx
!# 
!f = open("dinvmass_dx.txt","w")
!i = 1
!for inode_diff in range(0,nnodes_r):
!    for idir in range(0,ndirs):
!
!        f.write("test_dinvmass_dx(:,:,"+str(inode_diff+1)+","+str(idir+1)+") = reshape((/ &\n")
!        array = np.zeros([nterms_s,nterms_s])
!        for irow in range(0,nterms_s):
!            row = ''
!            for icol in range(0,nterms_s):
!                data = invmass[irow,icol]
!                data.backward(retain_graph=True)
!                ddata = coords.grad
!                ddata_np = ddata.numpy()
!                array[irow,icol] = ddata_np[inode_diff,idir]
!                update_progress("Writing dinvmass_dx to file          ", i/(nnodes_elem*nnodes_r*ndirs*nterms_s))
!                dummy = coords.grad.data.zero_()
!
!                row = row + str(array[irow,icol])+'_rk'
!                if ((icol == nterms_s-1) and (irow == nterms_s-1)):
!                    row = row + '   &\n'
!                elif ((icol == nterms_s-1) and (irow != nterms_s-1)):
!                    row = row + "," +  "   &\n"
!                else:
!                    row = row + ', '
!                i += 1
!            f.write(row)
!        f.write("/),(/8,8/))\n")
!f.close()
!
!#
!# dbr2_vol_dx
!#
!f = open("dbr2_vol_face1_dx.txt","w")
!i = 1
!for inode_diff in range(0,nnodes_r):
!    for idir in range(0,ndirs):
!
!        f.write("test_dbr2_vol_face1_dx(:,:,"+str(inode_diff+1)+","+str(idir+1)+") = reshape((/ &\n")
!        array = np.zeros([nnodes_elem,nnodes_face])
!        for irow in range(0,nnodes_elem):
!            row = ''
!            for icol in range(0,nnodes_face):
!                data = br2_vol_face1[irow,icol]
!                data.backward(retain_graph=True)
!                ddata = coords.grad
!                ddata_np = ddata.numpy()
!                array[irow,icol] = ddata_np[inode_diff,idir]
!                update_progress("Writing ddbr2_vol_face1_dx to file          ", i/(nnodes_r*ndirs*nnodes_elem*nnodes_face))
!                dummy = coords.grad.data.zero_()
!
!                row = row + str(array[irow,icol])+'_rk'
!                if ((icol == nnodes_face-1) and (irow == nnodes_elem-1)):
!                    row = row + '   &\n'
!                elif ((icol == nnodes_face-1) and (irow != nnodes_elem-1)):
!                    row = row + "," +  "   &\n"
!                else:
!                    row = row + ', '
!                i += 1
!            f.write(row)
!        f.write("/),(/4,8/))\n")
!f.close()
!
!
!f = open("dbr2_vol_face2_dx.txt","w")
!i = 1
!for inode_diff in range(0,nnodes_r):
!    for idir in range(0,ndirs):
!
!        f.write("test_dbr2_vol_face2_dx(:,:,"+str(inode_diff+1)+","+str(idir+1)+") = reshape((/ &\n")
!        array = np.zeros([nnodes_elem,nnodes_face])
!        for irow in range(0,nnodes_elem):
!            row = ''
!            for icol in range(0,nnodes_face):
!                data = br2_vol_face2[irow,icol]
!                data.backward(retain_graph=True)
!                ddata = coords.grad
!                ddata_np = ddata.numpy()
!                array[irow,icol] = ddata_np[inode_diff,idir]
!                update_progress("Writing ddbr2_vol_face2_dx to file          ", i/(nnodes_elem*nnodes_r*ndirs*nnodes_face))
!                dummy = coords.grad.data.zero_()
!
!                row = row + str(array[irow,icol])+'_rk'
!                if ((icol == nnodes_face-1) and (irow == nnodes_elem-1)):
!                    row = row + '   &\n'
!                elif ((icol == nnodes_face-1) and (irow != nnodes_elem-1)):
!                    row = row + "," +  "   &\n"
!                else:
!                    row = row + ', '
!                i += 1
!            f.write(row)
!        f.write("/),(/4,8/))\n")
!f.close()
!
!
!f = open("dbr2_vol_face3_dx.txt","w")
!i = 1
!for inode_diff in range(0,nnodes_r):
!    for idir in range(0,ndirs):
!        f.write("test_dbr2_vol_face3_dx(:,:,"+str(inode_diff+1)+","+str(idir+1)+") = reshape((/ &\n")
!        array = np.zeros([nnodes_elem,nnodes_face])
!        for irow in range(0,nnodes_elem):
!            row = ''
!            for icol in range(0,nnodes_face):
!                data = br2_vol_face3[irow,icol]
!                data.backward(retain_graph=True)
!                ddata = coords.grad
!                ddata_np = ddata.numpy()
!                array[irow,icol] = ddata_np[inode_diff,idir]
!                update_progress("Writing ddbr2_vol_face3_dx to file          ", i/(nnodes_elem*nnodes_r*ndirs*nnodes_face))
!                dummy = coords.grad.data.zero_()
!
!                row = row + str(array[irow,icol])+'_rk'
!                if ((icol == nnodes_face-1) and (irow == nnodes_elem-1)):
!                    row = row + '   &\n'
!                elif ((icol == nnodes_face-1) and (irow != nnodes_elem-1)):
!                    row = row + "," +  "   &\n"
!                else:
!                    row = row + ', '
!                i += 1
!            f.write(row)
!        f.write("/),(/4,8/))\n")
!f.close()
!
!
!f = open("dbr2_vol_face4_dx.txt","w")
!i = 1
!for inode_diff in range(0,nnodes_r):
!    for idir in range(0,ndirs):
!
!        f.write("test_dbr2_vol_face4_dx(:,:,"+str(inode_diff+1)+","+str(idir+1)+") = reshape((/ &\n")
!        array = np.zeros([nnodes_elem,nnodes_face])
!        for irow in range(0,nnodes_elem):
!            row = ''
!            for icol in range(0,nnodes_face):
!                data = br2_vol_face4[irow,icol]
!                data.backward(retain_graph=True)
!                ddata = coords.grad
!                ddata_np = ddata.numpy()
!                array[irow,icol] = ddata_np[inode_diff,idir]
!                update_progress("Writing dbr2_vol_face4_dx to file          ", i/(nnodes_elem*nnodes_r*ndirs*nnodes_face))
!                dummy = coords.grad.data.zero_()
!
!                row = row + str(array[irow,icol])+'_rk'
!                if ((icol == nnodes_face-1) and (irow == nnodes_elem-1)):
!                    row = row + '   &\n'
!                elif ((icol == nnodes_face-1) and (irow != nnodes_elem-1)):
!                    row = row + "," +  "   &\n"
!                else:
!                    row = row + ', '
!                i += 1
!            f.write(row)
!        f.write("/),(/4,8/))\n")
!f.close()
!
!
!f = open("dbr2_vol_face5_dx.txt","w")
!i = 1
!for inode_diff in range(0,nnodes_r):
!    for idir in range(0,ndirs):
!
!        f.write("test_dbr2_vol_face5_dx(:,:,"+str(inode_diff+1)+","+str(idir+1)+") = reshape((/ &\n")
!        array = np.zeros([nnodes_elem,nnodes_face])
!        for irow in range(0,nnodes_elem):
!            row = ''
!            for icol in range(0,nnodes_face):
!                data = br2_vol_face5[irow,icol]
!                data.backward(retain_graph=True)
!                ddata = coords.grad
!                ddata_np = ddata.numpy()
!                array[irow,icol] = ddata_np[inode_diff,idir]
!                update_progress("Writing dbr2_vol_face5_dx to file          ", i/(nnodes_elem*nnodes_r*ndirs*nnodes_face))
!                dummy = coords.grad.data.zero_()
!
!                row = row + str(array[irow,icol])+'_rk'
!                if ((icol == nnodes_face-1) and (irow == nnodes_elem-1)):
!                    row = row + '   &\n'
!                elif ((icol == nnodes_face-1) and (irow != nnodes_elem-1)):
!                    row = row + "," +  "   &\n"
!                else:
!                    row = row + ', '
!                i += 1
!            f.write(row)
!        f.write("/),(/4,8/))\n")
!f.close()
!
!
!f = open("dbr2_vol_face6_dx.txt","w")
!i = 1
!for inode_diff in range(0,nnodes_r):
!    for idir in range(0,ndirs):
!
!        f.write("test_dbr2_vol_face6_dx(:,:,"+str(inode_diff+1)+","+str(idir+1)+") = reshape((/ &\n")
!        array = np.zeros([nnodes_elem,nnodes_face])
!        for irow in range(0,nnodes_elem):
!            row = ''
!            for icol in range(0,nnodes_face):
!                data = br2_vol_face6[irow,icol]
!                data.backward(retain_graph=True)
!                ddata = coords.grad
!                ddata_np = ddata.numpy()
!                array[irow,icol] = ddata_np[inode_diff,idir]
!                update_progress("Writing dbr2_vol_face6_dx to file          ", i/(nnodes_elem*nnodes_r*ndirs*nnodes_face))
!                dummy = coords.grad.data.zero_()
!
!                row = row + str(array[irow,icol])+'_rk'
!                if ((icol == nnodes_face-1) and (irow == nnodes_elem-1)):
!                    row = row + '   &\n'
!                elif ((icol == nnodes_face-1) and (irow != nnodes_elem-1)):
!                    row = row + "," +  "   &\n"
!                else:
!                    row = row + ', '
!                i += 1
!            f.write(row)
!        f.write("/),(/4,8/))\n")
!f.close()
!
!#
!# dbr2_face_dx
!#
!f = open("dbr2_face_face1_dx.txt","w")
!i = 1
!for inode_diff in range(0,nnodes_r):
!    for idir in range(0,ndirs):
!
!        f.write("test_dbr2_face_face1_dx(:,:,"+str(inode_diff+1)+","+str(idir+1)+") = reshape((/ &\n")
!        array = np.zeros([nnodes_face,nnodes_face])
!        for irow in range(0,nnodes_face):
!            row = ''
!            for icol in range(0,nnodes_face):
!                data = br2_face_face1[irow,icol]
!                data.backward(retain_graph=True)
!                ddata = coords.grad
!                ddata_np = ddata.numpy()
!                array[irow,icol] = ddata_np[inode_diff,idir]
!                update_progress("Writing dbr2_face_face1_dx to file          ", i/(nnodes_face*nnodes_face*ndirs*nterms_s))
!                dummy = coords.grad.data.zero_()
!
!                row = row + str(array[irow,icol])+'_rk'
!                if ((icol == nnodes_face-1) and (irow == nnodes_face-1)):
!                    row = row + '   &\n'
!                elif ((icol == nnodes_face-1) and (irow != nnodes_face-1)):
!                    row = row + "," +  "   &\n"
!                else:
!                    row = row + ', '
!                i += 1
!            f.write(row)
!        f.write("/),(/4,4/))\n")
!f.close()
!
!
!f = open("dbr2_face_face2_dx.txt","w")
!i = 1
!for inode_diff in range(0,nnodes_r):
!    for idir in range(0,ndirs):
!
!        f.write("test_dbr2_face_face2_dx(:,:,"+str(inode_diff+1)+","+str(idir+1)+") = reshape((/ &\n")
!        array = np.zeros([nnodes_face,nnodes_face])
!        for irow in range(0,nnodes_face):
!            row = ''
!            for icol in range(0,nnodes_face):
!                data = br2_face_face2[irow,icol]
!                data.backward(retain_graph=True)
!                ddata = coords.grad
!                ddata_np = ddata.numpy()
!                array[irow,icol] = ddata_np[inode_diff,idir]
!                update_progress("Writing dbr2_face_face2_dx to file          ", i/(nnodes_face*nnodes_face*ndirs*nterms_s))
!                dummy = coords.grad.data.zero_()
!
!                row = row + str(array[irow,icol])+'_rk'
!                if ((icol == nnodes_face-1) and (irow == nnodes_face-1)):
!                    row = row + '   &\n'
!                elif ((icol == nnodes_face-1) and (irow != nnodes_face-1)):
!                    row = row + "," +  "   &\n"
!                else:
!                    row = row + ', '
!                i += 1
!            f.write(row)
!        f.write("/),(/4,4/))\n")
!f.close()
!
!
!f = open("dbr2_face_face3_dx.txt","w")
!i = 1
!for inode_diff in range(0,nnodes_r):
!    for idir in range(0,ndirs):
!
!        f.write("test_dbr2_face_face3_dx(:,:,"+str(inode_diff+1)+","+str(idir+1)+") = reshape((/ &\n")
!        array = np.zeros([nnodes_face,nnodes_face])
!        for irow in range(0,nnodes_face):
!            row = ''
!            for icol in range(0,nnodes_face):
!                data = br2_face_face3[irow,icol]
!                data.backward(retain_graph=True)
!                ddata = coords.grad
!                ddata_np = ddata.numpy()
!                array[irow,icol] = ddata_np[inode_diff,idir]
!                update_progress("Writing dbr2_face_face3_dx to file          ", i/(nnodes_face*nnodes_face*ndirs*nterms_s))
!                dummy = coords.grad.data.zero_()
!
!                row = row + str(array[irow,icol])+'_rk'
!                if ((icol == nnodes_face-1) and (irow == nnodes_face-1)):
!                    row = row + '   &\n'
!                elif ((icol == nnodes_face-1) and (irow != nnodes_face-1)):
!                    row = row + "," +  "   &\n"
!                else:
!                    row = row + ', '
!                i += 1
!            f.write(row)
!        f.write("/),(/4,4/))\n")
!f.close()
!
!
!f = open("dbr2_face_face4_dx.txt","w")
!i = 1
!for inode_diff in range(0,nnodes_r):
!    for idir in range(0,ndirs):
!
!        f.write("test_dbr2_face_face4_dx(:,:,"+str(inode_diff+1)+","+str(idir+1)+") = reshape((/ &\n")
!        array = np.zeros([nnodes_face,nnodes_face])
!        for irow in range(0,nnodes_face):
!            row = ''
!            for icol in range(0,nnodes_face):
!                data = br2_face_face4[irow,icol]
!                data.backward(retain_graph=True)
!                ddata = coords.grad
!                ddata_np = ddata.numpy()
!                array[irow,icol] = ddata_np[inode_diff,idir]
!                update_progress("Writing dbr2_face_face4_dx to file          ", i/(nnodes_face*nnodes_face*ndirs*nterms_s))
!                dummy = coords.grad.data.zero_()
!
!                row = row + str(array[irow,icol])+'_rk'
!                if ((icol == nnodes_face-1) and (irow == nnodes_face-1)):
!                    row = row + '   &\n'
!                elif ((icol == nnodes_face-1) and (irow != nnodes_face-1)):
!                    row = row + "," +  "   &\n"
!                else:
!                    row = row + ', '
!                i += 1
!            f.write(row)
!        f.write("/),(/4,4/))\n")
!f.close()
!
!
!f = open("dbr2_face_face5_dx.txt","w")
!i = 1
!for inode_diff in range(0,nnodes_r):
!    for idir in range(0,ndirs):
!
!        f.write("test_dbr2_face_face5_dx(:,:,"+str(inode_diff+1)+","+str(idir+1)+") = reshape((/ &\n")
!        array = np.zeros([nnodes_face,nnodes_face])
!        for irow in range(0,nnodes_face):
!            row = ''
!            for icol in range(0,nnodes_face):
!                data = br2_face_face5[irow,icol]
!                data.backward(retain_graph=True)
!                ddata = coords.grad
!                ddata_np = ddata.numpy()
!                array[irow,icol] = ddata_np[inode_diff,idir]
!                update_progress("Writing dbr2_face_face5_dx to file          ", i/(nnodes_face*nnodes_face*ndirs*nterms_s))
!                dummy = coords.grad.data.zero_()
!
!                row = row + str(array[irow,icol])+'_rk'
!                if ((icol == nnodes_face-1) and (irow == nnodes_face-1)):
!                    row = row + '   &\n'
!                elif ((icol == nnodes_face-1) and (irow != nnodes_face-1)):
!                    row = row + "," +  "   &\n"
!                else:
!                    row = row + ', '
!                i += 1
!            f.write(row)
!        f.write("/),(/4,4/))\n")
!f.close()
!
!
!f = open("dbr2_face_face6_dx.txt","w")
!i = 1
!for inode_diff in range(0,nnodes_r):
!    for idir in range(0,ndirs):
!
!        f.write("test_dbr2_face_face6_dx(:,:,"+str(inode_diff+1)+","+str(idir+1)+") = reshape((/ &\n")
!        array = np.zeros([nnodes_face,nnodes_face])
!        for irow in range(0,nnodes_face):
!            row = ''
!            for icol in range(0,nnodes_face):
!                data = br2_face_face6[irow,icol]
!                data.backward(retain_graph=True)
!                ddata = coords.grad
!                ddata_np = ddata.numpy()
!                array[irow,icol] = ddata_np[inode_diff,idir]
!                update_progress("Writing dbr2_face_face6_dx to file          ", i/(nnodes_face*nnodes_face*ndirs*nterms_s))
!                dummy = coords.grad.data.zero_()
!
!                row = row + str(array[irow,icol])+'_rk'
!                if ((icol == nnodes_face-1) and (irow == nnodes_face-1)):
!                    row = row + '   &\n'
!                elif ((icol == nnodes_face-1) and (irow != nnodes_face-1)):
!                    row = row + "," +  "   &\n"
!                else:
!                    row = row + ', '
!                i += 1
!            f.write(row)
!        f.write("/),(/4,4/))\n")
!f.close()
!
!
!#
!# dgrad1_dx
!#
!f = open("dgrad1_dx.txt","w")
!i = 1
!for inode_diff in range(0,nnodes_r):
!    for idir in range(0,ndirs):
!        f.write("test_dgrad1_dx(:,:,"+str(inode_diff+1)+","+str(idir+1)+") = reshape((/ &\n")
!        array = np.zeros([nnodes_elem,nterms_s])
!        for irow in range(0,nnodes_elem):
!            row = ''
!            for icol in range(0,nterms_s):
!                data = grad1[irow,icol]
!                data.backward(retain_graph=True)
!                ddata = coords.grad
!                ddata_np = ddata.numpy()
!                array[irow,icol] = ddata_np[inode_diff,idir]
!                update_progress("Writing dgrad1_dx to file          ", i/(nnodes_elem*nnodes_r*ndirs*nterms_s))
!                dummy = coords.grad.data.zero_()
!
!                row = row + str(array[irow,icol])+'_rk'
!                if ((icol == nterms_s-1) and (irow == nnodes_elem-1)):
!                    row = row + '   &\n'
!                elif ((icol == nterms_s-1) and (irow != nnodes_elem-1)):
!                    row = row + "," +  "   &\n"
!                else:
!                    row = row + ', '
!                i += 1
!            f.write(row)
!        f.write("/),(/8,8/))\n")
!f.close()
!
!
!#
!# dgrad2_dx
!#
!f = open("dgrad2_dx.txt","w")
!i = 1
!for inode_diff in range(0,nnodes_r):
!    for idir in range(0,ndirs):
!        f.write("test_dgrad2_dx(:,:,"+str(inode_diff+1)+","+str(idir+1)+") = reshape((/ &\n")
!        array = np.zeros([nnodes_elem,nterms_s])
!        for irow in range(0,nnodes_elem):
!            row = ''
!            for icol in range(0,nterms_s):
!                data = grad2[irow,icol]
!                data.backward(retain_graph=True)
!                ddata = coords.grad
!                ddata_np = ddata.numpy()
!                array[irow,icol] = ddata_np[inode_diff,idir]
!                update_progress("Writing dgrad2_dx to file          ", i/(nnodes_elem*nnodes_r*ndirs*nterms_s))
!                dummy = coords.grad.data.zero_()
!
!                row = row + str(array[irow,icol])+'_rk'
!                if ((icol == nterms_s-1) and (irow == nnodes_elem-1)):
!                    row = row + '   &\n'
!                elif ((icol == nterms_s-1) and (irow != nnodes_elem-1)):
!                    row = row + "," +  "   &\n"
!                else:
!                    row = row + ', '
!                i += 1
!            f.write(row)
!        f.write("/),(/8,8/))\n")
!f.close()
!
!
!#
!# dgrad3_dx
!#
!f = open("dgrad3_dx.txt","w")
!i = 1
!for inode_diff in range(0,nnodes_r):
!    for idir in range(0,ndirs):
!        f.write("test_dgrad3_dx(:,:,"+str(inode_diff+1)+","+str(idir+1)+") = reshape((/ &\n")
!        array = np.zeros([nnodes_elem,nterms_s])
!        for irow in range(0,nnodes_elem):
!            row = ''
!            for icol in range(0,nterms_s):
!                data = grad3[irow,icol]
!                data.backward(retain_graph=True)
!                ddata = coords.grad
!                ddata_np = ddata.numpy()
!                array[irow,icol] = ddata_np[inode_diff,idir]
!                update_progress("Writing dgrad3_dx to file          ", i/(nnodes_elem*nnodes_r*ndirs*nterms_s))
!                dummy = coords.grad.data.zero_()
!
!                row = row + str(array[irow,icol])+'_rk'
!                if ((icol == nterms_s-1) and (irow == nnodes_elem-1)):
!                    row = row + '   &\n'
!                elif ((icol == nterms_s-1) and (irow != nnodes_elem-1)):
!                    row = row + "," +  "   &\n"
!                else:
!                    row = row + ', '
!                i += 1
!            f.write(row)
!        f.write("/),(/8,8/))\n")
!f.close()
!
!





end module test_element_linearC_dx_mod
